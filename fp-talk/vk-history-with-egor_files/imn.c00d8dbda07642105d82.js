(()=>{var __webpack_modules__={520797:e=>{e.exports={im_img_prebody:'<div class="im-prebody"> <img alt="" src="%photo%" /> </div>',im_admin_link:' (<a href="%href%" class="_im_admin_name" target="_blank">%name%</a>)',im_right_menu_tpl:'<a id="ui_rmenu_peer_%peer%" href="%href%" class="_im_peer_tab ui_rmenu_item %cls%" %attrs%>\n  %extra%<span class="ui_rmenu_item_label "><span class="ui_rmenu_label-text">%label%</span></span>\n</a>',im_right_menu_sep:'<div class="ui_rmenu_sep"></div>',im_right_menu_ct:'<div class="ui_rmenu_extra_label"><span class="ui_rmenu_count _im_r_ct _im_r_badge">%count%</span> <button type="button" class="im-right-menu--close _im_r_cl"><svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M4.72 4.72c.3-.3.77-.3 1.06 0L10 8.94l4.22-4.22a.75.75 0 1 1 1.06 1.06L11.06 10l4.22 4.22a.75.75 0 1 1-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 0 1-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 0 1 0-1.06z" fill="currentColor" fill-rule="evenodd"/></svg></button></div>',im_dialogs_link_img:'<a href="%href%" class="_im_peer_target _online_reader" target="_blank"><div class="im_grid">%photo%</div></a>',sImDialogImRowPhoto:'<div class="im_grid">%photo%</div>',im_dialogs_link:'<a href="%href%" class="_im_peer_target _online_reader" target="_blank">%photo%</a>',im_peer_photo:'<div class="nim-peer %online_class% %modifier_class%"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo"> %owner_photo% </div> </div> </div>',im_peer_photo_nft:'<div class="nim-peer %modifier_class%"> %user_photo% %user_icon%</div>',sImContactAvatar:' <div class="ContactAvatar ContactAvatar--%size% %classes%">%name%</div>',sImUserAvatar:' <div class="ImUserAvatar _online %online_class% %classes%"> <img src="%src%" class="ImUserAvatar__img" alt=""> </div>',sImUserNftAvatar:' <div class="ImUserAvatar"> <div class="ImUserAvatar__img" alt=""> <span\nclass="AvatarRich AvatarRich--sz-48 AvatarRich--shadow AvatarRich--nft" style="width: 48px; height: 48px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 3px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%src% class="AvatarRich__img"\n/> <div class="AvatarRich__badge AvatarRich__badge--shadow">%online%</div> </span> </div> </div>',sImDrawNftOnline:' <div class="AvatarRich__badgeIcon--online"> <svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M10 6a4 4 0 1 1-8 0 4 4 0 0 1 8 0z" fill="currentColor"/></svg> </div>',sImDrawNftOnlineMobile:' <div class="AvatarRich__badgeIcon--onlineMobile"> <svg xmlns="http://www.w3.org/2000/svg" width="8" height="12" fill="none" viewBox="0 0 8 12"><path fill="currentColor" d="M5.99 0C7.1 0 8 .9 8 2.01v7.98C8 11.1 7.1 12 5.99 12H2.01C.9 12 0 11.1 0 9.99V2.01C0 .9.9 0 2.01 0h3.98Zm0 3H2a.5.5 0 0 0-.5.5v5c0 .28.23.5.5.5h4a.5.5 0 0 0 .5-.5v-5A.5.5 0 0 0 6 3Z"/></svg> </div>',im_owner_item:'<a href="%link%" class="olist_item_wrap%cls%" id="olist_item_wrap%owner_id%" >\n  <div class="olist_item clear_fix">\n    <div class="olist_item_photo_wrap %img_cls%">\n      <img class="olist_item_photo" src="%photo%"/>\n    </div>\n    <div class="olist_item_name">%name%</div>\n    <div class="olist_checkbox"></div>\n  </div>\n</a>',im_simple_name:function(){return'<div class="im-page--title %more_cls%"> <span class="im-page--title-main" title="%name_attr%" %ads_union%> <span class="im-page--title-main-in"> <a href="%href%" target="_blank" class="im-page--title-main-inner _im_page_peer_name">%name%</a> <span class="im-page--title-main-verified _im_chat_verified"></span> <span class="im-page--title-main-donut _im_chat_donut"></span> </span> </span> <span class="im-page--title-meta _im_page_peer_online">%online%</span> <span class="im-page--title-status _im_page_status"></span> <button class="im-page--title-reconnect _im_page_reconnect">'+getLang("mail_network_reconnect")+"</button> %more_children%</div>"},im_simple_link:'<a href="%href%" class="_im_header_link" target="_blank">%content%</a>',im_selected_messages:'<span class="im-page--selected-messages-count">%label%</span> <button aria-label="%tip%" type="button" class="im-page--selected-messages-remove"></button>',sImSimpleNameBusinessNotifyLabel:'<span class="im-page--title-main-business-notify _im_chat_business_notify">%text%</span>',im_topic:"<div class='im-topic %cls%'>%topic%</div>",im_stack_date:' <a href="%link%" class="_im_mess_link" >%date%</a>',im_dialogs_none:'<li data-list-id="002300" class="im-page--dialogs-empty"> <div class="im-page--dialogs-empty--icon">%icon%</div> %msg%</li>',im_dialogs_active_folder_button:'<li class="im-page--dialogs-folder-button %class_name%" data-list-id="all"> <button class="im-page--dialogs-folder-button--back _im_dialog_folder_back"><svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12.53 4.22a.75.75 0 0 1 0 1.06L7.8 10l4.72 4.72a.75.75 0 1 1-1.06 1.06l-5.25-5.25a.75.75 0 0 1 0-1.06l5.25-5.25a.75.75 0 0 1 1.05 0z" fill="currentColor"/></svg></button> <span class="im-page--dialogs-folder-button--text">%msg%</span> %actions%</li>',im_dialogs_active_folder_button_actions:'<button type="button" class="im-page--dialogs-folder-button--actions _im_dialog_folder_actions" data-folder="%folder%"><svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path d="M9.53 6.42a.75.75 0 0 1 .94 0l5.25 4.25a.75.75 0 1 1-.94 1.16L10 7.96l-4.78 3.87a.75.75 0 1 1-.94-1.16z" fill="currentColor"/></svg></button>',im_dialogs_message_requests_button:'<li class="im-page--dialogs-folder-button im-page--dialogs-message-requests-button _im_toggle_mr_tab" data-list-id="message_request_button_go"> <span class="im-page--dialogs-folder-button--icon"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M8 2C4.44 2 1.5 4.52 1.5 7.75c0 1.09.34 2.12.95 3.02-.09.4-.36 1.04-.82 1.87a1.08 1.08 0 0 0 .46 1.49c.17.08.36.12.54.12A5.5 5.5 0 0 0 6 13.23a7.4 7.4 0 0 0 2 .28c3.56 0 6.5-2.52 6.5-5.76C14.5 4.52 11.56 2 8 2Zm0 1.5c-2.92 0-5 2.02-5 4.25 0 .8.25 1.55.73 2.22l.13.19a.75.75 0 0 1 .13.57l-.04.23a7.08 7.08 0 0 1-.65 1.74c.87-.1 1.44-.36 1.8-.66l.23-.21a.75.75 0 0 1 .7-.15l.31.1c.52.15 1.08.23 1.66.23 2.92 0 5-2.02 5-4.26 0-2.23-2.08-4.25-5-4.25Zm8.16 5.07a.75.75 0 1 1 1.18-.91A5.46 5.46 0 0 1 18.5 11a5.42 5.42 0 0 1-.91 3.01c.08.41.34 1.05.78 1.9a1.09 1.09 0 0 1-.99 1.59 5.18 5.18 0 0 1-3.23-1.01 6.8 6.8 0 0 1-1.9.27 6.73 6.73 0 0 1-2.57-.5.75.75 0 0 1 .57-1.39 5.22 5.22 0 0 0 2 .39 5.3 5.3 0 0 0 1.57-.24l.3-.09a.75.75 0 0 1 .71.16l.23.2c.33.3.85.54 1.66.65a7.34 7.34 0 0 1-.63-1.74l-.04-.23a.75.75 0 0 1 .12-.55l.13-.19A3.92 3.92 0 0 0 17 11c0-.9-.3-1.73-.84-2.43Z"/></svg></span> <span class="im-page--dialogs-folder-button--text">%msg%</span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--mentions" data-mentions=""><svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg></span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--counter">%counter%</span> </li>',im_dialogs_message_requests_notice:'<li class="im-page--dialogs-message-requests-notice-w" data-list-id="message_request_notice"> <div class="im-page--dialogs-message-requests-notice BannerInfo BannerInfo--noMargin"> %msg% </div> </li>',im_dialogs_business_notify_button:'<li class="im-page--dialogs-folder-button im-page--dialogs-business-notify-button _im_toggle_business_notify_tab %class_name%" data-list-id="business_notify_button_go"> <span class="im-page--dialogs-folder-button--icon"><svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="work_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="work_outline_20__Icons-20/work_outline_20"><g id="work_outline_20__work_outline_20"><path opacity=".4" d="M0 0h20v20H0z"/><path d="M10.8 2c1.11 0 1.51.12 1.92.33.4.22.73.54.95.95.2.38.31.76.33 1.71v.51h1.36c1.04 0 1.45.12 1.86.33.4.22.73.54.95.95.21.4.33.82.33 1.86v1.8c0 .89-.1 1.21-.27 1.54-.17.31-.41.57-.73.74v1.53a3.25 3.25 0 0 1-3.07 3.24l-.18.01h-8.5a3.25 3.25 0 0 1-3.24-3.07l-.01-.18v-1.53l-.13-.08c-.26-.17-.46-.4-.6-.66-.16-.3-.26-.6-.27-1.35v-2c0-1.03.12-1.44.33-1.85.22-.4.54-.73.95-.95.38-.2.76-.31 1.64-.33H6v-.3c0-1.11.12-1.51.33-1.92.22-.4.54-.73.95-.95.38-.2.76-.31 1.71-.33h1.8ZM16 13H4v1.25c0 .92.7 1.67 1.6 1.74l.15.01h8.5c.92 0 1.67-.7 1.74-1.6l.01-.15V13Zm-.47-6H4.47l-.31.01c-.36.02-.52.06-.67.15a.77.77 0 0 0-.33.33c-.1.2-.15.39-.16.98V10.82c.01.2.03.3.06.38l.03.07c.03.06.08.1.14.14l.07.03c.11.04.28.06.76.06h11.88c.48 0 .65-.02.76-.06l.07-.03c.06-.03.1-.08.14-.14l.03-.07c.04-.11.06-.28.06-.76v-1.8c0-.72-.04-.94-.16-1.15a.77.77 0 0 0-.33-.33c-.2-.1-.39-.15-.98-.16Zm-4.56-3.5H8.72c-.33.02-.5.05-.63.1l-.1.06a.77.77 0 0 0-.33.33l-.05.1c-.07.17-.1.4-.1.94l-.01.47h5v-.78a1.82 1.82 0 0 0-.1-.63l-.06-.1a.77.77 0 0 0-.33-.33l-.1-.05a2.6 2.6 0 0 0-.94-.1Z" id="work_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg></span> <span class="im-page--dialogs-folder-button--text">%msg%</span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--mentions" data-mentions=""><svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg></span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--counter">%counter%</span> <button class="im-page--dialogs-folder-button--hide _im_dialog_folder_button_hide"><svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M4.72 4.72c.3-.3.77-.3 1.06 0L10 8.94l4.22-4.22a.75.75 0 1 1 1.06 1.06L11.06 10l4.22 4.22a.75.75 0 1 1-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 0 1-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 0 1 0-1.06z" fill="currentColor" fill-rule="evenodd"/></svg></button> </li>',sImBusinessNotifyDisableBoxContent:'<div class="im_bussiness_notify_disable_box"> <div class="im_bussiness_notify_disable_box_text"> %text% </div> </div>',im_dialogs_archives_button:'<li class="im-page--dialogs-folder-button im-page--dialogs-archives-button _im_toggle_archives_tab %class_name%" data-list-id="archive_button_go"> <span class="im-page--dialogs-folder-button--icon"><svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M7 10.75c0-.41.34-.75.75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75z"/><path clip-rule="evenodd" d="M14.58 2H5.42c-.53 0-.98 0-1.34.03-.38.03-.74.1-1.08.27-.52.26-.94.68-1.2 1.2-.17.34-.24.7-.27 1.08-.03.36-.03.8-.03 1.34v.42c.02.13.05.3.14.48a1.25 1.25 0 0 0 1.02.67L3 7.5v4.98c0 .81 0 1.47.04 2 .05.55.14 1.03.37 1.47.36.7.93 1.28 1.64 1.64.44.23.92.32 1.47.37.53.04 1.19.04 2 .04h2.96c.81 0 1.47 0 2-.04a3.84 3.84 0 0 0 1.47-.37c.7-.36 1.28-.93 1.64-1.64.23-.44.32-.92.37-1.47.04-.53.04-1.19.04-2V7.5h.34c.13-.02.3-.05.48-.14a1.25 1.25 0 0 0 .67-1.02l.01-.37v-.05c0-.53 0-.98-.03-1.34-.03-.38-.1-.74-.27-1.08A2.75 2.75 0 0 0 17 2.3a2.8 2.8 0 0 0-1.08-.27C15.56 2 15.12 2 14.58 2zm.92 5.5h-11v4.95c0 .85 0 1.45.04 1.9.04.46.1.72.2.92.22.42.57.77.99.98.2.1.46.17.91.21.46.04 1.06.04 1.91.04h2.9c.85 0 1.45 0 1.9-.04.46-.04.72-.1.92-.2.42-.22.77-.57.98-.99.1-.2.17-.46.21-.91.04-.46.04-1.06.04-1.91zM17 6v-.05c0-.57 0-.96-.02-1.25a1.36 1.36 0 0 0-.12-.52 1.25 1.25 0 0 0-.54-.54c-.1-.05-.23-.1-.52-.12-.3-.02-.68-.02-1.25-.02h-9.1c-.57 0-.96 0-1.25.02-.29.03-.43.07-.52.12-.23.12-.42.3-.54.54-.05.1-.1.23-.12.52C3 5 3 5.38 3 5.95V6z" fill-rule="evenodd"/></g></svg></span> <span class="im-page--dialogs-folder-button--text">%msg%</span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--mentions" data-mentions="%mentions%"><svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg></span> <span class="im-page--dialogs-folder-button-badge im-page--dialogs-folder-button--counter">%counter%</span> <button class="im-page--dialogs-folder-button--hide _im_dialog_folder_button_hide"><svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><path clip-rule="evenodd" d="M4.72 4.72c.3-.3.77-.3 1.06 0L10 8.94l4.22-4.22a.75.75 0 1 1 1.06 1.06L11.06 10l4.22 4.22a.75.75 0 1 1-1.06 1.06L10 11.06l-4.22 4.22a.75.75 0 0 1-1.06-1.06L8.94 10 4.72 5.78a.75.75 0 0 1 0-1.06z" fill="currentColor" fill-rule="evenodd"/></svg></button> </li>',im_dialogs_archive_notice:'<li class="im-page--dialogs-archive-notice-w _im_archive_notice" data-list-id="archive_notice"> <div class="im-page--dialogs-archive-notice"> <span class="im-page--dialogs-archive-notice--title">%title%</span> <span class="im-page--dialogs-archive-notice--text">%text%</span> <button class="im-page--dialogs-archive-notice--close _im_archive_notice_close"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg></button> </div> </li>',im_dialogs_archive_notice_button:'<button class="im-page--dialogs-archive-notice--button _im_archive_notice_settings">%text%</button>',im_dialogs_new_ui_notice:'<li class="im-page--dialogs-new-ui-notice-w _im_new_ui_notice" data-list-id="new_ui_notice"> <div class="im-page--dialogs-new-ui-notice"> <span class="im-page--dialogs-new-ui-notice--title">%title%</span> <span class="im-page--dialogs-new-ui-notice--text">%text%</span> <button class="im-page--dialogs-new-ui-notice--close _im_new_ui_notice_close"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg></button> </div> </li>',im_filter:'<a class="im-page--dialogs-filter %cls%">%filter%</a>',im_drow_prebody:'<span class="nim-dialog--who">%prebody% </span> <span class="nim-dialog--inner-text">%body%</span>',im_attach_mess:' <div class="im-fwd"> <span class="im-fwd--title"> <span class="im-fwd--title-name">%title%</span> <span class="im-fwd--date">%date%</span> </span> <span class="im-fwd--close _im_fwd_close"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg></span> <div rel="button" tab-index="0" type="button" class="im-fwd--messages _im_will_fwd">%messages%</div> </div>',im_preloader:'<div class="im-preloader %cls%"> %preloader%</div>',im_service_row:'<ul class="ui_clean_list"> <li class="im-mess im-mess_srv _im_mess _im_mess_srv _im_mess_%message_id%" data-msgid="%message_id%" data-from="%from_id%" data-ts="%date%"> <div class="im-mess--text">%text%</div> </li> </ul>',im_chat_members:'<button type="button" class="_im_chat_members im-page--members">%name%</button>',im_vkcomgroup_members:'<span class="im-page--members im-page--members--nohover">%name%</span>',im_mess_stack:'<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peerId%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <a target="_blank" href="%href%"><span\nclass="AvatarRich AvatarRich--sz-36 AvatarRich--shadow AvatarRich--nft" style="width: 36px; height: 36px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 2px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% alt="%name%" class="AvatarRich__img"\n/> </span></a> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%messageMeta%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',im_mess_stack_name:'<a href="%link%" class="im-mess-stack--lnk%class%" title="" target="_blank">%name%</a>',im_mess_stack_nft:'<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peer_id%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <a target="_blank" href="%href%"><span\nclass="AvatarRich AvatarRich--sz-36 AvatarRich--shadow AvatarRich--nft" style="width: 36px; height: 36px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 2px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% alt="%name%" class="AvatarRich__img"\n/> </span></a> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%messageMeta%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',im_mess_stack_no_nft:'<div class="im-mess-stack _im_mess_stack %cls%" data-peer="%peer_id%" data-admin="%admin%"> <div class="im-mess-stack--photo"> <div class="nim-peer nim-peer_small fl_l"> <div class="nim-peer--photo-w"><div class="nim-peer--photo"><a target="_blank" class="im_grid" href="%href%"><img alt="%name%" src="%photo%" /></a></div></div> </div> </div> <div class="im-mess-stack--content"> <div class="im-mess-stack--info"> <div class="im-mess-stack--pname"> %stack_name% <span class="im-mess-stack--tools">%messageMeta%</span> </div> </div> <ul class="ui_clean_list im-mess-stack--mess _im_stack_messages"> %messages% </ul> </div> </div>',im_message_media:'<div class="_im_msg_%type%%messageId%" class="wall_module">%attaches%</div>%text%',im_dialog_media:'<span class="nim-dialog--preview nim-dialog--preview-attach">%name%</span>',im_dialog_deleted_media:function(){return'  <span class="nim-dialog--preview nim-dialog--preview-deleted-attach">\n    '+getLang("mail_attach_deleted")+"\n  </span>"},im_attachment_deleted:'<span class="im-mess--del-attach">%text%</span>',im_typing:'<div class="im-page--typing _im_typing"> <div class="im-activity %cls%"><div class="pr im-activity--icon"><div class="pr_bt"></div><div class="pr_bt"></div><div class="pr_bt"></div></div><span class="_im_typing_name">&nbsp;</span></div> </div>',ctrl_submit_hint:function(){return'<div class="reply_submit_hint_wrap" >\n  <div class="reply_submit_hint_title">'+getLang("wall_reply_submit_settings")+'</div>\n  <div class="reply_submit_hint_opts" id="">\n    <div class="radiobtn %enter_on% _im_submit_btn" data-val="0" onclick="radiobtn(this, 0, \'im_submit\'); "><div class="radiobtn_label">'+getLang("wall_reply_submit_settings_1")+'</div></div>\n    <div class="radiobtn %ctrl_on% _im_submit_btn" data-val="1" onclick="radiobtn(this, 1, \'im_submit\'); "><div class="radiobtn_label">'+getLang("wall_reply_submit_settings_2")+"</div></div>\n  </div>\n</div>"},im_day_bar:'<h5 class="im-page--history-new-bar im-page--history-new-bar_days _im_bar_date %day_class%" data-date="%date%"><span>%day%</span></h5>',im_mess_bar:function(){return'<h4 class="im-page--history-new-bar _im_unread_bar_row"><span>'+getLang("mail_new_unread_msgs")+"</span></h4>"},im_replied_message:'<div class="im-replied"> <div class="im-replied--photo-wrapper"></div> <div class="im-replied--content"> <div class="im-replied--author"> <span class="im-replied--author-link">%authorName%</span> </div> <div class="im-replied--text">%text%</div> </div> </div>',im_drow:function(){return'<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <div class="nim-peer--photo-w"><div class="nim-peer--photo _im_dialog_photo">%photo%</div></div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <div class="nim-dialog--date_wrapper"> <button type="button" class="nim-dialog--star _im_dialog_star"></button> <div class="nim-dialog--date _im_dialog_date">%date%</div> </div> %actions% <button type="button" class="nim-dialog--markre _im_dialog_markre"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.78 4.72a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 0 1 1.06-1.06l1.97 1.97 5.47-5.47a.75.75 0 0 1 1.06 0zm4.25 0a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l6-6a.75.75 0 0 1 1.06 0z" fill="currentColor"/></svg></button> <div class="_im_dialog_title" title="%title%"> <div class="nim-dialog--name" > <span class="nim-dialog--name-w _im_dialog_name_w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"><svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'" role="img" ></span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--mute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.69 5.5 11 11.8v1.7c0 .3-.23.47-.49.5l-3.63-3.5H4a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h.69Zm.77-2.85 2.2 2.19L10.5 2.5c.27.02.49.2.49.48v5.2l2.6 2.6a.75.75 0 0 1-1.06 1.06L4.4 3.71a.75.75 0 0 1 1.06-1.06Z"/></svg></span> <div class="nim-dialog--peer-tags _im_dialog_peer_tags PeerTags"></div> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> </div> <div class="nim-dialog--pinned-conversation" role="img"></div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_drow_classic:function(){return'<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <div class="nim-peer--photo-w"><div class="nim-peer--photo _im_dialog_photo">%photo%</div></div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <div class="nim-dialog--date_wrapper"> <button type="button" class="nim-dialog--star _im_dialog_star"></button> <div class="nim-dialog--date _im_dialog_date">%date%</div> </div> %actions% <button type="button" class="nim-dialog--markre _im_dialog_markre"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.78 4.72a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 0 1 1.06-1.06l1.97 1.97 5.47-5.47a.75.75 0 0 1 1.06 0zm4.25 0a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l6-6a.75.75 0 0 1 1.06 0z" fill="currentColor"/></svg></button> <div class="_im_dialog_title" title="%title%"> <div class="nim-dialog--name" > <span class="nim-dialog--name-w _im_dialog_name_w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"><svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'" role="img" ></span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--mute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.69 5.5 11 11.8v1.7c0 .3-.23.47-.49.5l-3.63-3.5H4a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h.69Zm.77-2.85 2.2 2.19L10.5 2.5c.27.02.49.2.49.48v5.2l2.6 2.6a.75.75 0 0 1-1.06 1.06L4.4 3.71a.75.75 0 0 1 1.06-1.06Z"/></svg></span> <div class="nim-dialog--peer-tags _im_dialog_peer_tags PeerTags"></div> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> </div> <div class="nim-dialog--pinned-conversation" role="img"></div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_drow_nft:function(){return'<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <span\nclass="AvatarRich AvatarRich--sz-46 AvatarRich--shadow AvatarRich--nft" style="width: 46px; height: 46px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 2px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% alt="%tab_name%" class="AvatarRich__img"\n/> </span> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <div class="nim-dialog--date_wrapper"> <button type="button" class="nim-dialog--star _im_dialog_star"></button> <div class="nim-dialog--date _im_dialog_date">%date%</div> </div> %actions% <button type="button" class="nim-dialog--markre _im_dialog_markre"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.78 4.72a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 0 1 1.06-1.06l1.97 1.97 5.47-5.47a.75.75 0 0 1 1.06 0zm4.25 0a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l6-6a.75.75 0 0 1 1.06 0z" fill="currentColor"/></svg></button> <div class="_im_dialog_title" title="%title%"> <div class="nim-dialog--name" > <span class="nim-dialog--name-w _im_dialog_name_w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"><svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'" role="img" ></span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--mute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.69 5.5 11 11.8v1.7c0 .3-.23.47-.49.5l-3.63-3.5H4a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h.69Zm.77-2.85 2.2 2.19L10.5 2.5c.27.02.49.2.49.48v5.2l2.6 2.6a.75.75 0 0 1-1.06 1.06L4.4 3.71a.75.75 0 0 1 1.06-1.06Z"/></svg></span> <div class="nim-dialog--peer-tags _im_dialog_peer_tags PeerTags"></div> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> </div> <div class="nim-dialog--pinned-conversation" role="img"></div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_drow_nft_classic:function(){return'<li data-list-id="%peer%" class="nim-dialog _im_dialog _im_dialog_%peer% %is_unread% %is_unread_out% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer %is_online% _im_peer_online"> <span\nclass="AvatarRich AvatarRich--sz-50 AvatarRich--shadow AvatarRich--nft" style="width: 50px; height: 50px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 3px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% alt="%tab_name%" class="AvatarRich__img"\n/> </span> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <div class="nim-dialog--date_wrapper"> <button type="button" class="nim-dialog--star _im_dialog_star"></button> <div class="nim-dialog--date _im_dialog_date">%date%</div> </div> %actions% <button type="button" class="nim-dialog--markre _im_dialog_markre"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.78 4.72a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 0 1-1.06 0l-2.5-2.5a.75.75 0 0 1 1.06-1.06l1.97 1.97 5.47-5.47a.75.75 0 0 1 1.06 0zm4.25 0a.75.75 0 0 1 0 1.06l-6 6a.75.75 0 1 1-1.06-1.06l6-6a.75.75 0 0 1 1.06 0z" fill="currentColor"/></svg></button> <div class="_im_dialog_title" title="%title%"> <div class="nim-dialog--name" > <span class="nim-dialog--name-w _im_dialog_name_w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--verfifed _im_dialog_verified"><svg fill="none" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M4.5 9.59 2.96 8.04a1 1 0 0 0-1.42 1.42L3.8 11.7a1 1 0 0 0 1.42 0l5.25-5.25a1 1 0 0 0-1.42-1.42z" fill="currentColor"/></svg></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'" role="img" ></span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--mute"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.69 5.5 11 11.8v1.7c0 .3-.23.47-.49.5l-3.63-3.5H4a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h.69Zm.77-2.85 2.2 2.19L10.5 2.5c.27.02.49.2.49.48v5.2l2.6 2.6a.75.75 0 0 1-1.06 1.06L4.4 3.71a.75.75 0 0 1 1.06-1.06Z"/></svg></span> <div class="nim-dialog--peer-tags _im_dialog_peer_tags PeerTags"></div> </div> <div class="nim-dialog--text-preview"> <span class="nim-dialog--preview _dialog_body" tabindex="0">%body%</span> <span class="nim-dialog--typing _im_dialog_typing"></span><span class="nim-dialog--typer-el"></span> </div> </div> <div class="nim-dialog--pinned-conversation" role="img"></div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <label class="blind_label _im_unread_blind_label">%unread_message_string%</label> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_conversation_search_row:function(){return'<li data-list-id="%peer%" class="nim-dialog nim-conversation-search-row _im_dialog _im_dialog_%peer% %is_unread% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer nim-peer_search %is_online% _im_peer_online"> <div class="nim-peer--photo-w"> <div class="nim-peer--photo _im_dialog_photo"> %photo% </div> </div> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"><svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'"></span> </div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_conversation_search_nft_row:function(){return'<li data-list-id="%peer%" class="nim-dialog nim-conversation-search-row _im_dialog _im_dialog_%peer% %is_unread% %is_selected% %more%" data-peer="%peer%" data-msgid="%msg_id%"> <div class="nim-dialog--photo"> <div class="nim-peer nim-peer_search %is_online% _im_peer_online"> <span\nclass="AvatarRich AvatarRich--sz-34 AvatarRich--shadow AvatarRich--nft" style="width: 34px; height: 34px; border-radius: unset; --avatar-rich-stroke-width: 2px; --avatar-rich-nft-frame-width: 2px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% class="AvatarRich__img"\n/> </span> </div> </div> <div class="nim-dialog--content"> <div class="nim-dialog--cw"> <span role="link" class="blind_label" aria-label="'+getLang("mail_im_to_multidialog")+': %tab_name%"></span> <button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer%"><svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg></button> <div class="nim-dialog--name"> <span class="nim-dialog--name-w" aria-hidden="true"> %user_link% </span> <span class="nim-dialog--donut _im_dialog_donut"></span> <span class="nim-dialog--casper _im_dialog_casper" aria-label="'+getLang("mail_casper_chat_label")+'"></span> </div> <div class="nim-dialog--unread_container"> <div class="nim-dialog--unread-badge_reaction nim-dialog--unread-badge" aria-label="'+getLang("mail_reactions_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M2.8.22a.32.32 0 0 0-.6 0l-.25.73a1.6 1.6 0 0 1-1 1l-.73.25a.32.32 0 0 0 0 .6l.73.25c.47.15.85.53 1 1l.25.73a.32.32 0 0 0 .6 0l.25-.73a1.6 1.6 0 0 1 1-1l.73-.25a.32.32 0 0 0 0-.6l-.73-.24a1.6 1.6 0 0 1-1-1.01L2.8.22Zm3.64 3.25c-.26.75-.6 1.5-1.04 1.93a5.3 5.3 0 0 1-1.93 1.03 12.31 12.31 0 0 1-.77.24c-.27.08-.27.58 0 .66a15.19 15.19 0 0 1 .77.23c.75.26 1.5.6 1.94 1.04a5.3 5.3 0 0 1 1.03 1.93 12.45 12.45 0 0 1 .23.77c.08.27.58.27.66 0a14.93 14.93 0 0 1 .23-.77c.26-.75.6-1.5 1.04-1.93a5.3 5.3 0 0 1 1.93-1.03 12.45 12.45 0 0 1 .77-.24c.27-.08.27-.58 0-.66a15.08 15.08 0 0 1-.77-.23c-.75-.26-1.5-.6-1.93-1.03a5.3 5.3 0 0 1-1.03-1.94 12.12 12.12 0 0 1-.24-.77c-.08-.27-.58-.27-.66 0a15.19 15.19 0 0 1-.23.77Z" clip-rule="evenodd"/></svg> </div> <div class="nim-dialog--unread-badge_mention nim-dialog--unread-badge" aria-label="'+getLang("mail_mention_badge_label")+'" role="img"> <svg height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M0 0h12v12H0z"/><path d="M6.17 11c.76 0 1.44-.1 1.89-.25.37-.12.5-.28.5-.49 0-.2-.15-.34-.4-.34-.06 0-.14 0-.23.03-.55.13-.98.21-1.58.21-2.62 0-4.4-1.5-4.4-4.09 0-2.5 1.65-4.24 4.15-4.24 2.18 0 3.95 1.31 3.95 3.73 0 1.25-.47 2.13-1.15 2.13-.44 0-.68-.23-.68-.64V4.08c0-.33-.2-.54-.52-.54s-.53.2-.53.54v.3h-.06c-.25-.53-.82-.84-1.49-.84-1.22 0-2.08 1.01-2.08 2.49 0 1.5.86 2.53 2.12 2.53.71 0 1.26-.34 1.53-.96h.06c.11.61.69.96 1.45.96 1.42 0 2.3-1.28 2.3-3.07C11 2.75 8.95 1 6.11 1 3.09 1 1 2.98 1 6.04 1 9.15 3.16 11 6.17 11zm-.3-3.37c-.75 0-1.2-.6-1.2-1.6 0-.98.46-1.57 1.2-1.57.78 0 1.27.61 1.27 1.57 0 .98-.5 1.6-1.26 1.6z" fill="currentColor" fill-rule="nonzero"/></g></svg> </div> <div class="nim-dialog--unread-badge_bomb nim-dialog--unread-badge" aria-label="'+getLang("mail_expiring_message_badge_label")+'" role="img"> <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 12 12"><path d="M7.84 1.49a.6.6 0 0 0-1.18.22l.15.8a.6.6 0 0 0 1.18-.22l-.15-.8Zm2.38.29a.6.6 0 0 1 0 .84l-.6.6a.6.6 0 0 1-.84-.84l.6-.6a.6.6 0 0 1 .84 0Z"/><path fill-rule="evenodd" d="M7.82 4.17a.6.6 0 0 1 0 .85l-.46.47a3.5 3.5 0 1 1-.84-.85l.45-.46a.6.6 0 0 1 .85 0ZM6.8 7.5a2.3 2.3 0 1 1-4.6 0 2.3 2.3 0 0 1 4.6 0Zm4.19-2.64a.6.6 0 0 1-.7.48l-.8-.15a.6.6 0 0 1 .22-1.18l.8.15a.6.6 0 0 1 .48.7Z"/></svg> </div> <div class="nim-dialog--unread _im_dialog_unread_ct" aria-hidden="true">%unread%</div> </div> </div> </div> </li>'},im_drow_actions_menu:'<button type="button" class="nim-dialog--actions _im_dialog_actions" data-peer="%peer_id%"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M13 6.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/></svg></button>',im_drow_close_button:'<button type="button" class="nim-dialog--close _im_dialog_close" data-peer="%peer_id%"><svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg></button>',im_page_inline_menu:'<ul class="im-page--inline-menu-list"> %actions%</ul>',im_page_inline_menu_item:'<li class="im-page--inline-menu--list-item"> <button class="im-page--inline-menu--button %class_name%" data-action="%action%"> <div class="im-page--inline-menu--button-icon">%icon%</div> <span class="im-page--inline-menu--button-text">%name%</span> </button> </li>',im_delete_actions:function(){return'<span class="nim-dialog--who">%text%</span> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="restore" type="button">'+getLang("mail_restore")+'</button> <button class="nim-dialog--daction ui_bullet _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="spam" type="button">'+getLang("mail_im_mark_spam")+'</button> <button class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction" data-sid=%spam_id% data-peer="%peer%" data-action="block" type="button">'+getLang("mail_user_black_list")+"</button>"},im_chat_change_topic:function(){return'<div class="im_change_topic_wrap clear_fix"> <div class="im_change_topic_label fl_l ta_r">'+getLang("mail_chat_topic_change_label")+'</div> <div class="im_change_topic_labeled fl_l"> <input class="text _im_chat_topic_change_input" value="%value%"/> </div> </div>'},im_msg_row:function(){return'<li class="im-mess %cls% _im_mess_noa _im_mess_%msg_id%" aria-hidden="%aria_hidden%" data-ts="%ts%" data-msgid="%msg_id%" data-cmid="%cmid%" data-peer="%from_id%"> <div class="im-mess--text wall_module _im_log_body">%text%</div> <span tabindex="0" role="link" aria-label="'+getLang("mail_select_message")+'" class="blind_label im-mess--blind-select _im_mess_blind_label_select"></span> <span class="blind_label im-mess--blind-read _im_mess_blind_unread_marker" %unread_params%></span> <span class="im-mess--marker _im_mess_marker" %marker_params%></span> <span class="im-mess--reactions _im_mess_reactions">%reactions%</span> </li>'},sImHistoryRowActions:function(){return'<div class="im-mess--actions"> <span role="link" aria-label="'+getLang("mail_im_set_reaction")+'" class="im-mess--reaction _im_mess_reaction"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.89 4.72a7.42 7.42 0 0 1-1.45 2.72c-.6.6-1.67 1.09-2.72 1.45a16.94 16.94 0 0 1-.8.25l-.27.08c-.39.1-.39.81 0 .92a21.17 21.17 0 0 1 1.07.33c1.05.36 2.11.84 2.72 1.45.6.6 1.09 1.67 1.45 2.72a16.94 16.94 0 0 1 .25.8l.08.27c.1.38.81.38.92 0a22.86 22.86 0 0 1 .27-.88 16.4 16.4 0 0 1 .06-.2c.36-1.04.84-2.1 1.45-2.71.6-.6 1.67-1.09 2.72-1.45a16.39 16.39 0 0 1 .8-.25l.27-.08c.39-.1.39-.82 0-.92a21.17 21.17 0 0 1-1.07-.33 7.44 7.44 0 0 1-2.72-1.45 7.44 7.44 0 0 1-1.45-2.72 16.4 16.4 0 0 1-.25-.8 22.85 22.85 0 0 1-.08-.27c-.1-.39-.81-.39-.92 0a21.17 21.17 0 0 1-.33 1.07ZM3.53.28a.4.4 0 0 0-.76 0l-.3.91a2 2 0 0 1-1.28 1.27l-.92.3a.4.4 0 0 0 0 .77l.92.3a2 2 0 0 1 1.27 1.28l.3.92a.4.4 0 0 0 .77 0l.3-.92a2 2 0 0 1 1.28-1.27l.91-.3a.4.4 0 0 0 0-.77l-.91-.3a2 2 0 0 1-1.27-1.28L3.53.28Z"/></svg></span> <span role="link" aria-label="'+getLang("mail_im_mark_forward")+'" class="im-mess--forward _im_mess_forward"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M7.11 2.36a1.63 1.63 0 0 1 2.65 1.27v1.4c1.57.4 2.84 1.2 3.74 2.35a7.78 7.78 0 0 1 1.5 4.87.75.75 0 0 1-.46.7.75.75 0 0 1-.83-.18 6.23 6.23 0 0 0-1.96-1.48 5.8 5.8 0 0 0-2-.45v1.53a1.63 1.63 0 0 1-2.64 1.27L1.62 9.28a1.63 1.63 0 0 1 0-2.56l5.5-4.36Z"/></svg></span> <span role="link" aria-label="'+getLang("mail_im_reply")+'" class="im-mess--reply _im_mess_reply"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M7.11 2.36a1.63 1.63 0 0 1 2.65 1.27v1.4c1.57.4 2.84 1.2 3.74 2.35a7.78 7.78 0 0 1 1.5 4.87.75.75 0 0 1-.46.7.75.75 0 0 1-.83-.18 6.23 6.23 0 0 0-1.96-1.48 5.8 5.8 0 0 0-2-.45v1.53a1.63 1.63 0 0 1-2.64 1.27L1.62 9.28a1.63 1.63 0 0 1 0-2.56l5.5-4.36Z"/></svg></span> <span role="link" aria-label="'+getLang("mail_im_edit")+'" class="im-mess--edit _im_mess_edit"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="m9.49 3.95 2.56 2.56-6.14 6.14a4.82 4.82 0 0 1-2 1.2l-2.1.64a.24.24 0 0 1-.3-.3l.64-2.1a4.82 4.82 0 0 1 1.2-2L9.5 3.95Zm3.67-2.13 1.02 1.02c.4.4.42 1.03.08 1.45l-1.17 1.18-2.56-2.56 1.1-1.1c.42-.42 1.1-.42 1.53 0Z"/></svg></span> <span role="link" aria-label="'+getLang("mail_important_message")+'" class="im-mess--fav _im_mess_fav"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="m5.75 3.87-.43 1c-.03.06-.04.1-.07.12a.23.23 0 0 1-.07.06c-.03.02-.07.02-.15.03l-.62.1c-1.77.24-2.65.37-3.02.78a1.53 1.53 0 0 0-.37 1.32c.11.55.81 1.1 2.2 2.22l.24.2c.06.05.1.07.11.1a.23.23 0 0 1 .04.1l-.02.15-.07.38c-.39 2.06-.58 3.09-.28 3.59a1.53 1.53 0 0 0 1.24.73c.59.02 1.4-.65 3-1.99l.28-.22c.08-.08.12-.11.17-.12a.23.23 0 0 1 .13 0c.05.01.09.04.17.11l.28.24c1.6 1.33 2.41 2 3 1.98a1.53 1.53 0 0 0 1.24-.73c.3-.5.11-1.53-.28-3.6l-.07-.37a.51.51 0 0 1-.02-.15.23.23 0 0 1 .04-.1l.11-.1.24-.2c1.39-1.11 2.09-1.67 2.2-2.22a1.53 1.53 0 0 0-.37-1.32c-.37-.41-1.25-.54-3.02-.79l-.62-.09c-.08 0-.12-.01-.15-.03a.23.23 0 0 1-.07-.06c-.03-.02-.04-.06-.07-.13l-.43-1c-.71-1.63-1.06-2.45-1.56-2.7a1.52 1.52 0 0 0-1.37 0c-.5.25-.85 1.07-1.56 2.7Z"/></svg></span> </div> <div class="im-mess--check fl_l"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill="currentColor" fill-rule="evenodd" d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zM6 7.94a.75.75 0 1 0-1 1.12l1.46 1.3c.44.38 1.1.33 1.49-.1l.04-.05 2.9-3.75a.75.75 0 1 0-1.19-.92L7.1 8.91 6 7.94z"/></svg></div>'},im_wrap_mobile:'<b class="mob_onl %class%" %attrs% onmouseover="mobileOnlineTip(this, {%params%})"></b>',im_pinned_message:'<div class="im-page-pinned _im_pinned_message"> <button class="im-page-pinned--hide _im_pin_hide"></button> <div class="im-page-pinned--meta"> <a href="%link%" target="_blank" class="im-page-pinned--name">%name%</a> <span class="im-page-pinned--date">%date%</span> </div> <div class="im-page-pinned--content">%content%</div> </div>',im_pinned_message_media:'<span class="im-page-pinned--media">%text%</span>',im_pinned_message_media_bar:'<div class="im-page-pinned--media-bar">\n  <div class="im-page-pinned--media-bar_progress" style="width: %percent%%;"></div>\n</div>',im_pinned_message_deleted_media:function(){return'  <span class="im-page-pinned--deleted-media">'+getLang("mail_attach_deleted")+"</span>"},im_pinned_messages_promo:'<div class="im-page--mess-actions-promo-content">%content%</div>',im_retry_link:function(){return'<button class="im-page--retry _im_retry_media">'+getLang("mail_retry")+"</button>"},sImLblWasEdited:function(){return" <span class='im-mess--lbl-was-edited _im_edit_time' data-time='%update_time%'>"+getLang("mail_was_edited_short")+"</span>"},sImLblWasSourceInfo:function(){return" <span class='im-mess--lbl-was-edited _im_page_info' data-info='%source%'>"+getLang("mail_was_source_short")+"</span>"},im_top_banner:'<div class="im-top-banner %classes%">\n  %icon%\n  <div class="im-top-banner--text">%text%</div>\n  <div class="im-top-banner--buttons">%buttons%</div>\n</div>',im_top_banner_icon:'<div class="im-top-banner--icon">\n  <img src="%icon%" alt=""/>\n</div>',im_top_banner_button_link:'<a href="%link%" target="_blank" class="_im_top_banner_button im-top-banner--button %css_class% flat_button button_small">%text%</a>',im_top_banner_button:'<button class="_im_top_banner_button im-top-banner--button %css_class% flat_button button_small" data-payload="%callback_data%">%text%</button>',im_top_banner_hide_btn:'<button class="im-top-banner--button im-top-banner--button_hide _im_top_banner_hide"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg></button>',im_calls_link:'<button class="im_srv_lnk_light _fc_call_link">%text%</button>',sImPeerMuteUnmute:'<button class="_im_peer_mute_unmute im-chat-input-block-control im-chat-input-block-control--with-icon im-chat-input-block-control--%type%">%text%</button>',sImPeerAcceptOrRejectMessageRequest:function(){return"<p>"+getLang("mail_message_request_user_notice")+'</p> <p> <button type="button" class="flat_button %cls_accept%">'+getLang("mail_message_request_accept")+'</button> <button type="button" class="flat_button secondary %cls_reject%">'+getLang("mail_message_request_reject")+"</button> </p>"},sImPeerReturnToChat:'<button class="_im_peer_return_to_chat im-chat-input-block-control">%text%</button>',sImCallSnippet:function(){return'<article class="CallSnippet %classes%" %attributes% tabindex="0" aria-label="'+getLang("me_start_call")+'" role="button" > <div class="CallSnippet__users">%user_list%</div> <div class="CallSnippet__content"> <h3 class="CallSnippet__title">%title%</h3> <div class="CallSnippet__desc">%description%</div> </div> %button%</article>'},sImMessageKeyboard:'<div class="MessageKeyboard">%content%</div>',sImMessageKeyboardRow:'<div class="MessageKeyboard__row">%content%</div>',sImMessageKeyboardButton:'<%tagName% class="FlatButton FlatButton--%appearance% FlatButton--size-s MessageKeyboard__button MessageKeyboard__button--%modifier% _im_mess_btn" %attributes%> <span class="FlatButton__in"> <span class="FlatButton__content">%label%</span> </span> </%tagName%>',sImBomb:'<span class="im-mess-stack--bomb %classnames%"></span>',sImEmptyCasper:function(){return' <div class="im-page--casper-empty"> <div class="im-page--casper-empty__icon"><svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M33.57 34.52c.6.65.57 1.67-.1 2.27-3 2.73-6.35 2.73-9.33 1.1-.74-.4-1.28-.8-1.61-1.1-.67-.6-.7-1.62-.1-2.27a1.66 1.66 0 0 1 2.19-.2l.13.1c.15.14.5.4.97.66 1.86 1.01 3.7 1.01 5.53-.65.67-.6 1.7-.56 2.32.09ZM19.5 22a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7ZM28 4c5.83 0 10.75 2.06 15.26 6.27A20.86 20.86 0 0 1 50 25.05l-.02 20.82c-.07 2.55-1.9 4.56-4.5 4.56-.59-.02-1.3-.12-2.24-.5l-1.92-.81a7.89 7.89 0 0 0-3.08-.81h-.15c-.42.04-.83.24-1.97 1.03l-1.75 1.25C32.16 52.16 30.03 52.93 28 53c-2.04 0-3.83-.69-6-2.18l-1.94-1.37-.55-.38a3.93 3.93 0 0 0-1.48-.74l-.25-.02c-.86 0-1.73.24-3.08.8l-1.93.82c-.8.32-1.22.44-1.7.48l-.55.02c-2.5 0-4.32-1.96-4.5-4.43L6 25.5c0-5.72 2.43-11.2 6.76-15.23C17.16 6.16 22.38 4.11 28 4Zm.02 3-.43.02c-4.78.2-9.12 2.02-12.79 5.44A17.85 17.85 0 0 0 9 25.07v.42l.02 20.37.01.1c.12.86.65 1.4 1.35 1.47h.11l.38-.01h.03c.09-.02.21-.06.44-.15l.26-.1 1.94-.82c1.6-.67 2.76-1 3.98-1.04h.46l.26.03.25.02c.98.15 1.67.51 3.04 1.46l.27.18 1.9 1.35c1.65 1.13 2.83 1.6 4.08 1.65h.16l.23-.01a8.85 8.85 0 0 0 4.14-1.62l.32-.22 1.78-1.27c1.7-1.18 2.52-1.57 3.83-1.57a10 10 0 0 1 3.9.9l.34.14 1.88.8c.51.2.85.27 1.13.28.82 0 1.39-.54 1.48-1.4v-.16L47 25.12a17.86 17.86 0 0 0-5.8-12.66C37.35 8.85 33.28 7.1 28.45 7h-.42Zm11.46 17.85c.6.52.7 1.46.2 2.1-.46.6-1.27.72-1.87.3l-.12-.09-.15-.13c-.9-.7-1.8-.66-2.74-.18l-.28.16-.13.09-.2.15c-.6.42-1.4.3-1.87-.3-.5-.64-.4-1.58.2-2.1.22-.2.57-.44 1.04-.68a5 5 0 0 1 5.92.68Z" fill="currentColor"/></svg></div> '+getLang("mail_im_empty_casper_chat")+" </div>"},sImExpiredMessagePlaceholder:' <div class="im-expired-message _im_expired_message " data-last-msgid="%id_classes%" data-count="%count%"> <a href="/im?w=expired_messages" target="_blank" class="im-expired-message--in"> <span class="im-expired-message--inner">%text%</span> </a> </div>',sImGiftLabel:' <span class="im-mess-stack--gift">%content%</span>',sImMoneyTransferLabel:' <span class="im-mess-stack--money-transfer">%content%</span>',sUiActionsMenuSeparator:'<div class="ui_actions_menu_sep"></div>',sImUiActionMenuItem:'<a tabindex="0" role="link" class="ui_actions_menu_item im-action im-action_%icon% %classes%" data-action="%action%"> %name%</a>',sImPeerTagsItem:' <div class="PeerTagsItem _im_dialog_peer_tag" data-id="%tag_id%" style="background-color: %color%;">%name%</div>',sImPeerTagsAdTag:function(){return' <div class="PeerTagsItem PeerTagsItem--adTag %extra_class%"> <a href="%url%" target="_blank" class="PeerTagsItem__adTagLink"> <span class="PeerTagsItem__adTagText">%ad_tag_text%</span> </a> <button onclick="return showFastBox(\''+getLang("mail_ad_tag_no_access_box_title")+"', '"+getLang("mail_ad_tag_no_access_box_text")+'\');" class="PeerTagsItem__adTagAlert"> <span class="PeerTagsItem__adTagText">%ad_tag_text%</span> </button> </div>'},sImPeerTagsExtra:' <div class="PeerTagsItem PeerTagsItem--extra _im_peer_tags_extra">%text%</div>',sImPeerTagsExtraTooltipItem:' <div class="PeerTagsExtraTooltipItem"> <span class="PeerTagsExtraTooltipItem__color" style="background-color: %color%"></span> <span class="PeerTagsExtraTooltipItem__name">%name%</span> </div>',sImPeerTagsFilterItem:'<div class="PeerTagsFilterItem"> <input class="PeerTagsFilterItem__checkbox _im_peer_tags_filter_checkbox" type="checkbox" id="peer_tag_%tag_id%" %checked%> <label class="PeerTagsFilterItem__label" for="peer_tag_%tag_id%"> <span class="PeerTagsFilterItem__checkboxOff"> <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.05 2.53C4.79 2.13 5.52 2 7.13 2h5.74c1.61 0 2.34.14 3.08.53.65.35 1.17.87 1.52 1.52.4.74.53 1.47.53 3.08v5.74c0 1.61-.14 2.34-.53 3.08a3.64 3.64 0 0 1-1.52 1.52c-.74.4-1.47.53-3.08.53H7.13c-1.61 0-2.34-.14-3.08-.53a3.64 3.64 0 0 1-1.52-1.52c-.4-.74-.53-1.47-.53-3.08V7.13c0-1.61.14-2.34.53-3.08.35-.65.87-1.17 1.52-1.52Zm3.08.97c-1.53 0-1.96.14-2.38.36-.38.2-.69.5-.9.9-.21.4-.35.84-.35 2.37v5.74c0 1.53.14 1.96.36 2.38.2.38.5.69.9.9.4.21.84.35 2.37.35h5.74c1.53 0 1.96-.14 2.38-.36.38-.2.69-.5.9-.9.21-.4.35-.84.35-2.37V7.13c0-1.53-.14-1.96-.36-2.38-.2-.38-.5-.69-.9-.9-.4-.21-.84-.35-2.37-.35H7.13Z" fill="currentColor"/></svg> </span> <span class="PeerTagsFilterItem__checkboxOn"> <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M2.44 4.18C2 5.04 2 6.16 2 8.4v3.2c0 2.24 0 3.36.44 4.22a4 4 0 0 0 1.74 1.74c.86.44 1.98.44 4.22.44h3.2c2.24 0 3.36 0 4.22-.44a4 4 0 0 0 1.74-1.74c.44-.86.44-1.98.44-4.22V8.4c0-2.24 0-3.36-.44-4.22a4 4 0 0 0-1.74-1.74C14.96 2 13.84 2 11.6 2H8.4c-2.24 0-3.36 0-4.22.44a4 4 0 0 0-1.74 1.74Zm12.2 3.8a.9.9 0 1 0-1.28-1.27L8.7 11.38 6.64 9.33a.9.9 0 0 0-1.28 1.27l2.7 2.69a.9.9 0 0 0 1.27 0l5.3-5.3Z" fill="currentColor"/></svg> </span> <span class="PeerTagsFilterItem__color" style="background-color: %color%"></span> <span class="PeerTagsFilterItem__name">%name%</span> <span class="PeerTagsFilterItem__count">%count%</span> </label> </div>',sImPeerTagsFilterPaneItem:'<div class="PeerTagsFilterPaneItem _im_peer_tags_filter_pane_item" data-id="%tag_id%"> <span class="PeerTagsFilterPaneItem__color" style="background-color: %color%"></span> <span class="PeerTagsFilterPaneItem__name">%name%</span> <span class="PeerTagsFilterPaneItem__remove"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.74 3.26a.9.9 0 0 1 0 1.28L9.27 8l3.47 3.46a.9.9 0 0 1 .08 1.18l-.08.1a.9.9 0 0 1-1.28 0L8 9.27l-3.46 3.47a.9.9 0 0 1-1.28-1.28L6.73 8 3.26 4.54a.9.9 0 0 1-.08-1.18l.08-.1a.9.9 0 0 1 1.28 0L8 6.73l3.46-3.47a.9.9 0 0 1 1.28 0Z"/></svg></span> </div>',sImCallUser:'<img src="%url%" alt="%name%" class="CallUsers__user">',sImCallUsers:'<div class="CallUsers"> <svg xmlns="http://www.w3.org/2000/svg" class="CallUsers__hidden"> <defs> <clipPath id="user-frame"> <path d="M12 0a12 12 0 11-7.97 20.97C5.89 18.47 7 15.37 7 12c0-3.36-1.1-6.47-2.97-8.97A11.95 11.95 0 0112 0z"/> </clipPath> </defs> </svg> <figure class="CallUsers__list"> %users% </figure> </div>',sImCallBannerContent:'<article class="CallBanner %cls%"> <div class="CallBanner__users">%user_list%</div> <div class="CallBanner__content"> <h3 class="CallBanner__title">%title%</h3> <div class="CallBanner__desc">%desc%</div> </div> </article>',sImCallBannerButton:function(){return'<button class="FlatButton FlatButton--secondary FlatButton--size-s _im_call_banner_join_btn _im_top_banner_button" type="button" data-link="%call_link%" >\n  <span class="FlatButton__in FlatButton__in--noPointerEvents">\n    \n    <span class="FlatButton__content">'+getLang("mail_join_chat")+"</span>\n    \n  </span>\n</button>"},sImAudioMsgPlayerASRToggle:' <button onclick="return AudioMessagePlayer.toggleTranscript(this, event);" class="audio-msg-track--transcriptToggle _msg_asr_toggle" > <span class="audio-msg-track--transcriptToggleShow"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M1.89 12.11c.46 0 .73-.23.9-.8L3.22 10h3.05l.45 1.33c.15.55.42.78.92.78.51 0 .88-.34.88-.83a1.56 1.56 0 0 0-.11-.56L6.1 4.42c-.25-.69-.66-1-1.36-1-.66 0-1.08.32-1.33 1.01l-2.3 6.29a1.82 1.82 0 0 0-.12.56c0 .5.34.83.9.83ZM3.6 8.63l1.1-3.47h.04l1.12 3.46H3.61Zm7.62 3.47c.78 0 1.57-.4 1.92-1.06h.03v.32c.04.5.36.76.82.76.49 0 .83-.29.83-.86V7.68c0-1.26-1.04-2.1-2.66-2.1-1.3 0-2.3.47-2.6 1.22a.9.9 0 0 0-.09.38c0 .39.3.66.72.66a.86.86 0 0 0 .68-.32c.38-.49.7-.66 1.22-.66.64 0 1.05.34 1.05.93v.41l-1.58.1c-1.57.1-2.45.75-2.45 1.9 0 1.13.91 1.9 2.1 1.9Zm.56-1.24c-.58 0-.96-.29-.96-.76 0-.44.36-.73 1-.78l1.32-.08v.46c0 .68-.61 1.16-1.36 1.16Z"/></svg></span> <span class="audio-msg-track--transcriptToggleHide"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" fill="currentColor" viewBox="0 0 16 12"><path d="M4.45 8.31a.9.9 0 0 1-1.1-1.42l4.1-3.2a.9.9 0 0 1 1.1 0l4.1 3.2a.9.9 0 1 1-1.1 1.42L8 5.54 4.45 8.31Z"/></svg></span> </button>',sImCarousel:'<div class="Carousel _im_carousel" data-scroll-count="%scroll_count%"> <button class="Carousel__control Carousel__control--prev Carousel__control--hidden _im_carousel_control _im_carousel_control_left %controls_class%" data-direction="-1"><svg fill="none" height="16" viewBox="0 0 12 16" width="12" xmlns="http://www.w3.org/2000/svg"><path d="m4.77 8 3.37 3.36a.9.9 0 1 1-1.28 1.28l-4-4a.9.9 0 0 1 0-1.28l4-4a.9.9 0 1 1 1.28 1.28z" fill="currentColor"/></svg></button> <button class="Carousel__control Carousel__control--next _im_carousel_control _im_carousel_control_right %controls_class%" data-direction="1"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" fill="none" viewBox="0 0 12 16"><path fill="currentColor" d="M7.23 8 3.86 4.64a.9.9 0 0 1 1.28-1.28l4 4a.9.9 0 0 1 0 1.28l-4 4a.9.9 0 0 1-1.28-1.28L7.23 8Z"/></svg></button> <div class="Carousel__viewport _im_carousel_viewport"> <div class="Carousel__layer _im_carousel_layer"> %content% </div> </div> </div>',sImBotCarousel:'<div class="BotCarousel _im_bot_carousel _im_bot_carousel_%msg_id%"> %content%</div>',sImBotCarouselSlide:'<div class="BotCarousel__slide" data-index="%index%">%content%</div>',sImBotCarouselSlideTitle:'<div class="BotCarousel__slideTitle">%content%</div>',sImBotCarouselSlideDescription:'<div class="BotCarousel__slideDescription">%content%</div>',sImBotCarouselSlideContent:'<div class="BotCarousel__slideContent">%content%</div>',sImBotCarouselSlideLinkWrapper:'<a href="%url%" class="BotCarousel__slideLinkWrapper" target="_blank" rel="nofollow noopener noreferrer">%content%</a>',sImBotCarouselSlidePhotoLinkWrapper:'<a href="#" class="BotCarousel__slideLinkWrapper" onclick="return showPhoto(\'%photo_id%\', \'mail%msg_id%\', {}, event)" rel="nofollow noopener noreferrer">%content%</a>',sImBotCarouselSlidePhoto:"<img class=\"BotCarousel__slideImage\" src='%url%' alt='%alt%' />",sImBotCarouselSlideButtons:'<div class="BotCarousel__slideButtons">%content%</div>',sImBotCarouselSlideButton:'<%tag_name% class="FlatButton FlatButton--%appearance% FlatButton--size-m FlatButton--wide BotCarousel__slideButton BotCarousel__slideButton--%modifier% _im_mess_btn" %attributes%> <span class="FlatButton__in"> <span class="FlatButton__content">%label%</span> </span> </%tag_name%>',sImConvoRecommendListUser:'<li class="ConvoRecommendList__item"> <a href="%link%" class="ConvoRecommendList__button _im_dialog _convoRecommendUser" data-peer="%id%" data-position="%position%" data-trackcode="%track_code%"> <div class="ConvoRecommendList__avatar"> %photo% <button class="ConvoRecommendList__removeItem _convoRecommendUserRemove" aria-label="%remove_label%"> <svg fill="none" height="12" viewBox="0 0 12 12" width="12" xmlns="http://www.w3.org/2000/svg"><path d="M3.53 2.46a.75.75 0 0 0-1.07 1.07L4.94 6 2.46 8.47a.75.75 0 1 0 1.07 1.07L6 7.06l2.47 2.48a.75.75 0 0 0 1.07-1.07L7.06 6l2.48-2.47a.75.75 0 1 0-1.07-1.07L6 4.94z" fill="currentColor"/></svg> </button> </div> <span class="ConvoRecommendList__name">%name%</span> </a> </li>',sImConvoRecommendListButton:'<li class="ConvoRecommendList__item"> <%tag_name% %attributes% class="ConvoRecommendList__button %classes%"> <span class="ConvoRecommendList__avatar ConvoRecommendList__icon" aria-hidden="true"> %icon% </span> <span class="ConvoRecommendList__name">%title%</span> </%tag_name%> </li>',sImConvoRecommendList:'<ul class="ConvoRecommendList" data-list-id="recommend_list"> %list_content%</ul>',sImEmptyDialogStub:' <div class="EmptyDialogStub %classes%"> <div class="EmptyDialogStub__main"> <div class="EmptyDialogStub__avatar">%avatar%</div> <div class="EmptyDialogStub__name">%name%</div> <div class="EmptyDialogStub__savedAs">%saved_as%</div> <div class="EmptyDialogStub__description">%stub_text%</div> </div> %secondary_block% </div> <div class="_im_stickers_panel_placeholder"></div>',sImEmptyDialogStubUserInfo:function(){return' <div class="EmptyDialogStub__secondary"> <div class="EmptyDialogStub__additional"> <div class="EmptyDialogStub__additionalIcon">%additional_icon%</div> %additional_info% </div> %mutual_friends% <div class="EmptyDialogStub__actions"> <a class="FlatButton FlatButton--secondary FlatButton--size-m" draggable="false" href="%profile_href%" > <span class="FlatButton__in"> <span class="FlatButton__content">'+getLang("mail_view_profile")+"</span> </span> </a> %subscribe_button% </div> </div>"},sImEmptyDialogStubSubscribeButton:'<button class="FlatButton FlatButton--primary FlatButton--size-m _im_subscribe_button" type="button" >\n  <span class="FlatButton__in">\n    \n    <span class="FlatButton__content">%button_text%</span>\n    \n  </span>\n</button>',sImEmptyDialogStubUnsubscribeButton:'<button class="FlatButton FlatButton--secondary FlatButton--size-m _im_subscribe_button" type="button" >\n  <span class="FlatButton__in">\n    \n    <span class="FlatButton__content">%button_text%</span>\n    \n  </span>\n</button>',sImEmptyDialogStubMutualFriends:' <div class="EmptyDialogStub__mutualFriends"> <div class="EmptyDialogStub__mutualFriendsPhotos">%friends%</div> <div class="EmptyDialogStub__mutualFriendsCount">%text%</div> </div>',sImEmptyDialogStubMutualFriend:' <img src="%src%" class="EmptyDialogStub__mutualFriendPhoto" alt="%name%" />',sImEmptyDialogStickers:'<div class="EmptyDialogStickers"> %content%</div>',sImEmptyDialogSticker:'<a id="emoji_sticker_item0_%set_id%_%sticker_id%" data-pack-id="%set_id%" data-sticker-id="%sticker_id%" class="EmptyDialogStickers__item" onclick="Emoji.stickerHintClick(%opt_id%, %sticker_id%, \'%sticker_url%\', this)" onmouseover="Emoji.stickerHintOver(this)" onmouseout="Emoji.stickerHintOut(this)"\n> <img class="EmptyDialogStickers__image sticker_img" src="%sticker_url%"> </a>',sImEmptyDialogAnimatedSticker:'<a id="emoji_sticker_item0_%set_id%_%sticker_id%" data-pack-id="%set_id%" data-sticker-id="%sticker_id%" class="EmptyDialogStickers__item" onclick="Emoji.stickerHintClick(%opt_id%, %sticker_id%, \'%sticker_url%\', this)" onmouseover="Emoji.stickerHintOver(this)" onmouseout="Emoji.stickerHintOut(this)" onmouseenter="StickersAnimation.loadAndPlaySticker(this);" data-animation-path="%animation_url%"\n> <img class="EmptyDialogStickers__image sticker_img" src="%sticker_url%"> </a>',sImDialogImRowAvatarRichSkinPhoto:'<span\nclass="AvatarRich AvatarRich--sz-%size% AvatarRich--shadow AvatarRich--nft" style="width: %size%px; height: %size%px; border-radius: unset; --avatar-rich-stroke-width: 1px; --avatar-rich-nft-frame-width: 2px "> <svg class="AvatarRich__heptagonUnderlay" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M 15.0864 1.656 A 5.6496 5.6496 90 0 1 20.544 0.192 l 18.3504 4.9152 a 5.6496 5.6496 90 0 1 3.9936 3.9936 l 4.9152 18.3504 a 5.6496 5.6496 90 0 1 -1.464 5.4576 L 32.9136 46.344 a 5.6496 5.6496 90 0 1 -5.4576 1.464 l -18.3504 -4.9152 a 5.6496 5.6496 90 0 1 -3.9936 -3.9936 L 0.192 20.544 a 5.6496 5.6496 90 0 1 1.464 -5.4576 L 15.0864 1.656 Z" fill="url(#avatar_hept_underlay_fill)"/></svg> <div class="AvatarRich__background"></div> <img src=%photo% class="AvatarRich__img"\n/> </span>',sImReactionsPanel:' <div class="MessageReactionsPanel _im_reaction_panel"> %reactions% <div class="MessageReactionsPanel__arrow"></div> </div>',sImReactionsPanelItem:' <div class="MessageReactionsPanel__reaction %selected% _im_reactions_panel_item" data-id="%id%"> <img src="%icon%" /> </div>',sImMessageReactions:' <div class="MessageReactions %classes% _im_message_reaction" data-id="%id%"> <div class="MessageReactions__icon">%icon%</div> <div class="MessageReactions__peers">%peers%</div> <div class="MessageReactions__counter">%count%</div> </div>',sImMessageReactionsIcon:' <img src="%icon%" />',sImMessageReactionsPeer:'    <img class="MessageReactions__peer" data-id="%peer_id%" src="%src%" title="%name%">',sImMessageReactionsModalButton:'    <button class="MessageReactionsModalButton _im_message_reactions_modal"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M13 6.5a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Zm-5 0a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3Z"/></svg></button>'}},486429:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a=(0,s(825028).makeIcon)("Icon46MessageReaction404","message_reaction_404_46","0 0 46 46",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 46 46" id="message_reaction_404_46"><path fill-rule="evenodd" d="M22.465 6.176c-.214.16-.379.604-.707 1.493-1.203 3.249-1.804 4.874-2.686 6.283a16.158 16.158 0 0 1-5.12 5.12c-1.41.882-3.034 1.483-6.283 2.686-.89.329-1.333.493-1.493.708a.898.898 0 0 0 0 1.069c.16.214.604.379 1.493.708 3.25 1.202 4.874 1.803 6.283 2.686a16.16 16.16 0 0 1 5.12 5.12c.882 1.408 1.483 3.033 2.686 6.283.328.888.493 1.333.707 1.492a.898.898 0 0 0 1.07 0c.214-.16.379-.604.707-1.492 1.203-3.25 1.804-4.875 2.686-6.284a16.159 16.159 0 0 1 5.12-5.12c1.41-.882 3.034-1.483 6.283-2.685.89-.33 1.333-.494 1.493-.708a.898.898 0 0 0 0-1.07c-.16-.214-.604-.378-1.493-.707-3.25-1.203-4.874-1.804-6.283-2.686a16.157 16.157 0 0 1-5.12-5.12c-.882-1.41-1.483-3.034-2.686-6.283-.328-.89-.493-1.333-.707-1.493a.898.898 0 0 0-1.07 0Zm-.875 18.945c0 .109.088.196.196.196h1.794a.196.196 0 0 0 .196-.196c.004-.377.052-.694.144-.951a1.92 1.92 0 0 1 .433-.681c.196-.196.446-.384.75-.565a4.78 4.78 0 0 0 .94-.721c.265-.27.47-.577.617-.923.15-.35.225-.75.225-1.2 0-.673-.168-1.247-.502-1.724-.335-.477-.796-.84-1.384-1.09-.589-.254-1.265-.381-2.03-.381-.697 0-1.333.125-1.91.375a3.171 3.171 0 0 0-1.39 1.124c-.293.42-.47.933-.531 1.542a.335.335 0 0 0 .34.362h1.625c.204 0 .365-.164.413-.362a1.355 1.355 0 0 1 .731-.912c.223-.112.46-.168.71-.168.257 0 .492.054.703.161.216.108.387.262.514.462s.19.432.19.698c0 .25-.056.477-.167.68-.112.2-.262.383-.45.548a5.443 5.443 0 0 1-.64.479c-.32.2-.592.423-.82.67-.226.245-.4.568-.518.968-.116.4-.175.936-.18 1.61Zm.156 3.872c.273.27.601.404.986.404.246 0 .473-.061.68-.184.208-.127.375-.295.502-.502a1.323 1.323 0 0 0-.22-1.667 1.34 1.34 0 0 0-.962-.404c-.385 0-.713.135-.986.404-.27.269-.402.592-.398.969-.004.38.128.707.398.98Z" clip-rule="evenodd" /></symbol>',46,46,!1,void 0)},571150:(e,t,s)=>{"use strict";s.d(t,{Icon12Chevron:()=>a});var a=(0,s(825028).makeIcon)("Icon12Chevron","chevron_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="chevron_12"><path fill-rule="evenodd" d="M4.22 2.47a.75.75 0 0 1 1.06 0l3 3a.75.75 0 0 1 0 1.06l-3 3a.75.75 0 0 1-1.06-1.06L6.69 6 4.22 3.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" /></symbol>',12,12,!1,void 0)},20403:(e,t,s)=>{"use strict";s.d(t,{Icon12Favorite:()=>a});var a=(0,s(825028).makeIcon)("Icon12Favorite","favorite_12","0 0 12 12",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 12 12" id="favorite_12"><path d="m4.559 2.876-.277.653a.337.337 0 0 1-.044.086.15.15 0 0 1-.048.037.322.322 0 0 1-.093.02l-.403.059c-1.136.163-1.703.245-1.942.516a1.015 1.015 0 0 0-.233.866c.07.357.518.723 1.412 1.454l.153.124c.04.033.06.05.074.07.011.02.019.04.022.062a.344.344 0 0 1-.011.103l-.046.245c-.25 1.347-.375 2.02-.178 2.35.17.285.47.465.796.479.378.016.895-.423 1.93-1.3l.177-.15a.351.351 0 0 1 .111-.077.146.146 0 0 1 .082 0c.03.008.057.031.111.077l.178.15c1.034.877 1.55 1.316 1.929 1.3a.979.979 0 0 0 .796-.479c.197-.33.072-1.003-.178-2.35l-.046-.245a.344.344 0 0 1-.01-.103.154.154 0 0 1 .021-.061.339.339 0 0 1 .074-.07l.153-.125c.894-.731 1.342-1.097 1.412-1.454.06-.31-.025-.631-.233-.866-.239-.27-.806-.353-1.942-.516l-.403-.058c-.048-.007-.072-.01-.093-.02a.15.15 0 0 1-.048-.038c-.015-.018-.024-.04-.044-.086l-.277-.653c-.455-1.071-.682-1.607-1-1.77a.965.965 0 0 0-.881 0c-.319.163-.546.699-1.001 1.77Z" /></symbol>',12,12,!1,void 0)},354819:(e,t,s)=>{"use strict";s.d(t,{Icon16Education:()=>a});var a=(0,s(825028).makeIcon)("Icon16Education","education_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="education_16"><path fill="currentColor" d="M14.495 5.078 8.467 1.625a.936.936 0 0 0-.934 0L1.505 5.078a.995.995 0 0 0-.385.402c-.258.492-.086 1.11.385 1.38l.995.567 5.002 2.874a1 1 0 0 0 .996 0l4.168-2.395 1.167-.668v2.996c0 .337.261.61.583.61a.597.597 0 0 0 .584-.61V5.968c0-.358-.183-.705-.505-.89Z" /><path fill="currentColor" d="M12.666 9.385 8.48 11.666a1 1 0 0 1-.958 0L3.333 9.382v1.055C3.334 12.713 5.447 14.5 8 14.5s4.667-1.787 4.667-4.063V9.385Z" /></symbol>',16,16,!1,void 0)},900917:(e,t,s)=>{"use strict";s.d(t,{Icon16Ghost:()=>a});var a=(0,s(825028).makeIcon)("Icon16Ghost","ghost_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="ghost_16"><path fill-rule="evenodd" d="M8 1a6.5 6.5 0 0 0-6.5 6.5v4.881c0 .407.095.809.277 1.172a1.498 1.498 0 0 0 2.11.615l.35-.21a1.406 1.406 0 0 1 1.504.036l.857.571.03.02a2.5 2.5 0 0 0 2.745 0l.03-.02.856-.571a1.406 1.406 0 0 1 1.504-.036l.35.21c.748.449 1.72.166 2.11-.615a2.62 2.62 0 0 0 .277-1.172V7.5A6.5 6.5 0 0 0 8 1Zm-1.091 9.121a.75.75 0 0 0-.818 1.258c.601.39 1.243.618 1.916.619.675 0 1.315-.225 1.911-.625a.75.75 0 1 0-.836-1.246c-.397.267-.75.371-1.072.37-.325 0-.687-.107-1.101-.376ZM5.5 8.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm6-1a1 1 0 1 1-2 0 1 1 0 0 1 2 0Z" clip-rule="evenodd" /></symbol>',16,16,!1,void 0)},998901:(e,t,s)=>{"use strict";s.d(t,{Icon16Muted:()=>a});var a=(0,s(825028).makeIcon)("Icon16Muted","muted_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="muted_16"><path d="m4.69 5.496 6.31 6.31v1.702c0 .284-.225.464-.488.488l-3.635-3.489-2.88-.008A1 1 0 0 1 3 9.5V6.497a1 1 0 0 1 1-1l.69-.001Zm.774-2.846 2.191 2.19 2.857-2.344c.263.023.488.204.488.488v5.201l2.596 2.596a.75.75 0 0 1-1.06 1.061L4.404 3.71a.75.75 0 0 1 1.06-1.06Z" /></symbol>',16,16,!1,void 0)},250237:(e,t,s)=>{"use strict";s.d(t,{Icon16Search:()=>a});var a=(0,s(825028).makeIcon)("Icon16Search","search_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="search_16"><path fill="currentColor" d="M14.743 13.574 10.91 9.74a5.426 5.426 0 0 0 1.05-3.232A5.532 5.532 0 0 0 6.46 1 5.436 5.436 0 0 0 1 6.468a5.532 5.532 0 0 0 5.5 5.508 5.409 5.409 0 0 0 3.241-1.062l.005-.003 3.829 3.832a.827.827 0 1 0 1.168-1.169Zm-8.247-2.696a4.425 4.425 0 0 1-4.4-4.406 4.35 4.35 0 0 1 4.368-4.374 4.426 4.426 0 0 1 4.4 4.406 4.35 4.35 0 0 1-4.368 4.374Z" /></symbol>',16,16,!1,void 0)},386835:(e,t,s)=>{"use strict";s.d(t,{Icon16Stars:()=>a});var a=(0,s(825028).makeIcon)("Icon16Stars","stars_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 16 16" id="stars_16"><path fill-rule="evenodd" d="M8.887 4.724C8.53 5.773 8.047 6.832 7.44 7.44c-.608.607-1.667 1.089-2.716 1.447a16.937 16.937 0 0 1-.801.253l-.277.08c-.381.105-.381.815 0 .92a21.173 21.173 0 0 1 1.078.332c1.049.36 2.108.84 2.716 1.448.607.608 1.089 1.667 1.447 2.715a16.942 16.942 0 0 1 .253.802l.08.277c.105.381.815.381.92 0a22.857 22.857 0 0 1 .266-.88 16.4 16.4 0 0 1 .067-.199c.358-1.048.84-2.107 1.447-2.715.608-.607 1.667-1.089 2.716-1.447a16.386 16.386 0 0 1 .8-.254l.278-.079c.381-.105.381-.815 0-.92a21.17 21.17 0 0 1-1.079-.333c-1.048-.358-2.107-.84-2.715-1.447-.607-.608-1.089-1.667-1.447-2.716a16.394 16.394 0 0 1-.254-.801 22.853 22.853 0 0 1-.079-.277c-.105-.381-.815-.381-.92 0a21.167 21.167 0 0 1-.333 1.078ZM3.53.275a.402.402 0 0 0-.762 0l-.305.917c-.2.6-.671 1.07-1.271 1.27l-.917.306a.402.402 0 0 0 0 .763l.917.306c.6.2 1.07.67 1.27 1.27l.306.918c.123.366.64.366.763 0l.306-.918c.2-.6.67-1.07 1.27-1.27l.918-.306a.402.402 0 0 0 0-.763l-.918-.305c-.6-.2-1.07-.671-1.27-1.271L3.53.275Z" /></symbol>',16,16,!1,void 0)},96715:(e,t,s)=>{"use strict";s.d(t,{Icon16Verified:()=>a});var a=(0,s(825028).makeIcon)("Icon16Verified","verified_16","0 0 16 16",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16" id="verified_16"><path fill="currentColor" d="M4.5 9.586 2.957 8.043a1 1 0 0 0-1.414 1.414l2.25 2.25a1 1 0 0 0 1.414 0l5.25-5.25a1 1 0 0 0-1.414-1.414L4.5 9.586Z" /></symbol>',16,16,!1,void 0)},735166:(e,t,s)=>{"use strict";s.d(t,{Icon20ArrowLeftOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20ArrowLeftOutline","arrow_left_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="arrow_left_outline_20"><path fill="currentColor" d="M8.707 4.233a.75.75 0 1 1 1.086 1.034L6 9.25h9.75a.75.75 0 0 1 0 1.5H6l3.793 3.983a.75.75 0 0 1-.026 1.06.75.75 0 0 1-1.06-.026l-5-5.25a.75.75 0 0 1 0-1.034l5-5.25Z" /></symbol>',20,20,!1,void 0)},29157:(e,t,s)=>{"use strict";s.d(t,{Icon20CheckCircleOff:()=>a});var a=(0,s(825028).makeIcon)("Icon20CheckCircleOff","check_circle_off_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="none" viewBox="0 0 20 20" id="check_circle_off_20"><defs><path id="check_circle_off_20_a" fill="currentColor" fill-rule="evenodd" d="M10 20c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Zm0-1a9 9 0 1 0 0-18 9 9 0 0 0 0 18Z" clip-rule="evenodd" /></defs><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /><use xlink:href="#check_circle_off_20_a" fill-rule="evenodd" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},661980:(e,t,s)=>{"use strict";s.d(t,{Icon20DoorArrowRightOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20DoorArrowRightOutline","door_arrow_right_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="door_arrow_right_outline_20"><path fill-rule="evenodd" d="M8.317 2h.933a.75.75 0 1 1 0 1.5h-.9c-.992 0-1.692 0-2.238.045-.537.044-.86.127-1.11.255A2.75 2.75 0 0 0 3.8 5.002c-.128.25-.21.573-.255 1.11-.044.546-.045 1.245-.045 2.238v3.3c0 .992 0 1.692.045 2.238.044.537.127.86.255 1.11A2.75 2.75 0 0 0 5.002 16.2c.25.128.573.21 1.11.255.546.044 1.246.045 2.238.045h.895a.75.75 0 0 1 0 1.5h-.928c-.952 0-1.713 0-2.327-.05-.63-.052-1.172-.16-1.67-.413a4.25 4.25 0 0 1-1.857-1.858c-.253-.497-.361-1.04-.413-1.67C2 13.397 2 12.636 2 11.684V8.317c0-.952 0-1.713.05-2.327.052-.63.16-1.172.413-1.67a4.25 4.25 0 0 1 1.858-1.857c.497-.253 1.04-.361 1.67-.413C6.603 2 7.364 2 8.316 2Zm5.903 4.97a.75.75 0 0 1 1.06 0l2.5 2.5a.75.75 0 0 1 0 1.06l-2.5 2.5a.75.75 0 1 1-1.06-1.06l1.22-1.22H8.75a.75.75 0 0 1 0-1.5h6.69l-1.22-1.22a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},661620:(e,t,s)=>{"use strict";s.d(t,{Icon20FolderOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20FolderOutline","folder_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="folder_outline_20"><path fill-rule="evenodd" d="M7.066 2.058C6.812 2 6.552 2 6.256 2h-.09c-.65 0-1.18 0-1.612.034-.446.035-.85.11-1.23.295A3.25 3.25 0 0 0 1.83 3.824c-.185.38-.26.784-.295 1.23-.034.432-.034.962-.034 1.611v5.616c0 .674 0 1.224.037 1.672.037.463.118.882.317 1.272a3.25 3.25 0 0 0 1.42 1.42c.391.2.81.28 1.273.318.447.037.998.037 1.671.037h7.563c.674 0 1.224 0 1.672-.037.463-.038.882-.118 1.272-.317a3.25 3.25 0 0 0 1.42-1.42c.2-.391.28-.81.318-1.273.037-.448.037-.998.037-1.672V8.85c0-.673 0-1.224-.037-1.672-.037-.463-.118-.881-.317-1.272a3.25 3.25 0 0 0-1.42-1.42c-.391-.2-.81-.28-1.273-.318-.447-.037-.998-.037-1.672-.037h-3.486c-.404 0-.484-.004-.55-.02a.75.75 0 0 1-.218-.091c-.059-.036-.118-.09-.403-.377l-.758-.764c-.208-.21-.391-.395-.611-.534a2.25 2.25 0 0 0-.69-.287ZM6.196 3.5c.39 0 .466.004.53.02a.75.75 0 0 1 .23.095c.056.035.113.086.388.363l.759.766c.216.218.406.41.636.552.202.125.423.217.653.273.263.063.534.063.84.063h3.518c.712 0 1.202 0 1.58.031.371.03.57.086.714.16.33.167.598.435.765.764.074.144.13.343.16.714.005.063.009.129.012.199H3v-.805c0-.686 0-1.157.03-1.523.027-.357.08-.55.147-.69a1.75 1.75 0 0 1 .805-.805c.14-.068.333-.12.69-.148.366-.029.837-.03 1.523-.03ZM3 9v3.25c0 .712 0 1.202.032 1.58.03.371.085.57.159.714.167.33.435.597.764.765.145.074.344.129.714.16.38.03.869.03 1.581.03h7.5c.712 0 1.202 0 1.58-.03.371-.031.57-.086.714-.16a1.75 1.75 0 0 0 .765-.765c.074-.144.13-.343.16-.713.03-.38.031-.869.031-1.581V9H3Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},784118:(e,t,s)=>{"use strict";s.d(t,{Icon20GearOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20GearOutline","gear_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="gear_outline_20"><path fill-rule="evenodd" d="m7.222 3.378.01-.033a4.147 4.147 0 0 1 .17-.476c.358-.821.944-1.285 1.854-1.36l.166-.009h1.208c1.051.033 1.735.608 2.095 1.692l.057.186.044.166c.016.064.037.132.06.203l.05.137.03.015.06-.02.116-.044.135-.059a5.36 5.36 0 0 1 .168-.074l.036-.015a4.23 4.23 0 0 1 .424-.15c.932-.27 1.685-.075 2.32.618l.108.125.714.88c.636.833.617 1.723-.004 2.683l-.109.161-.102.139c-.04.054-.082.113-.123.177l-.062.1-.029.05.004.017.08.052.11.066.133.072c1.209.614 1.707 1.42 1.515 2.541l-.032.162-.213.916c-.137.593-.245.873-.67 1.258a2.135 2.135 0 0 1-1.059.518l-.01.003a3.917 3.917 0 0 1-.438.059l-.191.012-.173.006-.052.001h-.006c-.05.002-.102.006-.156.01l-.158.02.012.123.011.083.029.154c.068.322.101.618.098.89v.012c-.015.84-.38 1.45-1.132 1.87l-.147.076-1.023.494c-.901.403-1.722.234-2.484-.467a3.934 3.934 0 0 1-.144-.14l-.133-.142-.113-.13a2.938 2.938 0 0 0-.147-.161l-.085-.083-.043-.04-.08.076-.091.093-.103.115c-.828.981-1.703 1.334-2.763.923l-.153-.063-.915-.443-.271-.138c-.415-.225-.647-.44-.874-.918a2.153 2.153 0 0 1-.209-1.01v-.016c.006-.19.03-.388.07-.603l.038-.195.001-.004c.014-.064.025-.133.035-.206l.016-.148-.003-.003-.09-.012-.128-.012-.151-.006a4.145 4.145 0 0 1-.862-.098l-.012-.003c-.837-.198-1.363-.69-1.608-1.524l-.043-.16-.254-1.102c-.204-1.026.205-1.818 1.186-2.41l.17-.098.152-.08c.06-.03.123-.065.188-.105l.134-.087.004-.017-.055-.093-.07-.108-.089-.124a5.194 5.194 0 0 1-.286-.423c-.54-.905-.534-1.72.046-2.523l.1-.132.717-.877c.687-.792 1.566-.958 2.64-.554l.18.072.158.07a2.9 2.9 0 0 0 .193.08l.118.042.032-.014.029-.077.04-.12.04-.143c.013-.056.028-.112.044-.166Zm4.24.841.013.038.05.138a1.5 1.5 0 0 0 .743.833l.03.014a1.5 1.5 0 0 0 1.136.082l.06-.02a1.47 1.47 0 0 0 .065-.023l.117-.044.062-.025.135-.059.035-.015a2.698 2.698 0 0 1 .415-.16c.268-.078.407-.06.47-.043.057.015.16.056.314.22l.077.09.682.84c.138.185.15.295.15.359 0 .084-.03.267-.225.573l-.082.122-.08.108a4.406 4.406 0 0 0-.18.26l-.014.022-.062.099-.008.013-.01.018-.03.05a1.5 1.5 0 0 0-.178 1.056l.004.017a1.5 1.5 0 0 0 .648.959l.08.052.05.032.11.066.06.034.133.072.034.018c.456.231.62.421.676.516.036.06.084.162.042.417l-.023.117-.207.892c-.066.285-.095.35-.105.369 0 0 0 .003-.01.013a.974.974 0 0 1-.101.103c-.082.074-.166.124-.354.161a2.357 2.357 0 0 1-.257.035l-.153.01-.138.004-.071.002a4.554 4.554 0 0 0-.28.02l-.158.019a1.5 1.5 0 0 0-1.318 1.628l.011.123.008.07.012.083.01.06.028.154.008.045c.05.236.068.419.066.557-.003.206-.046.301-.073.348-.028.046-.094.131-.276.235l-.105.056-.977.471c-.204.088-.317.082-.382.07-.076-.015-.228-.068-.456-.279a2.382 2.382 0 0 1-.08-.076l-.1-.107-.088-.102a4.389 4.389 0 0 0-.217-.236l-.018-.018-.084-.082a1.433 1.433 0 0 0-.036-.034l-.043-.04a1.5 1.5 0 0 0-2.047.014l-.08.075a1.43 1.43 0 0 0-.042.041l-.09.094a1.534 1.534 0 0 0-.048.05l-.103.116-.025.03c-.315.371-.532.495-.646.535-.073.025-.183.05-.415-.038l-.094-.039-.864-.418-.238-.12a1.186 1.186 0 0 1-.13-.083l-.004-.003-.003-.003a1.077 1.077 0 0 1-.083-.147.666.666 0 0 1-.063-.34c.003-.09.015-.207.043-.365l.035-.174a4.384 4.384 0 0 0 .058-.35l.016-.149a1.5 1.5 0 0 0-.434-1.224l-.004-.003a1.5 1.5 0 0 0-.86-.423l-.09-.012a1.405 1.405 0 0 0-.064-.008l-.128-.01a1.539 1.539 0 0 0-.068-.005l-.15-.007-.04-.001a2.663 2.663 0 0 1-.549-.06c-.215-.05-.305-.115-.346-.154-.04-.038-.109-.12-.17-.319l-.03-.114-.242-1.052c-.042-.224-.006-.329.023-.387.038-.076.146-.23.459-.42l.128-.074.119-.063a4.431 4.431 0 0 0 .316-.179l.134-.087a1.5 1.5 0 0 0 .65-.947l.004-.017a1.5 1.5 0 0 0-.171-1.066l-.055-.093a1.49 1.49 0 0 0-.037-.062l-.07-.108a1.496 1.496 0 0 0-.04-.057l-.088-.124a1.516 1.516 0 0 0-.024-.031c-.307-.406-.369-.647-.378-.754-.006-.067-.004-.18.148-.395l.072-.094.684-.838c.154-.173.262-.211.33-.225.09-.018.28-.027.623.1l.138.055.123.055a4.42 4.42 0 0 0 .316.13l.118.042a1.5 1.5 0 0 0 1.134-.058l.031-.015a1.5 1.5 0 0 0 .764-.823l.03-.077.023-.066.04-.12.02-.065.04-.143.01-.037.03-.119c.037-.128.076-.235.114-.323.1-.23.192-.319.243-.357.044-.033.134-.086.343-.105l.1-.006h1.14c.234.01.333.071.386.114.067.056.192.195.308.538l.043.14.034.129c.026.1.056.2.088.298ZM10 11.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0 1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},707599:(e,t,s)=>{"use strict";s.d(t,{Icon20NotificationOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20NotificationOutline","notification_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="notification_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M5.5 8a4.5 4.5 0 0 1 9-.008v1.674c0 .297.106.584.299.81l1.523 1.787a.75.75 0 0 1-.571 1.237H4.249a.75.75 0 0 1-.57-1.237L5.2 10.477a1.25 1.25 0 0 0 .299-.811V8zm-1.488-.385a6 6 0 0 1 11.976 0c.008.044.012.089.012.135v1.823l1.463 1.717c1.245 1.461.207 3.71-1.712 3.71h-2.076a3.751 3.751 0 0 1-7.35 0H4.249c-1.919 0-2.957-2.249-1.712-3.71L4 9.575V7.75c0-.046.004-.091.012-.135zM10 16.5A2.25 2.25 0 0 1 7.878 15h4.244A2.251 2.251 0 0 1 10 16.5z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},644695:(e,t,s)=>{"use strict";s.d(t,{Icon20PalleteOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20PalleteOutline","pallete_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="pallete_outline_20"><g fill="currentColor"><path d="M10.8 6.05a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0zM14.45 8.2a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5zM4.3 9.45a1.25 1.25 0 1 1 2.5 0 1.25 1.25 0 0 1-2.5 0zM7.85 4.8a1.25 1.25 0 1 0 0 2.5 1.25 1.25 0 0 0 0-2.5z" /><path fill-rule="evenodd" d="M14.177 14.037c2.142.23 4.323-.743 4.323-4.037 0-2.347-.951-4.472-2.49-6.01S12.347 1.5 10 1.5s-4.472.951-6.01 2.49S1.5 7.653 1.5 10s.951 4.472 2.49 6.01S7.653 18.5 10 18.5c1.13 0 2.255-1.007 1.977-2.425-.047-.24-.11-.472-.168-.688-.254-.94-.43-1.59 1.076-1.487.036.002.455.047 1.292.137zm.16-1.491-.246-.027c-.653-.07-1.037-.11-1.103-.116-.525-.036-1.172-.024-1.74.264a1.996 1.996 0 0 0-1.102 1.687c-.033.476.089.944.154 1.197l.072.27c.054.197.097.357.133.542a.58.58 0 0 1-.003.277.435.435 0 0 1-.099.173A.574.574 0 0 1 10 17a6.973 6.973 0 0 1-4.95-2.05A6.973 6.973 0 0 1 3 10c0-1.933.782-3.681 2.05-4.95A6.973 6.973 0 0 1 10 3c1.933 0 3.681.782 4.95 2.05A6.973 6.973 0 0 1 17 10c0 1.297-.412 1.873-.774 2.152-.412.317-1.065.482-1.889.394z" clip-rule="evenodd" /></g></symbol>',20,20,!1,void 0)},966430:(e,t,s)=>{"use strict";s.d(t,{Icon20Search:()=>a});var a=(0,s(825028).makeIcon)("Icon20Search","search_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="search_20"><path fill="currentColor" fill-rule="evenodd" d="M9.5 4.5a5 5 0 1 0 0 10 5 5 0 0 0 0-10zM3 9.5a6.5 6.5 0 1 1 11.596 4.035l3.184 3.185a.75.75 0 1 1-1.06 1.06l-3.185-3.184A6.5 6.5 0 0 1 3 9.5z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},331870:(e,t,s)=>{"use strict";s.d(t,{Icon20UserAddOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20UserAddOutline","user_add_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="user_add_outline_20"><path fill-rule="evenodd" d="M12.5 8.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5ZM8.5 6a4 4 0 1 1 8 0 4 4 0 0 1-8 0Zm-4-.25a.75.75 0 1 0-1.5 0v2H1a.75.75 0 0 0 0 1.5h2v2a.75.75 0 0 0 1.5 0v-2h2a.75.75 0 0 0 0-1.5h-2v-2Zm4.155 7.227c.865-.458 2.194-.727 3.845-.727 1.65 0 2.98.27 3.845.727.794.42 1.155.959 1.155 1.71a.685.685 0 0 1-.05.288.325.325 0 0 1-.092.12c-.077.063-.26.155-.599.155H8.241c-.34 0-.522-.092-.6-.156a.325.325 0 0 1-.09-.12.686.686 0 0 1-.051-.287c0-.751.36-1.29 1.155-1.71ZM12.5 10.75c-1.774 0-3.38.283-4.547.902C6.783 12.27 6 13.26 6 14.688c0 .688.268 1.217.687 1.563.408.337.956.499 1.554.499h8.518c.598 0 1.146-.162 1.555-.499.418-.346.686-.875.686-1.564 0-1.426-.783-2.416-1.953-3.035-1.168-.619-2.773-.902-4.547-.902Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},376499:(e,t,s)=>{"use strict";s.d(t,{Icon20WriteOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon20WriteOutline","write_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" id="write_outline_20"><path fill="currentColor" fill-rule="evenodd" d="M13.076 2.649A2.215 2.215 0 0 1 14.645 2c.566 0 1.135.216 1.568.649l1.137 1.136a2.21 2.21 0 0 1 0 3.133l-.941.94-9.17 9.179a3.296 3.296 0 0 1-2.33.963H3a1 1 0 0 1-1-1v-1.893a3.288 3.288 0 0 1 .965-2.34l8.123-8.132 1.988-1.986zm2.286 4.135.927-.926a.711.711 0 0 0 0-1.013l-1.137-1.136a.713.713 0 0 0-.507-.21.713.713 0 0 0-.507.21l-.927.926 2.15 2.149zM12.135 5.71l-8.109 8.118a1.79 1.79 0 0 0-.525 1.266V16.2a.3.3 0 0 0 .3.3H4.91c.475 0 .931-.189 1.267-.525l8.11-8.118-2.152-2.148z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},387613:(e,t,s)=>{"use strict";s.d(t,{Icon24Back:()=>a});var a=(0,s(825028).makeIcon)("Icon24Back","back_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="back_24"><g fill="none" fill-rule="evenodd"><path d="M24 0H0v24h24z" /><path fill="currentColor" d="m7.8 11 4.9-4.9a.99.99 0 0 0-1.4-1.4l-6.593 6.593a1 1 0 0 0 0 1.414L11.3 19.3a.99.99 0 0 0 1.4-1.4L7.8 13H20a1 1 0 0 0 0-2H7.8Z" /></g></symbol>',24,24,!1,void 0)},483704:(e,t,s)=>{"use strict";s.d(t,{Icon24DotsVertical:()=>a});var a=(0,s(825028).makeIcon)("Icon24DotsVertical","dots_vertical_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" id="dots_vertical_24"><path fill="currentColor" fill-rule="evenodd" d="M9 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm0 6a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm2 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm4-10a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm2 4a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm-2 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" clip-rule="evenodd" /></symbol>',24,24,!1,void 0)},262332:(e,t,s)=>{"use strict";s.d(t,{Icon24List:()=>a});var a=(0,s(825028).makeIcon)("Icon24List","list_24","0 0 24 24",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" id="list_24"><g fill="none" fill-rule="evenodd"><path d="M0 0h24v24H0z" /><path fill="currentColor" d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5Zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5Zm0 12a1.5 1.5 0 1 0-.001 2.999A1.5 1.5 0 0 0 4 16.5ZM21 18a1 1 0 0 0-1-1H8a1 1 0 0 0 0 2h12a1 1 0 0 0 1-1Zm0-6a1 1 0 0 0-1-1H8a1 1 0 0 0 0 2h12a1 1 0 0 0 1-1ZM8 7h12a1 1 0 0 0 0-2H8a1 1 0 1 0 0 2Z" /></g></symbol>',24,24,!1,void 0)},851594:(e,t,s)=>{"use strict";s.d(t,{Icon28ArchiveCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28ArchiveCircleFillGray","archive_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="archive_circle_fill_gray_28"><linearGradient id="archive_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#archive_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><g fill="#fff"><path d="M6.568 8.482c-.068.255-.068.565-.068 1.185 0 .31 0 .465.034.592a1 1 0 0 0 .707.707c.127.034.282.034.592.034h12.334c.31 0 .465 0 .592-.034a1 1 0 0 0 .707-.707c.034-.127.034-.282.034-.592 0-.62 0-.93-.068-1.185a2 2 0 0 0-1.414-1.414C19.763 7 19.453 7 18.833 7H9.167c-.62 0-.93 0-1.185.068a2 2 0 0 0-1.414 1.414z" /><path fill-rule="evenodd" d="M8 14.1c0-.56 0-.84.109-1.054a1 1 0 0 1 .437-.437C8.76 12.5 9.04 12.5 9.6 12.5h8.8c.56 0 .84 0 1.054.109a1 1 0 0 1 .437.437C20 13.26 20 13.54 20 14.1v2.1c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C17.72 21 16.88 21 15.2 21h-2.4c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C8 18.72 8 17.88 8 16.2zm3.5.65a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 0 1.5h-3.5a.75.75 0 0 1-.75-.75z" clip-rule="evenodd" /></g></symbol>',28,28,!1,void 0)},402516:(e,t,s)=>{"use strict";s.d(t,{Icon28CameraAddOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon28CameraAddOutline","camera_add_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="camera_add_outline_28"><path fill-rule="evenodd" d="M12.587 3h2.826c.469 0 .822 0 1.161.058a4 4 0 0 1 2.223 1.19c.237.25.433.543.693.934l.042.063.086.129c.129.193.156.231.18.26a1 1 0 0 0 .673.361c.038.004.085.005.317.005h.09c.574 0 .98 0 1.338.057a4.5 4.5 0 0 1 3.727 3.727c.057.357.057.764.057 1.338V15.5a1 1 0 1 1-2 0v-4.288c0-.7-.003-.932-.032-1.11a2.5 2.5 0 0 0-2.07-2.07c-.178-.029-.41-.032-1.11-.032h-.036c-.176 0-.33 0-.481-.015a3 3 0 0 1-2.018-1.08 4.888 4.888 0 0 1-.28-.392l-.02-.03-.085-.128c-.32-.482-.418-.621-.522-.731a2 2 0 0 0-1.112-.595c-.149-.026-.319-.029-.897-.029h-2.674c-.578 0-.748.003-.897.029a2 2 0 0 0-1.112.595c-.104.11-.201.25-.522.73l-.085.129-.02.03a4.814 4.814 0 0 1-.28.392 3 3 0 0 1-2.018 1.08C7.579 8 7.424 8 7.249 8h-.037c-.7 0-.932.003-1.11.032a2.5 2.5 0 0 0-2.07 2.07c-.029.178-.032.41-.032 1.11V15c0 1.417 0 2.419.065 3.203.063.771.182 1.243.371 1.613a4 4 0 0 0 1.748 1.748c.37.189.842.308 1.613.371C8.581 22 9.583 22 11 22h4.5a1 1 0 1 1 0 2h-4.544c-1.363 0-2.447 0-3.321-.072-.896-.073-1.66-.226-2.359-.582a6 6 0 0 1-2.622-2.622c-.356-.7-.51-1.463-.583-2.359C2 17.491 2 16.407 2 15.044v-3.922c0-.574 0-.98.057-1.338a4.5 4.5 0 0 1 3.727-3.727C6.141 6 6.548 6 7.122 6h.09c.232 0 .28-.001.317-.005a1 1 0 0 0 .673-.36c.024-.03.052-.068.18-.261l.086-.129.042-.063c.26-.39.456-.684.693-.934a4 4 0 0 1 2.223-1.19C11.766 3 12.118 3 12.587 3ZM14 11a3 3 0 1 0 0 6 3 3 0 0 0 0-6Zm-5 3a5 5 0 1 1 10 0 5 5 0 0 1-10 0Zm13 3a1 1 0 0 1 1 1v2h2a1 1 0 1 1 0 2h-2v2a1 1 0 1 1-2 0v-2h-2a1 1 0 1 1 0-2h2v-2a1 1 0 0 1 1-1Z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},926128:(e,t,s)=>{"use strict";s.d(t,{Icon28EducationCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28EducationCircleFillGray","education_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="education_circle_fill_gray_28"><rect width="28" height="28" fill="url(#education_circle_fill_gray_28_a)" rx="14" /><path fill="#fff" d="M19.2 14.937v1.732c0 2.116-2.328 3.831-5.2 3.831-2.873 0-5.2-1.715-5.2-3.83l-.001-1.733 4.01 2.192a2.494 2.494 0 0 0 2.23.075l.15-.075 4.01-2.192Zm-4.804-8.336 7.197 3.933a.76.76 0 0 1 .404.665H22v4.704c0 .423-.358.766-.8.766-.442 0-.8-.343-.8-.766v-3.387l-6.004 3.282a.831.831 0 0 1-.793 0l-7.2-3.933a.749.749 0 0 1 0-1.33l7.2-3.934a.831.831 0 0 1 .793 0Z" /><defs><linearGradient id="education_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop stop-color="#B1B6BD" /><stop offset="1" stop-color="#99A2AD" /></linearGradient></defs></symbol>',28,28,!1,void 0)},284069:(e,t,s)=>{"use strict";s.d(t,{Icon28MessageUnreadCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28MessageUnreadCircleFillGray","message_unread_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="message_unread_circle_fill_gray_28"><linearGradient id="message_unread_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#message_unread_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><g fill="#fff"><path d="M19.87 12.17a3 3 0 0 1-4.09-3.935A6.77 6.77 0 0 0 13.999 8c-3.314 0-6 2.359-6 5.269 0 1.406.628 2.684 1.653 3.63a11.487 11.487 0 0 1-.404 1.688c-.055.173-.13.376-.224.606a.578.578 0 0 0 .017.475.606.606 0 0 0 .801.273l.159-.076c.152-.075.286-.145.401-.21a12 12 0 0 0 1.895-1.333c.54.14 1.11.215 1.702.215 3.314 0 6-2.359 6-5.268 0-.377-.045-.745-.13-1.099z" /><path d="M20 9.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z" /></g></symbol>',28,28,!1,void 0)},19675:(e,t,s)=>{"use strict";s.d(t,{Icon28NotificationCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28NotificationCircleFillGray","notification_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="notification_circle_fill_gray_28"><linearGradient id="notification_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#notification_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><path fill="#fff" d="M15.817 19.5a1.85 1.85 0 0 1-3.634 0zM9.5 18c-1 0-1.5-.333-1.5-1 0-1 1.5-1 1.5-2.5v-3a4.501 4.501 0 0 1 3.7-4.43V7a.8.8 0 0 1 1.6 0v.071a4.501 4.501 0 0 1 3.7 4.429v3C18.5 16 20 16 20 17c0 .667-.5 1-1.5 1z" /></symbol>',28,28,!1,void 0)},743597:(e,t,s)=>{"use strict";s.d(t,{Icon28SendCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28SendCircleFillGray","send_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="send_circle_fill_gray_28"><linearGradient id="send_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#send_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><path fill="#fff" d="M10.16 16.628c-.458 1.298-.745 2.21-.863 2.737-.368 1.653-.637 2.026.738 1.24 1.375-.786 8.031-4.679 9.516-5.544 1.936-1.128 1.962-1.04-.104-2.237-1.573-.912-8.15-4.703-9.412-5.447-1.26-.745-1.106-.414-.738 1.24.12.533.41 1.453.875 2.761.324.915 1.079 1.586 1.992 1.772l3.843.781a.07.07 0 0 1 .052.083.068.068 0 0 1-.052.055l-3.852.78c-.916.186-1.673.86-1.996 1.779z" /></symbol>',28,28,!1,void 0)},315226:(e,t,s)=>{"use strict";s.d(t,{Icon28SunglassesCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28SunglassesCircleFillGray","sunglasses_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="sunglasses_circle_fill_gray_28"><path fill="url(#sunglasses_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14Z" /><path fill="#fff" d="M5.84 15.44c-.186-1.213-.23-1.357-.555-1.816-.409-.577-.467-1.238.428-1.412 2.296-.446 4.782-.113 7.047.302a6.239 6.239 0 0 0 2.48 0c2.265-.415 4.75-.748 7.047-.302.895.174.837.835.428 1.412-.325.46-.369.603-.555 1.816-.278 1.82-1.807 2.56-3.7 2.56-2.08 0-2.773-1.187-3.418-2.805-.628-1.573-1.454-1.573-2.082 0C12.315 16.813 11.622 18 9.541 18c-1.894 0-3.423-.741-3.701-2.56Z" /><defs><linearGradient id="sunglasses_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop stop-color="#B1B6BD" /><stop offset="1" stop-color="#99A2AD" /></linearGradient></defs></symbol>',28,28,!1,void 0)},538649:(e,t,s)=>{"use strict";s.d(t,{Icon28TextCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28TextCircleFillGray","text_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="text_circle_fill_gray_28"><path fill="url(#text_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14Z" /><path fill="#fff" d="M18.42 18.97c.996 0 2.09-.51 2.535-1.379H21v.419c.045.655.357.99.944.99.617 0 1.056-.38 1.056-1.12v-4.653c0-1.645-1.331-2.727-3.376-2.727-1.65 0-2.93.602-3.301 1.577a1.204 1.204 0 0 0-.112.502c0 .503.38.853.907.853.35 0 .625-.137.863-.41.483-.64.885-1.022 1.546-1.022.818 0 1.473.602 1.473 1.364v.54l-2.142.122c-1.993.122-3.108.989-3.108 2.474 0 1.47 1.153 2.47 2.67 2.47Zm.713-1.607c-.728 0-1.152-.381-1.152-.99 0-.58.394-.953 1.204-1.014L21 15.253v.594c0 .883-.915 1.516-1.867 1.516Z" /><path fill="#fff" fill-rule="evenodd" d="M6.189 19c.621 0 .971-.297 1.189-1.01l.59-1.67.095-.32h3.853l.1.32.59 1.693c.21.697.56.987 1.22.987.684 0 1.174-.438 1.174-1.054 0-.223-.039-.423-.148-.713l-3.077-7.971C11.441 8.386 10.897 8 9.981 8c-.886 0-1.438.4-1.764 1.27l-3.062 7.963c-.1.275-.155.527-.155.713C5 18.592 5.458 19 6.189 19Zm3.745-8.803h.054l1.456 4.303H8.51l1.425-4.303Z" clip-rule="evenodd" /><defs><linearGradient id="text_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop stop-color="#B1B6BD" /><stop offset="1" stop-color="#99A2AD" /></linearGradient></defs></symbol>',28,28,!1,void 0)},951891:(e,t,s)=>{"use strict";s.d(t,{Icon28UsersCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28UsersCircleFillGray","users_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="users_circle_fill_gray_28"><linearGradient id="users_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#users_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><path fill="#fff" d="M10.5 15c2.25 0 4.5.9 4.5 2.846v.134c0 .295-.04.447-.114.585a.773.773 0 0 1-.32.321c-.14.075-.29.114-.586.114H7.02c-.295 0-.447-.04-.585-.114a.773.773 0 0 1-.321-.32c-.075-.14-.114-.29-.114-.586v-.134C6 15.9 8.25 15 10.5 15zm7 0c2.25 0 4.5.9 4.5 2.846v.134c0 .295-.04.447-.114.585a.773.773 0 0 1-.32.321c-.14.075-.29.114-.586.114H16.6c.084-.248.13-.508.144-.797l.006-.223v-.134c0-1.069-.358-1.957-.971-2.659A7.74 7.74 0 0 1 17.5 15zm-7-6a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5zm7 0a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5z" /></symbol>',28,28,!1,void 0)},778816:(e,t,s)=>{"use strict";s.d(t,{Icon28VolumeCircleFillGray:()=>a});var a=(0,s(825028).makeIcon)("Icon28VolumeCircleFillGray","volume_circle_fill_gray_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="volume_circle_fill_gray_28"><linearGradient id="volume_circle_fill_gray_28_a" x1="-14" x2="14" y1="14" y2="42" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#b1b6bd" /><stop offset="1" stop-color="#99a2ad" /></linearGradient><path fill="url(#volume_circle_fill_gray_28_a)" d="M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14z" /><path fill="#fff" fill-rule="evenodd" d="M6.923 11.5H9l3.293-3.293A1 1 0 0 1 14 8.914v10.172a1 1 0 0 1-1.707.707L9 16.5H6.923c-.669 0-.911-.07-1.156-.2-.244-.131-.436-.323-.567-.567s-.2-.487-.2-1.156v-1.154c0-.669.07-.911.2-1.156.131-.244.323-.436.567-.567.245-.13.487-.2 1.156-.2zm9.526-.788a.9.9 0 0 1 1.27.097A4.885 4.885 0 0 1 18.9 14c0 1.216-.444 2.33-1.177 3.186a.9.9 0 1 1-1.367-1.17A3.084 3.084 0 0 0 17.1 14c0-.772-.28-1.476-.747-2.018a.9.9 0 0 1 .096-1.27zm4.044-2.39a.9.9 0 1 0-1.251 1.294A6.08 6.08 0 0 1 21.1 14a6.08 6.08 0 0 1-1.859 4.384.9.9 0 0 0 1.252 1.294A7.88 7.88 0 0 0 22.9 14a7.88 7.88 0 0 0-2.407-5.677z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0)},999411:(e,t,s)=>{"use strict";s.d(t,{Icon56BookmarkOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon56BookmarkOutline","bookmark_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="bookmark_outline_56"><path fill="currentColor" fill-rule="evenodd" d="M25.433 5h5.134c2.744 0 4.894 0 6.623.141 1.76.144 3.215.442 4.53 1.112a11.5 11.5 0 0 1 5.027 5.026c.67 1.316.968 2.77 1.112 4.53.141 1.73.141 3.88.141 6.624v20.321c0 1.783 0 3.224-.101 4.336-.1 1.102-.317 2.18-.984 3.02A5 5 0 0 1 43.024 52c-1.072.005-2.054-.491-2.982-1.094-.936-.607-2.07-1.499-3.47-2.6l-6.433-5.06c-1.206-.948-1.476-1.124-1.718-1.19a1.6 1.6 0 0 0-.843 0c-.24.066-.51.242-1.717 1.19l-6.433 5.06c-1.4 1.101-2.534 1.993-3.47 2.6-.928.603-1.91 1.1-2.982 1.094a5 5 0 0 1-3.891-1.89c-.667-.84-.884-1.918-.984-3.02C8 45.978 8 44.536 8 42.754V22.433c0-2.743 0-4.894.141-6.623.144-1.76.442-3.215 1.112-4.53a11.5 11.5 0 0 1 5.026-5.027c1.316-.67 2.77-.968 4.53-1.112C20.54 5 22.69 5 25.434 5zm-6.379 3.131c-1.575.129-2.59.376-3.413.795a8.5 8.5 0 0 0-3.715 3.715c-.419.823-.666 1.838-.795 3.413-.13 1.592-.131 3.621-.131 6.446v20.177c0 1.878.002 3.182.089 4.141.09.986.252 1.309.345 1.426A2 2 0 0 0 12.99 49c.149 0 .503-.071 1.333-.61.808-.524 1.835-1.33 3.31-2.49l6.372-5.012.19-.15c.904-.712 1.684-1.328 2.592-1.576a4.601 4.601 0 0 1 2.424 0c.908.248 1.688.864 2.592 1.576l.19.15 6.371 5.011c1.476 1.161 2.503 1.967 3.31 2.491.83.539 1.185.61 1.334.61a2 2 0 0 0 1.557-.756c.093-.117.256-.44.345-1.426.088-.959.089-2.263.089-4.141V22.5c0-2.825-.001-4.854-.131-6.446-.129-1.575-.376-2.59-.795-3.413a8.5 8.5 0 0 0-3.715-3.715c-.823-.419-1.838-.666-3.413-.795C35.354 8.001 33.325 8 30.5 8h-5c-2.825 0-4.854.001-6.446.131z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},537090:(e,t,s)=>{"use strict";s.d(t,{Icon56ErrorOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon56ErrorOutline","error_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" id="error_outline_56"><g fill="none" fill-rule="evenodd"><path d="M0 0h56v56H0z" /><path fill="currentColor" fill-rule="nonzero" d="M28 4c13.255 0 24 10.745 24 24S41.255 52 28 52 4 41.255 4 28 14.745 4 28 4Zm0 3C16.402 7 7 16.402 7 28s9.402 21 21 21 21-9.402 21-21S39.598 7 28 7Zm0 27a2 2 0 1 1 0 4 2 2 0 0 1 0-4Zm0-17.5a1.5 1.5 0 0 1 1.5 1.5v11l-.007.144A1.5 1.5 0 0 1 26.5 29V18l.007-.144A1.5 1.5 0 0 1 28 16.5Z" /></g></symbol>',56,56,!1,void 0)},233699:(e,t,s)=>{"use strict";s.d(t,{Icon56FolderPlusBadgeOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon56FolderPlusBadgeOutline","folder_plus_badge_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 56 56" id="folder_plus_badge_outline_56"><path fill-rule="evenodd" d="M4 35.2V20.8c0-4.48 0-6.72.872-8.432a8 8 0 0 1 3.496-3.496C10.08 8 12.32 8 16.8 8h2.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.442 1.284L27 13h12.2c4.48 0 6.72 0 8.432.872a8 8 0 0 1 3.496 3.496C52 19.08 52 21.32 52 25.8v1.7a1.5 1.5 0 0 1-3 0V25H7v12.8c0 2.52 0 3.78.49 4.743a4.5 4.5 0 0 0 1.967 1.967c.963.49 2.223.49 4.743.49h11.3a1.5 1.5 0 0 1 0 3h-8.7c-4.48 0-6.72 0-8.432-.872a8 8 0 0 1-3.496-3.496C4 41.92 4 39.68 4 35.2ZM7 22v-3.8c0-2.52 0-3.78.49-4.743a4.5 4.5 0 0 1 1.967-1.966C10.42 11 11.68 11 14.2 11h6.3l3.125 3.126c.692.691 1.038 1.037 1.442 1.285.358.219.748.38 1.156.479.46.11.95.11 1.928.11H41.8c2.52 0 3.78 0 4.743.49a4.5 4.5 0 0 1 1.967 1.967c.405.796.475 1.796.488 3.543H7Zm46 19c0 6.627-5.373 12-12 12s-12-5.373-12-12 5.373-12 12-12 12 5.373 12 12Zm-12-7a1.5 1.5 0 0 0-1.5 1.5v4h-4a1.5 1.5 0 0 0 0 3h4v4a1.5 1.5 0 0 0 3 0v-4h4a1.5 1.5 0 0 0 0-3h-4v-4A1.5 1.5 0 0 0 41 34Z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},194805:(e,t,s)=>{"use strict";s.d(t,{Icon56MessagesOutline:()=>a});var a=(0,s(825028).makeIcon)("Icon56MessagesOutline","messages_outline_56","0 0 56 56",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 56 56" id="messages_outline_56"><path fill="currentColor" fill-rule="evenodd" d="M22.029 10c-8.474 0-14.971 5.925-14.971 12.806 0 2.468.817 4.782 2.253 6.738a1.5 1.5 0 0 1 .291.888c0 1.638-.425 3.23-.953 4.674-.351.962-.772 1.919-1.17 2.803 3.314-.334 5.494-1.392 6.807-2.955a1.5 1.5 0 0 1 1.68-.437 17.062 17.062 0 0 0 6.063 1.095c8.474 0 14.97-5.925 14.97-12.806C37 15.925 30.504 10 22.03 10zM4.058 22.806C4.058 13.886 12.309 7 22.028 7 31.749 7 40 13.885 40 22.806c0 8.92-8.251 15.806-17.971 15.806-2.165 0-4.244-.337-6.172-.956-2.254 2.144-5.545 3.181-9.592 3.342-1.618.065-2.726-1.62-2.077-3.08.14-.318.282-.633.423-.946.434-.963.861-1.911 1.22-2.895.41-1.12.689-2.184.756-3.19-1.6-2.346-2.53-5.115-2.53-8.081z" clip-rule="evenodd" /><path fill="currentColor" fill-rule="evenodd" d="M43.012 18.768a1.5 1.5 0 0 0 .377 2.088c3.437 2.385 5.553 5.988 5.553 9.95 0 2.469-.817 4.782-2.253 6.738a1.5 1.5 0 0 0-.291.888c0 1.638.425 3.23.952 4.674.352.962.773 1.919 1.17 2.803-3.314-.334-5.493-1.392-6.806-2.955a1.5 1.5 0 0 0-1.68-.437 17.063 17.063 0 0 1-6.063 1.095c-2.986 0-5.755-.748-8.078-2.026a1.5 1.5 0 0 0-1.446 2.63c2.77 1.523 6.037 2.396 9.524 2.396 2.164 0 4.244-.337 6.172-.956 2.254 2.144 5.545 3.181 9.592 3.342 1.618.065 2.726-1.62 2.077-3.08-.14-.318-.282-.633-.423-.946-.434-.962-.861-1.911-1.22-2.895-.41-1.12-.69-2.184-.756-3.19 1.6-2.346 2.53-5.115 2.53-8.081 0-5.09-2.725-9.557-6.843-12.415a1.5 1.5 0 0 0-2.088.377z" clip-rule="evenodd" /></symbol>',56,56,!1,void 0)},279262:()=>{},876863:(e,t,s)=>{"use strict";s.d(t,{default:()=>a});const a={emoji:"Emoji-module__emoji--E0R4u"}},882972:(e,t,s)=>{"use strict";s.d(t,{EntityType:()=>a,EventQueue:()=>i});var a,n=s(434788);!function(e){e.Online="online"}(a||(a={}));class i{constructor({getQueue:e,registerQueue:t}){this.QUEUE_KEY_TTL=3e3,this.MAX_RETRIES=5,this.listeners=[],this.retriesLeft=this.MAX_RETRIES,this.restart=()=>{this.intervalId&&clearInterval(this.intervalId),0!==this.retriesLeft&&(this.retriesLeft--,this.getQueue().then((e=>{this.retriesLeft=this.MAX_RETRIES;const t=(0,n._)({},e);this.intervalId=window.setInterval((()=>{this.registerQueue(t,((e,s)=>{if(void 0===s.err){t.ts=s.ts;for(const e of s.events)for(const t of this.listeners)t(e)}else this.restart()}))}),this.QUEUE_KEY_TTL)})).catch((e=>{console.error(e),setTimeout(this.restart,this.QUEUE_KEY_TTL)})))},this.subscribe=e=>(this.listeners.push(e),1===this.listeners.length&&this.restart(),()=>{this.listeners=this.listeners.filter((t=>t!==e)),0===this.listeners.length&&(this.retriesLeft=this.MAX_RETRIES,this.intervalId&&clearInterval(this.intervalId))}),this.registerQueue=t,this.getQueue=e}}},595091:(e,t,s)=>{"use strict";s.d(t,{MediaScopeStats:()=>i});const a=(0,s(839470).partConfigEnabled)("messenger_mediascope_stats_collect"),n={vk:{open:"23112",close:"25112",active:"24112"},vkme:{open:"23122",close:"25122",active:"24122"},mvk:{open:"23112",close:"25112",active:"24112"}};const i=new class{constructor(){this.sendRequest=e=>{const t=n[this.platform][e];t&&("hidden"===document.visibilityState&&void 0!==navigator.sendBeacon?navigator.sendBeacon(`https://${t}.ms.vk.com`):fetch(`https://${t}.ms.vk.com`,{method:"HEAD",mode:"no-cors"}).catch((()=>{})))},this.stopStatsCollecting=()=>{clearInterval(this.timerId),this.sendRequest("close")},this.startStatsCollecting=()=>{this.sendRequest("open"),this.timerId=setInterval((()=>{this.sendRequest("active")}),1e4)},this.handleVisibilityChange=()=>{"hidden"===document.visibilityState?this.stopStatsCollecting():this.startStatsCollecting()},this.start=e=>{a&&(this.platform=e,this.startStatsCollecting(),document.addEventListener("visibilitychange",this.handleVisibilityChange))},this.stop=()=>{this.platform&&(this.stopStatsCollecting(),document.removeEventListener("visibilitychange",this.handleVisibilityChange))}}}},326214:(e,t,s)=>{"use strict";s.d(t,{createLongpollConnect:()=>v});var a=s(731062),n=s(302925),i=s(835200),o=s(839470);const r=1226,l=(0,o.partConfigEnabled)("me_web_read_by_cmid")?15:14,c=4,d=-3,_=-4,u=-5;function g(e,t){e.waitAbortFns.push(t)}function m(e){if(e.isStoppedFn())return Promise.resolve({ts:0,updates:[]});const{request:t,cancel:s}=(0,n.plaingetCancelable)(e.url,{act:"a_check",key:e.key,version:e.version,ts:e.ts,wait:25,mode:e.mode});return e.stopFn=s,t.then((([t,s])=>(e.onData(e,s),e.waitTimeout=2,JSON.parse(t)))).catch((([,t])=>(e.onData(e,t),Promise.reject(new Error(""))))).then((t=>function(e,t){const{abort:s,pause:n}=t.failed?(0,a.abortablePause)(c,null):{abort:()=>{},pause:()=>Promise.resolve()};switch(t.failed){case 1:return g(e,s),e.onHistoryLost(e,t).then((()=>e.onResult({ts:t.ts,updates:[[-1]]}))).then(n).then((()=>m(e)));case 2:return g(e,s),e.onKeyExpired(e,t).then((([t,s,a,n])=>e.onResult({ts:+n,updates:[[-2,t,`${s}/${a}`],[-1]]}))).then(n).then((()=>m(e)));case 3:return e.onLpBroken(e,t);default:return t.updates.some((e=>{switch(e[0]){case 4:return 4===e.length;case 5:case 18:return 3===e.length;default:return!1}}))?e.onHistoryLost(e,t).then((()=>e.onResult({ts:t.ts,updates:[[-1]]}))).then(n).then((()=>m(e))):Promise.resolve(t)}}(e,t)))}function p(e){e.isStoppedFn()||m(e).then(e.onResult.bind(e)).then((()=>e.isReconnecting&&h(e,u))).catch((t=>function(e,t){if(e.isStoppedFn())return;e.onRequestError(t),e.waitTimeout=Math.min(60,2*e.waitTimeout),h(e,d);const{abort:s,pause:n}=(0,a.abortablePause)(e.waitTimeout,null);return g(e,s),n().then((()=>h(e,_)))}(e,t))).then((()=>p(e)))}function h(e,t){e.isReconnecting=t===_,e.onResult({ts:e.ts,updates:[[t,e.waitTimeout]]})}function v(e,t){let s=!!e.stopped;const a={id:e.id,key:e.key,ts:e.ts,url:e.url,lpstat:e.lpstat||0,version:e.version||l,mode:r,waitTimeout:2,waitAbortFns:[],isReconnecting:!1,isStoppedFn:()=>s,onResult:e=>{e.ts&&o(a.ts,e.ts,e.updates.map(i.constructEvent))},onData:f(t.onData),onRequestError:f(t.onRequestError),onHistoryLost:b(t.onHistoryLost),onKeyExpired:b(t.onKeyExpired),onLpBroken:b(t.onHistoryLost)},{onEvents:n}=t;function o(e,t,s){a.ts=t;for(let e=0;e<s.length;++e)s[e].type===i.REFRESH_LP_KEY&&(a.key=s[e].key||"",a.url=s[e].url||"");n(e,t,s)}const c={options:a,isStopped:()=>s,stopConnection(){s=!0,a.stopFn&&a.stopFn(),a.stopFn=void 0,document.removeEventListener("resume",d),this.abortWaiting()},reinitConnection(){this.stopConnection(),document.addEventListener("resume",d),h(a,_),s=!1,p(a)},abortWaiting(){a.waitAbortFns.forEach((e=>e())),a.waitAbortFns=[],a.waitTimeout=2},onLp:o};function d(){c.abortWaiting()}return document.addEventListener("resume",d),p(a),c}function f(e){return e||(()=>{})}function b(e){return e?(...t)=>Promise.resolve(e(...t)):()=>Promise.reject()}},329737:(e,t,s)=>{"use strict";function a(e,t,s){let a=0,n=e,i=[],o=!1;function r(){!i.length||a>0||o||(t(i),i=[])}return{pause(){a++},resume(){a>0&&(a--,r())},onLp(e,t,a){o||(n>=e?(n=t,i.push(...a),r()):s&&(o=!0,s(n).then((([,e,t])=>{n=e,o=!1,i.push(...t),r()}))))}}}s.d(t,{createLongpollEventsQueue:()=>a})},189856:(e,t,s)=>{"use strict";s.d(t,{screenWakeLocker:()=>a});const a=new class{_onVisibilityChange(){this.wakeLockSentinel&&"visible"===document.visibilityState&&this.lock().then((()=>{})).catch(console.error)}requestWakeLock(){return navigator.wakeLock?this.wakeLockSentinel?Promise.resolve():navigator.wakeLock.request("screen").then((e=>{this.wakeLockSentinel=e})):Promise.reject()}isLocked(){return!!this.wakeLockSentinel&&!this.wakeLockSentinel.released}lock(){return this.requestWakeLock().then((()=>{this.wakeLockSentinel&&document.addEventListener("visibilitychange",this.onVisibilityChange)})).catch((()=>{}))}unlock(){return this.wakeLockSentinel?(document.removeEventListener("visibilitychange",this.onVisibilityChange),this.wakeLockSentinel.release().finally((()=>{this.wakeLockSentinel=null}))):Promise.resolve()}constructor(){this.onVisibilityChange=this._onVisibilityChange.bind(this)}}},160079:(e,t,s)=>{"use strict";s.d(t,{IdleManager:()=>c});var a=s(434788),n=s(980602),i=s(301230),o=s(404145),r=s(189856);const l=i.browser.iphone||i.browser.ipad||i.browser.ipod;class c extends n.default{stop(){this.started=!1,_(this.opts.element,this.opts.triggerEvents,this.cbActive),(0,o.isMvk)()&&this._isTopLevel()&&g()&&_(document,g(),this.onVisiblityChange),(0,o.isMvk)()&&l||(_(this.opts.focusElement,"focus",this.cbActive),_(this.opts.focusElement,"blur",this.cbInactive)),clearTimeout(this.setIdleTo),clearTimeout(this.checkIdleCbTo),clearTimeout(this.sendCbTO),this.is_idle=!0,this.opts.parentManager&&this.opts.parentManager.off("idle",this.cbInactive)}idle(e){this.is_idle=!0,e||this.opts.onIdleCb(),this.emit("idle")}unidle(e){this.is_idle=!1,e||this.opts.onUnIdleCb(),this.emit("unidle")}start(){this.started=!0,!(0,o.isMvk)()&&i.browser.mobile||(this.is_idle=!this._isFocused(),this.opts.parentManager&&this.opts.parentManager.on("idle",this.cbInactive),(0,o.isMvk)()&&this._isTopLevel()&&g()&&d(document,g(),this.onVisiblityChange),(0,o.isMvk)()&&l||(d(this.opts.focusElement,"focus",this.cbActive),d(this.opts.focusElement,"blur",this.cbInactive)),clearTimeout(this.checkIdleCbTo),this.checkIdleCb(),this.checkIdleCbTo=setTimeout(this.checkIdleCb,this.opts.idleTimeout))}constructor(e){super(),this.started=!1,this.is_idle=!0,this.activeTimeStart=null,this.checkIdleCb=()=>{this.started&&(d(this.opts.element,this.opts.triggerEvents,this.cbActive),clearTimeout(this.setIdleTo),this.setIdleTo=setTimeout(this.cbInactive,this.opts.idleTimeout))},this.cbActive=()=>{this.started&&(this.activeTimeStart=(new Date).getTime(),clearTimeout(this.setIdleTo),this.is_idle&&(this.is_idle=!1,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout((()=>{this.emit("unidle"),this.opts.onUnIdleCb&&this.opts.onUnIdleCb()}),100)),_(this.opts.element,this.opts.triggerEvents,this.cbActive),clearTimeout(this.checkIdleCbTo),this.checkIdleCbTo=setTimeout(this.checkIdleCb,this.opts.idleTimeout))},this.cbInactive=()=>{this.started&&(r.screenWakeLocker.isLocked()||(this.activeTimeStart=null,this.is_idle||(this.is_idle=!0,clearTimeout(this.sendCbTO),this.sendCbTO=setTimeout((()=>{this.emit("idle"),this.opts.onIdleCb&&this.opts.onIdleCb()}),100)),clearTimeout(this.checkIdleCbTo),_(this.opts.element,this.opts.triggerEvents,this.cbActive),d(this.opts.element,this.opts.triggerEvents,this.cbActive),this.checkIdleCbTo=setTimeout(this.checkIdleCb,this.opts.idleTimeout)))},this.getActiveTime=()=>!this.is_idle&&this.activeTimeStart?(new Date).getTime()-this.activeTimeStart:0,this.onVisiblityChange=()=>{"visible"===u()?this.cbActive():this.cbInactive()},this._isTopLevel=()=>{const{focusElement:e}=this.opts;return e===window||e===document},this._isFocused=()=>{const{focusElement:e}=this.opts;if(this._isTopLevel()){const e=u();return"string"==typeof e&&"visible"===e}return document.activeElement===e},this.opts=(0,a._)({triggerEvents:"mousemove keydown",onIdleCb:()=>{},onUnIdleCb:()=>{},focusElement:e.element,idleTimeout:3e4},e)}}function d(e,t,s){(0,o.isMvk)()?window.addEvent(e,t,s,{passive:!0}):window.addEvent(e,t,s)}function _(e,t,s){(0,o.isMvk)()?window.removeEvent(e,t,s,{passive:!0}):window.removeEvent(e,t,s)}function u(){return document.visibilityState||document.webkitVisibilityState}function g(){let e="visibilitychange";return document.visibilityState||(document.webkitVisibilityState?e+="webkit":e=""),e}},653902:(e,t,s)=>{"use strict";s.d(t,{CLIP_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>c,SHORT_VIDEO_UPLOAD_EXTS:()=>n,SHORT_VIDEO_UPLOAD_INPUT_ACCEPT:()=>o,VIDEO_UPLOAD_CHUNK_MAX_RETRY_NUMBER:()=>u,VIDEO_UPLOAD_CHUNK_SIZE:()=>d,VIDEO_UPLOAD_EXTS:()=>i,VIDEO_UPLOAD_FILE_THREAD_NUMBER:()=>_,VIDEO_UPLOAD_INPUT_ACCEPT:()=>r,VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB:()=>l,VIDEO_UPLOAD_SUBTITLES_DISABLED:()=>g,VIDEO_UPLOAD_SUBTITLES_USER_LANG:()=>m});const a=e=>["video/*",...e.map((e=>`.${e}`))].join(","),n="avi mp4 3gp mpeg mov flv f4v wmv mkv webm vob rm rmvb m4v mpg ogv ts m2ts mts mxf".split(" "),i=[...n,"torrent"],o=a(n),r=a(i),l=5,c=1,d=4194304,_=4,u=10,g=-1,m=-2},313702:(e,t,s)=>{"use strict";s.d(t,{getUploadErrorText:()=>o,getVideoDuration:()=>i});var a,n=s(29271);s(653902);function i(e){return new Promise((t=>{try{const s=document.createElement("video");s.preload="metadata",s.onloadedmetadata=()=>t(Math.round(s.duration)),s.onerror=()=>t(null),s.src=window.URL.createObjectURL(e)}catch(e){t(null)}}))}function o(e){return e?100===e?n.getLang("video_upload_encode_error_too_short"):101===e?n.getLang("video_upload_encode_error_too_long"):void 0:n.getLang("video_upload_encode_error")}!function(e){e[e.SHORT_VIDEO_TOO_SHORT=100]="SHORT_VIDEO_TOO_SHORT",e[e.SHORT_VIDEO_TOO_LONG=101]="SHORT_VIDEO_TOO_LONG"}(a||(a={}))},144968:(e,t,s)=>{"use strict";s.d(t,{BotButton:()=>u});var a=s(434788),n=s(785893),i=s(667294),o=s(86894),r=s(659397),l=s(571039),c=s(12402),d=s(408014),_=s(300069);function u({button:e,keyboardAuthorId:t,sendMessage:s,store:u}){const[g,m]=(0,i.useState)(!1),p=(0,i.useMemo)((()=>(0,c.getButtonLabel)(e)),[e]),{mode:h,appearance:v}=(0,i.useMemo)((()=>{let t="primary",s="accent";switch((0,c.getButtonAppearance)(e)){case"primary":break;case"secondary":t="secondary";break;case"positive":s="positive";break;case"negative":s="negative"}return{mode:t,appearance:s}}),[e]);const f=(0,i.useMemo)((()=>e.action.type===c.BUTTON_TYPE_OPEN_LINK||e.action.type===c.BUTTON_TYPE_OPEN_MODAL_VIEW?{href:(0,l.wrapAwayIfExternal)(e.action.link,!0),target:"_blank",rel:"nofollow noopener"}:null),[e]);return(0,n.jsx)(o.Button,(0,a._)({className:(0,r.classNames)("BotButton",`BotButton--${e.action.type.replace("_","-")}`),onClick:function(){if(g)return;const a=(0,d.getCurrentTab)(u);return a?(0,c.handleButtonClick)(e.action,s,u,{keyboardAuthorId:t,peerId:a.peerId,onBeforeSend(){m(!0)},onSendSuccess(e){const t=()=>{m(!1)},s={timeout:window.setTimeout(t,c.CALLBACK_TIMEOUT_MS),onCallback:t};u.set((t=>(0,_.setPressedCallbackButton)({peerId:a.peerId,eventId:e},s,t))),m(!0)},onSendFail(){m(!1)}}):void 0},mode:h,appearance:v,loading:g,stretched:!0},f,{children:(0,n.jsx)("span",{className:"BotButton__labelWrap",children:(0,n.jsx)("span",{className:"BotButton__label",dangerouslySetInnerHTML:{__html:p}})})}))}},205628:(e,t,s)=>{"use strict";s.d(t,{MessageReactionsPopup:()=>_});var a=s(434788),n=s(785893),i=s(667294),o=s(125777),r=s(513486),l=s(86894),c=s(555948),d=s(486429);const _=({getReactedPeers:e,reactionsData:t})=>{const[s,a]=(0,i.useState)(new Map),[d,_]=(0,i.useState)([]),[m,p]=(0,i.useState)(new Map),[h,v]=(0,i.useState)(0),[f,b]=(0,i.useState)(0);(0,i.useEffect)((()=>{e().then((e=>{const t=e.counters.map((e=>[e.reaction_id,e.count])).sort(((e,t)=>t[1]-e[1]));return _(t),b(e.count),e})).then((e=>u(e,t))).then((e=>{a(e),p(e)}))}),[]);const w=n=>{if(v(n||0),f<=100&&!n)p(s);else if(f<=100){const e=new Map([...s].filter((([,e])=>e.reactionId===n)));p(e)}else e(n).then((e=>u(e,t))).then((e=>{a(e)}))};return(0,n.jsx)(l.ConfigProvider,{platform:l.Platform.VKCOM,scheme:"inherit",children:(0,n.jsx)(l.AdaptivityProvider,{sizeX:l.SizeType.REGULAR,sizeY:l.SizeType.COMPACT,viewWidth:l.ViewWidth.DESKTOP,children:(0,n.jsx)(l.AppRoot,{mode:"partial",children:(0,n.jsx)("div",{className:"MessageReactionsPopup vkui__root",children:(0,n.jsx)("div",{className:"MessageReactionsPopup__content",children:f>0?(0,n.jsxs)(l.CustomScrollView,{children:[d.length>1&&(0,n.jsx)(l.HorizontalScroll,{children:(0,n.jsxs)(l.Tabs,{className:"MessageReactionsPopup__tabs",sizeX:l.SizeType.COMPACT,sizeY:l.SizeType.COMPACT,children:[(0,n.jsx)(c.TabsItem,{selected:0===h,onClick:()=>w(),children:(0,n.jsx)(o.MessageReactionsPopupTab,{count:f})}),d.map((([e,s])=>(0,n.jsx)(c.TabsItem,{selected:h===e,onClick:()=>w(e),children:(0,n.jsx)(o.MessageReactionsPopupTab,{count:s,icon:g(t,e,"MessageReactionsPopupTab__iconElement")})},e)))]})}),(0,n.jsx)("div",{className:"MessageReactionsPopup__peers",children:[...m.values()].map((e=>(0,n.jsx)(r.MessageReactionsPopupPeer,{reactedPeer:e},e.userId)))})]}):(0,n.jsx)(l.Spinner,{className:"MessageReactionsPopup__loader",size:"medium"})})})})})})};function u(e,t){const{profiles:s,groups:n,reactions:i}=e,o=new Map,r=new Map;return null==s||s.forEach((e=>{r.set(e.id,(0,a._)({},e,{name:`${e.first_name} ${e.last_name}`}))})),null==n||n.forEach((e=>{r.set(-e.id,e)})),0===r.size||i.forEach((e=>{const{reaction_id:s,user_id:a}=e,n=r.get(a),i=g(t,s,"MessageReactionsPopupPeer__reactionIconElement");n&&o.set(a,{peerId:a,name:n.name,photo:n.photo_200,screenName:n.screen_name,icon:i,reactionId:s})})),o}function g(e,t,s){const a=t&&e.get(t);return a?(0,n.jsx)("img",{className:s,src:a.icon}):(0,n.jsx)(d.default,{className:s})}},513486:(e,t,s)=>{"use strict";s.d(t,{MessageReactionsPopupPeer:()=>n});var a=s(785893);const n=({reactedPeer:e})=>{const{icon:t,name:s,photo:n,screenName:i}=e;return(0,a.jsxs)("div",{className:"MessageReactionsPopupPeer",children:[(0,a.jsxs)("div",{className:"MessageReactionsPopupPeer__avatar",children:[(0,a.jsx)("img",{className:"MessageReactionsPopupPeer__avatarImage",src:n,alt:s}),(0,a.jsx)("div",{className:"MessageReactionsPopupPeer__reactionIcon",children:t})]}),(0,a.jsx)("div",{className:"MessageReactionsPopupPeer__name",children:s}),(0,a.jsx)("a",{href:`/${i}`,className:"MessageReactionsPopupPeer__link",target:"_blank"})]})}},125777:(e,t,s)=>{"use strict";s.d(t,{MessageReactionsPopupTab:()=>i});var a=s(785893),n=s(29271);const i=({count:e,icon:t})=>(0,a.jsxs)("div",{className:"MessageReactionsPopupTab",children:[t?(0,a.jsx)("div",{className:"MessageReactionsPopupTab__icon",children:t}):(0,a.jsx)("span",{className:"MessageReactionsPopupTab__label",children:n.getLang("global_all")}),e]})},41963:(e,t,s)=>{"use strict";s.d(t,{CAROUSEL_LAYER_CLASS:()=>l,CAROUSEL_VIEWPORT_CLASS:()=>r,mount:()=>w});var a=s(15080),n=s(795558),i=s(936134);const o="_im_carousel",r="_im_carousel_viewport",l="_im_carousel_layer",c="_im_carousel_control",d="_im_carousel_control_left",_="_im_carousel_control_right",u="Carousel__control--hidden";function g(e){return(0,n.domClosest)(o,e.target)}function m(e,t){const s=t.querySelector(`.${d}`),a=t.querySelector(`.${_}`),n=t.querySelector(`.${r}`),i=t.querySelector(`.${l}`);if(!(a&&s&&n instanceof HTMLElement&&i instanceof HTMLElement))return;const o=n.offsetWidth,c=i.offsetWidth,g=o<c;s.classList.toggle(u,!g||e<=0),a.classList.toggle(u,!g||e+o>=c)}function p(e){const t=g(e),s=(0,n.domClosest)(c,e.target),a=Number(s.dataset.direction);if(!t)return;const i=t.querySelector(`.${r}`),o=t.querySelector(`.${l}`);if(!i||!o||!a)return;const d=Number(t.dataset.scrollCount)||1,_=Math.floor(o.offsetWidth/o.childElementCount),u=(Math.floor(i.scrollLeft/_)+a*d)*_;m(u,t),i.scrollTo({left:u,behavior:"smooth"})}const h=(0,i.debounce)((e=>{const t=g(e),s=t&&t.querySelector(`.${r}`);s&&m(s.scrollLeft,t)}),20);function v(e){const t=g(e);(t&&t.querySelector(`.${r}`)).addEventListener("scroll",h)}function f(e){const t=g(e);(t&&t.querySelector(`.${r}`)).removeEventListener("scroll",h)}function b(e){return{unmount(){(0,a.destroyModule)(e)}}}function w(e,t){const{bindMutations:s}=(0,a.createMutations)(b);return s((0,a.createModule)({handlers:(e,s)=>{s(t,"click",c,p),s(t,"mouseover",o,v),s(t,"mouseout",o,f)}}),e)}},688087:(e,t,s)=>{"use strict";s.d(t,{mount:()=>m});var a=s(15080),n=s(875610),i=s(527405),o=s(222009),r=s(728785),l=s(502478),c=s(29271),d=s(82161);const _="_im_dialogs_cog_settings",u="_im_to_unread",g="im-page--dialogs-filter";function m(e,t,s){const m=(e,a)=>{(0,i.showUnreadOnly)(t,s,n.changeDialogsTab).then((e=>{const n=t.get().active_tab;if(!e)return;const i=n===r.ConvoListFolder.UNREAD;a.innerHTML=(0,d.getTemplate)("im_filter",{filter:i?c.getLang("mail_to_all_dialogs"):c.getLang("mail_to_unread")}),n===r.ConvoListFolder.ALL&&s().updateRecommendationList(t)}))},p=(0,a.createModule)({handlers:(t,s)=>{s(e,"click",u,m)}});return function(e,t){return{updateFilter(t){const s=t.get().active_tab,a=s===r.ConvoListFolder.UNREAD;let n,i=[];((0,o.isSearching)(t)||[r.ConvoListFolder.BUSINESS_NOTIFY,r.ConvoListFolder.ARCHIVE,r.ConvoListFolder.MR].includes(s))&&i.push("im-page--dialogs-filter_hidden"),(0,l.getUnreadCountWithMuted)(t)>0?n=a?c.getLang("mail_to_all_dialogs"):c.getLang("mail_to_unread"):(n=c.getLang("mail_all_dialogs"),i.push("im-page--dialogs-filter_disabled"));const _=e.querySelector(`.${u}`);_&&(_.innerHTML=(0,d.getTemplate)("im_filter",{filter:n,cls:i.join(" ")}))},toggleButton(t,s){const a=e.querySelector(`.${g}`);a&&a.classList.toggle("im-page--dialogs-filter_hidden",s)},toggleLoader(t,s){const a=e.querySelector(`.${_}`);a&&a.classList.toggle("im-page--dialogs-settings_loading",s)},unmount(){(0,a.destroyModule)(t)}}}(e,p)}},790738:(e,t,s)=>{"use strict";s.d(t,{mount:()=>_,mountHistoryMsgsReactionsObserver:()=>u});var a=s(15080),n=s(552666),i=s(662273),o=s(502478),r=s(82161),l=s(408014),c=s(49988);function d(e,t,s,a){const{observer:n,targets:i}=s.get();i.forEach((e=>n.unobserve(e)));const r=function(e,t,s){const a=(0,o.getPeer)(e);if(!(0,l.isFullyLoadedTab)(e,a))return[];const n=(0,l.getTab)(e,a);return n&&n.msgs?Object.keys(n.msgs).reduce(((e,a)=>{if(!n.msgs)return e;const i=(0,c.parseMessage)(n.msgs[a]);if(!t(i,n))return e;const o=s||document,r=o.querySelector(`._im_mess_${a}`)||o.querySelector(`._im_expired_message_${a}`);return r&&e.push(r),e}),[]):[]}(e,a,t);s.setState({targets:r}),r.forEach((e=>n.observe(e)))}function _(e,t,s,i){const o=(0,n.default)({observer:new IntersectionObserver(s,{root:t}),targets:[]});d(e,t,o,i);const r=(0,a.createModule)({handlers:()=>{}});let l=!1;return{update(){l||d(e,t,o,i)},unmount(){const{observer:e}=o.get();e.disconnect(),(0,a.destroyModule)(r),l=!0}}}function u(e,t,s,l,c){const _=15e3,u=1e3;let g=new Set,m=new Map,p=new Map;function h(t){const s=(0,o.getPeer)(e),a=(0,o.getUnreadReactions)(e,s),n=[];for(let e of t)a.has(e)&&n.push(e);return n}const v=(0,i.throttle)((()=>{const e=h(Array.from(g));e.length&&c(e)}),100);const f=setInterval((function(){const e=Array.from(g),t=function(e){const t=Date.now(),s=e.some((e=>{const s=p.get(e),a=m.get(e);return s&&a&&t-s>=_&&t-a>=u}));return s&&e.forEach((e=>{p.set(e,t)})),s}(e),s=h(e);t&&l(e),s.length&&c(s)}),1e3),b=e=>{g=new Set;const{targets:t}=e.get(),s=new Map,a=new Map;t.forEach((e=>{const t=e.getAttribute("data-cmid"),n=t&&(0,r.intval)(t);if("number"==typeof n){const e=p.get(n)||Date.now(),t=m.get(n);t&&a.set(n,t),s.set(n,e)}})),p=s,m=a},w=(0,n.default)({observer:new IntersectionObserver((e=>{e.forEach((e=>{const t=e.target.getAttribute("data-cmid"),s=t&&(0,r.intval)(t);if("number"==typeof s){if(e.isIntersecting){g.add(s);const e=m.get(s)||Date.now();m.set(s,e)}else g.delete(s),m.delete(s);v()}}))}),{root:t}),targets:[]});d(e,t,w,(()=>!0)),b(w);const C=(0,a.createModule)({handlers:()=>{}});let y=!1;return s(),{update(){y||(d(e,t,w,(()=>!0)),b(w))},unmount(){const{observer:e}=w.get();e.disconnect(),(0,a.destroyModule)(C),y=!0,clearInterval(f)}}}},85981:(e,t,s)=>{"use strict";s.d(t,{mount:()=>u});var a=s(785893),n=s(973935),i=s(869048),o=s(871333),r=s(544358),l=s(15080),c=s(875610);function d(){return document.getElementById("_im_keyboard_container")}function _(e,t,s){return{init(){return new Promise((e=>{this.isMounted=!0,function(e,t,s){const l=d();if(l){const c=(0,a.jsx)(i.AppRootProvider,{children:(0,a.jsx)(r.default,{value:e,children:(0,a.jsx)(o.default,{send:t})})});n.render(c,l,s)}}(t,s,e)}))},toggle:(e,s,a)=>t.set(c.toggleKeyboard.bind(null,e,s,a)),unmount(){const t=d();t&&this.isMounted&&n.unmountComponentAtNode(t),this.isMounted=!1,(0,l.destroyModule)(e)}}}function u(e,t,s){const{bindMutations:a}=(0,l.createMutations)(_);return a((0,l.createModule)({handlers:()=>{}}),e,s)}},199005:(e,t,s)=>{"use strict";s.d(t,{mount:()=>m});var a=s(785893),n=s(15080),i=s(514986),o=s(638871),r=s(502478),l=s(552666),c=s(973935),d=s(205628),_=s(29271);const u="reactions-modal";function g(e){return{unmount:()=>function(e){const t=document.getElementById(u);t&&(c.unmountComponentAtNode(t),(0,n.destroyModule)(e))}(e)}}function m(e,t){const{bindMutations:s}=(0,n.createMutations)(g),m=s((0,n.createModule)({handlers:()=>{}}),e),p=new i.MessageBox({title:_.getLang("mail_reactions_popup_title"),width:640,height:580,hideButtons:!0,bodyStyle:{padding:"0"},onHideAttempt:()=>(m.unmount(),!0)}),h=document.createElement("section");return h.setAttribute("id",u),p.content(h).show(),function(e,t,s){const n=(0,l.unpackStore)(t),i=(0,r.getGroupId)(t),_=(0,r.getPeer)(t);c.render((0,a.jsx)(d.MessageReactionsPopup,{getReactedPeers:e=>(0,o.getReactedPeers)(_,i,s,e),reactionsData:n.reactions}),e)}(h,e,t),m}},179880:(e,t,s)=>{"use strict";s.d(t,{mount:()=>E});var a=s(785893),n=s(973935),i=s(544358),o=s(869048),r=s(15080),l=s(875610),c=s(222009),d=s(408014),_=s(804381),u=s(747805),g=s(659397),m=s(811453),p=s(514986),h=s(502478);const v=s(570630).default,f=s(242060).default,{MAIN:b,EDIT:w}=s(242060);function C(e,t){return(0,u.default)().reduce(((t,s)=>t.replace(new RegExp(`({${s.id}})`,"gi"),s.process(e))),t).replace(/&lt;br&gt;/gi,"<br>")}function y(e,t,s,r,u){let v;return{closeSettingsPopup(){v&&v.hide()},showSettingsPopup(e){const s="TemplatesSettings",r={hideButtons:!0,bodyStyle:"padding: 0; background: none;",width:500,onShow:()=>{const r=document.getElementById(s);r&&n.render((0,a.jsx)(o.AppRootProvider,{children:(0,a.jsx)(i.default,{value:t,children:(0,a.jsx)(f,{popup:v,section:e,getTemplates:()=>(0,c.getTemplates)(t),saveTemplate:this.saveTemplate.bind(this),deleteTemplate:this.deleteTemplate.bind(this),closePopup:this.closeSettingsPopup.bind(this)})})}),r),requestAnimationFrame((()=>v.updateBoxCoords()))}};v=new p.MessageBox(r).content(`<div id="${s}"></div>`),v.show()},applyTemplate(e){const s=(0,c.getTemplates)(t).find((({id:t})=>t===e));(0,_.statlogsCommunityTemplatesClickEvent)(),r(C(t,(0,m.prepareToWriting)(s.text)))},getPreparedTemplates:()=>(0,c.getTemplates)(t).map((e=>Object.assign({},e,{name:e.name,text:C(t,e.text)}))),saveTemplate(e){const s=(0,g.decodeHTMLEntities)(e.name),a=(0,g.decodeHTMLEntities)(e.text);return t.set(e.id?l.updateTemplate.bind(null,e.id,s,a):l.createTemplate.bind(null,s,a))},deleteTemplate:e=>t.set(l.deleteTemplate.bind(null,e)),isNeedRenderTemplates(){const e=(0,h.getPeer)(t);if(!e)return!1;if(!(0,c.isCommunityInterface)(t))return!1;const s=(0,d.getCurrentTab)(t);return(!s||!(0,c.isChannelPeer)(s))&&!(0,c.isCommunityChat)(t,e)},toggleImText(e=this.isNeedRenderTemplates()){u(e)},update(){this.toggleImText()},unmount(){this.toggleImText(!1)}}}function E(e,t,s,o){const{bindMutations:l}=(0,r.createMutations)(y),c=l((0,r.createModule)({handlers:()=>{}}),e,t,s,o);if("function"!=typeof c){c.toggleImText();const s=(0,a.jsx)(i.default,{value:e,children:(0,a.jsx)(v,{getTemplates:c.getPreparedTemplates,applyTemplate:c.applyTemplate.bind(c),isNeededRendering:c.isNeedRenderTemplates,showSettingsPopup:c.showSettingsPopup.bind(c,b),showCreatingTemplatePopup:c.showSettingsPopup.bind(c,w)})});n.render(s,t)}return c}},166858:(e,t,s)=>{"use strict";var a,n,i,o=s(434788),r=s(98626),l=s(584356),c=s(418252),d=s(552666),_=s(95638),u=s(875610),g=s(590646),m=s(527405),p=s(82161),h=s(29271),v=s(795558),f=s(520797),b=s.n(f),w=s(839470),C=s(321850),y=s(967805);s(216799);(null==(a=window.vk)||null==(n=a.pe)?void 0:n.static_manager_dynamic_imports)&&(null==(i=window.vk)?void 0:i.stDomain)&&(s.p=window.vk.stDomain+"/dist/"),window.IM={init(e){var t,s;if((0,p.addTemplates)(b()),window.cur.lang.dont_attach=h.getLang("mail_dont_add_media"),e.failed)return(0,c.mount)((0,v.geByClass1)("im-sick",(0,v.ge)("page_body")),null);localStorage.removeItem("im_sick_timer"),window.cur.ctrl_submit=Boolean(e.settings.ctrl_submit),window.cur.module="im",window.cur.mutedPeers=e.mutedPeers,window.cur.gid=e.gid,window.cur.peer=e.peer,window.cur.options={blacklist_hash:e.thash},null==(t=window.StickerPickerViewer)||t.initPeerId();const a=-10800-60*(new Date).getTimezoneOffset(),n=e.timeshift,i=Object.entries(e.defaultReactions).reduce(((e,[t,s])=>e.set(Number(t),s)),new Map),f=(0,o._)({},e,{owners:void 0,tabbedPeers:(e.tabbedPeersArray||[]).map((e=>({peer:e,type:"perm"}))),blockedFlagUpdates:{},msgid:(0,p.intval)(window.nav.objLoc.msgid),timeshift:n-a,oCache:{},ref_id:window.nav.objLoc.ref,ref_source:window.nav.objLoc.ref_source,topConvTree:new Promise((()=>{})),hintsTree:new Promise((()=>{})),imTopConvList:new Promise((()=>{})),callbackEventButtons:new Map,reactions:i,pendingReadReactionsCmids:new Map,cmidToMessageIdMap:new Map});let y=(0,d.default)(f);null==(s=e.owners)||s.forEach((e=>(0,g.oCacheAdd)(y,e))),(0,m.normalizeTabsGotFromServer)(y,y.get().tabs),window.cur.imClassicInterface=(0,m.isClassicInterface)(y);let E=(0,r.mount)((0,v.geByClass1)("js-im-page",(0,v.ge)("page_body")),y);(0,u.updateMentions)(y.get()),e.group_calls_feature_tt_hash&&(0,m.showGroupCallsOnboardingBox)(y.get(),e.group_calls_feature_tt_hash),e.group_calls_new_year_feature_tt_hash&&(0,m.showGroupCallsNewYearTooltip)(y.get(),e.group_calls_new_year_feature_tt_hash),window.IMBRIDGE={chatPhotoSaved(e){(0,l.curBox)()&&(0,l.curBox)().hide();let t=(e||{})[1];return t?(window.cur.pvShown&&window.layers.fullhide(!0,!0),"im"!=window.cur.module||y.get().peer!=t?window.nav.go("/im?sel=c"+(t-2e9)):void 0):window.nav.reload()},syncHistory(){y.set((e=>(0,u.syncHistory)(e))).then((()=>{}),(()=>{}))},activateTab(e,t="notifications"){y.get().gid||y.get().longpoll.push([(0,_.changePeer)((0,p.intval)(e),!1,!1,!0,t)])},selectedPeer:()=>y.get().peer,openSettings(){E.openSettings()}},(0,w.partConfigEnabled)("debug_messenger")&&(window.IMBRIDGE.store=y);let S=!1;window.cur.nav.push((function(){var e;return!!S||((null==(e=y.get().audio_msg)?void 0:e.isRecording)&&E.cancelRecording(),window.AudioMessagePlayer.detachPlayer(),E.route.apply(null,arguments))})),(0,C.pushNavDestroy)((function(){if(S)return!0;E.unmount(),window.IMBRIDGE=void 0,y.unmount(),window.store=void 0,S=!0,e=!1,y=!1,E=!1}))},initOnboarding:y.initOnboarding,updateHints:y.updateHints,activeHints:[],onboardingParams:{}};try{window.stManager.done(window.jsc("web/imn.js"))}catch(e){}},39611:(e,t,s)=>{"use strict";s.d(t,{addMessageReactionOptimistic:()=>o,removeMessageReactionOptimistic:()=>r,setMessageFlag:()=>i});var a=s(783400),n=s(408014);function i(e,t,s,i,o){const r=(0,n.getTab)(e,t),l=(0,a.getMessage)(e,t,s);return r&&r.msgs&&l?(l.flags=o?l.flags|i:l.flags&~i,r.msgs[s]=l,Promise.resolve(e)):Promise.resolve(e)}function o(e,t,s,i){const o=(0,n.getTab)(i,e),r=(0,a.getMessage)(i,e,t),l=(null==r?void 0:r.kludges.reactions)||[],c=i.id;if(!r||!(null==o?void 0:o.msgs))return Promise.resolve(i);const d=l.findIndex((e=>e.reaction_id===s));if(r.kludges.reaction_id=s,r.kludges.reactions||(r.kludges.reactions=[]),-1===d)r.kludges.reactions.push({reaction_id:s,count:1,user_ids:[c]});else{var _;const e=l[d];null==(_=e.user_ids)||_.unshift(c),e.count=e.count+1,r.kludges.reactions=[...l.slice(0,d),e,...l.slice(d+1)]}return o.msgs[t]=r,Promise.resolve(i)}function r(e,t,s,i){var o;const r=(0,n.getTab)(i,e),l=(0,a.getMessage)(i,e,t);if(!l)return Promise.resolve(i);const c=(null==l?void 0:l.kludges.reactions)||[],d=i.id;if(delete l.kludges.reaction_id,0===c.length||!(null==r?void 0:r.msgs))return Promise.resolve(i);const _=c.findIndex((e=>e.reaction_id===s)),u=c[_];return u.user_ids=null==(o=u.user_ids)?void 0:o.filter((e=>e!==d)),u.count=u.count-1,l.kludges.reactions=[...c.slice(0,_),u,...c.slice(_+1)].filter((e=>0!==e.count)),r.msgs[t]=l,Promise.resolve(i)}},993901:(e,t,s)=>{"use strict";s.d(t,{ContactList:()=>d});var a=s(785893),n=s(349232),i=s(937107),o=s(589448),r=s(29271),l=s(973935);const c=({store:e,browserEnv:t,onClose:s,onSelect:l})=>(0,a.jsxs)(i.default,{onClose:s,disableBodyScroll:!0,children:[(0,a.jsx)(o.default.Header,{title:r.getLang("mail_contacts_list"),onClose:s}),(0,a.jsx)("div",{style:{width:550,height:560},children:(0,a.jsx)(n.ContactListApp,{store:e,env:t,onSelect:l})})]});class d{renderContactListPopup(e,t){const s=d.getContainer(),n=()=>this.hide();s&&l.render((0,a.jsx)(c,{store:e,browserEnv:t,onClose:n,onSelect:e=>this.onSelectPeer(e)}),s)}static getContainer(){return document.getElementById("ContactList")}hide(){if(!this.isMounted)return;const e=d.getContainer();e&&l.unmountComponentAtNode(e),this.isMounted=!1}show(){var e;const t=null==(e=window.reforgedME)?void 0:e.contactListContext;if(!t)return;const{store:s,browserEnv:a}=t;this.renderContactListPopup(s,a),this.isMounted=!0}onSelectPeer(e){this.hide(),window.nav.go(`/im?sel=${e}`,null,{params:{entrypoint:"contacts_list"}})}constructor(){this.isMounted=!1}}},525207:(e,t,s)=>{"use strict";s.d(t,{Settings:()=>F});var a=s(785893),n=s(640974),i=s(812081),o=s(95154),r=s(883950),l=s(790351),c=s(277210),d=s(327320),_=s(915234),u=s(982732),g=s(378002),m=s(300069),p=s(441416),h=s(205261),v=s(354273),f=s(727539),b=s(232621),w=s(356432),C=s(415102),y=s(891172),E=s(25153),S=s(485950),M=s(651695),I=s(605836),T=s(973935),k=s(253434),L=s(937107),A=s(549309),P=s(29271),x=s(451116),B=s(95638),R=s(731062),D=s(404145);const O=({onClose:e,store:t,browserEnv:s})=>(0,a.jsxs)(L.default,{onClose:e,children:[(0,a.jsx)(A.ModalHeader,{title:P.getLang("mail_im_settings_header"),onClose:e}),(0,a.jsx)(k.ModalBody,{hasScroll:!1,children:(0,a.jsx)("div",{style:{width:"560px",margin:"0 -25px",padding:"4px 20px"},children:(0,a.jsx)(n.SettingsApp,{store:t,env:s,set:new Set(["ctrSubmit","soundNotifications","showRecommendations","countOnlyNotMuted","autoUnarchive","transcriptAutoShow"])})})})]});class F{renderSettingsPopup(e,t){const s=F.getContainer(),n=()=>this.hide();s&&T.render((0,a.jsx)(O,{onClose:n,store:e,browserEnv:t}),s)}static getContainer(){return document.querySelector("#MessengerSettings")}getContext(){var e;if(null==(e=window.reforgedME)?void 0:e.settingsContext)return window.reforgedME.settingsContext;if(this.ownContext)return this.ownContext;(0,i.initConfig)();const t=(0,D.getHostName)(),s=window.vk.id,a=(0,x.createFeatureFlags)(),n=new v.Api(s),m=new b.Logger,p=new w.ProxyStorage(o.STORAGE_DB_NAME),T=new S.SharedEngine(m,(0,x.isMasterTab)()),k=new M.Stats,L=(0,x.createLang)(m),A={system:new r.Modals,stack:new r.Stack},P=new l.Uploader(n),B=new c.MEAppMediaMediator,R=new h.FCPlayer(B),O=new h.FCVoicePlayer(B),F=new d.MEAppRecorder({},B),N=new x.VkComRouter(a.vkm_reforged_in_vkcom,a,t),U={vkDomain:t,api:n,lang:L,logger:m,storage:p,player:R,voicePlayer:O,videoMessagePlayer:new _.MEAppVideoMessagePlayer(B),browserNotifications:new C.BrowserNotifications,externalEvents:new u.ExternalEvents,idle:new f.Idle(m),stats:k,geoLocation:new I.GeoLocation,openApp:()=>{},vkcom_textInput:(0,x.vkcom_textInputStub)(),vkcom_mediaSelector:(0,x.vkcom_mediaSelectorStub)(),botKeyboard:{update:()=>{},subscribe:()=>()=>{},openApp:()=>{},openLink:()=>{},openSnackbar:()=>{},addEventId:()=>{}},modals:A,router:N,uploader:P,voiceRecorder:F},H={api:n,engine:T,queue:new E.SharedQueue,lang:L,logger:m,storage:p,player:R,voicePlayer:O,stats:k,botKeyboard:{update:()=>{},subscribe:()=>()=>{},openApp:()=>{},openLink:()=>{},openSnackbar:()=>{},addEventId:()=>{}},modals:A,router:N,notification:new y.Notification},j=(0,g.createStore)(H,a,void 0,s);return j.start(),this.ownContext={store:j,browserEnv:U},this.ownContext}hide(){if(!this.isMounted)return;const e=F.getContainer();e&&T.unmountComponentAtNode(e),this.unsubscribe(),this.isMounted=!1}show(){const{store:e,browserEnv:t}=this.getContext();let s=e.getState().viewer.settings;this.unsubscribe=e.subscribe((e=>{const t=e.viewer.settings;s.ctrSubmit!==t.ctrSubmit&&(window.cur.ctrl_submit=t.ctrSubmit,this.imStore.set((e=>(0,m.setLocalSettingsValue)("ctrl_submit",Number(t.ctrSubmit),e)))),s.showRecommendations!==t.showRecommendations&&this.imStore.set((e=>(0,m.setLocalSettingsValue)("messages_recommendation_list_hidden",Number(!t.showRecommendations),e))).finally((()=>{if(!t.showRecommendations)return void this.imPageMutations().setRecommendationListVisibility(!1);this.imPageMutations().setRecommendationListVisibility(!0)||(this.hide(),window.nav.reload())})),s.countOnlyNotMuted!==t.countOnlyNotMuted&&this.imStore.set((e=>(0,m.setLocalSettingsValue)("show_only_not_muted_messages",Number(t.countOnlyNotMuted),e))).then((e=>{(0,p.updateUnreadCounter)(e)})),s.transcriptAutoShow!==t.transcriptAutoShow&&this.imStore.set((e=>(0,m.setLocalSettingsValue)("transcript_auto_show",Number(t.transcriptAutoShow),e))).then((()=>(0,R.pause)(.25))).then((()=>{var e;return null==(e=this.imStore.get().longpoll)?void 0:e.push([(0,B.changeVoiceTranscriptUI)()])})),s=e.viewer.settings})),this.renderSettingsPopup(e,t),this.isMounted=!0}constructor(e,t){this.isMounted=!1,this.imStore=e,this.imPageMutations=t}}},997889:(e,t,s)=>{"use strict";s.d(t,{prepareEmptyDialogStickersTemplate:()=>f,renderHistoryStub:()=>v});var a=s(790287),n=s(502478),i=s(82161),o=s(839470),r=s(832468),l=s(221780),c=s(620145),d=s(51875),_=s(21442),u=s(790637),g=s(408014),m=s(83667),p=s(211314),h=s(931917);function v(e){const t=(0,n.getPeer)(e),s=h.Ranges.isContactId(t),a=t&&(0,g.getTab)(e,t),p=(0,r.getEmptyScreenUserInfo)(e,t);if(a&&(0,g.isCasperChatTab)(a))return(0,i.getTemplate)("sImEmptyCasper");const v=s||(0,g.isUserEmptyScreenRich)(e,t)&&p&&0!==(null==p?void 0:p.canWrite);if(!a||!(0,o.partConfigEnabled)("messages_new_empty_dialog_screen")||!v)return l.getLang("mail_im_here_history");const b=s?(0,m.prepareContactName)(a.tab):(0,i.stripHTML)(a.tab),w=s?(0,m.prepareContactName)(a.name):a.name,C=a.contact_name,y=s?l.getLang("mail_empty_history_with_contact").replace("{user_name}",w):(0,l.langSex)(a.sex,l.getLang("mail_empty_history_with_user","raw")).replace("{user_name}",w),E=C?(0,l.langSex)(a.sex,l.getLang("mail_saved_in_contacts_as","raw")).replace("{contact_name}",C):"";let S="";S=a.is_nft_photo&&a.photo?(0,i.getTemplate)("sImDialogImRowAvatarRichSkinPhoto",{photo:a.photo,size:80}):a.photo?`<img src="${a.photo}" alt="${w}">`:(0,i.getTemplate)("sImContactAvatar",{name:(0,m.getUserInitials)(w),size:80,classes:""});const M=a.is_subscribed,I=M?"sImEmptyDialogStubUnsubscribeButton":"sImEmptyDialogStubSubscribeButton",T=M?l.getLang("mail_friend_request_sent"):l.getLang("mail_add_to_friends"),k=s||a.is_friend?"":(0,i.getTemplate)(I,{button_text:T}),[L,A]=p?function(e){if(e.occupation){const{icon:t}="work"===e.occupationType?(0,c.getIcon20WorkOutline)():(0,d.getIcon20EducationOutline)();return[e.occupation,t]}if(e.bdate){const{icon:t}=(0,_.getIcon20CakeOutline)(),[s,a]=e.bdate.split("."),n=new Date;n.setDate(+s),n.setMonth(+a-1);return[(0,l.langDate)(n.getTime(),l.getLang("mail_birthday_day_month","raw"),0,l.getLang("months_of","raw"),!0),t]}if(e.city){const{icon:t}=(0,u.getIcon20HomeOutline)();return[e.city,t]}return["",""]}(p):["",""],P=(null==p?void 0:p.mutualFriends.length)?function(e){const t=e.mutualFriends.map((e=>(0,i.getTemplate)("sImEmptyDialogStubMutualFriend",{name:e.name,src:e.photo}))).join("");return(0,i.getTemplate)("sImEmptyDialogStubMutualFriends",{friends:t,text:(0,l.langNumeric)(e.commonCount||0,l.getLang("mail_mutual_friends_count","raw"))})}(p):"",x=s?"":(0,i.getTemplate)("sImEmptyDialogStubUserInfo",{profile_href:a.href,subscribe_button:k,additional_info:L,additional_icon:A,mutual_friends:P});return`${(0,i.getTemplate)("sImEmptyDialogStub",{avatar:S,name:b,stub_text:y,secondary_block:x,saved_as:E,classes:(0,n.isClassicInterface)(e)?"EmptyDialogStub--classic":""})}${f(e)}`}function f(e){var t;const s=(0,n.getPeer)(e),o=(0,g.getTab)(e,s),r=(0,n.getEmojiOptId)(e);if(!o)return"";const l=o.is_new,c=(null==(t=window.stickersKeywords)?void 0:t["привет"])||[],d=new Map;if(c.reduce(((e,t)=>{var s;const{packId:a,sticker:n}=(null==(s=window.Emoji.stickersById)?void 0:s[t])||{};return t<0||!n?e:e.set(t,[t,256,"",n[3],a])}),d),l){var _;((null==(_=window.Emoji.stickers[a.Emoji.TAB_NEW_CONVO_STICKERS])?void 0:_.stickers)||[]).reduce(((e,t)=>e.set(t[0],t)),d)}const u=[...d.values()].reduce(((e,t)=>{const[s,,,a,n]=t,o={sticker_id:s,sticker_url:p.Stickers.getStickerUrl(s,((0,i.isRetina)()?256:128)+"b"),animation_url:a,set_id:n||0,opt_id:r},l=a?"sImEmptyDialogAnimatedSticker":"sImEmptyDialogSticker";return`${e}${(0,i.getTemplate)(l,o)}`}),"");if(!u)return"";const m=(0,i.getTemplate)("sImCarousel",{content:u,controls_class:"",scroll_count:"3"});return(0,i.getTemplate)("sImEmptyDialogStickers",{content:m})}},327777:(e,t,s)=>{"use strict";s.d(t,{updateFolderCounters:()=>r});var a=s(552666),n=s(728785),i=s(874223);const o=[n.ConvoListFolder.MR,n.ConvoListFolder.BUSINESS_NOTIFY,n.ConvoListFolder.ARCHIVE];function r(e){const t=(0,a.unpackStore)(e);o.forEach((e=>{var s,a;const n=(0,i.getFolderUnreadCount)(t,e),o=document.querySelector(`._im_right_menu_counter[data-tab="${e}"]`);o&&(o.innerHTML=n,null==(s=o.closest(".ui_rmenu_item"))||null==(a=s.classList)||a.toggle("ui_rmenu_item_hidden",(0,i.isConvoListFolderHidden)(t,e)))}));const s=(0,i.getFolderMentionsCount)(t,n.ConvoListFolder.ARCHIVE),r=document.querySelector(`._im_right_menu_mentions[data-tab="${n.ConvoListFolder.ARCHIVE}"]`);r&&(r.dataset.mentions=s)}},779625:(e,t,s)=>{"use strict";function a(){window.cur.videoAutoplayScrollHandler&&window.cur.videoAutoplayScrollHandler()}s.d(t,{videoAutoPlayHandler:()=>a})},309436:(e,t,s)=>{"use strict";s.d(t,{createLongpoll:()=>c});var a=s(326214),n=s(84486),i=s(302925),o=s(875610),r=s(215066),l=s(931917);function c(e,t){return(0,a.createLongpollConnect)(e,{onEvents:t,onData:g,onRequestError:m,onHistoryLost:p,onKeyExpired:h,onLpBroken:v})}const d=3e4;let _={},u=Date.now();function g(e,t){if(!t||!t.status||!e.lpstat)return;const s=t.status.toString();t.status>=500&&t.status<600&&(0,r.statlogsValueEvent)("fc_longpoll",1,s,t.getResponseHeader("x-frontend")||""),_[s]=s in _?_[s]+1:1,Date.now()-u>=d&&(Object.keys(_).forEach((e=>{(0,r.statlogsValueEvent)("fc_longpoll",_[e],e,t.getResponseHeader("x-frontend")||"")})),_={},u=Date.now())}function m(e){(0,n.lpLogFc)("red","LP error",e.message||"no message (probably browser reset)")}function p(e,t){(0,n.lpLogFc)("red","LP failed: old timestamp; resync, next ts",t.ts)}function h(e){return(0,n.lpLogFc)("red","LP failed: key is incorrect; refresh key"),(0,i.post)(o.CONTROLLER,{act:"a_get_key",uid:e.id,gid:l.Ranges.isGroupId(e.id)?l.Ranges.convertGroupIdToOwnerId(e.id):0},1e3)}function v(){throw window.nav.reload({force:!0}),new Error("ts is very wrong")}},84486:(e,t,s)=>{"use strict";function a(e,t,...s){if(!window.vk.lpConfig.debug)return;const a=`background: ${e}; color: white`,n=new Date,i=e=>e<10?"0"+e.toString():e.toString();console.log(`%c ${n.getHours()}:${i(n.getMinutes())}:${i(n.getSeconds())}:${n.getMilliseconds()} ${t} `,a,...s)}function n(){return window.lpBufferFc||(window.lpBufferFc=[]),window.lpBufferFc}function i(){return window.lpBufferIm||(window.lpBufferIm=[]),window.lpBufferIm}function o(){return"im"===window.cur.module&&window.store&&window.store.get().longpoll&&!window.store.get().stopped}function r(){o()&&(i().forEach((e=>{!n().find((t=>e.ev===t.ev))&&e.time<Date.now()-1e3&&!e.warned&&(e.warned=!0,a("red","im not fc",e.ev))})),n().forEach((e=>{const t=i().find((t=>t.ev===e.ev));t&&t.warned&&!e.warned&&(e.warned=!0,a("red","now fc like im",e.ev))}))),function(){const e=Date.now()-3e4;window.lpBufferFc=n().filter((t=>t.time>e)),window.lpBufferIm=i().filter((t=>t.time>e))}()}function l(e){o()&&(n().push(...e.map((e=>({time:Date.now(),ev:JSON.stringify(e),warned:!1})))),setTimeout(r,0)),a("green","fc",...e)}s.d(t,{longpollTestingOnFcEvents:()=>l,lpLogFc:()=>a}),window.longpollTestingOnImEvents=function(e){o()&&(i().push(...e.map((e=>({time:Date.now(),ev:JSON.stringify(e),warned:!1})))),setTimeout(r,1100)),a("blue","im",...e)}},349232:(e,t,s)=>{"use strict";s.d(t,{ContactListApp:()=>_});var a=s(667294),n=s(682930),i=s(826226),o=s(966933),r=s(545443),l=s(96190),c=s(86894),d=s(635800);const _=({store:e,env:t,onSelect:s})=>{const[_,u]=(0,a.useState)(e.getState());(0,a.useEffect)((()=>e.subscribe(u)),[e]);const g=l.safeGet(_.peers,_.viewer.id),{items:m,contacts:p,hasMore:h}=_.contacts;return a.createElement(d.ErrorBoundary,{fallbackRender:()=>null,onError:e=>t.logger.error("[ContactListApp] Error",e)},a.createElement("div",{className:"ContactListApp MEConfig vkui__root"},a.createElement(r.Symbols,null),a.createElement(n.Provider,{env:t,state:_,dispatch:e.dispatch,featureFlags:e.featureFlags,owner:g},a.createElement(c.ConfigProvider,{platform:c.Platform.VKCOM,scheme:"inherit"},a.createElement(c.AdaptivityProvider,null,a.createElement(o.LayoutDataProvider,{value:(0,a.useMemo)((()=>({mode:"two-column"})),[])},a.createElement(c.AppRoot,{noLegacyClasses:!0,mode:"partial",disablePortal:!0},a.createElement(i.ContactList,{items:m,contacts:p,hasMore:h,onSelect:s}))))))))}},640974:(e,t,s)=>{"use strict";s.d(t,{SettingsApp:()=>g,VKCOMSettingsApp:()=>m});s(968641),s(29354);var a=s(667294),n=s(369379),i=s(86894),o=s(682930),r=s(96190),l=(s(279262),s(635800)),c=s(635402),d=s(324247),_=s(966933),u=s(364705);const g=({store:e,env:t,set:s})=>{const[c,d]=(0,a.useState)(e.getState());(0,a.useEffect)((()=>e.subscribe(d)),[e]);const _=0===c.convoConn.pts,u=r.safeGet(c.peers,c.viewer.id);return a.createElement(l.ErrorBoundary,{fallbackRender:()=>null,onError:e=>t.logger.error("[SettingsApp] Error",e)},a.createElement(o.Provider,{env:t,state:c,dispatch:e.dispatch,featureFlags:e.featureFlags,owner:u},a.createElement(i.ConfigProvider,{platform:i.Platform.VKCOM,scheme:"inherit"},a.createElement(i.AdaptivityProvider,null,a.createElement(i.AppRoot,{noLegacyClasses:!0,mode:"partial",disablePortal:!0},a.createElement(n.Settings,{isLoading:_,set:s}))))))},m=({store:e,env:t})=>{const[s,n]=(0,a.useState)(e.getState());if((0,a.useEffect)((()=>e.subscribe(n)),[e]),"loading"===s.convoConn.status)return null;const c=r.safeGet(s.peers,s.viewer.id);return a.createElement(l.ErrorBoundary,{fallbackRender:()=>null,onError:e=>t.logger.error("[SettingsApp] Error",e)},a.createElement(o.Provider,{env:t,state:s,dispatch:e.dispatch,featureFlags:e.featureFlags,owner:c},a.createElement(_.UIConfigProvider,{scheme:"VKCOM",theme:s.viewer.settings.theme,locale:t.lang.locale},a.createElement(i.ConfigProvider,{platform:i.Platform.VKCOM,scheme:"inherit"},a.createElement(i.AdaptivityProvider,null,a.createElement(i.AppRoot,{noLegacyClasses:!0,mode:"partial",disablePortal:!0},a.createElement(p,{state:s})))))))},p=({state:e})=>{const{route:t}=(0,u.useRouter)();if("SettingsRoute"!==t.kind)return null;const s=t.section||"main";return a.createElement("div",{className:"VKCOMSettingsApp"},a.createElement(d.VKCOMSettingsContent,{activeSection:s,convos:e.convos,locks:e.locks,folders:e.organisers.folders,foldersView:"horizontal"}),a.createElement(c.VKCOMSettingsMenu,{activeSection:s}))}},21442:(e,t,s)=>{"use strict";function a(){return{icon:'<svg fill="none" height="20" viewBox="0 0 20 20" width="20" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M10.1 1.78c-.03-.09-.17-.09-.2 0-.2.54-.4.9-.55 1.17C9.15 3.33 9 3.6 9 4a1 1 0 0 0 2 0c0-.41-.14-.67-.35-1.05-.16-.28-.35-.63-.55-1.17z"/><path clip-rule="evenodd" d="M17.29 11.7c-.22.3-.49.53-.79.7v.68c0 .53 0 .98-.03 1.34-.03.38-.1.74-.27 1.08-.26.52-.68.94-1.2 1.2-.34.17-.7.24-1.08.27-.36.03-.8.03-1.34.03H7.42c-.53 0-.98 0-1.34-.03-.38-.03-.74-.1-1.08-.27a2.75 2.75 0 0 1-1.2-1.2 2.8 2.8 0 0 1-.27-1.08c-.03-.36-.03-.8-.03-1.34v-.69a2.5 2.5 0 0 1-.79-.69A4.45 4.45 0 0 1 2 9h.75H2v-.02a1.42 1.42 0 0 1 0-.12 2.44 2.44 0 0 1 .4-1.14C2.83 7.05 3.64 6.5 5 6.5h10c1.36 0 2.17.55 2.6 1.22a2.58 2.58 0 0 1 .4 1.26v.01c0 1.08-.2 2.02-.71 2.71zM3.5 9.01c0 .92.18 1.48.41 1.79.2.27.52.45 1.09.45.46 0 .78-.22 1.1-.53l.23-.25.02-.02.23-.25c.08-.08.2-.18.33-.27.13-.08.34-.18.59-.18s.46.1.6.18c.13.09.24.19.32.27l.23.25.02.02.24.25c.31.31.63.53 1.09.53.46 0 .78-.22 1.1-.53l.23-.25.02-.02.23-.25c.08-.08.2-.18.33-.27.13-.08.34-.18.59-.18s.46.1.6.18c.13.09.24.19.32.27l.23.25.02.02.24.25c.31.31.63.53 1.09.53.57 0 .88-.18 1.09-.45.23-.31.4-.87.41-1.79v-.02c0-.02 0-.06-.02-.1-.02-.1-.06-.24-.14-.36C16.2 8.33 15.89 8 15 8H5c-.9 0-1.2.33-1.34.53a1.08 1.08 0 0 0-.16.48zM17.25 9H18zm-4.4 2.78c.43.44 1.11.97 2.15.97v.3c0 .57 0 .96-.02 1.25-.03.29-.07.43-.12.52-.12.23-.3.42-.54.54-.1.05-.23.1-.52.12-.3.02-.68.02-1.25.02h-5.1c-.57 0-.96 0-1.25-.02a1.36 1.36 0 0 1-.52-.12 1.25 1.25 0 0 1-.54-.54c-.05-.1-.1-.23-.12-.52C5 14 5 13.62 5 13.05v-.3c1.04 0 1.72-.53 2.16-.97l.28-.3.06-.07.06.07.28.3c.44.44 1.12.97 2.16.97s1.72-.53 2.16-.97l.28-.3.06-.07.06.07.28.3z" fill-rule="evenodd"/><path d="M6.4 1.78c.03-.09.17-.09.2 0 .2.54.4.9.55 1.17.2.38.35.64.35 1.05a1 1 0 0 1-2 0c0-.41.14-.67.35-1.05.16-.28.35-.63.55-1.17zm7.2 0c-.03-.09-.17-.09-.2 0-.2.54-.4.9-.55 1.17-.2.38-.35.64-.35 1.05a1 1 0 1 0 2 0c0-.41-.14-.67-.35-1.05-.16-.28-.35-.63-.55-1.17z"/></g></svg>',name:"cake_outline_20"}}s.d(t,{getIcon20CakeOutline:()=>a})},51875:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="education_outline_20__Page-2" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="education_outline_20__education_outline_20"><path id="education_outline_20__Bounds" d="M0 0h20v20H0z"/><path d="M17.5 9.06 16 9.9V13c0 2.8-2.72 5-6 5s-6-2.2-6-5V9.89l-2.35-1.3a1.25 1.25 0 0 1 0-2.19L9.4 2.15c.37-.2.83-.2 1.2 0l7.75 4.25c.42.24.66.68.65 1.13v5.22a.75.75 0 1 1-1.5 0V9.06Zm-3 1.65-3.9 2.14c-.37.2-.83.2-1.2 0L5.5 10.7V13c0 1.9 1.98 3.5 4.5 3.5s4.5-1.6 4.5-3.5v-2.3ZM10 3.54 2.77 7.5 10 11.46l7.23-3.96L10 3.54Z" id="education_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"education_outline_20"}}s.d(t,{getIcon20EducationOutline:()=>a})},790637:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g id="home_outline_20__Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="home_outline_20__Icons-20/home_outline_20"><g id="home_outline_20__home_outline_20"><path opacity=".4" d="M0 0h20v20H0z"/><path d="M3 11h-.04l-.18-.01A2.04 2.04 0 0 1 1.67 7.4L8.2 1.8a2.75 2.75 0 0 1 3.58 0l6.54 5.6A2.04 2.04 0 0 1 17 11v4.25c0 1.24-1 2.25-2.25 2.25h-2.8a.95.95 0 0 1-.95-.95V13.5a1 1 0 0 0-2 0v3.05c0 .52-.43.95-.95.95h-2.8c-1.24 0-2.25-1-2.25-2.25V11Zm11.75 5c.41 0 .75-.34.75-.75v-4.9c0-.47.38-.85.85-.85H17a.54.54 0 0 0 .35-.96l-6.54-5.6c-.46-.4-1.16-.4-1.62 0l-6.54 5.6a.54.54 0 0 0-.06.77c.09.1.21.17.31.18l.1.01h.65c.47 0 .85.38.85.85v4.9c0 .41.34.75.75.75H7.5v-2.5a2.5 2.5 0 1 1 5 0V16h2.25Z" id="home_outline_20__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></g></svg>',name:"home_outline_20"}}s.d(t,{getIcon20HomeOutline:()=>a})},669827:(e,t,s)=>{"use strict";function a(){return{icon:'<svg width="56" height="56" viewBox="0 0 56 56" xmlns="http://www.w3.org/2000/svg"><g id="archive_outline_56__Icons-56/archive_outline_56" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="archive_outline_56__archive_outline_56"><path d="M0 0h56v56H0z"/><path d="M44.5 18c.83 0 1.5.67 1.5 1.5v21a7.5 7.5 0 0 1-7.5 7.5h-21a7.5 7.5 0 0 1-7.5-7.5v-21c0-.83.67-1.5 1.5-1.5h33ZM43 21H13v19.5a4.5 4.5 0 0 0 4.5 4.5h21a4.5 4.5 0 0 0 4.5-4.5V21Zm-21.5 9h13a1.5 1.5 0 0 0 0-3h-13a1.5 1.5 0 0 0 0 3Zm-9-22h31a6.5 6.5 0 0 1 6.5 6.5v4a2.5 2.5 0 0 1-2.5 2.5h-39A2.5 2.5 0 0 1 6 18.5v-4A6.5 6.5 0 0 1 12.5 8ZM47 18v-3.5a3.5 3.5 0 0 0-3.5-3.5h-31A3.5 3.5 0 0 0 9 14.5V18h38Z" id="archive_outline_56__Icon-Color" fill="currentColor" fill-rule="nonzero"/></g></g></svg>',name:"archive_outline_56"}}s.d(t,{getIcon56ArchiveOutline:()=>a})},273555:(e,t,s)=>{"use strict";s.d(t,{random:()=>i});var a=s(664988);const n=2147483647;function i(){try{if(window.crypto){let e=new Int32Array(1);return crypto.getRandomValues(e),Math.abs(e.reduce(((e,t)=>e+t)))}}catch(e){}return(0,a.intval)((0,a.rand)(0,n).toFixed(0))}},459393:(e,t,s)=>{"use strict";s.d(t,{screenfull:()=>o});var a=s(159726),n=s(839470);const i=function(){const e=function(){let e,t;const s=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]];let a=0,n=s.length;const i={};for(;a<n;a++)if(e=s[a],e&&e[1]in document){for(a=0,t=e.length;a<t;a++)i[s[0][a]]=e[a];return i}return!1}(),t={request:function(t){const s=e.requestFullscreen;(t=t||document.documentElement)[s]()},exit:function(){document[e.exitFullscreen]()},toggle:function(e){this.isFullscreen?this.exit():this.request(e)},raw:e};return!!e&&(Object.defineProperties(t,{isFullscreen:{get:function(){return Boolean(document[e.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[e.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return Boolean(document[e.fullscreenEnabled])}}}),t)}(),o=(0,n.partConfigEnabled)("screenfull_lib_enabled")?a.default:i},662273:(e,t,s)=>{"use strict";function a(e,t){let s,a,n=!1;return function i(){if(n)return s=arguments,void(a=this);e.apply(this,arguments),n=!0,setTimeout((function(){n=!1,s&&(i.apply(a,s),s=a=null)}),t)}}s.d(t,{throttle:()=>a})},702929:(e,t,s)=>{"use strict";function a(){let e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||window.MediaDevices&&window.MediaDevices.getUserMedia,t=function(t){return new Promise((function(s,a){e?e.call(navigator,t,s,a):a(new Error("NotSupported"))}))},s=function(){return new Promise((function(e,t){if(MediaStreamTrack&&MediaStreamTrack.getSources){let t={audio:"audioinput",video:"videoinput"};return MediaStreamTrack.getSources((function(s){e(s.map((function(e){return{label:e.label,kind:t[e.kind],deviceId:e.id,groupId:""}})))}))}t(new Error("NotSupported"))}))};e&&!navigator.mediaDevices&&(navigator.mediaDevices=navigator.mediaDevices||{}),navigator.mediaDevices&&(navigator.mediaDevices.getUserMedia||(navigator.mediaDevices.getUserMedia=t),navigator.mediaDevices.enumerateDevices||(navigator.mediaDevices.enumerateDevices=s)),window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext&&(window.AudioContext.prototype.createScriptProcessor=window.AudioContext.prototype.createScriptProcessor||window.AudioContext.prototype.createJavaScriptNode)}s.d(t,{initFailBack:()=>a})},211314:(e,t,s)=>{"use strict";s.d(t,{Stickers:()=>l});var a=s(68003),n=s(29271),i=s(404145);const o={},r=(e,t,s,a)=>{delete o[t],1===a?Emoji.favorite.addFavoriteSticker(e,t,s):-1===a&&Emoji.favorite.deleteFavoriteSticker(e,t,s)};const l={toggleFavorite:function(e,t,s){if(t&&t.stopPropagation(),!e.classList.contains("on")&&function(){const e=Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS].stickers;return!(!e||e.length<Emoji.favoriteLimit)}())return function(){if(!Emoji.favoriteLimitNoticed){const e=(0,n.langStr)(getLang("purchases_stickers_favorite_limit_notice"),"%s",Emoji.favoriteLimit);setTimeout(window.showFastBox(getLang("global_error"),e).hide,3e3),ajax.post("stickers.php",{act:"favorite_limit_noticed",value:1}),Emoji.favoriteLimitNoticed=!0}}(),!1;const a=e.getAttribute("data-sticker-id"),i=e.getAttribute("data-hash");return!(!a||!i)&&(!o[a]&&(o[a]=1,e.classList.toggle("on"),void ajax.post("/stickers.php",{act:"toggle_favorite",sticker_id:a,hash:i},{onDone:r.pbind(s,a,e)})))},getStickerUrl:function(e,t){let s=String(t);if(a.colorScheme.isDarkScheme()&&(s=s.replace(/b$/,"")+"b"),window.Emoji){var n,o,r;const t=null==(n=null==(o=Emoji.stickersById)||null==(r=o[e])?void 0:r.sticker[Emoji.STICKER_FIELD_IMAGES])?void 0:n[s];if(t)return t}const l={id:e,size:s};if((0,i.isMvk)()){if(window.stickers_cache){const t=window.stickers_cache.getStickerImage(e,s);if(t)return t}return window.store.stickers&&window.rs(window.store.stickers.url_template,{id:e,size:s})}return window.getTemplate("stickers_sticker_url",l)}}},871333:(e,t,s)=>{"use strict";s.d(t,{default:()=>g});var a=s(785893),n=s(667294),i=s(45697),o=s.n(i),r=s(824111),l=s(544358),c=s(659397),d=s(222009),_=s(144968);class u extends n.Component{static getButtonWidth(e){return`calc(100% / ${e} - 10px)`}render(){const{store:e,send:t}=this.props,s=(0,d.getCurrentKeyboard)(e);return s&&s.buttons?(0,a.jsx)("div",{className:(0,c.classNames)("Keyboard",{"Keyboard--hidden":s.hide}),children:(0,a.jsx)(r.Scroll,{className:"Keyboard__scrollWrapper",children:(0,a.jsx)("div",{className:"Keyboard__container",children:s.buttons.map(((n,i)=>(0,a.jsx)("div",{className:"Keyboard__row",children:n.map(((i,o)=>(0,a.jsx)("div",{className:"Keyboard__button",style:{width:u.getButtonWidth(n.length)},children:(0,a.jsx)(_.BotButton,{button:i,sendMessage:t,keyboardAuthorId:s.author_id,store:e})},`cell-${o}`)))},`row-${i}`)))})})}):null}}u.propTypes={store:o().object.isRequired,send:o().func.isRequired};const g=(0,l.connect)(u)},570630:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var a=s(785893),n=s(667294),i=s(45697),o=s.n(i),r=s(824111),l=s(29271),c=s(544358),d=s(700200),_=s(682615),u=s(262332);class g extends n.Component{render(){const{getTemplates:e,showSettingsPopup:t,showCreatingTemplatePopup:s,isNeededRendering:n}=this.props,{isShowDropDown:i}=this.state;if(!n())return null;const o=e();return(0,a.jsxs)("div",{className:"TemplatesDropDown",onMouseOver:this.toggleDropdown.bind(this,!0),onMouseOut:this.toggleDropdown.bind(this,!1),children:[(0,a.jsx)("div",{className:(0,_.classNames)("TemplatesDropDown__wrapper",{"TemplatesDropDown__wrapper--show":i}),"aria-hidden":i,children:(0,a.jsx)("div",{className:"TemplatesDropDown__container",children:(0,a.jsx)(r.Scroll,{className:"TemplatesDropDown__scroll-wrapper",children:(0,a.jsxs)("div",{children:[" ",(0,a.jsxs)("header",{className:"TemplatesDropDown__header",children:[(0,a.jsx)("h2",{className:"TemplatesDropDown__title",children:l.getLang("mail_community_templates")}),(0,a.jsx)("a",{role:"button",className:"TemplatesDropDown__setting-button",onClick:t,children:l.getLang("mail_settings_configure")})]}),o.length?(0,a.jsx)("ul",{className:"TemplatesDropDown__list",children:o.map((e=>(0,a.jsxs)("li",{className:"TemplatesDropDown__item",onMouseDown:this.elementOnClick.bind(null,e.id),children:[(0,a.jsx)("h3",{className:"TemplatesDropDown__item-name",dangerouslySetInnerHTML:{__html:e.name}}),(0,a.jsx)("div",{className:"TemplatesDropDown__item-content",dangerouslySetInnerHTML:{__html:e.text}})]},e.id)))}):(0,a.jsxs)("div",{className:"TemplatesDropDown__not-found-container",children:[(0,a.jsx)("span",{children:l.getLang("mail_community_templates_not_found")}),(0,a.jsx)(d.default,{onClick:s,children:l.getLang("mail_add_community_template")})]})]})})})}),(0,a.jsx)("button",{className:"TemplatesDropDown__icon",children:(0,a.jsx)(u.Icon24List,{})})]})}constructor(...e){super(...e),this.elementOnClick=(e,t)=>{t.preventDefault(),t.stopPropagation(),this.props.applyTemplate(e),this.toggleDropdown(!1)},this.toggleDropdown=e=>{this.setState({isShowDropDown:e})},this.state={isShowDropDown:!1}}}g.propTypes={getTemplates:o().func.isRequired,applyTemplate:o().func.isRequired,showSettingsPopup:o().func.isRequired,showCreatingTemplatePopup:o().func.isRequired,isNeededRendering:o().func.isRequired};const m=(0,c.connect)(g)},242060:(e,t,s)=>{"use strict";s.r(t),s.d(t,{EDIT:()=>b,MAIN:()=>f,default:()=>C});var a=s(785893),n=s(667294),i=s(45697),o=s.n(i),r=s(29271),l=s(400856),c=s(544358),d=s(589897),_=s(824111),u=s(700200),g=s(106455),m=s(747805),p=s(875610),h=s(659397),v=s(514986);const f="main",b="edit";class w extends n.Component{go(e,{id:t=null,name:s="",text:a=""}={}){return new Promise((n=>{this.state.section!==e?this.setState({section:e,editableMessage:{id:t,name:s,text:a}},(()=>{this.props.popup.updateBoxCoords(),n()})):n()}))}render(){const{getTemplates:e,closePopup:t}=this.props,{section:s,editableMessage:i}=this.state,o=e();return(0,a.jsxs)("section",{className:"TemplatesSettings",children:[(0,a.jsxs)(l.ModalHeader,{onClose:t,closeAriaLabel:r.getLang("global_close"),children:[s===f&&r.getLang("mail_community_templates"),s===b&&r.getLang("mail_add_community_template")]}),(0,a.jsxs)("main",{className:"TemplatesSettings__content",children:[s===f&&(o.length?(0,a.jsx)(_.Scroll,{className:"TemplatesSettings__scroll-wrapper",children:(0,a.jsx)("div",{className:"TemplatesSettings__list",children:o.map((e=>(0,a.jsxs)("section",{className:"TemplatesSettings__item",children:[(0,a.jsx)("h3",{className:"TemplatesSettings__item-name",dangerouslySetInnerHTML:{__html:e.name}}),(0,a.jsx)("div",{className:"TemplatesSettings__item-content",dangerouslySetInnerHTML:{__html:e.text}}),(0,a.jsxs)("div",{className:"TemplatesSettings__buttons-row",children:[(0,a.jsx)(u.default,{onClick:()=>this.go(b,e),className:"TemplatesSettings__item-button",children:r.getLang("mail_settings_edit")}),(0,a.jsxs)("span",{className:"TemplatesSettings__buttons-splitter","aria-hidden":"true",children:[" ","·"," "]}),(0,a.jsx)(u.default,{onClick:this.deleteTemplate.bind(null,e.id),className:"TemplatesSettings__item-button",children:r.getLang("mail_delete")})]})]},e.id)))})}):(0,a.jsxs)("div",{className:"TemplatesSettings__not-found-container",children:[(0,a.jsx)("span",{children:r.getLang("mail_community_templates_not_found")}),(0,a.jsx)(u.default,{onClick:()=>this.go(b),children:r.getLang("mail_add_community_template")})]})),s===b&&(0,a.jsxs)("form",{className:"TemplatesSettings__form",id:"create_template_form",onSubmit:this.saveTemplate,children:[(0,a.jsxs)("div",{className:"TemplatesSettings__form-row",children:[(0,a.jsxs)("label",{className:"TemplatesSettings__label",htmlFor:"name",children:[r.getLang("mail_name"),":"]}),(0,a.jsxs)("div",{className:"TemplatesSettings__input-container",children:[(0,a.jsx)(g.default,{id:"name",type:"text",initialValue:i.name,className:"TemplatesSettings__input",onChange:this.onChangeEditableMessage.bind(null,"name")}),(0,a.jsx)("span",{className:"TemplatesSettings__notice",children:r.getLang("mail_community_templates_input_size").replace("{min}",2).replace("{max}","200")})]})]}),(0,a.jsxs)("div",{className:"TemplatesSettings__form-row",children:[(0,a.jsxs)("label",{className:"TemplatesSettings__label",htmlFor:"text",children:[r.getLang("mail_text"),":"]}),(0,a.jsxs)("div",{className:"TemplatesSettings__input-container",children:[(0,a.jsx)(g.WithEmoji,{title:r.getLang("global_emoji_hint"),children:(0,a.jsx)(g.default,{id:"text",name:"text",isMultiLine:!0,ref:this.getTextAreaRef,initialValue:i.text,className:"TemplatesSettings__textarea",onChange:this.onChangeEditableMessage.bind(null,"text")})}),(0,a.jsx)("span",{className:"TemplatesSettings__notice",children:r.getLang("mail_community_templates_input_size").replace("{min}",5).replace("{max}","2 000")})]})]}),(0,a.jsxs)("div",{className:"TemplatesSettings__form-row",children:[(0,a.jsxs)("label",{className:"TemplatesSettings__label",children:[r.getLang("mail_hints"),":"]}),(0,a.jsx)("div",{className:"TemplatesSettings__input-container",children:(0,m.default)().map((e=>(0,a.jsx)(d.default,{type:"button",onMouseDown:this.addHint.bind(null,e),appearance:"secondary",className:"TemplatesSettings__hint",children:e.label},e.id)))})]})]})]}),(0,a.jsxs)("footer",{className:"TemplatesSettings__footer",children:[s===f&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)(u.default,{onClick:()=>this.go(b),children:r.getLang("mail_add_community_template")}),(0,a.jsx)(d.default,{onClick:t,children:r.getLang("mail_close")})]}),s===b&&(0,a.jsxs)(n.Fragment,{children:[(0,a.jsx)("div",{children:i.id&&(0,a.jsx)(u.default,{onClick:this.deleteTemplate.bind(null,i.id),children:r.getLang("mail_delete_community_template")})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(d.default,{appearance:"tertiary",onClick:()=>this.go(f),children:r.getLang("mail_cancel")}),(0,a.jsx)(d.default,{onClick:this.saveTemplate,form:"create_template_form",type:"submit",children:r.getLang("mail_save")})]})]})]})]})}constructor(...e){super(...e),this.setEditableMessage=({id:e,name:t,text:s})=>new Promise((a=>this.setState({editableMessage:{id:e,name:t,text:s}},a))),this.onChangeEditableMessage=(e,t)=>this.setEditableMessage(Object.assign({},this.state.editableMessage,{[e]:(0,h.escape)(t)})),this.deleteTemplate=e=>Promise.resolve().then((()=>this.state.section!==f?this.go(f):Promise.resolve())).then((()=>this.props.store.set(p.deleteTemplate.bind(null,e)))).catch((()=>{(0,v.showFastBox)(r.getLang("mail_error"),r.getLang("mail_community_templates_delete_error"))})),this.saveTemplate=e=>{e.preventDefault();const{editableMessage:t}=this.state,{name:s,text:a}=t;s.length>200||s.length<2||s.length>2e3||a.length<5?(0,v.showFastBox)(r.getLang("mail_error"),r.getLang("mail_form_is_filled_in_incorrectly")):this.props.saveTemplate(t).catch((()=>{(0,v.showFastBox)(r.getLang("mail_error"),r.getLang("mail_community_templates_save_error"))})).then((()=>this.go(f)))},this.addHint=(e,t)=>{t.preventDefault();const{editableMessage:{id:s=null,name:a,text:n}}=this.state;return(0,g.setHTML)(this.textarea,`{${e.id}}`),this.setEditableMessage({id:s,name:a,text:`${n}{${e.id}} `})},this.getTextAreaRef=e=>{this.textarea=(e||{}).container},this.state={section:this.props.section,editableMessage:{id:null,name:"",text:""}}}}w.propTypes={section:o().string},w.defaultProps={section:f};const C=(0,c.connect)(w)},747805:(e,t,s)=>{"use strict";s.d(t,{default:()=>o});var a=s(590646),n=s(29271),i=s(502478);const o=()=>[{id:"user name",label:n.getLang("mail_community_templates_hint_name"),process:e=>(0,a.oCacheGet)(e,(0,i.getPeer)(e)).first_name},{id:"user surname",label:n.getLang("mail_community_templates_hint_last_name"),process(e){const t=(0,a.oCacheGet)(e,(0,i.getPeer)(e));return t.name.replace(t.first_name,"").trim()}},{id:"admin name",label:n.getLang("mail_community_templates_hint_your_name"),process:e=>(0,a.oCacheGet)(e,vk.id).first_name},{id:"admin surname",label:n.getLang("mail_community_templates_hint_your_last_name"),process(e){const t=(0,a.oCacheGet)(e,vk.id);return t.name.replace(t.first_name,"").trim()}},{id:"community",label:n.getLang("mail_community_templates_hint_community"),process:e=>(0,a.oCacheGet)(e,e.get().id).name},{id:"greeting",label:n.getLang("mail_community_templates_hint_greeting"),process(e){const t=(new Date).getHours();let s;return s=t>=3&&t<12?n.getLang("mail_greeting_good_morning"):t>=12&&t<17?n.getLang("mail_greeting_good_afternoon"):t>=17&&t<=23?n.getLang("mail_greeting_good_evening"):n.getLang("mail_greeting_good_night"),s}}]},564553:(e,t,s)=>{"use strict";s.d(t,{handleEventChatUpdated:()=>_});var a=s(527405),n=s(222009),i=s(875610),o=s(227575),r=s(835200),l=s(998898);function c(e,t){return-1===(e?e.indexOf(t):0)&&(e.push(t),!0)}function d(e,t){let s=e?e.indexOf(t):-1;return-1!==s&&(e.splice(s,1),!0)}function _(e,t,s,_,m,p){let h=(0,n.getTab)(e,t);const v=_===vk.id;switch(s){case r.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED:case r.MAIL_CHAT_UPDATE_TYPE_ADMIN_KICKED:return s===r.MAIL_CHAT_UPDATE_TYPE_ADMIN_GRANTED?c(h.adminIds,_):d(h.adminIds,_),e.set((e=>(0,i.setCallAvailability)(t,e))).then((()=>{u(e,t,m),g(e,t,m,p)})),!0;case r.MAIL_CHAT_UPDATE_TYPE_FLAGS_CHANGED:return h.data.flags=_,e.set((e=>(0,i.setCallAvailability)(t,e))).then((()=>{u(e,t,m),g(e,t,m,p)})),!0;case r.MAIL_CHAT_UPDATE_TYPE_PINNED:delete h.pinHideId,cur.imDb.update(o.PIN_HIDDEN_ID_OP,[h.peerId,void 0]);const f=h&&h.pinned&&(0,a.parserMessage)(h.pinned).messageId;return m.removeUnpinnedMessageEditable(e,f),!1;case r.MAIL_CHAT_UPDATE_TYPE_USER_JOINED:return function(e,t,s){if((0,a.isTabLoaded)(s.get(),e)){let a=(0,n.getTab)(s,e);c(a.memberIds,t)&&a.membersCount++,-1===a.data.active.indexOf(t)&&a.data.active.push(t),t===vk.id&&(a.data.kicked=0,a.data.closed=0)}return s.set((s=>(0,i.loadChatMember)({[e]:[t]},s)))}(t,_,e).then((()=>{if(v&&e.get().peer===t)return e.set((e=>(0,i.getPinnedMessage)(t,e)))})).then((()=>g(e,t,m,p))).then((()=>{if(v&&e.get().peer===t)return Promise.all([e.set((e=>(0,i.getPeerActiveCallData)(t,e))),e.set((e=>(0,i.loadKeyboard)(t,e)))])})).then((()=>(e.get().peer===t&&h.callInProgress&&(m.updateBanner(e),m.updateHeader(e)),m.fixKeyboard()))).then((()=>{if(v)return e.set((e=>(0,i.syncMessagesEditableStatus)(e,t)))})).then((()=>(0,i.syncMessageReactStatus)(e,t))),!0;case r.MAIL_CHAT_UPDATE_TYPE_USER_LEFT:case r.MAIL_CHAT_UPDATE_TYPE_USER_KICKED:return function(e,t,s,o,r){if((0,a.isTabLoaded)(o.get(),e)){let a=(0,n.getTab)(o,e);d(a.memberIds,t)&&a.membersCount--,a.data.active=a.data.active.filter((e=>e!==t)),t===vk.id&&(s?a.data.kicked=1:a.data.closed=1,o.set((t=>(0,i.removePeerActiveCallData)(e,t))))}return t===vk.id&&o.get().peer===e?(r.cancelEditing(),o.set((t=>(0,i.unpinMessageOptimistic)(e,t)))):Promise.resolve()}(t,_,s===r.MAIL_CHAT_UPDATE_TYPE_USER_KICKED,e,m).then((()=>g(e,t,m,p))).then((()=>(0,i.syncMessageReactStatus)(e,t))).then((()=>{if(v)return e.set((e=>(0,i.syncMessagesEditableStatus)(e,t)))})),e.get().id!==_&&((0,n.getKeyboard)(e,t)||{}).author_id!==_||e.set((e=>(0,i.deleteKeyboard)(t,e))).then((()=>m.fixKeyboard())),!0;case r.MAIL_CHAT_UPDATE_TYPE_BANNER_CHANGED:return e.set((e=>(0,i.loadBanner)(t,e))).then((()=>m.updateBanner(e))),!0;case r.MAIL_CHAT_UPDATE_TYPE_KEYBOARD_CHANGED:case r.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED:return!0;case r.MAIL_CHAT_UPDATE_TYPE_CALL_IN_PROGRESS_CHANGED:const b=_?e=>(0,i.getPeerActiveCallData)(t,e):e=>(0,i.removePeerActiveCallData)(t,e);return e.set(b).then((()=>{e.get().peer===t&&(m.updateBanner(e),m.updateHeader(e)),p.updateDialog(t,e),u(e,t,m)})),!0;case r.MAIL_CHAT_UPDATE_TYPE_IS_NEW_CHANGED:return e.set((e=>(0,l.setConvoIsNew)(t,_,e))),!0;default:return!1}}function u(e,t,s){e.get().peer===t&&((0,i.setActions)(e.get()),s.updateActions(e))}function g(e,t,s,a){e.get().peer===t&&((0,i.setActions)(e.get()),s.updateChat(e,t),a.updateDialog(t,e))}},894330:(e,t,s)=>{"use strict";s.d(t,{mount:()=>k});var a=s(434788),n=s(552666),i=s(221780),o=s(82161),r=s(795558),l=s(936134),c=s(527405),d=s(875610),_=s(481792),u=s(343394);const g=68,m=32,p=300,h=20,v=68,f=10,b=2e3,w=100;function C(e,t,s,a){const n=e instanceof Array?e:(0,r.geByClass)("_im_bar_date",e),i=t.contHeight();_.default.onNewMessagesChunk();let l=n.reduce(((e,t)=>(e[(0,r.domData)(t,"date")]=[t.offsetTop+f,i,t],e)),{});const c=!s&&a.barMap?a.barMap:{};return a.barMap=(0,o.extend)(c,l),a.barMapKeys=Object.keys(a.barMap).sort(),Promise.resolve(a)}function y(e,t){return t.barMapKeys.forEach((s=>{t.barMap[s][0]-=e})),Promise.resolve(t)}function E(e,t,s,a,n){let i=e.get().barMap[t];const o=(0,c.isClassicInterface)(n)?v:h;return s-(i[0]+s-i[1])+a-o}function S(e,t,s,a){return a.barTransition=a.barMap[t][2],s>0?((0,r.addClass)(a.barMap[t][2],"im-page--date-bar-transition-inverse"),(0,r.addClass)(e,"im-page--date-bar-transition-inverse")):s<0&&((0,r.removeClass)(a.barMap[t][2],"im-page--date-bar-transition-inverse"),(0,r.removeClass)(e,"im-page--date-bar-transition-inverse")),(0,r.addClass)(a.barMap[t][2],"im-page--date-bar-transition"),(0,r.addClass)(e,"im-page--date-bar-transition"),Promise.resolve(a)}function M(e,t){return t.barTransition&&((0,r.removeClass)(t.barTransition,"im-page--date-bar-transition"),t.barTransition=null),(0,r.removeClass)(e,"im-page--date-bar-transition"),Promise.resolve(t)}function I(e,t,s,a,n){const i=e.get();let o,l;const c=s-t;i.barMapKeys.forEach((t=>{const i=E(e,t,s,a,n);if(i>=c){const r=o?E(e,o,s,a,n):s;o=r>i?t:o}else if(i<c){const o=l?E(e,l,s,a,n):0;l=i>o?t:l}}));let d={};return[[l,"prev"],[o,"cur"]].forEach((([t,i])=>{t&&(d[i+"Bar"]=function(e,t){let s=e.get().barMap[t][2];return{text:s.textContent,date:(0,r.domData)(s,"date")}}(e,t),d[i+"Left"]=E(e,t,s,a,n)-c)})),d}function T(e,t,s,a,n){const l=e.get(),_=(0,d.isEverythingLoaded)(l),p=t.get(),h=n.scrollTop(),v=p.lastTop?p.lastTop-h:0;p.lastTop=h;const f=(0,u.isPinnedMessageVisibleInTab)(l,l.peer)?(0,c.getPinnedMessageHeight)(e):0,b=(0,d.isSearchingInplace)(l.peer,l)&&l.tabs[l.peer]&&l.tabs[l.peer].top_banner?50:0,w=((0,c.isClassicInterface)(e)?g+f+b:0)-m/2,C=n.contHeight();let{prevBar:y,curBar:E,prevLeft:T}=I(t,h,C,w,e),k="translateY(0px)",L=!1,A=!1,P=!1;E||_||(E=function(e){let t=(0,r.geByClass1)("_im_mess",e),s=(0,r.domData)(t,"ts");return t&&s?{text:(0,i.getShortDate)((0,o.intval)(s),!1,!0,i.getLang("months_of","raw")),date:s}:null}(a)),E?L=E:A=!0,y&&E&&T>-m&&T<0&&(P=!0,A=!1,L=E,k=`translateY(${-m-T}px)`),L&&function(e,t){(0,r.domData)(e,"ts")!==t.date&&(e.innerHTML=t.text,(0,r.domData)(e,"ts",t.date),e.style.visibility="visible")}(s,L),P?t.set(S.bind(null,s,y.date,v)):t.set(M.bind(null,s)),k&&(s.style.transform=k),(0,r.toggleClass)(s,"im-page--top-date-bar_no-b",A)}function k(e,t){let s=(0,r.geByClass1)("_im_top_date_bar",t);const i={lastTop:!1,barMap:{},barMapKeys:[],isDisabled:!1},o=(0,n.default)(i);let c=null,d=null,_=null,u=(0,l.debounce)((e=>{const s=o.get();Object.keys(s).length&&!s.isDisabled&&o.set(C.bind(null,t,e,!1))}),500);return{reset(a){o.get().isDisabled||o.set(C.bind(null,t,a,!0)).then(T(e,o,s,t,a))},disable(){o.setState((0,a._)({},i,{isDisabled:!0}))},enable(){o.setState({isDisabled:!1})},heightIncreased(e,t){o.get().isDisabled||(u(t),o.set(y.bind(null,e)))},parseMore(a,n){o.get().isDisabled||o.set(C.bind(null,a,n,!1)).then((()=>{T(e,o,s,t,n)}))},toggle(e){o.get().isDisabled&&e||s.classList.toggle("im-page--top-date-bar--hidden",!e)},show(){o.get().isDisabled||(d=Date.now(),_||((0,r.addClass)(t,"im-page--top-date-bar_visible"),_=setInterval((function(){Date.now()-d>b&&((0,r.removeClass)(t,"im-page--top-date-bar_visible"),clearInterval(_),_=null)}),w)))},update(a){o.get().isDisabled||(c&&(clearTimeout(c),c=null),c=setTimeout((function(){T(e,o,s,t,a)}),p),T(e,o,s,t,a))},unmount(){c&&(clearTimeout(c),c=null),_&&(clearInterval(_),_=null),o.unmount()}}}},68103:(e,t,s)=>{"use strict";s.d(t,{mount:()=>fe});var a=s(785893),n=s(875610),i=s(664988),o=s(196026),r=s(254667),l=s(953908),c=s(82161),d=s(584356),_=s(795558),u=s(222009),g=(s(667294),s(973935)),m=s(554254),p=s(937107),h=s(869048),v=s(400856),f=s(120051),b=s(527405),w=s(95933),C=s(15080),y=s(552666),E=s(95638),S=s(705758),M=s(514986),I=s(320422),T=s(29271),k=s(731062),L=s(149822),A=s(656448),P=s(854099);const x="_im_create_cancel",B="_im_create_list",R="_im_dialog",D="_im_dialogs_creation_name",O="_im_create_select",F="_im_create_avatar",N="_im_create_remove_avatar",U="_im_confirm_creation",H="_im_cancel_creation",j="_im_avatar_img",q=["im-creation--item_hovered"],G="olist_item_wrap_on",V="ui_search_reset",K="_im_creation_settings",z=33554432,Z=100;let W=z;function $(e){!function(e){const t=e.querySelector("._im_creation_settings_modal_wrap"),s=Y.bind(null,t);g.render((0,a.jsx)(h.AppRootProvider,{children:(0,a.jsxs)(p.default,{onClose:s,className:"im-creation--modal-settings",children:[(0,a.jsx)(v.ModalHeader,{onClose:s,closeAriaLabel:T.getLang("global_close"),children:T.getLang("mail_chat_creation_settings")}),(0,a.jsx)(m.ChatSettingsOptions,{flags:W,back:s,isChatCreation:!0,onSave:Q,afterSave:X.bind(null,t),onCancel:s})]})}),t)}(e)}function Y(e){e&&g.unmountComponentAtNode(e)}function Q(e){return W=e,Promise.resolve()}function X(e){Y(e)}function J(e){return(0,I.showTooltip)(e,{text:T.getLang("mail_chat_creation_settings_icon_tooltip"),black:1,center:!0,zIndex:1e3,shift:[0,10]})}function ee(e,t,s,a,i,r){(0,n.toggleConversation)(!1),(0,_.removeClass)(t,"im-create_shown"),(0,_.removeClass)(t,"im-create_photo-attached"),setTimeout(se.bind(null,t,!1),100),re(r).map((e=>(0,_.geByClass1)("_im_dialog"+e))).forEach((e=>{(0,_.removeClass)(e,G)})),s().createCanceled(e),i.resetSelection(),"add_member"===e.get().creationType&&e.set(n.setCreationType.bind(null,"chat",[])),e.set(n.presetAvatar.bind(null,!1));let l=(0,_.geByClass1)(j,t);ae(e,r,t),uiSearch.reset((0,_.geByClass1)(D,t)),uiSearch.reset((0,_.geByClass1)(O,t)),l&&l.parentNode.removeChild(l),ae(e,r,t),(0,o.cancelStackFilter)("im_search");let c=0===e.get().peer?"search":"default";e.get().longpoll.push([(0,E.transitionEvent)(c)]),(0,_.attr)(t,"aria-hidden","true")}function te(e,t,s){return t&&(s.current_create_peer_ids={},s.current_create_peers=[]),s.current_create_peer_ids||(s.current_create_peer_ids={}),s.current_create_peers||(s.current_create_peers=[]),e.forEach((e=>{e.then((e=>{e=e.filter((e=>!s.current_create_peer_ids[e.peerId])),s.current_create_peer_ids=e.reduce(((e,t)=>(e[t.peerId]=!0,e)),s.current_create_peer_ids),s.current_create_peers=s.current_create_peers.concat(e)}))})),Promise.resolve(s)}function se(e,t){(0,_.toggleClass)(e,"im-create_material",t)}function ae(e,t,s){const a=(0,_.geByClass1)(U,s),n=t.get().selection.length,i="add_member"===e.get().creationType,o=uiSearch.getFieldEl((0,_.geByClass1)(D,s)),r=n>0,l=(o?o.value.trim():"").length>0,c=!r&&(i||!l),d=i?1===n?T.getLang("mail_append_chat"):T.getLang("mail_im_create_chat_with"):l||n>1?T.getLang("mail_im_create_chat"):T.getLang("mail_im_go_to_dialog");P.FlatButton.setLabel(a,d),P.FlatButton.setDisabled(a,c)}function ne(e,t,s,a,n,i,o){if(!o)return;let r,l=(0,c.intval)((0,_.domData)(o,"list-id")),d=re(i),u=(0,c.trim)(o.textContent),g=(0,_.geByClass1)(O,t),m=(0,_.getSize)(g)[1];(0,c.inArray)(l,d)?(r=a.removeSelection(l,u),(0,_.removeClass)(o,G)):(r=a.addSelection(l,u),(0,_.addClass)(o,G)),r.then((()=>{let e=m-(0,_.getSize)(g)[1],t=n.scrollTop();n.scrollTop(t-e)})),ae(e,i,t);let p=(0,_.geByClass1)(O,t);uiSearch.reset(p)}function ie(e,t){let s=re(e),a=["_im_dialog","_im_dialog"+t.peerId,"im-creation--item"],n=[];return t.online&&n.push("online"),mobPlatforms[t.online]&&n.push("mobile"),(0,c.inArray)(t.peerId,s)&&a.push(G),(0,c.getTemplate)("im_owner_item",{owner_id:t.peerId,cls:" "+a.join(" "),photo:t.photo,name:t.name,link:t.href,img_cls:n.join(" ")})}function oe(e){return(0,u.getSearchText)(e)||!1}function re(e){return e.get().selection.map((e=>e.id))}function le(e,t,s){return e.then((e=>e.filter((e=>e.is_friend&&!(0,c.inArray)(e.peerId,s.get().creationFilter)))))}function ce(e,t,s,a,i){let o,r,l=(0,_.geByClass1)(O,e),c=(0,n.searchLocalHints)(a,t.get()),d=s.hoverFirstElement.bind(s,q,pe(t));t.get().creation_shown_all=!1,s.reset(),s.pipe(le(c,0,t),a),s.toTop(),a?(r=(0,n.searchTopConv)(a,t.get()),o=(0,n.searchHintsIndex)(a,[],"friends",t.get()),s.pipe(le(o,0,t),a).then(d),s.pipe(le(r,0,t),a).then(d)):(o=Promise.resolve([]),r=Promise.resolve([])),t.set(te.bind(null,[c,r,o],!0)),uiSearch.showProgress(l),Promise.all([c,o,r]).then((()=>uiSearch.hideProgress(l)))}function de(e,t,s,a){let o=2e9+Math.round((0,i.rand)(1e6,2e6));cur.recieveCropResult=s=>{cur.recieveCropResult=!1,(0,d.curBox)()&&(0,d.curBox)().hide(),e.set(n.presetAvatar.bind(null,s)),(0,n.getOwnerPhoto)(s,o).then((e=>{(0,_.geByClass1)(F,t).appendChild((0,_.ce)("img",{className:`im-chat-placeholder--img ${j}`,src:e}))})),(0,_.addClass)(t,"im-create_photo-attached")},Page.ownerPhoto(o)}function _e(e,t){(0,_.geByClass1)(F,t).innerHTML="",e.set(n.presetAvatar.bind(null,!1)),(0,_.removeClass)(t,"im-create_photo-attached")}function ue(e,t,s,a,n,i){re(t).map((e=>(0,_.geByClass1)("_im_dialog"+e))).forEach((e=>(0,_.removeClass)(e,G))),t.reset(),ce(s,e,a,!1,re(t)),n.resetSelection(),ee(e,s,i,0,n,t)}function ge(e,t,s,a,i,o,l){const c=re(t),d=e.get(),g=(0,_.geByClass1)(U,s),m=uiSearch.getFieldEl((0,_.geByClass1)(D,s)).value,p="add_member"===e.get().creationType,h=!p&&(m.length||c.length>1),v=(0,_.geByClass1)("_im_creation_show_history_input",s).checked;if(p)return e.set(n.addNewMember.bind(null,d.peer,c,v)).catch((e=>(0,M.showFastBox)(T.getLang("global_error"),e))),ee(e,s,o,0,i,t);if(P.FlatButton.lock(g),!h)return f(c[0]);function f(n){W=z,ue(e,t,s,a,i,o),function(e,t,s,a,n,i){ee(e,t,s,0,n,i),e.get().longpoll.push([(0,E.changePeer)(a,!1,!1,!1,"create_conversation")])}(e,s,o,n,i,t),P.FlatButton.unlock(g),(0,u.isSearching)(e)?o().cancelSearch(e):o().restoreDialogs(e),(0,A.collectChatCreateStats)(n,"create_chat__create_new")}e.set((e=>(0,L.createChatAction)(e,d.next_chat_avatar,c,m,W))).then((()=>f(d.next_peer))).catch((e=>{P.FlatButton.unlock(g),(0,r.topMsg)(T.getLang("global_unknown_error"),2,"#FFB4A3")}))}function me(e,t){return(0,I.showTooltip)(e,{text:T.getLang("mail_cancel"),black:1,zIndex:1e3,shift:[3,-2],appendCls:"js-im-page"})}function pe(e,t){const s=t&&t.get().selection.length;return{top:-1,bottom:(0,b.isClassicInterface)(e)?s>0?69:0:-1}}function he(e,t,s){ae(e,t,s)}function ve(e,t,s,a,n,i,r,l){return{show(t,i=[]){t.setState({shown:!0}),se(e,!0),(0,o.cancelStackPush)("im_create",r),(0,_.addClass)(e,"im-create_shown");const l=a.get().selection.reduce(((e,t)=>(e[t.id]=!0,e)),{});i&&i.forEach((t=>{if(!l[t[0]]){const s=e.querySelector(`._im_dialog${t[0]}`);n.addSelection(t[0],t[1]),s&&!s.classList.contains(G)&&s.classList.add(G)}})),function(e,t,s,a){(0,_.toggleClass)(e,"im-create_chat","chat"===a.get().creationType),(0,_.toggleClass)(e,"im-create_invite","add_member"===a.get().creationType);let n="chat"===a.get().creationType?T.getLang("mail_im_group_dialog"):T.getLang("mail_im_friends_tab"),i=(0,_.geByClass1)("_im_create_title",e);(0,_.val)(i,n),P.FlatButton.setLabel((0,_.geByClass1)(U,e),"add_member"===a.get().creationType?T.getLang("mail_im_create_chat_with"):T.getLang("mail_im_create_chat")),ce(e,a,t,!1,s.get().selection.map((e=>e.id)))}(e,s,a,t),setTimeout((()=>{t.get().longpoll.push([(0,E.transitionEvent)("create")]),(0,_.attr)(e,"aria-hidden","false"),n.focus()}),1)},focusSearch(e){n.focus()},confirmCreate(e){l()},hide(s){s.get().shown=!1,ee(s,e,t,0,n,a)},scroll(e){s.scrollPage(e,!0)},updateScroll(){s.updateScroll()},selectElement(t){ne(t,e,0,n,s,a,s.getHoveredElement())},hoverPrevElement(e){s.hoverPrevElement(q,null,pe(e,a))},hoverNextElement(e){s.hoverNextElement(q,null,pe(e,a))},unmount(){(0,C.destroyModule)(i),s.unmount(),n.unmount(),(0,o.cancelStackFilter)("im_create"),cur.recieveCropResult=void 0}}}function fe(e,t,s){let a=(0,y.default)({selection:[]}),i=(0,_.geByClass1)(B,e),o=(0,_.geByClass1)(O,e);const r=(0,k.debouncedPromise)((function(s){return function(e,t,s,a){const n=a.get(),i=oe(n);n.selection.map((e=>e.id)),s.unhoverElements(q),e.get().creationQuery=i,ce(t,e,s,i)}(t,e,u,s)}),300);let d=(0,w.mount)(o,a,(()=>({selectionDeleted(s,a){ae(t,s,e),(0,_.removeClass)((0,_.geByClass1)("_im_dialog"+a),G)},onChange:e=>r(e).catch((e=>{if("debounce"!==e)throw e}))}))),u=(0,f.mount)(i,(0,y.default)({offset:0,limit:Z,elements:[],elCls:R}),(()=>({idFn:e=>(0,c.intval)(e.peerId),hoverableFn:e=>(0,_.hasClass)(e,"_im_dialog"),renderFn:ie.bind(null,a),more(e,s){let i;return t.get().shown?(t.get().creation_shown_all||!1!==oe(a)?i=Promise.resolve([]):(t.get().creation_shown_all=!0,i=(0,n.searchTopConv)(oe(a),t.get())),t.set(te.bind(null,[i],!1)),le(i,oe(a),t)):Promise.resolve(!1)},onClick(s,n){(0,l.checkEvent)(s)||(ne(t,e,0,d,u,a,n),(0,l.cancelEvent)(s))}})));t.get().creationQuery=!1,t.get().creationType="chat";let g=ee.bind(null,t,e,s,"cross",d,a),m=de.bind(null,t,e),p=_e.bind(null,t,e),h=ue.bind(null,t,a,e,u,d,s),v=ge.bind(null,t,a,e,u,d,s),b=he.bind(null,t,a,e),E=$.bind(null,e),M=(0,_.geByClass1)(x,e),I=(0,_.geByClass1)(D,e),T=(0,_.geByClass1)(K,e),L=I.querySelector("."+V);const A=(0,C.createModule)({handlers:(t,s)=>{t(M,"click",g),t(M,"mouseover",me.bind(null,M)),t((0,_.geByClass1)(F,e),"click",m),t((0,_.geByClass1)(N,e),"click",p),t((0,_.geByClass1)(H,e),"click",h),t(I,"change",b),t(I,"input",b),t(I,"paste",b),t(L,"click",b),t((0,_.geByClass1)(U,e),"click",v),t(T,"click",E),t(T,"mouseenter",J.bind(null,T)),t(e,"mouseover",(0,S.throttle)(u.unhoverElements.bind(u,q),100))}});return ve(e,s,u,a,d,A,g,v)}},657303:(e,t,s)=>{"use strict";s.d(t,{mount:()=>wt});var a=s(434788),n=s(875610),i=s(196026),o=s(664988),r=s(221780),l=s(584356),c=s(82161),d=s(953908),_=s(527405),u=s(222009),g=s(894523),m=s(523305),p=s(849965),h=s(165203),v=s(552666),f=s(705758),b=s(120051),w=s(835200),C=s(15080),y=s(945263),E=s(590646),S=s(408014),M=s(320422),I=s(610812),T=s(95638),k=s(755320),L=s(832468),A=s(301230),P=s(41963),x=s(502478),B=s(656448),R=s(998898),D=s(728785),O=s(530097),F=s(638871),N=s(84543),U=s(839470),H=s(669827),j=s(874223),q=s(300069),G=s(540537),V=s(316646),K=s(987870),z=s(795558),Z=s(196655),W=s(659397),$=s(745163),Y=s(508159),Q=s(931917);const X=64,J="_im_dialog",ee="_im_peer_target",te="_im_dialog_star",se="_im_dialog_actions",ae="_im_dialog_close",ne="_im_dialog_actions_item",ie="nim-dialog_inline-menu_visible",oe="_im_dialog_daction",re=["_im_dialog_selected","nim-dialog_selected"],le=["_im_dialog_hovered","nim-dialog_hovered"],ce="_im_dialog_peer_tags",de="_im_dialog_name_w",_e="_im_peer_tags_extra",ue="_im_dialog_peer_tag",ge="ConvoRecommendList",me="_convoRecommendUser",pe="_convoRecommendUserRemove",he="_convoRecommendAction",ve=`${ge}--hidden`,fe=`${ge}--fadeIn`,be=`${ge}--fadeOut`,we="_im_dialog_folder_button_hide",Ce="im-page--dialogs-folder-button_hidden",ye="_im_archive_notice",Ee="_im_archive_notice_close",Se="_im_archive_notice_settings",Me="_im_new_ui_notice",Ie="_im_new_ui_notice_close",Te="archive_folder_hidden",ke="business_notify_folder_hidden",Le="_im_dialog_folder_actions",Ae="_im_dialog_folder_actions_item",Pe="_im_dialog_folder_back",xe=340,Be=16,Re=6,De=46;function Oe(e,t,s){(0,z.removeClass)(t.parentNode,"im-page--dialogs_with-mess");let a=s.getCurrentElements().filter((e=>e.message));s.toTop(),s.reset(),(0,y.statlogsProbValueEvent)(.01,"im_search_stat",1,"search_messages_only"),a.length>0?(a=[{type:"sep_messages"}].concat(a),e.setState({searchOnlyMessages:!0})):a=[at()],s.pipeReplace(Promise.resolve(a))}function Fe(e){return(0,z.hasClass)(e,"_im_search")}function Ne(e){if((0,u.isSearching)(e)&&e.get().searchAllLoaded||(0,u.isRecentSearchesActive)(e))return Promise.resolve([]);if(e.get().dialog_search_going||(0,_.isClassicInterface)(e)&&0!==e.get().peer)return Promise.resolve(!1);if((0,u.isSearching)(e))return(0,n.searchMessages)((0,u.getSearchText)(e),e.get()).then((([e,t])=>st(t,e)));const t=e.get().active_tab,s=e.get().dialog_tabs_all;return![h.FOLDER_MESSAGE_REQUEST,h.FOLDER_PEER_TAGS,D.FOLDER_BUSINESS_NOTIFY,D.FOLDER_ARCHIVE].includes(t)&&s[h.FOLDER_ALL]&&!(0,_.isReversedDialogs)(e)||s[t]?Promise.resolve(ft(e)):e.set(n.loadDialogs).then(ft)}function Ue(e,t,s,a,i,o){var r,l;if(null==i||null==(r=i.target)||null==r.closest?void 0:r.closest(`.${se}`))return;const c=parseInt((0,z.domData)(o,"peer"),10),g=(0,u.getTab)(s,c),m=(0,z.hasClass)(o,"_im_sugg_"+c),p=o.classList.contains(`${ge}__button`);if(!g&&!m&&!p)return;const h=(0,z.gpeByClass)(ee,i.target)&&(0,d.checkEvent)(i),v=(0,_.isCommunityInterface)(s)&&(0,z.gpeByClass)(ce,i.target),f=!!(null==(l=i.target)?void 0:l.closest("."+pe));if(h||v||f)return;const b=s.get(),w=Fe(o),C=parseInt((0,z.domData)(o,"msgid"),10);if(g&&(0,u.tabIsMessageRequestToChat)(g))return e().showChatInvitationBox(s,c),(0,d.cancelEvent)(i);let y=`list_${b.active_tab}`;if((0,u.isSearching)(s)&&(y="conversations_search"),(0,u.isRecentSearchesActive)(s)&&(y="recent_searches"),m&&(y="popular_suggestions"),p&&(y="list_all_suggestions"),w&&(y="message_search"),g&&(0,d.checkEvent)(i))return window.open(function(e,t,s,a=!1){const n=(0,_.getBaseLink)(e),i=()=>`${n}?sel=${(0,_.convertPeerToUrl)(t.peerId)}${a&&s?"&msgid="+s:""}`;if(a)return i();if(Q.Ranges.isUserIdTransitional(t.peerId)||Q.Ranges.isGroupId(t.peerId))return(0,_.isClassicInterface)(e)?i():t.href;return i()}(s,g,C,w));if(a.saveScroll("list"),e().deselectAllMessages(s),w&&b.msgid!==C)b.longpoll.push([(0,T.changePeer)(c,C,!1,!1,y)]);else if(c!==b.peer){b.longpoll.push([(0,T.changePeer)(c,!1,!0,!0,y)]);const e=(0,u.isSearching)(s);e&&!(0,z.hasClass)(o,"_dont_add_recent")&&(0,n.saveRecentSearchPeer)(c,cur.imDb),e&&g&&!(0,_.isClassicInterface)(s)&&setTimeout((()=>{const e=g.message?g.message.messageId:g.peerId;a.scrollToElement(e.toString(),!0,0,"center")}),100)}else c===b.peer&&e().goToHistoryEnd();(0,k.isMarusiaPeer)(c)&&(Y.marusiaStats.logChatOpen($.navigationStat.getModule()),ajax.post("al_marusia.php",{act:"send_event",event:"chatopen"})),(0,d.cancelEvent)(i)}function He(e,t,s,a){let n;const i="string"==typeof s.photo&&""!==s.photo,o=Q.Ranges.isContactId(t),r=s.tab||s.name,l=o?(0,_.prepareContactName)(r):r;if(Q.Ranges.isChatOrChannelPeer(t)&&!i)n=(0,_.renderPhotosFromTab)(e,s,a);else{if(o&&!i){const t=(0,_.getUserInitials)(r),i=(0,u.isSearching)(e)&&!s.message?34:a?50:46;n=(0,c.getTemplate)("sImContactAvatar",{name:t,size:i,classes:"nim-peer--contact-avatar"})}else n=(0,L.isDialogWithYourself)(e.get().id,t)?`<img src="${D.FAVORITES_ICON_URL}" alt="">`:s.is_nft_photo?s.photo.trim():`<img src="${s.photo}" alt="">`;a&&!s.is_nft_photo&&(n=(0,c.getTemplate)("im_dialogs_link_img",{href:s.href||s.link,photo:n}))}return{photo:n,userLink:`<span class="_im_dialog_link">${l}</span>`}}function je(e,t,s,a){return s?"":a?(0,c.getTemplate)("im_img_prebody",{photo:t}):e+":"}function qe(e,t,s){if(!(s&w.FLAG_OUTBOUND))return!1;if((0,_.isSelfMessage)(t.peerId,e.get().gid))return!1;if(Q.Ranges.isChatOrChannelPeer(t.peerId)&&t.data&&t.data.closed)return!1;if(t.unread)return!1;if((0,U.partConfigEnabled)("me_web_read_by_cmid")){const e=$e(t);return!!e.local||e.chat_local_id>t.out_up_to_cmid}return!!t.lastmsg&&t.lastmsg>t.out_up_to}function Ge(e){let t=$e(e);return!!(e.unread>0&&t)||!!(0,u.isTabMarkedUnread)(e)}function Ve(e){return(0,S.isUnreadWithExpiring)(e)&&!(0,S.isUnreadWithMentions)(e)}function Ke(e,t,s=null,a={}){const n=s||$e(t),{photo:i,userLink:l}=He(e,t.peerId,t,(0,_.isClassicInterface)(e));if(!n)return function(e,t,s,a,n={}){let i=[];(0,_.isClassicInterface)(a)&&i.push("nim-dialog_classic"),(0,u.isRecentSearchesActive)(a)&&i.push("nim-dialog_recent"),i.push("nim-dialog_empty"),n.search&&i.push("_im_search");const o=(0,c.getTemplate)("im_drow_close_button",{peer_id:e.peerId}),r=(0,L.isDialogWithYourself)(a.get().id,e.peerId),l=e.is_nft_photo&&!r;return(0,c.getTemplate)(`im_drow${l?"_nft":""}${(0,_.isClassicInterface)(a)?"_classic":""}`,{peer:e.peerId,msg_id:"",photo:t,user_link:s,date:"",body:"",unread:"",more:i.join(" "),is_star:"",unread_message_string:"",is_online:(0,f.onlinePlatformClass)(e.online),is_unread:"",is_unread_out:"",is_selected:e.peerId==a.get().peer?"nim-dialog_selected _im_dialog_selected":"",actions:o})}(t,i,l,e,a);const{flags:d}=n,m=(0,_.isFvkcomgroup)(e,t.peerId),p=(0,S.tabIsMessageRequest)(t),h=(0,u.tabIsMessageRequestToChat)(t),v=(0,u.isCasperChat)(e,t.peerId),b=We(t,e,s),C=(0,u.isCommunityChat)(e,t.peerId),y=t.major_sort_id;let E=[];a.search&&E.push("_im_search","nim-dialog_search"),(0,c.inArray)(t.peerId,e.get().mutedPeers)&&E.push("nim-dialog_muted"),t.verified&&E.push("nim-dialog_verified"),!t.verified&&t.verified_by_other_services&&E.push("nim-dialog_verified_by_other_services"),t.isDonutChat&&E.push("nim-dialog_donut"),v&&E.push("nim-dialog_casper"),(0,u.isRecentSearchesActive)(e)&&E.push("nim-dialog_recent"),(0,g.isMessageEmpty)(n)&&!v&&E.push("nim-dialog_empty"),(0,_.isClassicInterface)(e)&&E.push("nim-dialog_classic"),t.folders&w.FOLDER_IMPORTANT&&E.push("nim-dialog_starred"),!a.search&&(0,_.isUnrespond)(e,t.peerId,t)&&E.push("nim-dialog_unrespond"),(m||C)&&e.get().gid&&E.push("nim-dialog_deny-remove"),(0,S.isUnreadWithMentions)(t)&&E.push("nim-dialog_unread-mentions"),(0,S.hasUnreadReactionsBadge)(e,t.peerId)&&E.push("nim-dialog_unread-reactions"),Ve(t)&&E.push("nim-dialog_unread-expiring"),t.callInProgress&&E.push("nim-dialog_active-call"),t.callInProgress&&t.callInProgress.participants.count<1&&E.push("nim-dialog_active-call-empty"),(0,k.isPinnedSortId)(y)&&E.push("nim-dialog_pinned");const M=(0,u.tabIsMessageRequestToChat)(t)?t.mr&&t.mr.request_date:n.date,I=e.get().timeshift,T=M?(0,r.getShortDateOrTime)(M,I,!0,r.getLang("months_sm_of","raw")):"",A=!qe(e,t,d)||h||(0,u.isSearching)(e)?"":"nim-dialog_unread-out",P=t.unread>0?r.getLang("mail_im_new_messages",t.unread):"",x=Q.Ranges.isContactId(t.peerId)?(0,_.prepareContactName)(t.tab):t.tab,B=(0,_.isCommunityInterface)(e)||p?"im_drow_close_button":"im_drow_actions_menu",R=(0,c.getTemplate)(B,{peer_id:t.peerId}),D=(0,L.isDialogWithYourself)(e.get().id,t.peerId),O=t.is_nft_photo&&!D;return(0,c.getTemplate)(`im_drow${O?"_nft":""}${(0,_.isClassicInterface)(e)?"_classic":""}`,{peer:t.peerId,msg_id:n.messageId||"",photo:i,user_link:l,date:T,body:b,unread_message_string:P,tab_name:(0,o.stripHTML)(x),unread:(0,_.simplifyCounter)(t.unread),more:E.join(" "),is_online:(0,f.onlinePlatformClass)(t.online),is_unread:Ge(t)?"nim-dialog_unread":"",is_unread_out:A,is_selected:a.noselect||h||t.peerId!=e.get().peer?"":"nim-dialog_selected _im_dialog_selected",actions:R,title:(0,U.partConfigEnabled)("mail_dialog_preview_title")?b.replace(/\<[^>]*\>/g,""):""})}function ze(e,t,s,a,n){if(t.deletedDialog)return;if((0,z.hasClass)(e,"nim-conversation-search-row"))return void Ze(e,t,s);const i=s.get(),o=$e(t),l=o.flags,d=We(t,s),{photo:m,userLink:p}=He(s,t.peerId,t,(0,_.isClassicInterface)(s)),h=s.get().timeshift,v=o.date?(0,r.getShortDateOrTime)(o.date,h,!0,r.getLang("months_sm_of","raw")):"";if(ot(e,t),(0,U.partConfigEnabled)("mail_dialog_preview_title")){const a=We(t,s,null,!0).replace(/<[^>]*>/g,"");(0,z.attr)((0,z.geByClass1)("_im_dialog_title",e),"title",(0,W.decodeHTMLEntities)(a))}(0,z.val)((0,z.geByClass1)("_dialog_body",e),d),(0,z.val)((0,z.geByClass1)("_im_dialog_date",e),v),(0,z.val)((0,z.geByClass1)("_im_dialog_unread_ct",e),(0,_.simplifyCounter)(t.unread));const b=(0,z.geByClass1)("_im_dialog_link",e);b&&(0,z.val)(b.parentNode,p);let C=(0,z.geByClass1)("_im_dialog_photo",e);C&&C.innerHTML!==m&&(0,z.val)(C,m),i.is_peer_profile_enabled&&(i.peer||ut(e,s));const y=(0,u.isCasperChat)(s,t.peerId);(0,z.toggleClass)(e,"nim-dialog_verified",!!t.verified),(0,z.toggleClass)(e,"nim-dialog_verified_by_other_services",!t.verified&&!!t.verified_by_other_services),(0,z.toggleClass)(e,"nim-dialog_casper",y),(0,z.toggleClass)(e,"nim-dialog_muted",(0,c.inArray)(t.peerId,s.get().mutedPeers)),(0,z.toggleClass)(e,"nim-dialog_unrespond",(0,_.isUnrespond)(s,t.peerId,t)),(0,z.toggleClass)(e,"nim-dialog_classic",(0,_.isClassicInterface)(s)),(0,z.toggleClass)(e,"nim-dialog_unread",Ge(t)),(0,z.toggleClass)(e,"nim-dialog_unread-mentions",(0,S.isUnreadWithMentions)(t)),(0,z.toggleClass)(e,"nim-dialog_unread-reactions",(0,S.hasUnreadReactionsBadge)(s,t.peerId)),(0,z.toggleClass)(e,"nim-dialog_unread-expiring",Ve(t)),(0,z.toggleClass)(e,"nim-dialog_active-call",!!t.callInProgress),(0,z.toggleClass)(e,"nim-dialog_active-call-empty",!!t.callInProgress&&t.callInProgress.participants.count<1),(0,z.toggleClass)(e,"nim-dialog_pinned",(0,k.isPinnedSortId)(t.major_sort_id)),(0,z.toggleClass)(e,"nim-dialog_deny-remove",s.get().gid>0&&((0,_.isFvkcomgroup)(s,t.peerId)||(0,u.isCommunityChat)(s,t.peerId))),(0,z.removeClass)(e,"nim-dialog_failed"),(0,z.removeClass)(e,"nim-dialog_deleted"),(0,z.addClass)(e,"_im_dialog"),(0,f.toggleOnline)((0,z.geByClass1)("_im_peer_online",e),t.online),(0,z.toggleClass)(e,"nim-dialog_recent",(0,u.isRecentSearchesActive)(s)),(0,z.toggleClass)(e,"nim-dialog_empty",(0,g.isMessageEmpty)(o)&&!y),(0,z.toggleClass)(e,"nim-dialog_unread-out",qe(s,t,l)&&!(0,u.isSearching)(s)),(0,z.toggleClass)(e,"nim-dialog_starred",t.folders&w.FOLDER_IMPORTANT),n&&setTimeout((function(){(0,z.addClass)((0,z.geByClass1)("_im_dialog_"+t.peerId,a),"nim-dialog_injected")}),100)}function Ze(e,t,s){ot(e,t),(0,z.toggleClass)(e,"nim-dialog_recent",(0,u.isRecentSearchesActive)(s)),(0,z.val)((0,z.geByClass1)("_im_dialog_unread_ct",e),(0,_.simplifyCounter)(t.unread)),(0,z.toggleClass)(e,"nim-dialog_unread",Ge(t)),(0,z.toggleClass)(e,"nim-dialog_unread-expiring",Ve(t)),(0,z.toggleClass)(e,"nim-dialog_unread-mentions",(0,S.isUnreadWithMentions)(t)),(0,z.toggleClass)(e,"nim-dialog_unread-reactions",(0,S.hasUnreadReactionsBadge)(s,t.peerId));let{photo:a}=He(s,t.peerId,t,(0,_.isClassicInterface)(s));const n=(0,L.isDialogWithYourself)(s.get().id,t.peerId),i=t.is_nft_photo&&!n;i&&(a=(0,c.getTemplate)("sImDialogImRowAvatarRichSkinPhoto",{photo:a,size:34}));let o=(0,z.geByClass1)(i?"nim-peer_search":"_im_dialog_photo",e);o.innerHTML!==a&&(0,z.val)(o,a),(0,f.toggleOnline)((0,z.geByClass1)("_im_peer_online",e),t.online)}function We(e,t,s=null,a=!1){const n=s||$e(e),i=(0,u.tabIsMessageRequestToChat)(e),o=(0,u.isCasperChat)(t,e.peerId),l=(0,_.isClassicInterface)(t)&&!a;if(i){const s=e.mr&&e.mr.inviter_id,a=(0,E.oCacheGet)(t,s),n=l?a.name:a.short_name;return(l?(0,c.getTemplate)("im_img_prebody",{photo:a.photo}):"")+r.getLang("mail_mr_service_message").replace(/{user}/,n)}if((0,_.isPeerBlocked)(e.peerId,t)){let s=t.get().block_states[e.peerId].name,a=r.getLang("mail_community_answering").replace("{username}",s);return(0,c.getTemplate)("im_drow_prebody",{prebody:a,body:""})}return(0,g.isServiceMsg)(n)&&!i?(0,Z.renderServiceMsg)(t,n,e.peerId,!1):o&&(0,g.isMessageEmpty)(n)?r.getLang("mail_empty_casper_message"):(0,g.isExpiredCasperMessage)(n)?r.getLang("mail_expired_message"):function(e,t,s,a,n,i,o,l,d,g){let m="",p="";const h=(0,u.isChannelPeer)((0,u.getTab)(e,s));return t&w.FLAG_OUTBOUND&&!(0,L.isDialogWithYourself)(e.get().id,s)?m=je(r.getLang("mail_by_you"),g,h,d):(0,S.isBusinessNotifyTab)((0,u.getTab)(e,s))||!Q.Ranges.isChatOrChannelPeer(s)||Q.Ranges.isZeroOwner(a)||(m=je((0,E.oCacheGet)(e,a).first_name,(0,E.oCacheGet)(e,a).photo,h,d)),o=(0,_.renderShortText)(s,l,o,n,i),p=m?(0,c.getTemplate)("im_drow_prebody",{prebody:m,body:o}):o,p}(t,n.flags,e.peerId,n.userId,!a,n.attaches,n.text,n.subject,l,(0,E.oCacheGet)(t,t.get().id).photo)}function $e(e){let t=e.lastmsg_meta;return Array.isArray(t)&&(t=(0,I.getMessageFromTuple)(t)),t||(0,I.getMessageFromTuple)([-1,0,e.peerId,0,"",{},{},-1,-1,0])}function Ye(e,t,s){const a=(0,u.getTab)(e,t),i=(0,u.tabIsMessageRequestToChat)(a),o=(0,_.showLeaveDialog)(e,t,(a=>{s().updateMenu(e);let r=Promise.resolve();Q.Ranges.isChatOrChannelPeer(t)&&(r=i?e.set((e=>(0,n.rejectMessageRequest)(t,!1,e))):e.set((e=>(0,n.leaveChat)(t,e)))),a&&r.then((()=>(0,_.cleanHistory)(e,o,s,n.flushHistory,t,a))),o.hide()}))}function Qe(e,t,s,a,i,o){let l=(0,z.gpeByClass)("_im_dialog",o,s);if((0,d.cancelEvent)(i),!l)return!1;const u=(0,c.intval)((0,z.domData)(l,"peer")),g=t.get(),m=Q.Ranges.isGroupId(u)||Q.Ranges.isUserIdTransitional(u);if(g.recentSearch){const s=(0,n.removeFromRecentSearch)(u,cur.imDb);(0,z.re)(l),0===s.length&&_t(t,a,e)}else(0,_.isClassicInterface)(t)&&m?(0,n.deleteDialog)(u,g).then((([s,a])=>{s?(!function(e,t,s,a,n){let i=(0,z.geByClass1)("_dialog_body",t);(0,z.addClass)(t,"nim-dialog_deleted"),(0,z.removeClass)(t,"_im_dialog"),(0,z.val)(i,(0,c.getTemplate)("im_delete_actions",{text:(0,r.langNumeric)(s,r.getLang("mail_im_X_message_deleted","raw")),peer:e,spam_id:a}))}(u,l,s,a),e().updateMenu(t)):Ye(t,u,e)})):Ye(t,u,e);return!1}function Xe(e,t,s){(0,_.toggleDialogsFolder)(e,(e=>{t().restoreDialogs(e,!0,!0),(0,v.unpackStore)(e).active_tab===h.FOLDER_ALL&&t().updateRecommendationList(e),t().updateDialogFilters(e,!0)}),n.changeDialogsTab,s)}function Je(e,t,s=""){var a;let{photo:n,userLink:i}=He(e,t.peerId,t,(0,_.isClassicInterface)(e));const r=Q.Ranges.isContactId(t.peerId)?(0,_.prepareContactName)(t.tab):t.tab;let l=function(e){return!(0,_.isPendingForward)(e)}(e),d=""===s?[]:[s];const g=e.get();(0,u.isRecentSearchesActive)(e)&&d.push("nim-dialog_recent"),(0,_.isClassicInterface)(e)&&d.push("nim-csr_classic"),(0,c.inArray)(t.peerId,e.get().mutedPeers)&&d.push("nim-dialog_muted"),(0,u.isCasperChatTab)(t)&&d.push("nim-dialog_casper"),(0,S.isUnreadWithMentions)(t)&&d.push("nim-dialog_unread-mentions"),(0,S.hasUnreadReactionsBadge)(e,t.peerId)&&d.push("nim-dialog_unread-reactions"),Ve(t)&&d.push("nim-dialog_unread_expiring"),(null==(a=(0,u.getTab)(e,t.peerId))?void 0:a.isDonutChat)&&d.push("nim-dialog_donut");const m=(0,L.isDialogWithYourself)(e.get().id,t.peerId),p=t.is_nft_photo&&!m;return(0,c.getTemplate)(p?"im_conversation_search_nft_row":"im_conversation_search_row",{peer:t.peerId,msg_id:t.lastmsg||"",photo:n,user_link:i,unread:(0,_.simplifyCounter)(t.unread),tab_name:(0,o.stripHTML)(r),is_unread:Ge(t)?"nim-dialog_unread":"",is_online:(0,f.onlinePlatformClass)(t.online),is_selected:t.peerId==g.peer&&l?"nim-dialog_selected _im_dialog_selected":"",more:d.join(" ")})}function et(e,t){switch(t.type){case"sep_btn_search_msg":return(0,_.renderBtnSearchOnlyMessages)(e);case"sep_messages":return(0,_.renderMessagesSep)();case"sep_conversations":return(0,_.renderConversationsSep)();case"sep_popular":return(0,_.renderPopularSuggSep)();case"popular_sugg":return(0,_.renderPopularSuggestions)(e);case"recommend_list":return(0,_.renderConvoRecommendList)(e);case"find_friends_stub":return(0,_.renderFindFriendsStub)(e);case"clear_recent":return(0,_.renderClearRecent)();case"empty_dialogs":return(0,c.getTemplate)("im_dialogs_none",{msg:r.getLang("mail_dialogs_list_empty"),icon:""});case"empty_business_notify":return(0,c.getTemplate)("im_dialogs_none",{msg:r.getLang("mail_dialogs_business_notify_empty"),icon:""});case"empty_archives":return(0,c.getTemplate)("im_dialogs_none",{msg:r.getLang("mail_dialogs_archives_empty"),icon:(0,H.getIcon56ArchiveOutline)().icon});case"empty_message_requests":return(0,c.getTemplate)("im_dialogs_none",{msg:r.getLang("mail_dialogs_mr_empty"),icon:""});case"empty":return(0,c.getTemplate)("im_dialogs_none",{msg:r.getLang("mail_im_search_empty"),icon:""});case"message_request_notice":return(0,c.getTemplate)("im_dialogs_message_requests_notice",{msg:r.getLang("mail_message_request_tab_notice")});case"message_request_button_go":return(0,c.getTemplate)("im_dialogs_message_requests_button",{msg:r.getLang("mail_tab_mr"),counter:(0,j.getFolderUnreadCount)(e,D.ConvoListFolder.MR)});case"business_notify_button_go":return(0,c.getTemplate)("im_dialogs_business_notify_button",{msg:r.getLang("mail_tab_business_notify"),class_name:t.hidden?Ce:"",counter:(0,j.getFolderUnreadCount)(e,D.ConvoListFolder.BUSINESS_NOTIFY)});case"archive_button_go":return(0,c.getTemplate)("im_dialogs_archives_button",{msg:r.getLang("mail_tab_archives"),class_name:t.hidden?Ce:"",counter:(0,j.getFolderUnreadCount)(e,D.ConvoListFolder.ARCHIVE),mentions:(0,j.getFolderMentionsCount)(e,D.ConvoListFolder.ARCHIVE)});case"archive_notice":const s=(0,c.getTemplate)("im_dialogs_archive_notice_button",{text:r.getLang("mail_archive_tab_notice_button")}),a=r.getLang("mail_archive_tab_notice_content").replace("{button}",s);return(0,c.getTemplate)("im_dialogs_archive_notice",{title:r.getLang("mail_archive_tab_notice_title"),text:a});case"all":const n=(0,v.unpackStore)(e).active_tab,i={[D.ConvoListFolder.MR]:r.getLang("mail_tab_mr"),[D.ConvoListFolder.BUSINESS_NOTIFY]:r.getLang("mail_tab_business_notify"),[D.ConvoListFolder.ARCHIVE]:r.getLang("mail_tab_archives")}[n],o=(0,j.getFolderInlineMenuActions)(e,n).length>0?(0,c.getTemplate)("im_dialogs_active_folder_button_actions",{folder:n}):"";return(0,c.getTemplate)("im_dialogs_active_folder_button",{msg:i,class_name:`_im_folder_${n}_header`,actions:o});case"new_ui_notice":return(0,c.getTemplate)("im_dialogs_new_ui_notice",{title:r.getLang("mail_new_ui_notice_title"),text:r.getLang("mail_new_ui_notice_text")});default:return t.message?Ke(e,t,t.message,{noselect:!0,search:!0}):t.local_index||(0,u.isSearching)(e)?Je(e,t):Ke(e,t)}}function tt(e,t,s,a,i,o){let l=(0,c.intval)((0,z.domData)(o,"peer")),u=(0,z.domData)(o,"action"),g=(0,z.domData)(o,"sid"),m=(0,z.geByClass1)("_im_dialog_"+l,t),p=(0,c.intval)((0,z.domData)(o,"spam"));switch(u){case"restore":m&&e.set(n.restoreDialog.bind(null,l,g,p)).then((()=>{(0,z.addClass)(m,"_im_dialog"),(0,z.removeClass)(m,"nim-dialog_deleted"),ze(m,e.get().tabs[l],e,t,!1),a().updateMenu(e)}));break;case"spam":const i=`${r.getLang("mail_im_dialog_marked_spam")}\n        <button type="button" class="nim-dialog--daction nim-dialog--daction_last _im_dialog_daction"\n          data-action="restore"\n          data-spam="1"\n          data-sid="${g}" data-peer="${l}">\n            ${r.getLang("mail_restore")}\n        </button>`;if(m){let t=(0,z.geByClass1)("_dialog_body",m);(0,z.val)(t,i),(0,n.spamDialog)(l,g,e.get())}break;case"block":let o;o=(0,_.isCommunityInterface)(e)?(0,_.showBlacklistBox)(l,e):(0,_.showBlacklistBoxUser)(l,e),o.once("success",(function(){e.set(n.flushHistory.bind(null,l)).then((()=>{s().restoreDialogs(e)}))}))}(0,d.cancelEvent)(i)}function st(e,t){return e.map((e=>(0,I.getMessageFromTuple)(e))).map((e=>(0,c.extend)({},t[e.peerId],{message:e})))}function at(e){return{type:"empty",lang:e}}function nt(e,t,s,a){let i=(0,z.gpeByClass)("_im_dialog",a,t),o=(0,c.intval)((0,z.domData)(i,"peer"));return e.set(n.toggleDialogImportant.bind(null,o)),setTimeout((function(){it(e,t,s,a)}),100),(0,d.cancelEvent)(s),!1}function it(e,t,s,a){(0,M.showTooltip)(a,{text:function(){let s=(0,z.gpeByClass)("_im_dialog",a,t),n=(0,z.domData)(s,"peer");return e.get().tabs[n].folders&w.FOLDER_IMPORTANT?r.getLang("mail_im_toggle_important_off"):r.getLang("mail_im_toggle_important")},black:1,zIndex:1,shift:[14,8],toup:bt(e,a.getBoundingClientRect().top)})}function ot(e,t){const s=t.unread>0?r.getLang("mail_im_new_messages",t.unread):"",a=(0,z.geByClass1)("_im_unread_blind_label",e);(0,z.val)(a,s)}function rt(e,t,s,a,i){let o=(0,z.gpeByClass)("_im_dialog",i,t),_=(0,c.intval)((0,z.domData)(o,"peer"));return e.set(n.markDialogAnswered.bind(null,_)).then((()=>{ze(o,e.get().tabs[_],e,t),(0,u.isRecentSearchesActive)(e)||s().restoreDialogs(e)})),(0,l.showDoneBox)(r.getLang("mail_marked_as_answered"),{out:1e3}),(0,d.cancelEvent)(a),!1}function lt(e){const t=(0,u.isSearching)(e),s=e.get().searchOnlyMessages;return(0,_.isClassicInterface)(e)?{top:t&&!s?96:60,bottom:(0,_.isCommunityInterface)(e)?42:87}:{top:t&&!s?36:0,bottom:0}}function ct(e,t){e.hoverFirstElement(le,lt(t))}function dt(e){e.unhoverElements(le)}function _t(e,t,s){if((0,u.doPopularSuggExist)(e)){let e=[{type:"sep_popular"},{type:"popular_sugg"}];t.pipeReplace(Promise.resolve(e)),t.toTop()}else s().cancelSearch(e),(0,i.cancelStackFilter)("im_search")}function ut(e,t){const s=t.get(),a=parseInt((0,z.domData)(e,"peer")),n=(0,u.getTab)(s,a);if(!s.is_peer_profile_enabled||!(0,_.isCommunityInterface)(s)||!n||(0,u.isChannelPeer)(n)||(0,u.isCommunityChat)(s,a)||(0,u.isSearching)(t))return;const i=(0,z.geByClass1)(ce,e);if(!(n.ad_id||s.peer_profile_tags&&n.peer_tags&&n.peer_tags.ids))return void(i.innerHTML&&(i.innerHTML=""));let o=n.peerTagsMaxWidth||0;if(!o){const s=(0,z.geByClass1)(de,e).offsetWidth;o=xe-(s+Re+(n.verified?Be:0)),t.set((e=>(e.tabs[a].peerTagsMaxWidth=o,Promise.resolve(e))))}(0,m.renderPeerTags)(i,o,t,a)}function gt(e,t){if(!(0,_.isCommunityInterface)(e))return;["empty_dialogs","empty_business_notify","empty_archives","empty"].includes((0,z.domData)(t,"list-id"))?(0,m.updateEmptyDialogsMargin)():(0,z.hasClass)(t,"_im_dialog")&&ut(t,e)}function mt(e){(0,d.checkEvent)(e)||(0,d.cancelEvent)(e)}function pt(){return window.FriendsSearch?Promise.resolve():window.stManager.add([window.jsc("web/friends_search.js")])}function ht(e,t,s){const{selector:a,setting:n}={new_ui_notice:{selector:`.${Me}`,setting:"new_ui_notice_hidden"},archive:{selector:`.${ye}`,setting:"archives_folder_notice_hidden"}}[s];a&&n&&e.set((e=>(0,q.setLocalSettingsValue)(n,1,e))).then((()=>(t.querySelector(a).hidden=!0,(0,G.toggleHideFolderNoticeHandler)((0,v.unpackStore)(e),s,1))))}function vt(e,t,s,a,n,i){return{selectPeer(t,s){let a=(0,z.geByClass)("_im_dialog",e),n=s.get().peer;for(let e=0;e<a.length;e++){let s=a[e],i=(0,c.intval)((0,z.domData)(s,"peer")),o=(0,c.intval)((0,z.domData)(s,"msgid"));i===n&&(!Fe(s)||t===o&&Fe(s))?((0,z.addClass)(s,"nim-dialog_selected"),(0,z.addClass)(s,"_im_dialog_selected")):(0,z.hasClass)(s,"_im_dialog_selected")&&((0,z.removeClass)(s,"nim-dialog_selected"),(0,z.removeClass)(s,"_im_dialog_selected"))}},appendFastDialogs(t,a,n){(0,z.removeClass)(e.parentNode,"im-page--dialogs_with-mess"),s.saveScroll("list"),n?(s.reset(),(0,_.isPendingForward)(t)||(0,u.isRecentSearchesActive)(t)||!(0,p.doesSearchResultContainConversations)(a)?(0,u.isRecentSearchesActive)(t)&&((0,p.doesSearchResultContainConversations)(a)&&(a=[{type:"clear_recent"}].concat(a)),(0,u.doPopularSuggExist)(t)&&(a=[{type:"sep_popular"},{type:"popular_sugg"}].concat(a))):a=[{type:"sep_btn_search_msg"},{type:"sep_conversations"}].concat(a),t.setState({searchOnlyMessages:!1}),s.pipeReplace(Promise.resolve(a)).then((()=>ct(s,t)))):s.pipe(Promise.resolve(a)),(0,_.isClassicInterface)(t)&&!Q.Ranges.isZeroOwner(t.get().peer)||s.toTop()},deactivate(){s.deactivate()},activate(){s.activate()},hoverFirstDialog(e){ct(s,e)},hoverNextDialog(e){s.hoverNextElement(le,re,lt(e))},hoverPrevDialog(e){s.hoverPrevElement(le,re,lt(e))},unhoverDialogs:dt.bind(s),selectHoveredDialog(t){let n=(0,z.geByClass1)("_im_dialog_hovered",e);(0,U.partConfigEnabled)("mail_dialog_list_disable_enter_default")||n||(n=(0,z.geByClass1)("_im_dialog",e)),n&&Ue(a,0,t,s,{},n)},appendSearch(t,a,n){let i=st(n,a);n.length>0?((0,z.addClass)(e.parentNode,"im-page--dialogs_with-mess"),s.pipe(Promise.resolve([{type:"sep_messages"}].concat(i))).then((()=>ct(s,t)))):(0===s.getCurrentElements().length&&s.pipeReplace(Promise.resolve([at()])),(0,z.removeClass)(e.parentNode,"im-page--dialogs_with-mess"))},update(e){s.pipeReplace(Promise.resolve(ft(e))).then(i.track)},updateDialog(t,s){let a=(0,z.geByClass1)("_im_dialog_"+t,e);a&&!Fe(a)&&ze(a,(0,u.getTab)(s,t),s,e)},focusOnSelected(t){let a=t.get().peer;if(!a)return;let n=(0,z.geByClass1)(`_im_dialog_${a}`,e);n?s.scrollTop(n.offsetTop-n.offsetHeight):s.toTop()},restoreScroll(e){s.restoreScroll("list")||s.toTop()},forceScrollReinit(){const e=s.getScroller();e&&(e.style.overflowY="hidden",setTimeout((()=>e.style.overflowY=""),0))},restoreDialogs:(t,n,o)=>((0,z.removeClass)(e.parentNode,"im-page--dialogs_with-mess"),t.setState({searchOnlyMessages:!1}),(0,j.isEmptyFolder)(t)&&!s.isLoading()&&(n=!0),n&&s.reset(),o&&s.wipe(),(0,M.hideAllTooltips)(e),s.pipeReplace(Promise.resolve(ft(t))).then((()=>{if(n&&(!(0,_.isClassicInterface)(t)||!t.get().peer)){let e=function(e,t,s){return(0,_.isClassicInterface)(s)||t().toggleSettingsLoader(s,!0),e.checkMore(!(0,_.isClassicInterface)(s)).then((()=>{(0,_.isClassicInterface)(s)||t().toggleSettingsLoader(s,!1)}))}(s,a,t);return s.toTop(),e}})).then((()=>dt(s))).then(i.track)),appendDialogs(t,a){(0,z.removeClass)(e.parentNode,"im-page--dialogs_with-mess"),a.forEach((s=>{let a=(0,z.geByClass1)("_im_dialog_"+s.peerId,e);a&&Ze(a,s,t)})),(0,_.isPendingForward)(t)||(0,u.isRecentSearchesActive)(t)||!(0,p.doesSearchResultContainConversations)(a)||(a=[{type:"sep_btn_search_msg"},{type:"sep_conversations"}].concat(a)),t.setState({searchOnlyMessages:!1}),s.isEmpty()&&0===a.length&&(0,_.isPendingForward)(t)&&(a=[at(r.getLang("mail_im_search_empty_chats"))]),s.replacePreserveOrder(a)},updateCounter(t,s){let a=(0,z.geByClass1)("_im_dialog_"+s,e),n=(0,u.getTab)(t,s);if(a&&!Fe(a)&&(ot(a,n),(0,z.val)((0,z.geByClass1)("_im_dialog_unread_ct",a),(0,_.simplifyCounter)(n.unread)),(0,z.toggleClass)(a,"nim-dialog_unread",Ge(n)),(0,z.toggleClass)(a,"nim-dialog_unread-out",qe(t,n,$e(n).flags)),(0,z.toggleClass)(a,"nim-dialog_unread-mentions",(0,S.isUnreadWithMentions)(n)),(0,z.toggleClass)(a,"nim-dialog_unread-reactions",(0,S.hasUnreadReactionsBadge)(t,s)),(0,z.toggleClass)(a,"nim-dialog_unread-expiring",Ve(n))),(0,u.isRecentSearchesActive)(t)){let t=(0,z.geByClass1)("_im_sugg_"+s,e);t&&((0,z.val)((0,z.geByClass1)("_sugg_unread_ct",t),(0,_.simplifyCounter)(n.unread)),(0,z.toggleClass)(t,"sugg-is_unread",n.unread>0))}},removeDialog(e,t){s.remove(t)},updateOnline(t,s){let a=(0,z.geByClass1)("_im_dialog_"+t,e);if(a){let e=s.get().tabs[t],n=(0,z.geByClass1)("_im_peer_online",a);(0,f.toggleOnline)(n,e.online)}},updateRecommendedOnline(t,s){const a=(0,S.getRecommendedConvoList)(s),n=e.querySelector(`.${ge}__button[data-peer="${t}"]`);if(n&&a){const e=a.item_data[t].online_info,s=n.querySelector("._online");s&&(s.classList.toggle("online",e.is_online||e.is_mobile),s.classList.toggle("mobile",e.is_mobile))}},updateRecommendationList(t){const s=(0,z.se)((0,_.renderConvoRecommendList)(t)),a=s.querySelector(`.${P.CAROUSEL_LAYER_CLASS}`);if(!a){const t=e.querySelector(`.${ge}`);return void(t&&t.replaceChildren(...s.children))}const n=e.querySelector(`.${ge} .${P.CAROUSEL_VIEWPORT_CLASS}`);if(!n)return;const o=n.querySelector(`.${P.CAROUSEL_LAYER_CLASS}:not(.${be})`);o&&(o.classList.add(be),o.addEventListener("animationend",(()=>{a.classList.remove(fe),o.parentNode&&(o.remove(),i.track())}))),a.classList.add(fe),n.appendChild(a)},setRecommendationListVisibility(t){const s=e.querySelector(`.${ge}`);return!!s&&(s.classList.toggle(ve,!t),!0)},setDialogFailed(t,s,a){let n=(0,z.geByClass1)("_im_dialog_"+t,e);n&&a.get().tabs[t].lastmsg===s&&((0,z.addClass)(n,"nim-dialog_failed"),(0,z.val)((0,z.geByClass1)("_im_dialog_unread_ct",n),"!"))},scrollUp(e,t=!1){s.toTop(e,t),s.saveScroll("list",!0)},saveScroll(e){s.saveScroll("list",!0)},promoteDialog(a,n){let i=(0,z.geByClass1)("_im_dialog_"+n,e);i&&!Fe(i)||!(0,u.isSearching)(a)?(s.pipeReplace(Promise.resolve(ft(a)),void 0,!0).then((t=>{!(0,c.inArray)(n,t)&&i&&ze(i,(0,u.getTab)(a,n),a,e)})),t().updateTyping(n,a)):s.unsetScroll("list")},removeSelection(t){const a=t.get().peer.toString(),n=`._im_dialog_${a}.${re.join(".")}`,i=(0,z.domQuery)(n,e)[0];re.forEach((e=>(0,z.removeClass)(i,e))),(0,_.isClassicInterface)(t)||s.hoverElement(a,le,lt(t))},updateScroll(){s.updateScroll()},updateTyping(t,s){let a=(0,z.geByClass1)(`_im_dialog_${t}`,e);if(a&&!Fe(a)&&!s.get().tabs[t].deletedDialog){let e=(0,z.geByClass1)("_im_dialog_typing",a);const n=!(0,_.isClassicInterface)(s);let i=(0,_.formatTyper)((0,u.getTab)(s,t).activity,t,!Q.Ranges.isChatOrChannelPeer(t),s.get(),1,n);(0,z.val)(e,i),(0,z.toggleClass)(a,"nim-dialog_typing",i)}},renderPeerTags(t,s=null){if(s){ut((0,z.geByClass1)("_im_dialog_"+s,e),t)}else!function(e,t){const s=t.get();s.is_peer_profile_enabled&&(0,_.isCommunityInterface)(s)&&(0,z.geByClass)("_im_dialog",e).forEach((e=>{ut(e,t)}))}(e,t)},updateFolderCounters(t){const s=(0,v.unpackStore)(t),a={[D.ConvoListFolder.ARCHIVE]:_.TOGGLE_ARCHIVES_TAB,[D.ConvoListFolder.BUSINESS_NOTIFY]:_.TOGGLE_BUSINESS_NOTIFY_TAB};[D.ConvoListFolder.MR,D.ConvoListFolder.BUSINESS_NOTIFY,D.ConvoListFolder.ARCHIVE].forEach((t=>{const n=(0,j.getFolderUnreadCount)(s,t),i=e.querySelector(`[data-list-id=${t}_button_go] .im-page--dialogs-folder-button--counter`);i&&(i.innerHTML=n);const o=a[t];var r,l;o&&(null==(r=null==e?void 0:e.querySelector(`.${o}`))||null==(l=r.classList)||l.toggle(Ce,(0,j.isConvoListFolderHidden)(s,t)))}));const n=(0,j.getFolderMentionsCount)(s,D.ConvoListFolder.ARCHIVE),i=e.querySelector(`[data-list-id=${D.ConvoListFolder.ARCHIVE}_button_go] .im-page--dialogs-folder-button--mentions`);i&&(i.dataset.mentions=n)},toggleFolder:Xe,unmount(){s.unmount(),i.destroy(),(0,C.destroyModule)(n)}}}function ft(e){var t;const s=(0,v.unpackStore)(e),a=s.active_tab;var n;const i=null!=(n=null==(t=s.dialog_tabs)?void 0:t[a])?n:[],o=s.tabs,r=i.map((e=>o[e.toString()])).sort(L.sortFn.bind(null,e)),l=(0,_.isViewWithRecommendations)(e)&&r.length<2&&!s.hasContacts;if(a===h.FOLDER_MESSAGE_REQUEST&&r.unshift({type:"message_request_notice"}),a!==D.FOLDER_ARCHIVE||s.settings.archives_folder_notice_hidden||r.unshift({type:"archive_notice"}),!(0,_.isClassicInterface)(e))switch(a){case h.FOLDER_ALL:(0,j.getConvoListFolderCounterDisplayed)(e,D.ConvoListFolder.MR)>0&&r.unshift({type:"message_request_button_go"}),(0,x.isBusinessNotifyEnabled)(e)&&r.unshift({type:"business_notify_button_go",hidden:(0,j.isConvoListFolderHidden)(e,D.FOLDER_BUSINESS_NOTIFY)}),r.unshift({type:"archive_button_go",hidden:(0,j.isConvoListFolderHidden)(e,D.FOLDER_ARCHIVE)});break;case h.FOLDER_UNREAD:r.unshift({type:"archive_button_go",hidden:(0,j.isConvoListFolderHidden)(e,D.FOLDER_ARCHIVE)});break;case h.FOLDER_MESSAGE_REQUEST:case D.FOLDER_BUSINESS_NOTIFY:case D.FOLDER_ARCHIVE:r.unshift({type:"all"})}(0,_.isViewWithRecommendations)(e)&&(s.hasContacts||i.length>1)&&r.unshift({type:"recommend_list"}),l?r.push({type:"find_friends_stub"}):(0,j.isEmptyFolder)(e)&&r.push(...(0,j.getEmptyFolderEls)(e));return a===h.FOLDER_ALL&&!(0,_.isCommunityInterface)(e)&&!(0,_.isClassicInterface)(e)&&!(0,x.getLocalSettingsValue)(e,"new_ui_notice_hidden")&&r.unshift({type:"new_ui_notice"}),r}function bt(e,t){let s=e.get().gid?220:150;return!((0,m.isPeerTagsFolder)(e)&&t<=s+De)&&(t>s||(0,u.isSearching)(e))}function wt(e,t,s,i){const{callMutations:o,bindMutations:l}=(0,C.createMutations)(vt),g=document.body.appendChild(document.createElement("div"));g.classList.add("im-page--dialogs-inline-menu-container");const p=function(e,s){(0,M.showTooltip)(s,{text:()=>{if((0,u.isRecentSearchesActive)(t))return r.getLang("mail_hide_from_recent");const e=Number(s.getAttribute("data-peer")),a=(0,u.getTab)(t,e),n=(0,u.tabIsMessageRequestToChat)(a);return Q.Ranges.isChatOrChannelPeer(e)&&!n?(0,S.doesChatTabHaveFlag)((0,u.getTab)(t,e),1024)?r.getLang("mail_unfollow_channel"):(0,u.isChatActive)(a)?r.getLang("mail_leave_chat"):r.getLang("mail_delete"):r.getLang("mail_delete")},black:1,[(0,_.isClassicInterface)(t)?"center":"needLeft"]:!0,shift:(0,_.isClassicInterface)(t)?[-4,10]:[0,10],toup:bt(t,s.getBoundingClientRect().top),zIndex:1})},h=function(s,n){const{folder:i}=n.dataset;if(!i)return;const o=function(e,t,s,a,n){return s=>{var i;const o=s.target.closest(`.${Ae}`);if(!o)return;const{action:r}=o.dataset;if(r!==D.FolderAction.SHOW)return;const l={[D.ConvoListFolder.BUSINESS_NOTIFY]:"business_notify_folder_hidden",[D.ConvoListFolder.ARCHIVE]:"archives_folder_hidden"}[a];l&&t.set((e=>(cur.imDb.updateByKey("archives_folder_hidden",null),(0,q.setLocalSettingsValue)(l,null,e)))).then((t=>{const s=e.querySelector(`.${Le}`);return s&&(s.hidden=!0),(0,G.toggleHideFolderHandler)((0,v.unpackStore)(t),a,!1,!0)})),null==n||null==(i=n.tt)||i.hide()}}(e,t,0,i,n),r=(0,j.getFolderInlineMenuActions)(t,i).map((e=>(0,c.getTemplate)("im_page_inline_menu_item",(0,a._)({},e,{class_name:Ae})))).join(""),l=(0,c.getTemplate)("im_page_inline_menu",{actions:r});(0,M.showTooltip)(n,{text:l,onCreate:()=>{var e,t;return null==(e=n.tt)||null==(t=e.container)?void 0:t.addEventListener("click",o)},onHide:()=>{var e,t,s;null==(e=n.tt)||null==(t=e.container)||t.removeEventListener("click",o),null==(s=n.tt)||s.destroy()},black:0,dir:"top",shift:[-2,-6],zIndex:130,hasover:!0,appendEl:g,className:"im_page_inline_menu_tt im_page_folder_inline_menu_tt",slide:4,showdt:100,hidedt:100,forcetodown:1,needLeft:!0})};let w;const y=function(n,i){const r=(0,u.getTab)(t,Number(i.dataset.peer));if(!r)return;(0,M.hideAllTooltips)(e),(0,M.destroyAllTooltips)(e),w=null;const l=function(e,t,s,a,n){return i=>{var o;const r=i.target.closest(`.${ne}`);if(!r)return;const{action:l}=r.dataset;(0,K.handleUiActionForPeer)(e,t,s,l,a),null==n||null==(o=n.tt)||o.hide()}}(t,s,o,r.peerId,i),d=(0,S.getConvoInlineMenuActions)(t,r).map((e=>(0,c.getTemplate)("im_page_inline_menu_item",(0,a._)({},e,{class_name:ne})))).join(""),_=(0,c.getTemplate)("im_page_inline_menu",{actions:d});w=i.closest(`.${J}`),(0,M.showTooltip)(i,{text:_,onCreate:()=>{var e,t;return null==(e=i.tt)||null==(t=e.container)?void 0:t.addEventListener("click",l)},onShowStart:()=>{var e;null==w||null==(e=w.classList)||e.add(ie)},onHide:()=>{var e;null==w||null==(e=w.classList)||e.remove(ie),w=null},black:0,dir:"left",shift:[-30,-11],zIndex:130,hasover:!0,className:"im_page_inline_menu_tt im_page_dialog_inline_menu_tt",appendEl:g,slideX:4,showdt:200,hidedt:100})};let E=function(e,s){(0,M.showTooltip)(s,{text:r.getLang("mail_end_conversation"),black:1,center:!0,zIndex:1,shift:[1,4],toup:bt(t,s.getBoundingClientRect().top)})},I=it.bind(null,t,e),T=nt.bind(null,t,e),k=rt.bind(null,t,e,o),L={idFn:e=>function(e,t){try{return t.message?t.message.messageId:(0,u.isSearching)(e)&&t.peerId?t.peerId+"cr":t.peerId||t.type}catch(s){if(t)throw s;const a=(0,v.unpackStore)(e),n=Object.keys(a.tabs).map(Number),i=a.dialog_tabs.all.filter((e=>!n.includes(e)));throw s.message=`Missing convo info for: ${i.join(", ")}`,s}}(t,e),hoverableFn:e=>(0,z.hasClass)(e,"_im_dialog"),renderFn:et.bind(null,t),more:Ne.bind(null,t,o),onScroll:()=>{if((0,_.isClassicInterface)(t)&&A.browser.safari){(document.body.scrollTop||document.documentElement.scrollTop)<=0&&!layers.visible?(0,z.addClass)(i,"im-page--header_static"):(0,z.removeClass)(i,"im-page--header_static")}(0,M.hideAllTooltips)(e)},onRenderFn:gt.bind(null,t)},P=(0,b.mount)(e,(0,v.default)({limit:40,offset:0,nativeScroll:!!(0,_.isClassicInterface)(t),height:X,elements:ft(t)}),(()=>L));const x=function(e){let t;const s=new Set,a=e=>{e.forEach((e=>{const{target:t,isIntersecting:a}=e,{position:n,peer:i,trackcode:o}=t.dataset;if(!s.has(i)&&a)s.add(i),(0,B.collectConversationSuggestionItemStats)(o,Number(n),"show");else if(s.has(i)&&!a){if(s.delete(i),!o)return;(0,B.collectConversationSuggestionItemStats)(o,Number(n),"hide")}}))};return{track:()=>{t&&t.disconnect();const e=document.querySelector(`.${ge}`);if(!e)return;const s=e.querySelector("._im_carousel_viewport");t=new IntersectionObserver(a,{root:s}),e.querySelectorAll(`.${me}`).forEach((e=>t.observe(e)))},destroy:()=>{t&&t.disconnect()}}}();x.track(),A.browser.mozilla&&pt();let U=Ue.bind(null,s,o,t,P);const H=e=>{var t;null==w||null==(t=w.classList)||t.remove(ie)};let Z=Oe.bind(null,t,e,P),W=tt.bind(null,t,e,o,s);const $=Qe.bind(null,s,t,e,P),[Y,re,ce,de]=[D.ConvoListFolder.MR,D.ConvoListFolder.BUSINESS_NOTIFY,D.ConvoListFolder.ARCHIVE,D.ConvoListFolder.ALL].map((e=>n=>{if(!n.target.closest(`.${we}`))return void Xe(t,s,e);const o=(0,v.unpackStore)(t).settings,l={[D.ConvoListFolder.BUSINESS_NOTIFY]:"number"!=typeof o.business_notify_folder_hidden,[D.ConvoListFolder.ARCHIVE]:"number"!=typeof o.archives_folder_hidden}[e],c={[D.ConvoListFolder.BUSINESS_NOTIFY]:ke,[D.ConvoListFolder.ARCHIVE]:Te},d=Boolean(cur.imDb.selectByKey(c[e]));l&&!d&&(!function(e,t){var s;const n=e.querySelector(`.${O.CONVO_MORE_CLASS}`);if(!n)return;let i;const o="feature_intro_tt feature_intro_blue_tt im-page--dialogs--folder_hide_hint";switch(t){case D.ConvoListFolder.BUSINESS_NOTIFY:i={width:206,content:r.getLang("mail_dialog_business_notify_more_hint"),cls:o+" im-page--dialogs--business-notify_hide_hint"};break;case D.ConvoListFolder.ARCHIVE:i={width:164,content:r.getLang("mail_dialog_archive_more_hint"),cls:o+" im-page--dialogs--archives_hide_hint"};break;default:return}null==(s=(0,z.data)(n,"ett"))||null==s.destroy||s.destroy();const l=new N.ElementTooltip(n,(0,a._)({autoShow:!1,appendTo:document.body,forceSide:"bottom",offset:[15,8],align:"right",withCloseButton:!0,onHide:()=>{l.destroy()}},i));l.show()}(i,e),cur.imDb.updateByKey(c[e],1)),s().hideFolderButton(t,e)})),ve=s=>{ht(t,e,"archive")},fe=s=>{ht(t,e,"new_ui_notice")},be=(0,C.createModule)({handlers:(a,i)=>{i(e,"click",ae,$),i(e,"click","_im_dialog_markre",k),i(e,"click",te,T),i(e,"click",J,U),i(e,"mouseover",J,H),i(e,"click",_.MESSAGE_SEARCH_CLASS,Z),i(e,"mouseover",ae,p),i(e,"mouseover",se,y),i(e,"mouseover",Le,h),i(e,"mouseover","_im_dialog_markre",E),i(e,"click",_.CLEAR_RECENT_CLASS,(()=>{(0,n.resetRecentSearch)(cur.imDb),_t(t,P,s)})),i(e,"click",_.TOGGLE_MR_TAB,Y),i(e,"click",_.TOGGLE_BUSINESS_NOTIFY_TAB,re),i(e,"click",_.TOGGLE_ARCHIVES_TAB,ce),i(e,"click",_.TOGGLE_ALL_TAB,de),i(e,"mouseover",te,I),i(e,"click",oe,W),i(e,"click",ee,mt),i(e,"click",pe,(e=>function(e,t){(0,d.cancelEvent)(e);const s=e.target.closest("."+me),a=s.parentNode,n=Number(s.dataset.position),i=Number(s.dataset.peer),o=s.dataset.trackcode;if(!o){const e=(0,v.unpackStore)(t),s={hasPeer:!!i,hasListData:!!e.recommendationList,hasPeerData:!!e.recommendationList.item_data[i]};throw a.remove(),t.set((e=>(0,R.removeStoredRecommendedListItem)(e,i))),new Error((0,V.getErrorText)(s,"Rec remove log"))}a.remove(),t.set((e=>(0,R.removeStoredRecommendedListItem)(e,i))),(0,F.hideSuggestedContact)({position:n,track_code:o}).catch((e=>{throw new Error((0,V.getErrorText)(e))}))}(e,t))),i(e,"click",me,(e=>function(e){if(e.target.closest("."+pe))return;const t=e.target.closest("."+me),{position:s,trackcode:a}=t.dataset;(0,B.collectConversationSuggestionItemStats)(a,Number(s),"click")}(e))),i(e,"click",he,(e=>function(e,t){"invite_by_phone_number"===e.target.closest("."+he).dataset.action&&pt().then((()=>{window.FriendsSearch.inviteBox()}))}(e))),(0,_.isCommunityInterface)(t)&&t.get().is_peer_profile_enabled&&(i(e,"mouseover",_e,(e=>(0,m.onPeerTagsExtraHover)(e,t))),i(e,"click",ue,(e=>(0,m.onDialogPeerTagClick)(e,t)))),a(e,"mouseover",(0,f.throttle)(P.unhoverElements.bind(P,le),100)),i(e,"mouseover",we,((e,t)=>{(0,M.showTooltip)(t,{text:r.getLang("mail_dialog_folder_button_hide"),black:1,center:!0,shift:[1,6],appendEl:document.body})})),i(e,"click",Ee,ve),i(e,"click",Ie,fe),i(e,"click",Se,(e=>{s().applySearchAction(t,"settings",e)})),i(e,"mouseover",Pe,((e,t)=>{(0,M.showTooltip)(t,{text:r.getLang("mail_dialog_folder_button_back"),black:1,center:!0,shift:[-3,0],appendEl:document.body})})),i(e,"click",Pe,de)}});return l(e,o,P,s,be,x)}},381001:(e,t,s)=>{"use strict";s.d(t,{mount:()=>p});var a=s(875610),n=s(82161),i=s(795558),o=s(849965),r=s(480657),l=s(527405),c=s(552666),d=s(15080),_=s(835200),u=s(321342);function g(e,t,s,n){if(e.loading||e.all)return;if(s.scrollTop+window.innerHeight-s.scrollHeight>-300){let s=(0,i.geByClass1)("_im_peer_history",t.bodyNode);e.loading=!0,(0,l.wrapLoading)(s)((0,a.loadImportant)(e.offset).then((([t,o,r,c])=>{e.all=c.all,e.offset=c.offset,e.all?(0,i.addClass)(s,"im-important_all"):e.loading=!1,n.set((e=>(0,a.mergeTabs)(e,(0,l.tabFromIds)(c.msgs,c.hash),!0)));let d=(0,i.ce)("div");d.innerHTML=o,s.appendChild(d),(0,u.ensureDomHasActions)(s)})),"bottom")}}function m(e,t,s,...i){i.filter((e=>(0,n.inArray)(e.type,[_.SET_FLAGS,_.RESET_FLAGS,_.CHANGE_PEER]))).forEach((n=>{if(n.type!==_.CHANGE_PEER){if(n.flags===_.FLAG_IMPORTANT){let s=n.type===_.SET_FLAGS;e.set(a.updateFavMessage.bind(null,[n.messageId],0,s)).then((a=>{t.markImportant(n.messageId,s,e)}))}}else s.hide()}))}function p(e,t,s,a){let n=(0,i.ge)("box_layer_wrap"),_=t.get().longpoll,p=(0,c.default)({peer:0,longpoll:_,oCache:{},tabs:(0,l.tabFromIds)(a.msgs,a.hash)}),h=(0,r.mount)(e.bodyNode,p,(()=>({}))),v=(0,o.mount)(e.bodyNode,t,"fav_box");(0,u.ensureDomHasActions)(e.bodyNode);let f=m.bind(null,t,h,e);_.onData(f);let b=g.bind(null,{all:!1,loading:a.all,offset:a.offset},e,n,p);const w=(0,d.createModule)({handlers:(e,t)=>{e(n,"scroll",b)}});return{unmount(){(0,d.destroyModule)(w),v.unmount(),h.unmount(),_.offData(f)}}}},171993:(e,t,s)=>{"use strict";s.d(t,{mount:()=>d});var a=s(527405),n=s(82161),i=s(875610);const o=5e3,r=54e6,l=72e5;function c(e){const t=e.get().tabs,s=e.get().peer,o=Object.keys(t).filter((t=>(0,a.isFullyLoadedTab)(e,t)&&(0,n.intval)(t)!==s)).map((e=>t[e]));o.filter((e=>Date.now()-e.last_visited>r)).forEach((t=>e.set(i.cleanTab.bind(null,t.peerId)))),o.filter((t=>(0,a.isFullyLoadedTab)(e,t.peerId)&&"string"!=typeof t.history&&Date.now()-t.last_touched>l)).forEach((t=>e.set(i.stringifyTab.bind(null,t.peerId))))}function d(e){const t=setInterval(c.bind(null,e),o);return{unmount(){clearInterval(t)}}}},797673:(e,t,s)=>{"use strict";s.d(t,{AUDIO_MSG_AUTOSHOW_SETTING_HINT:()=>it,mount:()=>vs});var a=s(11010),n=s(875610),i=s(652027),o=s(196026),r=s(504867),l=s(953908),c=s(95432),d=s(795558),_=s(804381),u=s(375353),g=s(502478),m=s(408014),p=s(527405),h=s(12402),v=s(222009),f=s(705758),b=s(894523),w=s(459393),C=s(779625),y=s(15080),E=s(91967),S=s(717150),M=s(316760),I=s(849965),T=s(480657),k=s(616829),L=s(790738),A=s(528283),P=s(343394),x=s(2914),B=s(894330),R=s(835200),D=s(95638),O=s(649851),F=s(481792),N=s(196635),U=s(227575),H=s(489141),j=s(37396),q=s(755320),G=s(406762),V=s(962983),K=s(682615),z=s(320422),Z=s(82161),W=s(936134),$=s(501087),Y=s(839470),Q=s(656448),X=s(220661),J=s(823826),ee=s(514986),te=s(415789),se=s(725296),ae=s(783400),ne=s(300069),ie=s(854099),oe=s(29271),re=s(934701),le=s(997889),ce=s(321342),de=s(540537),_e=s(196655),ue=s(638871),ge=s(123378),me=s(239301),pe=s(931917);const he=1e3,ve=-30,fe=30,be=2e3,we=700,Ce=45,ye=16,Ee=42,Se=47,Me=15,Ie=40,Te="._im_to_end",ke="._im_to_mention",Le="._im_to_reaction",Ae="_im_failed_action",Pe="_im_mess_link",xe="_im_admin_name",Be="_im_typer_c",Re="_im_error",De="im-page--error--visible",Oe="_im_join_cancel",Fe="_im_retry_media",Ne="im-audio-message_recorded",Ue="im-audio-message_recording",He="_im_mess_srv",je="im_srv_mess_link",qe="_chat_invitation",Ge="_im_mess",Ve="_im_replied_message",Ke="_im_replied_author_link",ze="im-mess-stack--bomb",Ze="top",We="center",$e="im-expired-message--in",Ye="_im-call-snippet",Qe="_im_mess_callsnippet",Xe="_im_call_snippet_join_btn",Je="mem_pseudolink",et="_im_mess_pinned",tt="_im_subscribe_button",st="im-mess-stack--lnk",at="_msg_asr_toggle",nt="im_msg_audiomsg--transcription-shown",it="_im_asr_setting_hint";let ot=!1,rt={},lt=!1;function ct(e){return e.get().isMassMentionsMessageAllowed}function dt(e){const t=(0,v.getTab)(e,e.get().peer);return!!(0,v.getPinnedMessage)(e)||!(!t||!t.top_banner)}function _t(e,t){const s=(0,f.unpackStore)(e),a=(0,v.getTab)(s,t);return pe.Ranges.isChatOrChannelPeer(t)&&(0,P.isPinnedMessageVisibleInTab)(s,t)||!!a.top_banner&&!(0,v.isSearchShown)(t,s)}function ut(e){return(0,p.getPinnedMessageHeight)(e)}function gt(e,t,s){const a=s||(0,d.clientHeight)();return Math.min(a-Me,Math.max(0,e,we+Ee+t.offsetTop))}function mt(e,t){const s=(0,Z.intval)((0,d.domData)(t.target,"msgid")),a=(0,d.gpeByClass)(`_im_mess_${s}`,t.target),n=(0,d.geByClass1)("_im_log_body",a),i=(0,d.geByClass1)("_im_mess_susp_cont",a);n.innerHTML=i.innerHTML}function pt(e,t){return(0,d.geByClass1)("_im_mess_"+t,e)}function ht(e){e().hideError()}function vt(e,t,s,a,i){if((0,l.checkEvent)(a))return!0;let o=(0,V.fromQueryString)(i.getAttribute("href")),r=(0,Z.intval)(o.msgid);r&&e.set(n.changePeer.bind(null,e.get().peer,r,!1)).then((()=>Lt(s,t,r,e))),(0,l.cancelEvent)(a)}function ft(e,t,s){const a=(0,v.getTab)(t,s),i=(0,n.strHistory)(a.history);(0,d.toggleClass)(e,"im-page--history_empty-hist",!i)}function bt(e,t,s,a){if(!(0,d.hasClass)(s.target,"_im_mess_marker"))return;const n=s.target,i=(0,f.toArray)((0,d.geByClass)(p.FAILED_CLASS,t));window.tooltips&&i.map((e=>(0,d.geByClass1)("_im_mess_marker",e))).filter((e=>e!==n)).forEach((e=>tooltips.hide(e,{fasthide:!0})));let o=(0,d.domData)(a,"msgid");(0,z.showTooltip)(n,{content:(0,Z.getTemplate)("im_failed_menu",{count:i.length,modifiers:(0,K.classNames)("im-settings_failed",{"im-settings_no_delete":o>0,"im-settings_single":1===i.length}),id:o}),className:"im-page--failed-tt",appendParentCls:"_chat_body_wrap",dir:"down",noZIndex:!0,shift:[12,8],hasover:!0,force:!0})}function wt(e){return(0,d.geByClass1)("_im_peer_history",e)}function Ct(e,t){const s=t.contHeight(),a=e.scrollTop+(s-e.contHeight);t.scrollTop(a)}function yt(e,t,s,a,i,o,r,l,_,u=!0,g=!1){let m=(t.get().tabs||{})[s];i().hideError(),o.renderPeer(t),l.renderPeer(t),_.render(t);const h=(0,v.isCasperChat)(t,s);if((0,d.toggleClass)(e,"im-page--history_casper",h),!t.get().tabHistoryNotChanged){o.reRenderTitle(t),ft(e,t,s);const r=(0,n.strHistory)(m.history);if(r){const t=(0,d.geByClass1)("_im_peer_history",e);(0,d.val)(t,r)}else i().showEmptyScreen();(0,c.getAudioPlayer)().isPlaying()&&(0,c.getAudioPlayer)().updateCurrentPlaying(),Wt(t,a,e)}if((0,n.isSearchingInplace)(s,t.get())?i().showSearch(t):i().cancelSearch(t,!1),r.changePeer(s,t),t.get().msgid)Lt(a,e,t.get().msgid,t);else if(m.scrollBottom&&u){Ct(m,a);const[s]=(0,p.isMessagesVisible)(t,e,a);m.skipped||setTimeout((()=>{m.unread&&!s&&(Bt(t,e,!0),Rt(t,e,!0)),St(t,a,e),Mt(t,a,e)}),100)}else kt(a,e,i,t,g)||a.scrollBottom(ve);Ft(t,e),(0,X.initWidgets)(e)}function Et(e,t,s=!1){const a=s||t.scrollTop(),i=t.scrollBottom(),o=t.contHeight(),r=e.get().peer;e.set(n.saveHistoryScroll.bind(null,r,a,i,o))}function St(e,t,s){const a=(0,v.isGoToMentionVisible)(e),n=(0,v.isGoToEndVisible)(e),i=t.getScrollHeight()/4,o=t.scrollTop()>0;t.scrollBottom()>i&&(!n||a)&&o&&Bt(e,s,!0,Ie)}function Mt(e,t,s){if(!ct(e))return;const a=t.getScrollHeight()/4,n=t.scrollTop()>0,i=(0,v.isGoToMentionVisible)(e);t.scrollBottom()>a&&!i&&n&&Rt(e,s,!0,Ie)}function It(e,t,s,a,i,o,r,l,c=!0){if(!e.get().history_init&&(e.get().history_init=!0,l.scrollTop()>0))return;if(w.screenfull.isFullscreen)return;i.update(l),i.show();const _=e.get().peer;if(0===_||!(0,p.isFullyLoadedTab)(e.get(),_))return;if(F.default.onHistoryScroll(l.scrollTop()),layers.visible)return;const u=(0,v.getTab)(e,_);u&&!u.skipped&&l.scrollBottom()>Ie?(St(e,l,o),Mt(e,l,o)):u.skipped||u.unread||(Xt(e,o),Jt(e,o));let g=(0,p.wrapLoading)(s);if(!(0,n.isSearchingInplace)(_,e.get())&&c&&a(l),!ot&&(r<0||0===l.scrollBottom())&&l.scrollBottom()<he){if((0,n.isSearchingInplace)(_,e.get()))return;if(u.skipped>0&&!e.get().no_moving_down){const s=(0,d.gpeByClass)("_im_page_history",o),a=e.get();ot=!0;let i=e.set(n.loadLessHistory).then(t().loadHistory.bind(null,a.peer,{reversed:!0})).then((()=>{t().updateObserver(),ot=!1,Bt(e,s),Rt(e,s),u.skipped||e.set(n.changePeer.bind(null,e.get().peer,!1,!1))}));return Gt(s,!0),void i.then(Gt.bind(null,s,!1))}}if(!ot&&l.scrollTop()<he){if((0,n.isSearchingInplace)(_,e.get())){ot=!0;let s=t().getSearchResulstModule();return s.isAll(e)?void(ot=!1):void g(s.loadMore(e).then((s=>{ot=!1,s&&(t().loadHistory(e.get().peer,{},e,s),a(l))})),"up")}let s=e.get();u.allShown||(ot=!0,g(e.set(n.loadMoreHistory.bind(null,0,0)).then(t().loadHistory.bind(null,s.peer,{})).then((()=>{ot=!1,a(l)})),"up"))}r<0&&os(e,_,l.scrollBottom(),o,t),(0,C.videoAutoPlayHandler)()}function Tt(e,t){return window.curNotifier&&curNotifier.idle_manager&&curNotifier.idle_manager.is_idle?Promise.resolve():e.set(n.readTillSpecificMessage.bind(null,t,e.get().peer))}function kt(e,t,s,a,n){const i=(0,d.geByClass1)("_im_unread_bar_row",t);if(i){let o=a.get(),r=o.peer,l=i.getBoundingClientRect(),c=(0,d.geByClass1)("_im_chat_body_abs",t).getBoundingClientRect().top+20;(0,p.isClassicInterface)(a)&&(c+=Se+(_t(o,r)?ut(a):0));const _=e.scrollTop()-c+l.top;return e.scrollTop(_),Et(a,e,_),setTimeout((()=>{r===a.get().peer&&It(a,s,wt(t),(function(){}),n,t,0,e)}),80),s().updateObserver(),!0}return!1}function Lt(e,t,s,a,n=Ze){const i=pt(t,s);if(i){const s=(0,p.isClassicInterface)(a),o=a.get().peer,r=s?(0,d.clientHeight)():(0,d.geByClass1)("_im_chat_body_abs",t).offsetHeight;let l=i.offsetTop+(0,d.domPN)(i).offsetTop+(0,d.domPN)((0,d.domPN)(i)).offsetTop+(0,d.domPN)((0,d.domPN)((0,d.domPN)(i))).offsetTop;s&&_t(a,o)&&(l-=ut(a)),n===Ze?e.scrollTop(l-e.getScrollHeight()/2+r/2):e.scrollTop(l-e.getScrollHeight()+r/4),(0,d.addClass)(i,"im-mess_light"),setTimeout((()=>{(0,d.removeClass)(i,"im-mess_light")}),be)}}function At(e,t,s){s.updateLastSeen(e)}function Pt(e,t,s,a,i,o){const r=(0,d.domData)(o,"action"),l=(0,d.domData)(o,"msgid"),c=(0,d.geByClass1)("_im_mess_marker",pt(s,l)),u=Number(l)>0?"edit":"send",g=e.get().peer,m=wt(s);switch(r){case"resend":(0,_.statlogsSendingRetry)("retry",u),t(i,o);break;case"resend_all":(0,_.statlogsSendingRetry)("retry",u),a().resendPeer();break;case"delete":(0,_.statlogsSendingRetry)("delete",u),e.set((t=>(0,n.removeFailed)(e,m,g,l,t)));break;case"delete_all":(0,_.statlogsSendingRetry)("delete",u),e.set((t=>(0,n.removeFailed)(e,m,g,void 0,t)))}tooltips.hide(c,{fasthide:!0})}function xt(){const e=(0,ee.showBox)("al_im.php",{act:"a_business_notify_info_content"},{title:!1,onDone:()=>{const t=()=>e.hide();document.querySelectorAll("._im_business_notify_info_box_hide").forEach((e=>e.addEventListener("click",t))),e.setOptions({hideButtons:!0})}})}function Bt(e,t,s,a=0){const i=e.get().peer;if(pe.Ranges.isZeroOwner(i))return;const o=e.get().tabs[i],r=(t||document).querySelector(Te);let l=!1;(s||o.skipped>0||o.unread>0)&&!(0,n.isSearchingInplace)(i,e.get())?(l=!0,Nt(t,e),(0,d.addClass)(r,"im-navigation_shown")):Qt(r,!0),e.set(n.updateGoToEndVisibility.bind(null,[l,+a]))}function Rt(e,t,s,a=0){if(!ct(e))return!1;const i=e.get().peer;if(pe.Ranges.isZeroOwner(i))return;const o=e.get().tabs[i],{mentions:r=[],mention_cmids:l=[]}=o,c=(t||document).querySelector(ke),_=(0,Y.partConfigEnabled)("me_web_read_by_cmid")?l.length:r.length;let u=!1;o.unread>0&&_>0&&!(0,n.isSearchingInplace)(i,e.get())?(u=!0,function(e,t,s){const a=(e||document).querySelector(ke),n=a.querySelector("._im_to_mention_label");n.innerHTML=s>0?(0,Z.formatCount)(s):""}(t,0,_),(0,d.addClass)(c,"im-navigation_shown")):Qt(c,!0),e.set(n.updateGoToMentionVisibility.bind(null,[u,+a]))}function Dt(e){Qt((e||document).querySelector(Le),!0)}function Ot(e,t){if(!(0,v.isGoToReactionAvailable)(e))return;const s=(0,g.getPeer)(e),a=(0,g.getUnreadReactions)(e,s).size,i=(t||document).querySelector(Le);i&&a&&!(0,n.isSearchingInplace)(s,e.get())?(!function(e,t){const s=e.querySelector("._im_to_reaction_label");s&&(s.innerHTML=t?(0,Z.formatCount)(t):"")}(i,a),(0,d.addClass)(i,"im-navigation_shown")):Dt(t)}function Ft(e,t){e.set((e=>(0,n.updateGoToReactionAvailability)(!0,e))),Ot(e,t)}function Nt(e,t){const s=t.get().peer,a=(0,v.getTab)(t,s);(e||document).querySelector(Te).querySelector("._im_to_end_label").innerHTML=Number(a.unread)>0?(0,Z.formatCount)(a.unread):""}function Ut(e,t=0){if(0===e.scrollTop()&&0===e.scrollBottom())return!1;return e.scrollBottom()<(t?fe+t:fe)}function Ht(e,t,s,a,n){let i=(0,d.domData)(n,"msgid"),o=e.get().peer,r=(0,v.getMessage)(e,o,i);r.type===R.EDIT_MESSAGE?(s().sendEditMessage(e,r),s().resendMessage(o,i)):e.get().imQueueResend(o,i).then((t=>{e.get().longpoll.push([(0,D.resendEvent)(o,t.mess)])}))}function jt(e,t,s,a,i,o){let r=(0,Z.intval)((0,d.domData)(o,"peer")),l=(0,Z.intval)((0,d.domData)((0,d.gpeByClass)("_im_mess",o),"msgid"));const c=(0,v.getTab)(e,r);return e.set(n.restoreMessage.bind(null,l,r)).then(p.restoreMessage.bind(null,l,r,wt(t))).then((()=>Wt(e,s,t))),(0,n.restoreMessageSend)(l,r,c.hash,e.get().gid).then((()=>{l>c.lastmsg&&(0,n.loadActualLastMessage)(e,r).then((()=>a().updateState(r,e)))})),!1}function qt(e,t){if(e){const s=e.querySelector(Te);(0,d.toggleClass)(s,"im-navigation_loading",t)}}function Gt(e,t){if(e){const s=e.querySelector(Te);(0,d.toggleClass)(s,"im-navigation_loading",t)}}function Vt(e,t,s,a){const i=t.get().peer,o=(0,v.getTab)(t,i);if(!(0,p.isFullyLoadedTab)(t,i))return;const r=Object.keys(o.msgs).find((e=>{const t=o.msgs[e];return!Array.isArray(t)&&(0,b.isUnread)(o,t)}));if(!o.skipped)return r?Lt(a,s,r,t):a.scrollBottom(ve),Bt(t,s),Rt(t,s),os(t,i,0,s,e),void(0,n.readTillSpecificMessage)(o.lastmsg,i,t.get());qt(s,!0),t.set((e=>(0,de.loadPeer)(e,i,-1,!0,!1,"goToEnd"))).then((()=>{qt(s,!1),e().changePeer(t,!1,!1)}))}function Kt(e,t,s,a){var n;const i=t.get().peer,o=(0,v.getTab)(t,i),{mentions:r=[],mention_cmids:l=[]}=o,c=(0,Y.partConfigEnabled)("me_web_read_by_cmid")?l[0]:r[0],d=(0,Y.partConfigEnabled)("me_web_read_by_cmid")&&c?null==(n=(0,ae.getMessageByCmid)(t,i,c))?void 0:n.messageId:c;if(!o.skipped)return d&&Lt(a,s,d,t,We),Bt(t,s,!0),Rt(t,s),Tt(t,d),void os(t,i,0,s,e);qt(s,!0),t.set((e=>(0,de.loadPeer)(e,i,d,!0,!1,"goToMention"))).then((()=>{qt(s,!1),e().changePeer(t,!1,!1),i===t.get().peer&&(Lt(a,s,d,t,We),Tt(t,d))}))}function zt(e,t,s){return Zt.apply(this,arguments)}function Zt(){return(Zt=(0,a._)((function*(e,t,s){const a=(0,g.getPeer)(e),n=(0,g.getGroupId)(e),i=Math.min(...Array.from((0,g.getUnreadReactions)(e,a)));if(!i)return;const o=(t||document).querySelector(Le);null==o||o.setAttribute("disabled","");const r=yield function(e,t,s,a){var n;let i=null==(n=(0,ae.getMessageByCmid)(e,t,a))?void 0:n.messageId;if(i)return Promise.resolve(i);const o=(0,g.getTabCmidToMessageIdMap)(e,t).get(a);return o?Promise.resolve(o):e.set((e=>(0,re.updateCmidToMessageIdMap)(e,t,s,a))).then((e=>(0,g.getTabCmidToMessageIdMap)(e,t).get(a)))}(e,a,n,i);null==o||o.removeAttribute("disabled"),r&&(0,p.focusOnMessage)(e,(()=>Lt(s,t,r,e)),a,r)}))).apply(this,arguments)}function Wt(e,t,s,a=!1){if((0,p.isClassicInterface)(e)){let e=t.contHeight(),n=(0,d.geByClass1)("_im_chat_input_w",s),i=(0,d.geByClass1)("im-chat-input",s),o=(0,d.geByClass1)("_im_chat_resize",s),r=(0,d.geByClass1)("EmptyDialogStickers",s);if(!1!==(a=!1!==a?a:(0,p.getClassicChatHeight)())&&a>0){const e=(0,d.clientHeight)();let t=(0,d.geByClass1)("_im_chat_audio_input_parent",s),i=gt(a,s,e),r=i-((0,d.hasClass)(t,Ue)||(0,d.hasClass)(t,Ne)?t:(0,d.geByClass1)("_im_chat_input_parent",s)).offsetHeight;o.style.height=e-i-Me+"px",(0,d.setStyle)(n,{top:r+"px",bottom:"auto"})}else o.style.height="0px",(0,d.setStyle)(n,{top:"auto",bottom:"0px"});let l=(0,d.geByClass1)("_im_peer_history_w",s),c=i.offsetHeight-Ce,_=n.offsetHeight-ye;return(0,d.setStyle)(l,{borderBottomWidth:r?c:_}),t.contHeight()-e}let n=t.getScrollHeight();return t.update(!1,!0),n-t.getScrollHeight()}function $t(e,t,s,a){let n=t.offsetHeight;a(),e.heightIncreased(t.offsetHeight-n,s)}function Yt(e,t){let s=t.getBoundingClientRect().top;(0,z.showTooltip)(t,{className:"im-page--admin-tt",text:oe.getLang("mail_only_admin_see"),appendParentCls:"_chat_body_wrap",shift:[20,5],dir:"auto",showdt:400,noZIndex:!0,toup:s>200})}function Qt(e,t=!1){(0,d.hasClass)(e,"im-navigation_shown")&&(t&&(0,d.addClass)(e,"im-navigation_fast"),(0,d.removeClass)(e,"im-navigation_shown"),t&&(e.offsetHeight,(0,d.removeClass)(e,"im-navigation_fast")))}function Xt(e,t,s=!1){const a=t.querySelector(Te);e.set(n.updateGoToEndVisibility.bind(null,[!1,0])),Qt(a,s)}function Jt(e,t,s=!1){const a=t.querySelector(ke);e.set(n.updateGoToMentionVisibility.bind(null,[!1,0])),Qt(a,s)}function es(e,t,s){w.screenfull.isFullscreen||0===t.get().peer||(0,p.isClassicInterface)(t)||e().restoreScroll(t,t.get().peer)}function ts(e,t){const s=e.get(),a=s.peer,i=(0,d.domClosest)(He,t.target),o=(0,Z.intval)((0,d.domData)(i,"msgid")),r=(0,v.getMessage)(e,a,o),l=r&&(0,b.isServiceMsg)(r)&&r.kludges.source_act;if(l!==p.CHAT_PIN_MESSAGE&&l!==p.CHAT_UNPIN_MESSAGE)return;const c=i.querySelector("."+je);if(c&&"A"!==c.tagName){const e=r.kludges.source_chat_local_id;if(!e||rt[e])return;rt[e]=(0,n.getMessageLocalId)(a,e,s).then((([t])=>{if(t){const s=`/im?sel=${(0,p.convertPeerToUrl)(a)}&msgid=${t}`,n=c.innerHTML;(0,d.domReplaceEl)(c,(0,_e.getServiceLinkTemplate)(s,n,!0,je)),delete rt[e]}}))}}function ss(e,t,s){const a=e.get(),n=a.peer,i=s.target.href&&s.target.href.match(/msgid=([\d]+)/),o=i&&i[1];if("A"===s.target.tagName&&o&&!(0,p.isAlreadyDeleted)(e,n,o)&&!(0,l.checkEvent)(s)){(0,v.getMessage)(e,n,o)?(e.setState({msgid:o}),(0,N.updateLocation)({msgid:o}),t().focusOnMessage()):a.longpoll.push([(0,D.changePeer)(n,o,!1,!1,a.currentEntryPoint||"")])}(0,l.cancelEvent)(s)}function as(e){let t=(0,m.getCurrentTab)(e);pe.Ranges.isChatOrChannelPeer(t.peerId)&&(t.pinHideId=cur.imDb.select(U.PIN_HIDDEN_ID_OP,t.peerId))}function ns(e,t,s,a,n){e.setState({isEditing:!1}),(0,d.removeClass)(a,"im-mess_is_editing"),(0,d.removeClass)((0,d.geByClass1)("_im_page_history"),"is_msg_editing"),(0,o.cancelStackFilter)("cancel_edit"),s.setDraft(e,(0,g.getPeer)(e)?(0,v.getTabDraft)((0,m.getCurrentTab)(e)):null),s.toggleStickers(e,!0),s.restoreKeyboard(),is(t)}function is(e){(0,f.toArray)((0,d.geByClass)("_im_history_tooltip",e)).forEach((e=>(0,d.hide)(e)))}function os(e,t,s,a,i){let o=(0,v.getTab)(e,t);if(!(Date.now()-(o.lastReset||0)<1e3)&&o&&o.msgs&&o.history&&!ot&&o.offset>300&&0==o.skipped&&s<50&&s>=0&&0===(e.get().selectedMessages||[]).length){let s=Object.keys(o.msgs).filter((e=>e>0)).sort(((e,t)=>e-t)).slice(0,-50);const a=s.slice(-1)[0];e.mutate(n.resetTabAll.bind(null,t)),e.set(n.removeMessages.bind(null,s,t)).then((()=>i().removeStartingFromMessage(a,t,e)))}}function rs(e,t,s,a){const n=a.target,i=(0,d.domClosest)(Ve,n),o=Number(i.getAttribute("data-msgid")),r=(0,d.domClosest)("im-mess",n),l=Number(r.getAttribute("data-msgid")),c=e.get().peer;o&&!(0,p.isAlreadyDeleted)(e,c,o)?(e.setState({msgid:o}),(0,N.updateLocation)({msgid:o}),(0,p.focusOnMessage)(e,t().focusOnMessage,c,o)):l&&(0,p.showRepliedBox)(e,l,a)}function ls(e){(0,l.checkEvent)(e)||(0,l.cancelEvent)(e)}const cs=new Map;function ds(e,t){const s=t.closest(`.${p.AUDIO_MSG_CLASS}`),a=s.querySelector("._msg_asr_empty"),n=t.closest(`.${Ge}`),i=s.id.replace("audmsg",""),o=!!s.closest(".im-mess_fwd"),r=Boolean(s.dataset.asr_done),l=o?0:Number(null==n?void 0:n.dataset.msgid),c=!s.classList.contains(nt),d=Number(null==n?void 0:n.dataset.peer)||void 0,_=Number(null==n?void 0:n.dataset.msgid),u=d&&(0,ae.getMessage)(e,d,_),g=Number(null==n?void 0:n.dataset.cmid)||(null==u?void 0:u.chat_local_id),m="audio_message"+i;if(c){const e=(cs.get(s.id)||0)+1;cs.set(s.id,e),r||((0,ue.recogniseAudioMessage)(l,i),g&&d&&(0,Q.collectVoiceStat)("transcript_loading",d,g,m)),e%3==0&&a?a.innerHTML=function(){var e;const t=oe.getLang("me_voice_asr_status_empty_set").split("|");return null==(e=t[Math.floor(Math.random()*t.length)])?void 0:e.trim()}():a&&(a.innerHTML=oe.getLang("me_voice_asr_status_empty"))}c&&!o&&(0,ge.markAudioMessageAsListened)(e,_,d).catch((()=>{})),g&&d&&(0,Q.collectVoiceStat)("transcript_toggle",d,g,m,c,"user"),s.classList.toggle(nt),window.tooltips&&tooltips.destroy(t,{fasthide:!0});if(!t.closest(".audio-msg-player"))return;s.querySelector(".audio-msg-track_player-attached .audio-msg-track--transcriptToggle").classList.toggle("audio-msg-track--transcript_on",t.classList.contains("audio-msg-track--transcript_on"))}function _s(e,t){function s(t,s){const a=s.closest(`.${Ge}`);if(!a)return;const n=s.id.replace("audiomsgpl_","audio_message"),i=Number(a.dataset.peer),o=Number(a.dataset.msgid);if(!i||!o)return;const r=(0,ae.getMessage)(e,i,o),l=Number(a.dataset.cmid)||(null==r?void 0:r.chat_local_id);switch(t){case"playing":(0,Q.collectVoiceStat)("play",i,l,n);break;case"paused":(0,Q.collectVoiceStat)("pause",i,l,n);break;case"finished":(0,Q.collectVoiceStat)("finish",i,l,n)}}window.AudioMessagePlayer.events.on("listened",(s=>function(e,t,s){const a=t.closest(`.${Ge}`),n=t.closest(".im_fwd_log_wrap");if(!a||n)return;const i=Number(a.dataset.msgid),o=Number(a.dataset.peer);i&&o&&(0,ge.markAudioMessageAsListened)((0,f.unpackStore)(e),i,o).then((()=>{s.markMessageAsListened(e,o,i)})).catch((()=>{}))}(e,s,t()))),window.AudioMessagePlayer.events.on("transcription_toggle",(t=>ds(e,t))),window.AudioMessagePlayer.events.on("playing",(e=>{s("playing",e)})),window.AudioMessagePlayer.events.on("paused",(e=>{s("paused",e)})),window.AudioMessagePlayer.events.on("finished",(e=>{s("finished",e)}))}function us(e){const t=e.target.closest(`.${at}`),s=e.target.closest(`.${p.AUDIO_MSG_CLASS}`);(0,z.showTooltip)(t,{text:s.classList.contains(nt)?oe.getLang("me_voice_asr_toggle_close"):oe.getLang("me_voice_asr_toggle_open"),className:"_im_history_tooltip",appendParentCls:"_im_mess_stack",black:1,shift:[6,12],showdt:400,onHide(){window.tooltips&&tooltips.destroy(t,{fasthide:!0})}})}function gs(e,t,s){const a=s.target.closest("."+p.MESSAGE_KEYBOARD_BUTTON_CLASS),n=s.target.closest("."+p.MESSAGE_STACK_CLASS);if(a){const i=e.sendMessageFromKeyboard.bind(null,(()=>e)),o=(0,h.getActionObjectFromElement)(a),r=n?n.dataset.peer:void 0,l=s.target.closest("."+Ge),c=(0,m.getCurrentTab)(t);if(!l||!c)return;const d=Number(l.dataset.msgid),_=(0,v.parserMessage)(d?c.msgs[d]:c.pinned);if(!_)return;return(0,h.handleButtonClick)(o,i,t,{keyboardAuthorId:r,peerId:_.peerId,message:_,onBeforeSend:()=>{(0,p.setCallbackButtonLoadingState)(a,!0)},onSendSuccess:e=>{const s={timeout:setTimeout((()=>{t.set((t=>(0,ne.unsetPressedCallbackButton)({peerId:_.peerId,eventId:e},t))).then((()=>(0,p.setCallbackButtonLoadingState)(a,!1)))}),h.CALLBACK_TIMEOUT_MS),onCallback:()=>{const e=Number(a.dataset.index);let t;document.contains(a)?t=a:isNaN(e)||(t=(0,p.getCallbackButton)(document,Number(_.messageId),e)),t&&(0,p.setCallbackButtonLoadingState)(t,!1)}};t.set((t=>(0,ne.setPressedCallbackButton)({peerId:_.peerId,eventId:e},s,t)))},onSendFail:e=>{e.error_msg&&(0,h.handleShowSnackbar)({peerId:_.peerId,store:t,text:e.error_msg}),(0,p.setCallbackButtonLoadingState)(a,!1)}})}}function ms(e,t){const s=t.target.closest("."+Ye),a=s.closest("."+Qe),n=s.dataset.type,i=s.dataset.participants,o=i&&i.split(",").reduce(((t,s)=>(+s!==e.get().id&&pe.Ranges.isUserIdTransitional(+s)&&t.push(+s),t)),[]),r=+a.dataset.peer;(0,p.isCallToPeerAvailable)(e,r)&&(0,p.startCallFromIm)(e,r,"video"===n,o,p.CALL_ENTRY_POINT_SNIPPET)}function ps(e,t,s){const a=s.target.closest("."+et);(0,p.updateMessageEditableStatus)(e,e.get().peer,t,a)}function hs(e,t,s,a,r,l,c,_,h,w,C,E,S,M,T,k,L,A,P,x){let B;const R=(0,f.throttle)((function(...e){s.smoothScroll(...e)}),300);return{fixKeyboard(){r.fixKeyboard()},removeUnpinnedMessageEditable(e,s){const a=t.querySelector(`.${et}:not(._im_mess_${s}`);a&&(a.classList.remove(et),(0,p.updateMessageEditableStatus)(e,e.get().peer,t,a))},changePeer(e,n=!0,o=!0){const c=e.get().peer;var f;if((0,i.revertLastInlineVideo)(t),h.hideReactionsPanel(),0===c)return null==(f=window.StickerPickerViewer)||f.destroy(),T.disable(),r.setDraft(e,null),(0,Y.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,me.loadMarusiaSdk)().then((e=>{e&&(e.stopListening(),e.hide())})),function(e){(0,d.addClass)(e,"im-page--history_empty"),wt(e).innerHTML=""}(t);if(!(0,p.isFullyLoadedTab)(e.get(),e.get().peer))return;(0,d.removeClass)(t,"im-page--history_search"),a.deselectAll(e),a.changeActions(e),a.showActions(e);const b=e.get().prevPeer;(0,d.removeClass)(t,"im-page--history_loading"),(0,d.toggleClass)(t,"im-page--history_vkcomgroup",(0,p.isFvkcomgroup)(e,c)),n?r.setDraft(e,(0,v.getTabDraft)((0,m.getCurrentTab)(e))):r.updateState(e),Bt(e,t),Rt(e,t),this.updateGoToReactionsButton(e,t),l().updateTyping(c,e),At(e,0,a),pe.Ranges.isZeroOwner(b)&&!pe.Ranges.isZeroOwner(c)?function(e,t,s,a,n,i,o,r,l,c,_){(0,d.removeClass)(e,"im-page--history_empty"),yt(e,t,s,a,n,i,o,r,l,c,_)}(t,e,c,s,l,a,_,k,A,o,T):pe.Ranges.isZeroOwner(b)||pe.Ranges.isZeroOwner(c)||yt(t,e,c,s,l,a,_,k,A,o,T),(0,v.isCasperChat)(e,c)||(T.enable(),T.toggle(!0),T.reset(s)),pe.Ranges.isZeroOwner(c)||setTimeout((()=>{It(e,l,wt(t),S,T,t,0,s)})),(0,ce.ensureDomHasActions)(t),(0,g.getPeer)(e)===u.VK_OFFICIAL_PEER_ID&&(0,Q.collectOnboardingFindFriendsShowStats)(e.get().viewer_id),r.updateMediaSelectorOptions(e),window.IM&&window.IM.updateHints(c)},preparePeer(e){const s=(0,g.getPeer)(e);as(e),r.setDraft(e,(0,v.getTabDraft)((0,v.getTab)(e,s)),!1),l().updateTyping(s,e),l().hideError(),a.renderPeer(e),k.renderPeer(e),a.hideActions(e),_.changePeer(s,e),At(e,0,a),T.toggle(!1),Xt(e,t,!0),Jt(e,t,!0),function(e,t){e.set((e=>(0,n.updateGoToReactionAvailability)(!1,e))),Dt(t)}(e,t)},saveScroll:e=>Et(e,s),loadingPeer(e){(0,n.isAnythingLoading)(e.get())||((0,d.removeClass)(t,"im-page--history_empty"),(0,d.addClass)(t,"im-page--history_loading"))},stopLoading(e){(0,d.removeClass)(t,"im-page--history_loading")},deselectDialog(e){c().removeSelection(e)},replaceMessageAttrs(e,s){(0,p.replaceMessageAttrs)(s.get(),wt(t),e),x.update()},cleanSelection(e){w.cleanSelection(e)},updateDialogFilters(e,t){c().updateDialogFilters(e,t)},getSearchResulstModule:()=>B,showSearchResults(e){e?((0,d.removeClass)(t,"im-page--history_search-empty"),wt(t).innerHTML=e):((0,d.addClass)(t,"im-page--history_search-empty"),wt(t).innerHTML=(0,p.renderEmptySearch)())},insertSearch(e,n){B||(a.deselectAll(n),B=(0,I.mount)(t,n,"message_search")),(0,d.addClass)(t,"im-page--history_search"),l().showSearchResults(e),Wt(n,s,t),s.scrollBottom(0),Bt(n,t),Rt(n,t),this.updateGoToReactionsButton(n,t),T.reset(s)},updateChatTopic(e,t){c().updateDialog(e,t),e===t.get().peer&&(a.renderPeer(t),a.renderActions(t),k.renderPeer(t))},updateActions(e){a.changeActions(e)},updateChatPhoto(e,n,i){if((0,p.isPeerActive)(e.peerId,i.get())){a.renderPeer(i),k.renderPeer(i);let o=Ut(s);(0,p.addChatPhotoToUpdate)(e,n,i.get(),wt(t)),o&&s.scrollBottom(ve)}},markImportant(e,s,n){pt(t,e)&&(a.changedMessageSelection(n),h.markImportant(e,s,n))},isNewMessagesVisible:e=>function(e,t){return(0,v.getUnreadScrollBottom)(e)>=(0,Z.intval)(t.scrollBottom())}(e,s),loadHistory(e,a,n,i=!1){let o=n.get();if((0,p.isPeerActive)(e,o)){let n=i||o.tabs[e].historyToAppend;if(!n)return;let r=(0,d.geByClass1)("_im_peer_history",t),l=(0,d.domFC)(r),c=s.scrollBottom(),_=a.reversed?e=>r.appendChild(e):e=>r.insertBefore(e,l),u=0;a.reversed&&(u=r.offsetHeight);const g=(0,d.sech)(n),m=document.createDocumentFragment();g.forEach((e=>m.appendChild(e))),_(m),(0,X.initWidgets)(t),a.reversed&&T.heightIncreased(r.offsetHeight-u,s),a.reversed||s.scrollBottomFixSave(c),s.update(!1,!0);const p=g.filter((e=>(0,d.hasClass)(e,"_im_bar_date")));T.parseMore(p,s),(0,ce.ensureDomHasActions)(t),x.update()}},sendMessage(e){0!==e.get().peer&&r.sendMessage()},editMessage(e,n){if((0,p.isFullyLoadedTab)(e,n.peerId)&&(0,p.isPeerActive)(n.peerId,e.get())){if(!pt(t,n.messageId))return;Et(e,s),(0,p.editAndReplaceMessage)(e.get(),n,t),Ct((0,v.getTab)(e,n.peerId),s),a.reRenderPinned(e),T.reset(s),x.update()}},updateMessageReactions(e,s,a){(0,p.replaceMessageReactions)(t,s,a,e)},addMessage(e,a){if(!(0,n.isSearchingInplace)(a.peerId,e.get())&&(0,p.isFullyLoadedTab)(e,a.peerId)&&(0,p.isPeerActive)(a.peerId,e.get())){if(pt(t,a.messageId))return;const i=wt(t);$t(T,i,s,(()=>{const n=Ut(s),o=(0,d.geByClass1)("_im_unread_bar_row",t),[r,c]=(0,p.isMessagesVisible)(e,t,s);(0,ce.appendMessageToHistory)(e.get(),a,i,!0,!r&&!o),(0,d.removeClass)(t,"im-page--history_empty-hist");const _=(0,v.getTab)(e,e.get().peer),u=(0,b.isServiceMsg)(a)&&a.userId===vk.id,g=a.kludges&&a.kludges.source_act,m=u&&g!==p.CHAT_PIN_MESSAGE&&g!==p.CHAT_UNPIN_MESSAGE;_.skipped||r||!(0,b.isUnread)(_,a)||(0,b.isOut)(a)||(Bt(e,t,!0,c),Rt(e,t,0,c)),(a.local||n||m)&&(lt=!0,s.scrollBottom(0)),l().updateTyping(a.peerId,e),Nt(t,e),is(t)}));let o=(0,d.domPS)((0,d.domLC)(i));if((0,d.hasClass)(o,"_im_bar_date")){let e=(0,d.ce)("div");e.innerHTML=o.outerHTML,T.parseMore(e,s)}l().hideError(),T.update(s),(0,n.updateMentions)(e.get()),os(e,a.peerId,s.scrollBottom(),0,l),this.updateObserver()}},setMessageErrored(e,s,a,n){a&&"string"==typeof a&&l().showError(a),(0,p.setMessageError)(e,s,t)},markMessagesAsRead(e,s){e.get().peer===s.peerId&&(0,p.markMessagesAsRead)(e.get(),s.peerId,t)},markMessageAsListened(e,s,a){(0,g.getPeer)(e)===s&&(0,p.updateListenedMark)(t,a)},compensateHistoryHeightChange(e){s.scrollTop(s.scrollTop()+e*ut(E))},updateTyping(e,s){if((0,n.isSearchingInplace)(e,s.get()))return;const a=s.get();if(a.peer!==e||!(0,p.isFullyLoadedTab)(a,e))return;let i=(0,p.formatTyper)((0,v.getTab)(s,e).activity,e,!1,a),o=(0,d.geByClass1)(p.TYPING_CLASS,t);if(!o&&!i)return;if(!o){let e=(0,d.geByClass1)(Be,t);(0,d.val)(e,(0,Z.getTemplate)("im_typing",{cls:(0,p.isClassicInterface)(s)?"im-activity_classic":""})),o=(0,d.geByClass1)(p.TYPING_CLASS,t)}(0,d.val)((0,d.geByClass1)("_im_typing_name",o),i);const r=(0,p.loadSummaryActivityType)((0,v.getTab)(s,e).activity||{})===n.ACTIVITY_TYPE_RECORDING_AUDIO;o.setAttribute("data-activity-type",r?"recording":"typing"),i?((0,d.addClass)(o,"im-page--typing_vis"),l().hideError()):(0,d.removeClass)(o,"im-page--typing_vis")},scrollFix(e,t,a){T.heightIncreased(a,s),T.update(s),(0,p.isPeerActive)(t,e.get())&&Ut(s,a)&&s.scrollBottom(ve)},scrollBottom(){s.scrollBottom(ve)},goToEnd(){Vt((()=>this),E,t,s)},updateGoToEnd(e,a){const n=(0,v.getTab)(e,e.get().peer);n&&(n.skipped||n.unread)?Bt(e,t):Xt(e,t,a),C(0,s,!1);const i=e.get().peer;setTimeout((()=>{e.get().peer===i&&Et(e,s)}))},updateGoToMention(e,a){const n=(0,v.getTab)(e,e.get().peer),{mentions:i=[],mention_cmids:o=[]}=n||{},r=(0,Y.partConfigEnabled)("me_web_read_by_cmid")?o[0]:i[0];n&&r?Rt(e,t):Jt(e,t,a),C(0,s,!1);const l=e.get().peer;setTimeout((()=>{e.get().peer===l&&Et(e,s)}))},newMessage(e){c().newMessage(e),Xt(e,t,!0),Jt(e,t,!0)},scroll(e,t,a=!1,n=!1){if(0===e.get().peer)return;let i=a?s.getScrollHeight():40;!0===n&&(i=s.contHeight()),i="up"===t?-i:i,a||n?R(i,(()=>{C(i,s)})):(s.scrollTop(s.scrollTop()+i),C(i,s))},showCreation(e,t){c().showCreation(e,t)},updateScroll:()=>Wt(E,s,t),toggleBarDate(e){T.toggle(e)},changedMessageSelection(e){a.changedMessageSelection(e)},updateOnline(e,t){(0,p.isTabLoaded)(t.get(),e)&&e===t.get().peer&&a.renderPeer(t)},isEmpty:e=>r.isEmpty(e),replaceAttachmentPlaceholders(e,n){if((0,p.isPeerActive)(n.peerId,e.get()))$t(T,wt(t),s,(()=>{let i=Ut(s);(0,p.replaceAttaches)(t,n,e.get());let o=(0,v.getTab)(e,n.peerId);if(o.mediacontent[n.messageId].length>=3&&o.mediacontent[n.messageId][2].pinned){let t=(0,v.parserMessage)(o.pinned);t&&t.messageId==n.messageId&&(o.pinned=o.mediacontent[n.messageId][2].pinned,a.reRenderPinned(e))}i&&s.scrollBottom(0)})),T.update(s);else if((0,b.isMoneyRequest)(n)){let t=(0,v.getTab)(e,n.peerId);if(t.mediacontent[n.messageId].length>=3&&t.mediacontent[n.messageId][2].pinned){let e=(0,v.parserMessage)(t.pinned);e&&e.messageId==n.messageId&&(t.pinned=t.mediacontent[n.messageId][2].pinned)}}},replaceBotCarouselPlaceholder(e,a){const n=e.get();(0,p.isPeerActive)(a.peerId,n)&&($t(T,wt(t),s,(()=>{let e=Ut(s);(0,p.replaceCarousel)(t,a,n),e&&s.scrollBottom(0)})),T.update(s))},removeMessages(e,n,i){i.get().peer===n&&((0,p.removeMessages)(e,wt(t)),(0,p.removeExpiredMessagesStub)(e,wt(t)),Wt(i,s,t),a.changedMessageSelection(i),this.updateObserver())},removeStartingFromMessage(e,n,i){if(i.get().peer===n){const n=wt(t);let o=(0,d.geByClass1)("_im_mess_"+e,n);(0,p.removeStartingFromMessage)(o,n),Wt(i,s,t),a.changedMessageSelection(i)}},hideGoToEnd(e){Xt(E,t,e)},hideGoToMention(e){Jt(E,t,e)},removeMessagesRestore(e,s,a,n){n.get().peer===s&&(0,p.removeMessagesWithRestore)(e,s,a,wt(t))},removeExpiredFailedMessages(e){E.get().peer===e&&E.set(n.removeExpiredFailed.bind(null,wt(t),e))},handleMessageExpiration(e){(0,p.isFullyLoadedTab)(E.get(),e.peerId)&&((0,p.replaceExpiredMessageWithPlaceholder)(E,t,e),(0,p.replaceExpiredRepliedMessageWithPlaceholder)(t,e),r.detachMessages(e))},updateState(e,t){c().updateState(e,t)},updateBanner(e){k.renderPeer(e)},updateHeader(e){a.renderPeer(e)},updateChat(e,t){e.get().peer===t&&(a.changeActions(e),a.renderPeer(e),a.renderActions(e),k.renderPeer(e),r.updateState(e),(0,n.updateMentions)(e.get()))},updateConvoInList(e,t){c().updateConvoInList(e,t)},focustTxt(e){r.focusOn(e)},startSearch(e){e.get().peer&&(l().showSearch(e),_.changePeer(e.get().peer,e),_.search())},showSearch(e){(0,d.addClass)(t,"im-page--hisory_search-open"),e.setState({searchShown:!0}),dt(e)&&this.updateChatTopic(e.get().peer,e),this.cancelEditing(),setTimeout((()=>_.focus(e)),10)},cancelSearch(e,i=!0){if(e.get().searchShown&&((0,d.removeClass)(t,"im-page--hisory_search-open"),(0,d.removeClass)(t,"im-page--history_search"),(0,d.removeClass)(t,"im-page--history_search-empty"),e.setState({searchShown:!1}),dt(e)&&this.updateChatTopic(e.get().peer,e),a.changedMessageSelection(e)),i&&!pe.Ranges.isZeroOwner(e.get().peer)&&B){let a=e.get().tabs[e.get().peer];const i=(0,n.strHistory)(a.history);i?wt(t).innerHTML=i:l().showEmptyScreen(),Wt(e,s,t),s.scrollBottom(0),e.get().msgid&&(Lt(s,t,e.get().msgid,e),Bt(e,t),Rt(e,t)),this.updateGoToReactionsButton(e,t),S(s),T.reset(s)}B&&(B.unmount(),B=!1,(0,ce.ensureDomHasActions)(t))},showEmptyScreen(){const e=(0,d.geByClass1)("_im_peer_history",t);(0,d.addClass)(t,"im-page--history_empty-hist");const s=(0,le.renderHistoryStub)(E);(0,d.val)(e,s)},updateHistory(e){0!==E.get().peer&&e(t)},focusOnMessage(){Lt(s,t,E.get().msgid,E)},sendEditMessage(e,t){e.set(n.deliverEditedMessage.bind(null,(0,v.getTab)(e,t.peerId),t)).catch((s=>e.get().longpoll.push([(0,D.failedMessage)(t.peerId,t,s)])))},renderStickersPanel(e){const s=(0,g.getPeer)(e),a=(0,v.getTab)(e,s);if(!a||a.block_error&&a.block_error>0)return;const i=(0,n.strHistory)(a.history||""),o=t.querySelector("._im_stickers_panel_placeholder");if(o&&!i){const t=(0,le.prepareEmptyDialogStickersTemplate)(e);if(!t)return;(0,d.domReplaceEl)(o,t)}},deselectAll(e){a.deselectAll(e)},unmount(){(0,y.destroyModule)(e),s.destroy(),clearInterval(M),r.unmount(),a.unmount(),h.unmount(),w.unmount(),_.unmount(),T.unmount(),(0,o.cancelStackFilter)("forward"),L.unmount(),null==P||P.unmount(),x.unmount(),function(e,t){(0,O.removeDraggable)((0,d.geByClass1)(e,t))}("_im_chat_resize_track",t),A.destroy()},removePeer(e,t){c().removePeer(e,t)},restoreScroll(e,t){const a=e.get().tabs[t];a.scrollBottom?Ct(a,s):s.scrollBottom(ve)},resendMessage(e,s){e===E.get().peer&&(0,p.startResendMessage)(e,s,t)},resendPeer(){r.resendPeer()},resendAll(){r.resendAll()},respond(e,t){r.attachMessages(e,t),r.focusOn(e);const a=(0,v.getTab)(e,t);a&&!a.skipped&&(s.scrollBottom(ve),S(s))},restoreDialogs(e,t,s){c().restoreDialogs(e,t,s)},cancelRecording(){r.cancelRecording()},flushDraft(e){r.saveText(e)},hideError(){(0,d.geByClass1)(Re,t).classList.remove(De)},showError(e){const a=(0,d.geByClass1)(Re,t);a.innerHTML=e,a.classList.add(De),s.scrollBottom(ve)},startEditing(e){if((0,n.isAnythingLoading)(E.get()))return void(0,p.showWaitUntilUploadedBox)();e=(0,v.parserMessage)(e);let s=(0,p.getNowEditingMessage)(E);if(r.isBlocked())return;if(s&&s.messageId==e.messageId)return;s&&this.cancelEditing(),is(t),E.get().searchShown&&this.cancelSearch(E);let i=pt(t,e.messageId);i&&(this.cancelRecording(),function(e,t,s,a,n){e.setState({isEditing:!0}),s.saveText(e),(0,d.addClass)(a,"im-mess_is_editing"),(0,d.addClass)((0,d.geByClass1)("_im_page_history"),"is_msg_editing"),(0,o.cancelStackPush)("cancel_edit",(()=>ns(e,t,s,a)));let i=new j.ImDraft;i.dData.txt=(0,H.convertEmojiHtmlToRegularText)(n.text),i.dData.attaches=(0,q.convertKludgesToAttaches)(n.kludges,n.messageId),s.toggleStickers(e,!1),s.setDraft(e,i),setTimeout((()=>s.focusOn(e)),0)}(E,t,r,i,e),r.hideKeyboard(),a.deselectAll(E))},cancelEditing(){let e=(0,p.getNowEditingMessage)(E);e&&ns(E,t,r,pt(t,e.messageId))},messageKeyboardButtonClick:e=>gs(r,E,e),getEditingMessage:()=>(0,p.getNowEditingMessage)(E),focusEditingMessage(){let e=(0,p.getNowEditingMessage)(E);e&&Lt(s,t,e.messageId,E),r.focusOn(E)},setNetworkWaitingStatus(e,t){a.setNetworkWaitingStatus(e,t)},setNetworkReconnectingStatus(e){a.setNetworkReconnectingStatus(e)},clearNetworkStatus(){a.clearNetworkStatus()},updateCasperMessageStatus(e,s=!1){(0,p.isFullyLoadedTab)(E.get(),e.peerId)&&E.set(n.updateCasperMessageExpiringStatus.bind(null,e,s)).then((()=>{E.get().peer===e.peerId&&(0,p.setCasperMessageExpiringStatusDOM)(t,s,e.messageId)}))},updateObserver(){L.update(),null==P||P.update(),x.update()},updateFolderCounters(e){c().updateFolderCounters(e)},renderPeerProfile(e){A.render(e)},destroyPeerProfile(){A.destroy()},updateGoToReactionsButton(e,t){Ot(e,t)}}}function vs(e,t,s,a,i){let o=(0,d.geByClass1)("_im_peer_history_w",e);(0,$.hasAccessibilityMode)()&&(0,d.addClass)(o,"history_a11y");let{callMutations:h,bindMutations:C}=(0,y.createMutations)(hs),I=(e=>{let t=(0,W.debounce)(e,100),s=(0,f.throttle)(e,100);return e=>{t(e),s(e)}})(Et.bind(null,t));const R=(0,B.mount)(t,e);let F=It.bind(null,t,h,o,I,R,e),N=(0,T.mount)(e,t,h),U=(0,x.createScroll)((0,d.geByClass1)("_im_chat_body_abs",e),{onScroll:(...e)=>{F(...e),(0,Y.partConfigEnabled)("mail_history_mention_popover")&&window.reforgedME&&window.reforgedME.profileInfo&&window.reforgedME.profileInfo.mountProfileInfo(null),(0,Y.partConfigEnabled)("messages_reactions")&&(!lt&&N.hideReactionsPanel(),lt=!1)},nativeScroll:(0,p.isClassicInterface)(t),shadows:!1});const H=(0,p.isClassicInterface)(t)?void 0:U.scroll.container,j=(0,L.mount)(t,H,(e=>function(e,t,s){const a=(0,m.getCurrentTab)(e);if(!a)return;const i=s.reduce(((t,s)=>{if(s.isIntersecting){const n=+s.target.getAttribute("data-msgid")||+s.target.getAttribute("data-last-msgid"),i=(0,v.getMessage)(e,a.peerId,n);n&&i&&!(0,b.isOut)(i)&&t.push(n)}return t}),[]);if(i.length){const s=Math.max(...i);Tt(e,s).then((()=>{s===a.lastmsg&&e.set((e=>(0,n.setActions)(e))).then((()=>t().updateActions(e)))}))}}(t,h,e)),((e,t)=>(0,b.isUnread)(t,e))),q=()=>{var e,t;return null==(e=window.curNotifier)||null==(t=e.idle_manager)?void 0:t.is_idle},V=(0,L.mountHistoryMsgsReactionsObserver)(t,H,(()=>Ft(t,e)),(e=>{if(q()||!(0,Y.partConfigEnabled)("messages_reactions"))return;const s=(0,m.getCurrentTab)(t);if(!(s&&(0,m.shouldUseReactionsShortPolling)(s)))return;const a=(0,g.getPeer)(t);t.set((t=>(0,re.updateMessagesReactions)(a,e,t))).then((t=>{e.forEach((e=>{const s=(0,ae.getMessageByCmid)(t,a,e),n=null==s?void 0:s.messageId;n&&void 0!==s.kludges.reactions&&h().updateMessageReactions(t,a,n)}))}))}),(n=>{if(q()||!(0,Y.partConfigEnabled)("messages_reactions"))return;const i=(0,g.getPeer)(t),o=(0,g.getGroupId)(t);t.set((e=>{const s=Array.from((0,g.getPendingReadReactionsCmids)(t,i));return(0,ne.setPendingReadReactionsCmids)(i,[...s,...n],e)})).then((t=>{Ot(t,e),s.updateCounter(t,i),(0,p.isClassicInterface)(t)&&a.updateCounter(t,i)})).then((()=>(0,re.markReactionsAsRead)(n,i,o))).then((()=>{const e=Array.from((0,g.getPendingReadReactionsCmids)(t,i)),s=new Set(n),a=e.filter((e=>!s.has(e)));t.set((e=>(0,ne.setPendingReadReactionsCmids)(i,a,e)))}))})),K=(0,g.getLocalSettingsValue)(t,"transcript_auto_show")&&(0,f.unpackStore)(t).isASRSettingHintActive?(0,L.mount)(t,H,(e=>{var s,a,n;let i=null!=(n=null==cur||null==(s=cur.imDb)||null==s.selectByKey?void 0:s.selectByKey("shown_asr_hints"))?n:[];e.forEach((e=>{if(!e.isIntersecting)return;const s=Number(e.target.dataset.msgid||e.target.dataset.lastMsgid);i&&!i.includes(s)&&e.target.querySelector(`.${it}`)&&(i.length+1<3?i.push(s):(t.set((e=>(e.isASRSettingHintActive=!1,Promise.resolve(e)))),(0,ue.hideHelpHint)("im:transcript_autoshow_setting"),K.unmount(),i=void 0))})),null==cur||null==(a=cur.imDb)||null==a.updateByKey||a.updateByKey("shown_asr_hints",i)}),b.isAudioMsg):void 0;let X=(0,E.mount)((0,d.geByClass1)("_im_dialog_header",e),t,h);setTimeout((function(){const s=t.get().peer;if(s){if(as(t),((0,m.getCurrentTab)(t).pinned||(0,m.getCurrentTab)(t).top_banner)&&(h().updateChatTopic(s,t),t.set(n.setActions),X.changeActions(t)),(0,m.getCurrentTab)(t).callInProgress&&h().updateBanner(t),t.get().msgid)Lt(U,e,t.get().msgid,t);else if(!kt(U,e,h,t,R)){U.scrollBottom(ve);const e=(0,m.getCurrentTab)(t);(0,p.isTabMarkedUnread)(e)&&t.set((t=>(0,n.markDialogRead)(e.peerId,t)))}t.get().history_init=!1,(0,v.isCasperChat)(t,s)?R.disable():R.reset(U),Bt(t,e),Rt(t,e),It(t,h,o,I,R,e,0,U),(0,ce.ensureDomHasActions)(e),nav.objLoc.st&&(t.mutate(n.setInplaceSearch.bind(null,nav.objLoc.st,s)),h().startSearch(t)),window.nav.objLoc.open_settings&&(X.showSettings(t),delete window.nav.objLoc.open_settings,window.nav.setLoc(window.nav.objLoc))}else R.disable()}),15);let le=(0,S.mount)((0,d.geByClass1)("_im_text_input",e),t,(0,p.isClassicInterface)(t)?a.updateMenu:void 0,((e,t)=>{s.removeDialog(e,t),s.restoreDialogs(e,!0)}),h),ge=(0,M.mount)((0,d.geByClass1)("_im_dialog_header",e),t,h),me=(0,k.mount)(e,t,(()=>({changedMessageSelection:X.changedMessageSelection})));const he=(0,A.mount)(o);(0,P.mount)(e,t,h);const fe=(0,G.mount)(e,t,(()=>({hidePinned(){(0,P.pinnedMessageHide)(t,t.get().peer,h,!1)},compensateHistoryHeightChange(e){h().compensateHistoryHeightChange(e)},showPinned(){(0,P.pinnedMessageUnHide)(t,t.get().peer,h,!1)},showMessageRequestRejectDialog(t){!function(e,t,s,a,i){const o=oe.getLang("mail_mr_reject_confirmation"),r=(0,J.oCacheGet)(e,i),l=`<div class="checkbox _im_is_spam_checkbox" onclick="checkbox(this);" role="checkbox" aria-checked="false">${oe.getLang("mail_report_as_spam")}</div>`,c=r?r.first_name_gen:"",_=(0,ee.showFastBox)(oe.getLang("mail_message_request_reject_request"),o.replace("{name}",c),oe.getLang("mail_message_request_reject"),(()=>{const o=(0,se.isChecked)((0,d.geByClass1)("_im_is_spam_checkbox"),t),r=o?oe.getLang("mail_message_request_rejected_and_spam"):oe.getLang("mail_message_request_rejected");e.set((e=>(0,n.rejectMessageRequest)(i,o,e))).then((e=>{(0,p.isClassicInterface)(e)&&a.updateMenu(e),s.removeDialog(e,i),s.restoreDialogs(e,!0),i===e.get().peer&&e.get().longpoll.push([(0,D.resetPeer)()]),(0,p.hideAllBoxes)(),(0,te.showNotification)({text:r})})).catch((e=>{(0,p.hideAllBoxes)(),(0,f.showErrorBox)(e)}))}));_.setControlsText(l)}(t,e,s,a,t.get().peer)},showBusinessNotifyDialog:xt})));pe.Ranges.isZeroOwner(t.get().peer)||t.set((e=>(0,de.restoreHistoryQueue)(e,t.get().peer))).then((()=>{(0,de.restoreQueuedMessagesInDom)(t.get(),t.get().peer,wt(e)),ft(e,t,t.get().peer)})),_s(t,h),function(e,t,s){let a,n,i=(0,d.geByClass1)(e,t);(0,O.initDraggable)(i,{onStartDrag:(e,t)=>{(0,d.addClass)(document.body,"cursor_ns_resize"),a=t,n=t},onDrop:()=>{(0,d.removeClass)(document.body,"cursor_ns_resize")},onDrag:(e,i)=>{let o=gt(n-a+i,t);(0,p.setClassicChatHeight)(o),s().fixHeight()}})}("_im_chat_resize_track",e,i);let be=Ht.bind(null,t,e,h),we=jt.bind(null,t,e,U,h),Ce=e=>{(0,l.cancelEvent)(e),function(e,t){e().showCreation(t)}(i,t)},ye=Vt.bind(null,h,t,e,U),Ee=Kt.bind(null,h,t,e,U),Se=zt.bind(null,t,e,U),Me=bt.bind(null,t,e),Ie=p.showEditTimeTooltip.bind(null,t),Be=p.showMessageInfoTooltip.bind(null,t),De=Pt.bind(null,t,be,e,h),Ne=vt.bind(null,t,e,U),Ue=es.bind(null,h,t,U),Ze=ts.bind(null,t),We=ss.bind(null,t,h),nt=rs.bind(null,t,h,e),ot=gs.bind(null,le,t);const rt=ht.bind(null,h),ct=p.showCasperExpiringTooltip.bind(null,t,e),dt=()=>(0,c.showWiki)({w:"expired_messages"}),_t=ms.bind(null,t),ut=e=>function(e,t){const s=t.target.closest("."+Xe),a=s.closest("."+Qe),n=s.dataset.link,i=+a.dataset.peer;((0,p.isCallToPeerFromSnippetAvailable)(e,i)||(0,p.isCallToPeerAvailable)(e,i))&&(0,p.joinCallFromIm)(e,i,n,!1,p.CALL_ENTRY_POINT_JOIN_SNIPPET)}(t,e),pt=ps.bind(null,t,e),Ct=e=>function(e,t){const s=t.target.closest(`.${tt}`),a=(0,g.getPeer)(e);if(ie.FlatButton.isLocked(s)||!a)return;const n=e.get().tabs[a].is_subscribed;ie.FlatButton.lock(s),e.set((e=>(0,re.setPeerSubscribedStatus)(a,n,e))).then((e=>{const t=(0,f.unpackStore)(e).tabs[a].is_subscribed,n=t?oe.getLang("mail_friend_request_sent"):oe.getLang("mail_add_to_friends"),i=t?ie.FlatButtonAppearance.SECONDARY:ie.FlatButtonAppearance.PRIMARY;ie.FlatButton.unlock(s),ie.FlatButton.setAppearance(s,i),ie.FlatButton.setLabel(s,n)})).catch((()=>{ie.FlatButton.unlock(s)}))}(t,e),yt=e=>{const t=(0,d.domClosest)(st,e.target);if(!t)return;const s=(0,d.domClosest)(p.MESSAGE_STACK_CLASS,t),a=parseInt((0,d.domData)(s,"peer"),10)||null;window.reforgedME&&window.reforgedME.profileInfo&&a&&window.reforgedME.profileInfo.mountProfileInfo({peerId:a,targetElement:t})},St=(0,y.createModule)({handlers:(s,a)=>{a(e,"click",p.RESTORE_CLASS,we),a(e,"mouseover click",p.FAILED_CLASS,Me),a(e,"mouseover","_im_edit_time",Ie),a(e,"mouseover","_im_page_info",Be),a(e,"click","_im_mess_susp",mt.bind(null,e)),a(e,"click",Ae,De),a(e,"click",Pe,Ne),a(e,"mouseover",xe,Yt),a(e,"mouseover",He,Ze),a(e,"mouseover",ze,ct),a(e,"mouseover",Je,(e=>function(e,t){const s=e.target.dataset.mention;let a=null;switch(!0){case u.MASS_MENTION_ALIASES.all.includes(s):a=oe.getLang("mail_im_mention_all");break;case u.MASS_MENTION_ALIASES.online.includes(s):a=oe.getLang("mail_im_mention_online")}a&&(window.tooltips&&window.tooltips.destroy(e.target),(0,z.showTooltip)(e.target,{shift:[0,5],center:!0,black:1,className:"im-mass-mention-tt",reverseOffset:!0,toup:e.target.getBoundingClientRect().top>(0,p.getHistoryTopIndent)(t)+37,text:a,noZIndex:!0}))}(e,t))),a(e,"mouseover",et,pt),a(e,"mouseover",at,us),a(e,"click",p.MESSAGE_ASR_COLLAPSE_TOGGLE_BUTTON,p.onASRCollapseToggleClick),a(e,"click",it,(()=>{i().openSettings()})),a(e,"click",je,We),a(e,"click",Re,rt),a(e,"click",Ve,nt),a(e,"click",Ke,ls),a(e,"click",qe,((e,s)=>{if((0,l.checkEvent)(e))return!0;if(!(0,d.gpeByClass)("wall_postlink_preview_btn",e.target)&&!(0,d.hasClass)(e.target,"wall_postlink_preview_btn"))return!0;const a=(0,d.geByClass1)("flat_button",s),i={invite_chat_id:(0,d.domData)(a,"inv-id"),invite_hash:(0,d.domData)(a,"hash")};(0,p.showInvitationBox)(t,i,n.leaveInvitation),(0,l.cancelEvent)(e)})),a(e,"click",p.JOIN_CALL_BY_LINK_CLASS,p.handleCallLinkClick),a(e,"click",Oe,(()=>t.get().longpoll.push([(0,D.resetPeer)()]))),a(e,"click",Fe,(e=>function(e,t,s){const a=e.get(),i=(0,d.domClosest)(Ge,s.target),o=(0,d.domData)(i,"msgid"),r=(0,v.getMessage)(a,a.peer,o),l=e=>t().replaceAttachmentPlaceholders(e,r);r&&((0,_.statlogsSendingRetry)("retry_attach"),e.set(n.addAttachmentsToStoreData.bind(null,r,[(0,_e.renderMessageMedia)(a,r)])).then(l),e.set(n.loadMedia.bind(null,r)).then(l))}(t,h,e))),a(e,"click",p.MESSAGE_KEYBOARD_BUTTON_CLASS,ot),a(e,"click",Ye,_t),a(e,"click",Xe,ut),s((0,d.geByClass1)("_im_peer_history_w",e),"mousemove",R.show),s((0,d.geByClass1)("_im_start_new",e),"click",Ce),s(e.querySelector(Te),"click",ye),s(e.querySelector(ke),"click",Ee),s(e.querySelector(Le),"click",Se),a(e,"click",tt,Ct),s((0,d.geByClass1)("_im_cancel_edit",e),"click",(()=>(h().cancelEditing(),!1))),s((0,d.geByClass1)("_im_edit_focus_cur",e),"click",(()=>(h().focusEditingMessage(),!1))),w.screenfull.raw&&s(document,w.screenfull.raw.fullscreenchange,Ue),s(window,"im_goToMessage",(e=>{const s=(0,Z.intval)(e.msgid);if(s)return(0,r.statlogsValueEvent)("im_links_to_attachments",1,"to_message"),t.set(n.changePeer.bind(null,e.sel,s,!1)).then((()=>(0,p.focusOnMessage)(t,h().focusOnMessage,t.get().peer,s)))})),a(e,"click",$e,dt),(0,Y.partConfigEnabled)("mail_history_mention_popover")&&a(e,"mouseover",st,yt)}});curNotifier.recvClbks.pin_hide=[function(e){e.hide?(0,P.pinnedMessageHide)(t,e.peer,h,!1):(0,P.pinnedMessageUnHide)(t,e.peer,h,!1)}],window.showForwardBox=e=>function(e,t){(0,p.applyMessageHandlers)((0,ee.showBox)("al_im.php",t,{params:{width:638,bodyStyle:"padding: 0px",containerClass:"im-show-message-box"}},{}),e)}(t,e);let Mt=setInterval(At.bind(null,t,e,X),1e4);(0,g.getPeer)(t)===u.VK_OFFICIAL_PEER_ID&&(0,Q.collectOnboardingFindFriendsShowStats)(t.get().viewer_id);const Dt=(0,g.getPeer)(t),Nt=(0,v.getTab)(t,Dt);return Nt&&(0,m.tabIsMessageRequest)(Nt)&&(0,Q.collectOpenMessageRequestStats)(Dt),C(St,e,U,X,le,h,i,ge,N,me,F,t,I,Mt,R,fe,j,he,K,V)}},316760:(e,t,s)=>{"use strict";s.d(t,{mount:()=>I});var a=s(15080),n=s(196026),i=s(29271),o=s(82161),r=s(795558),l=s(953908),c=s(936134),d=s(875610),_=s(862736);const u="im_hist_search",g="_im_search_date",m="_im_search_date_input",p="_im_search_history_input",h="_im_start_inplace_search",v="_im_cancel_inplace_search",f="_im_clear_date";function b(e,t,s,i,o,r){return{focus(e){uiSearch.focus(t),function(e,t,s,a){(0,n.cancelStackPush)(u,S.bind(null,e,t,s,a))}(e,t,s,i)},changePeer(e,s){uiSearch.getFieldEl(t).value=s.get().tabs[e].searchText||""},search(){r({})},unmount(){(0,a.destroyModule)(o),(0,n.cancelStackFilter)(u),i.then((e=>e.destroy()))}}}function w(e,t,s,a){e.set(d.setCurrentSearchDate.bind(null,e.get().peer,`${a.d}.${a.m}.${a.y}`)).then(y.bind(null,e,t,s))}function C(e,t){e.then((e=>{(0,l.triggerEvent)((0,r.geByClass1)("datepicker_control",t),"mousedown",!1,!0)}))}function y(e,t,s){let a=e.get().peer;uiSearch.showProgress(s),(0,d.searchMessagesInplace)(a,e.get()).then((a=>{uiSearch.hideProgress(s),t().insertSearch(a,e),(0,_.updateCounters)(location.href,document.referrer)})).catch((()=>{uiSearch.focus(s),uiSearch.hideProgress(s)}))}function E(e,t,s,a,n,i){if("keyup"===i.type&&13!=i.which)return;let r=(0,o.clean)(uiSearch.getFieldEl(t).value);e.set(d.setCurrentSearch.bind(null,r,e.get().peer)).then(n.bind(null,e,a,t))}function S(e,t,s,a){(0,n.cancelStackFilter)(u),a.then((e=>{e.hide()})),e.set(d.cancelSearch.bind(null,e.get().peer)).then((()=>{uiSearch.getFieldEl(t).value="",s().cancelSearch(e)}))}function M(e,t,s,a){s.then((e=>{e.hide()})),e.set(d.clearDate.bind(null,e.get().peer)).then(y.bind(null,e,t,a))}function I(e,t,s){let n=(0,r.geByClass1)(m,e),o=(0,r.geByClass1)(p,e),l=function(e,t,s,a){let n='<td class="cal_clear" colspan="7"><button type="button" class="im_cal_clear_lnk _im_clear_date">'+i.getLang("wall_clear_date_filter")+"</button></td>";return new Promise((e=>{window.stManager.add(["ui_controls.js",window.jsc("web/datepicker.js"),"datepicker.css"],(function(){let t=new Datepicker(s,{width:140,resfmt:"plain",addRows:'<tr id="im_day_clear">'+n+"</tr>",addRowsM:'<tr id="im_month_clear">'+n+"</tr>",onUpdate:a,pastActive:!0,noFuture:!0});e(t)}))}))}(0,0,n,w.bind(null,t,s,o)),d=C.bind(null,l,e),_=E.bind(null,t,o,n,s,(0,c.debounce)(y,300)),u=S.bind(null,t,o,s,l),I=M.bind(null,t,s,l,o);const T=(0,a.createModule)({handlers:(t,s)=>{t((0,r.geByClass1)(g,e),"click",d),t(uiSearch.getFieldEl(o),"keyup",_),t((0,r.geByClass1)(h,e),"click",_),t((0,r.geByClass1)(v,e),"click",u),s(e,"click",f,I)}});return b(0,o,s,l,T,_)}},480657:(e,t,s)=>{"use strict";s.d(t,{mount:()=>ee});var a=s(875610),n=s(29271),i=s(82161),o=s(795558),r=s(527405),l=s(894523),c=s(222009),d=s(15080),_=s(804381),u=s(320422),g=s(514986),m=s(835200),p=s(265937),h=s(199005),v=s(196655),f=s(552666),b=s(934701),w=s(502478),C=s(783400),y=s(839470),E=s(39611);const S="_im_mess_fav",M="_im_mess_reply",I="_im_mess_forward",T="_im_mess_edit",k="_im_mess_reaction",L="_im_reaction_panel",A="_im_reactions_panel_item",P="im-mess_reacting",x="_im_message_reaction",B="_im_message_reactions_modal",R="_im_unsafe_doc_link",D="_im_message_unknown_reaction";let O=0;function F(e,t,s,a,n){const i=(0,r.getHistoryTopIndent)(e);(0,u.showTooltip)(t,{shift:[s,10],black:1,className:"_im_history_tooltip "+a,appendParentCls:"_im_mess_stack",toup:t.getBoundingClientRect().top>i+37,text:n})}function N(e,t,s){const n=(0,o.gpeByClass)("_im_mess",s),r=(0,i.intval)((0,o.domData)(n,"msgid")),d=e.get().peer,_=(0,c.getMessage)(e,d,r),u=!(0,l.isImportant)(_);return e.get().longpoll.push([{peerId:d,messageId:r,type:u?m.SET_FLAGS:m.RESET_FLAGS,flags:m.FLAG_IMPORTANT}]),e.set(a.favMessage.bind(null,[r],u,d)),U(e,-10,t,s,!0),!1}function U(e,t,s,a,i){const r=(0,o.domData)((0,o.gpeByClass)("_im_mess",a),"msgid"),d=(0,c.getMessage)(e,e.get().peer,r),_=n.getLang("mail_im_unmark_important"),u=n.getLang("mail_im_toggle_important"),g=(0,l.isImportant)(d)?_:u,m=g.length>16;i&&window.tooltips&&tooltips.destroy(a),F(e,a,m?84:34,m?"im-star-tt_long":"im-star-tt",d?g:"")}function H(e,t){const s=e.get().peer,n=+(0,o.domData)((0,o.domClosest)("im-mess",t.target),"msgid");if((0,r.canForwardMessages)(e,[n]))return(0,_.statlogsForwardFromChannel)(),(0,a.processFwd)([n],s,e).then((t=>e.set(a.prepareForward.bind(null,t)))).then((()=>{(0,p.mount)(e)})),!1}function j(e,t,s){const n=e.get().peer,i=+(0,o.domData)((0,o.domClosest)("im-mess",s.target),"msgid");return(0,a.processFwd)([i],n,e).then((t=>e.set(a.forwardMessages.bind(null,t,e.get().tfdraft,!0)))).then((()=>t().respond(e,n))),!1}function q(e,t,s,a){F(e,a,18,"im-reply-tt",n.getLang("mail_im_mark_forward"))}function G(e,t,s,a){F(e,a,18,"im-reply-tt",n.getLang("mail_im_reply"))}function V(e,t,s,a){let n=(0,i.intval)((0,o.domData)((0,o.gpeByClass)("_im_mess",a),"msgid")),r=(0,c.getMessage)(e,e.get().peer,n);return r&&t().startEditing(r),!1}function K(e,t,s){F(e,s,18,"im-edit-tt",n.getLang("mail_im_edit"))}function z(e,t,s){cancelEvent(s);const a=new g.MessageBox({title:n.getLang("mail_unknown_reaction")});return a.content(n.getLang("mail_unknown_reaction_warning")).setButtons(n.getLang("global_continue"),a.hide).show(),!1}function Z(e,t,s,a){const n=a.closest("._im_mess");if(!n)return!1;const i=Number(n.dataset.cmid);return!!i&&((0,h.mount)(e,i),!1)}function W(e,t,s,a){if(!(0,y.partConfigEnabled)("messages_reactions"))return!1;const n=a.closest("._im_mess");if(!n)return!1;const i=(0,r.getHistoryTopIndent)(e),l=Number(n.dataset.cmid);if(l===O)return Y(),!1;O>0&&Y();const c=(0,f.unpackStore)(e);if(!c.reactions)return;const d=(0,w.getPeer)(e),_=(0,C.getMyReaction)(e,d,l),u=(0,v.renderReactionsPanel)([...c.reactions.values()],_),g=(0,o.se)(u),m=n.offsetWidth-a.offsetLeft-a.offsetWidth-a.offsetWidth/2;return g.style.setProperty("--right-offset",`${m}px`),a.parentElement.after(g),O=l,n.classList.add(P),g.getBoundingClientRect().top<i+30&&g.classList.add("MessageReactionsPanel--bottom"),setTimeout((()=>{document.addEventListener("click",Y)})),!1}function $(e,t,s){if(O>0)return;const a=n.getLang("mail_im_set_reaction"),i=a.length>16;F(e,s,i?98:48,i?"im-reaction-tt":"im-reaction-long-tt",a)}function Y(e){if(0===O||(null==e?void 0:e.target.closest(`.${L}`)))return;O=0;const t=document.querySelector(`.${L}`);if(!t)return;const s=t.closest("._im_mess");null==s||s.classList.remove(P),t.remove(),document.removeEventListener("click",Y)}function Q(e,t,s){const a=s.target.closest(`.${A}`);return!!a&&(X(e,t,s,a),!1)}function X(e,t,s,a){const n=a.closest("._im_mess"),i=(0,w.getPeer)(e);if(!i||!n)return!1;const o=Number(n.dataset.cmid),r=Number(a.dataset.id),l=(0,C.getMyReaction)(e,i,o),c=Number(n.dataset.msgid),d=l===r,_=(0,w.getGroupId)(e),u=d?e=>(0,E.removeMessageReactionOptimistic)(i,c,l,e):e=>(l?(0,E.removeMessageReactionOptimistic)(i,c,l,e):Promise.resolve(e)).then((e=>(0,E.addMessageReactionOptimistic)(i,c,r,e)));return e.set((e=>u(e))).then((e=>t().updateMessageReactions(e,i,c))).then((()=>(0,b.changeMessageReaction)(i,o,r,l,_))),Y(),!1}function J(e,t,s,a){const i=a.textContent,o=a.dataset.url;if(!o||!i)return!1;const r=n.getLang("mail_download_unsafe_text").replace("{filename}",i),l=new g.MessageBox({title:n.getLang("mail_download_unsafe_title")});return l.content(r).setButtons(n.getLang("global_continue"),(()=>{const e=document.createElement("a");e.setAttribute("href",o),e.click(),l.hide()}),n.getLang("global_cancel")).show(),!1}function ee(e,t,s){const a=U.bind(null,t,0),n=N.bind(null,t),i=q.bind(null,t,0),o=H.bind(null,t),l=G.bind(null,t,0),c=j.bind(null,t,s),_=K.bind(null,t),u=V.bind(null,t,s),g=$.bind(null,t),m=W.bind(null,t,s),p=Q.bind(null,t,s),h=X.bind(null,t,s),v=J.bind(null,t,s),f=z.bind(null,t,s),b=Z.bind(null,t,s),w=(0,d.createModule)({handlers:(t,s)=>{s(e,"click",S,n),s(e,"mouseover",S,a),s(e,"click",I,o),s(e,"mouseover",I,i),s(e,"click",M,c),s(e,"mouseover",M,l),s(e,"click",T,u),s(e,"mouseover",T,_),s(e,"click",k,m),s(e,"mouseover",k,g),s(e,"click",D,f),s(e,"click",L,p),s(e,"click",x,h),s(e,"click",B,b),s(e,"click",R,v)}});return function(e,t){return{markImportant(t,s){(0,r.updateStar)(t,s,e)},unmount(){(0,d.destroyModule)(t)},hideReactionsPanel(){Y()}}}(e,w)}},90495:(e,t,s)=>{"use strict";s.d(t,{mount:()=>h});var a=s(165203),n=s(301230),i=s(82161),o=s(953908),r=s(875610),l=s(527405),c=s(95638),d=s(552666),_=s(15080);function u(e){return e.which||e.keyCode}function g(e,t,s){!s||(0,i.inArray)(u(s),a.UNPRINTABLE_KEYS)||(0,r.isSearchingInplace)(e.get().peer,e.get())||(0,l.isEditableFocused)()||s.ctrlKey||n.browser.mac&&s.metaKey||s.key&&1!==s.key.length||t.signal("printable",s)}function m(e,t,s){u(s)===a.ENTER&&e.signal(u(s),s)}function p(e,t,s,r){const d=u(r);if(!layers.visible){if(d>=49&&d<=57&&(r.ctrlKey||r.metaKey&&n.browser.mac)&&(0,l.isClassicInterface)(t))return function(e,t){const s=e.get().tabbedPeers[t];s&&e.get().longpoll.push([(0,c.changePeer)(s.peer,!1,!0,!0,"right_menu")])}(t,d-49),(0,o.cancelEvent)(r);(0,i.inArray)(d,a.UP_DOWN_CONTROLS)&&e.signal(d,r)}}function h(e,t){const s=n.browser.mozilla?"keydown":"keypress",a=(0,d.default)({signalTimer:!1}),i=g.bind(null,e,t),o=p.bind(null,t,e,a),r=m.bind(null,t,a),l=(0,_.createModule)({handlers:e=>{e(document,"keydown",o),e(document,"keyup",r),e(document,s,i)}});return{unmount(){(0,_.destroyModule)(l)}}}},98626:(e,t,s)=>{"use strict";s.d(t,{mount:()=>st});var a=s(11010),n=s(434788),i=s(657303),o=s(301230),r=s(241857),l=s(196026),c=s(29271),d=s(664988),_=s(953908),u=s(584356),g=s(82161),m=s(638871),p=s(795558),h=s(797673),v=s(530097),f=s(688087),b=s(68103),w=s(41963),C=s(196635),y=s(2914),E=s(896879),S=s(882972),M=s(15080),I=s(290183),T=s(594901),k=s(835200),L=s(766981),A=s(836791),P=s(245234),x=s(171993),B=s(227575),R=s(970978),D=s(705758),O=s(222009),F=s(894523),N=s(875610),U=s(804381),H=s(527405),j=s(165203),q=s(381001),G=s(90495),V=s(590646),K=s(564553),z=s(160079),Z=s(872306),W=s(936134),$=s(839470),Y=s(610812),Q=s(95638),X=s(998898),J=s(523305),ee=s(408014),te=s(502478),se=s(300069),ae=s(779625),ne=s(441416),ie=s(12402),oe=s(934701),re=s(39611),le=s(327777),ce=s(728785),de=s(540537),_e=s(196655),ue=s(49988),ge=s(783400),me=s(321342),pe=s(47304),he=s(220661),ve=s(755320),fe=s(239301),be=s(625139),we=s(375353),Ce=s(47095),ye=s(595091),Ee=s(931917),Se=s(796943);const Me=30,Ie=400,Te=250;function ke(e,t,s,a,n){const i=new Map,r=new Map,l=new Map;for(const t of n){i.has(t.peerId)||i.set(t.peerId,new Set),i.get(t.peerId).add(t.messageId);const s=(0,O.getMessage)(e,t.peerId,t.messageId);s&&r.set(t.messageId,s.chat_local_id),l.set(t.messageId,t)}i.forEach(((n,i)=>{const c=[...n],d=(0,O.getTab)(e,i),_=d&&!d.offset,u=d&&d.inplaceSearch&&!!d.searchOffset;e.set(N.removeMessages.bind(null,c,i)).then((()=>e.set(N.removeMessagesMarkDeleted.bind(null,c,i)))).then((()=>{if(e.get().peer===+i&&(0,H.isFullyLoadedTab)(e.get(),i)){const s=(0,O.getTab)(e,i);t.removeMessages(c,+i,e);const a=s.inplaceSearch;if(!s.offset&&!_&&((0,N.setActions)(e.get()),t.updateActions(e),a||t.showEmptyScreen()),a&&u&&!s.searchOffset&&(t.showSearchResults(),o.browser.safari)){const e=(0,p.geByClass1)("_im_peer_history_w");e.style.display="none",setTimeout((()=>e.style.display=""),0)}}})).then((()=>{const n=(0,O.getTab)(e,i);if(!n)return;const o=c.some((e=>e>=n.lastmsg)),d=(0,$.partConfigEnabled)("me_web_read_by_cmid")?c.filter((e=>{const t=r.get(e);return t&&t>n.in_up_to_cmid&&!(l.get(e).flags&k.FLAG_OUTBOUND)})):c.filter((e=>e>n.in_up_to&&!(l.get(e).flags&k.FLAG_OUTBOUND)));o?(0,N.loadActualLastMessage)(e,+i).then((()=>{s.promoteDialog(e,i),a&&a.updateCounter(e,i),i===(0,te.getPeer)(e)&&(t.updateGoToEnd(e,!0),t.updateGoToMention(e,!0))})):d&&(0,X.removeDeletedUnreadMsgsFromTab)(i,d,e.get()).then((()=>s.updateDialog(i,e)))}))}))}function Le(e,t){"spam"===t?(0,H.showSpamLayer)(e,A.mount,{}):"fav"===t&&(0,H.showFavvedBox)(e,{},q.mount,{})}function Ae(e,t,s,a,n){e.forEach((e=>{switch(e.kludges.source_act){case H.CHAT_PHOTO_REMOVE:case H.CHAT_PHOTO_UPDATE:!function(e,t,s,a){t.set(N.updateChatPhoto.bind(null,e)).then((()=>{let n=e.kludges.source_act;s.updateDialog(e.peerId,t),a.updateChatPhoto(e,n,t)}))}(e,t,s,a)}}))}function Pe(e,t){const s=e.get().longpoll.push.bind(null,[(0,Q.resetPeer)()]),a=()=>{const n=e.get().selectedMessages;n&&n.length?(e.setState({selectedMessages:[]}).then((()=>{t.changedMessageSelection(e),t.cleanSelection(n)})),setTimeout((()=>(0,l.cancelStackPush)("im_peer",a)),0)):s()};(0,l.cancelStackPush)("im_peer",a)}function xe(e,t){return Be.apply(this,arguments)}function Be(){return(Be=(0,a._)((function*(e,t){if("event_add_message"!==t.type&&"event_edit_message"!==t.type)return!1;try{var s;const{id:n,tabs:i}=e.get();if(!(0,ee.tabIsArchived)(i[t.peerId]))return!1;var a;const o=null!=(a=null==(s=t.kludges)?void 0:s.marked_users)?a:[],r=Object.values(we.MASS_MENTION_ALIASES).flat();if(!o.some((([e,t])=>{if(e!==Ce.MARKED_TYPE.MENTIONS)return!1;return Array.isArray(t)&&t.includes(n)||r.includes(t)})))return!1;if((0,ee.isMutedConvo)(e.get(),t.peerId))return!0;const{messages_auto_unarchive:l=!1}=yield(0,m.getInfo)();return!l}catch(e){return console.error(e),!1}}))).apply(this,arguments)}function Re(){return(Re=(0,a._)((function*(e){try{const{archiveMentionsMap:t}=e.get();if(Array.isArray(t))return!1;const s=cur.imDb.selectByKey("archive-mentions-map");if(void 0===s)return cur.imDb.updateByKey("archive-mentions-map",t),!1;return Object.entries(t).some((([e,t])=>!s.hasOwnProperty(e)||s[e]<t))}catch(e){return console.error(e),!1}}))).apply(this,arguments)}function De(e,t){e.set((e=>(0,se.setLocalSettingsValue)("archives_folder_hidden",null,e))).then((s=>(cur.imDb.updateByKey("archives_folder_hidden",null),(0,H.isClassicInterface)(e)||t.updateFolderCounters(e),(0,de.toggleHideFolderHandler)((0,D.unpackStore)(s),"archive",!1,!0))))}function Oe(e,t,s=null){var a,i;const o=(0,D.unpackStore)(e);var r;const l=null!=(r=null==o||null==(a=o.tabs)||null==(i=a[t])?void 0:i.mention_cmids)?r:[];if(!l.length)return;const c=s||Math.max(...l);cur.imDb.updateByKey("archive-mentions-map",(0,n._)({},cur.imDb.selectByKey("archive-mentions-map")||{},{[t]:c})),e.set((e=>(Array.isArray(e.archiveMentionsMap)&&(e.archiveMentionsMap={}),e.archiveMentionsMap[t]=c,Promise.resolve(e))))}function Fe(e){let t=e.attaches.filter((e=>"sticker"!==e.type&&"call"!==e.type));return(0,F.isServiceMsg)(e)||0===t.length}function Ne(e,t,s){(0,p.addClass)(s,"im-page_history-show"),t.loadingPeer(e)}function Ue(e,t){let s=(0,H.getRightMenuMaxItems)(e,t.offsetHeight);if(e.get().tabbedPeers.length>s){const t=e.get().tabbedPeers.filter((({peer:t})=>(0,g.intval)(t)!==e.get().peer)).map((({peer:t})=>e.get().tabs[t])).sort(((e,t)=>t.last_touched-e.last_touched));let a=[];0!==e.get().peer&&a.push(e.get().tabs[e.get().peer]);const n=a.concat(t).slice(s).map((e=>e.peerId)),i=e.get().tabbedPeers.filter((e=>!(0,g.inArray)(e.peer,n)));return e.set(N.updateTabbedPeers.bind(null,i,!0))}return Promise.resolve(e)}function He(){let e=(0,u.curBox)();for(;e;)e.hide(),e=(0,u.curBox)()}function je(e,t,s,a,n,i,o,r,c){e.get().audio_msg.isRecording&&e.set(N.cancelRecording).then((()=>{a.cancelRecording()})),AudioMessagePlayer.loaded&&AudioMessagePlayer.detachPlayer(),(0,O.isAnyMessageBeingEdited)(e)&&a.cancelEditing(),(0,O.isSearching)(e)&&t.cancelSearch&&(n.clearSearch(e),s.restoreDialogs(e),c().toggleSettingsButton(e,!1)),qe(e,r,c),Ne(e,a,i);let d=e.get().peer;(0,N.updateMentions)(e.get()),(0,H.isFullyLoadedTab)(e,t.peerId)&&(t.msgid&&!(0,O.getMessage)(e,t.peerId,t.msgid)||!t.msgid&&!(0,O.getMessage)(e,t.peerId,(0,O.getTab)(e,t.peerId).lastmsg)||(0,O.getTab)(e,t.peerId).skipped)&&e.mutate((e=>(0,O.makeTabNotFullyLoaded)(e,t.peerId)));let _=e.set(N.changePeer.bind(null,t.peerId,t.msgid,t.entryPoint)).then((e=>{const s=e.get();return s.tabs[t.peerId]?Promise.resolve(s):e.set((()=>(0,de.loadPeer)(s,t.peerId,t.msgid,!0,!1,"applyPeer")))})).then((()=>{if(s.selectPeer(t.msgid,e),function(e,t){(0,H.isPendingForward)(e)&&((0,l.cancelStackFilter)("forward"),e.set(N.forwardMessages.bind(null,e.get().pendingForward,(0,O.getTabDraft)((0,O.getTab)(e,t)),!1)))}(e,e.get().peer),window.tooltips&&tooltips.hideAll(),He(),a.preparePeer(e),Pe(e,a),(0,H.isClassicInterface)(e)?(s.deactivate(),Ue(e,i).then((()=>o.updateMenu(e))),(0,le.updateFolderCounters)(e)):s.updateFolderCounters(e),!(0,H.isClassicInterface)(e)&&(0,ee.isRecommendedConvo)(e,t.peerId)&&Ee.Ranges.isUserIdTransitional(t.peerId)&&!Ee.Ranges.isContactId(t.peerId)){const a=((0,O.getTab)(e,t.peerId)||{}).online||0,{is_online:n,is_mobile:i}=(0,H.convertLegacyOnlineToAPIFlags)(a);e.set((e=>(0,X.updateRecommendedListItemOnline)(e,t.peerId,n,i))).then((e=>{s.updateRecommendedOnline(t.peerId,e)}))}}));return _=t.msgid?_.then((()=>e.set(N.selectPeerOnMessage.bind(null,t.peerId===d,d)))):_.then((()=>e.set((e=>(0,N.selectPeer)(!0,e))))),_.then((()=>e.set(N.prepareCasperMessagesFromMessages.bind(null,t.peerId)))).then((()=>{if(e.get().peer===t.peerId){if(t.forward){const s=e.get().tabs[e.get().peer];!s.scrollBottom&&s.unread?e.set(N.setActions).then((()=>a.updateActions(e))):!s.unread&&(0,O.isTabMarkedUnread)(s)&&e.set((e=>(0,N.markDialogRead)(t.peerId,e)))}(0,H.isClassicInterface)(e)&&o.updateMenu(e),a.changePeer(e,!1),a.updateTyping(t.peerId,e),a.removeExpiredFailedMessages(t.peerId),a.updateObserver(),(0,N.updateMentions)(e.get())}})).catch(pe.dummyCatch)}function qe(e,t,s){t&&e.get().shown&&(t.hide(e),s().createCanceled(e))}function Ge(e,t,s){(0,O.isSearching)(e)&&(t.clearSearch(e),s.restoreDialogs(e))}function Ve(e,t,s,a,n,i,o){e.setState({isCreating:!0}),(0,H.isClassicInterface)(e)&&(n.saveScroll(e),i.saveScroll(e)),a.showCancelControl(),(0,p.addClass)(o,"im-page_creating"),s&&s.show(e,t),(0,H.isClassicInterface)(e)&&((0,p.setStyle)(o,{height:Xe(o,e).page}),setTimeout((function(){(0,p.addClass)(o,"im-page_cropped")}),200)),(0,N.toggleConversation)(!0)}function Ke(e,t,s,a){(0,H.isTabLoaded)(e.get(),a)&&(t.updateTyping(a,e),s.updateTyping(a,e))}function ze(e,t,s,a,n){a.activityType||(a.activityType=n);const i=e=>Ke(e,t,s,a.peerId);(0,H.isSelfMessage)(a.peerId,e.get().gid)||(e.set(N.setActivity.bind(null,a,n)).then(i),e.set(N.waitActivity.bind(null,a,n)).then(i))}function Ze(e,t,s){const a=(0,O.getTab)(s,(0,ee.getCurrentTab)(s));if(!a||(0,ee.isBusinessNotifyTab)(a))return;const n="im-page_reconnecting";t?e.classList.add(n):e.classList.remove(n)}function We(e,t,s,a,n){if((0,O.isMessageRequestChangedEvent)(t))return void function(e,t,s,a){const n=(0,ee.getCurrentTab)(e);switch(t.updateType){case k.MAIL_CHAT_UPDATE_TYPE_CONTACT_CONVERTED:n&&n.peerId===t.updateArg&&e.get().longpoll.push([(0,Q.changePeer)(t.peerId,!1,!1,!1,e.get().currentEntryPoint)]),e.set((e=>(0,N.deletedDialog)(t.updateArg,Promise.resolve([]),e))).then((()=>{s().removePeer(e,t.updateArg),s().updateDialogFilters(e)}));break;case k.MAIL_CHAT_UPDATE_TYPE_MESSAGE_REQUEST_CHANGED:{const i=(0,O.getTab)(e,t.peerId);(!(0,$.partConfigEnabled)("simplified_start_conversation")||i&&(0,ee.tabIsNotImportantMessageRequest)(i)?e.set((e=>(0,N.updateMessageRequestsCounter)(t,e))):e.set((e=>Promise.resolve(e)))).then((()=>{i&&t.updateArg===k.MESSAGE_REQUEST_STATUS_REJECTED&&(0,X.updateListedConvos)(e.get(),i,!0,(e=>e.filter((e=>e!==Number(t.peerId)))))})).then((()=>{(0,H.isClassicInterface)(e)?(0,le.updateFolderCounters)(e):a.updateFolderCounters(e),(0,H.checkMessageRequestsTab)(e,a.update),k.MESSAGE_REQUEST_STATUS_ACCEPTED===t.updateArg&&(0,H.isClassicInterface)(e)&&s().updateMenu(e),k.MESSAGE_REQUEST_STATUS_REJECTED===t.updateArg&&0===e.get().dialog_tabs[j.FOLDER_MESSAGE_REQUEST].length&&(0,O.isMessageRequestFolder)(e)&&e.get().longpoll.push([(0,Q.changeTab)(j.FOLDER_ALL)]),k.MESSAGE_REQUEST_STATUS_ACCEPTED===t.updateArg&&(null==n?void 0:n.peerId)===t.peerId&&e.set((()=>(0,N.syncMessageReactStatus)(e,t.peerId)))}))}}}(e,t,s,n);if((0,O.isBusinessNotifyChangedEvent)(t))return void function(e,t,s,a){const n=e.set((e=>(0,X.resetFolderList)(e,ce.ConvoListFolder.BUSINESS_NOTIFY)));e.get().active_tab===ce.ConvoListFolder.BUSINESS_NOTIFY&&n.then((()=>e.set(N.loadDialogs))).then((()=>s().restoreDialogs(e,!0,!0)))}(e,0,s);if(!(0,H.isTabLoaded)(e.get(),t.peerId))return;(0,K.handleEventChatUpdated)(e,t.peerId,t.updateType,t.updateArg,a,n)||!Ee.Ranges.isChatOrChannelPeer(t.peerId)||e.set((e=>(0,N.loadChatInfo)(t.peerId,e).then((e=>e.peer===t.peerId?(0,N.setActions)(e):Promise.resolve(e))))).then((()=>{s().updateChatInfo(t.peerId)}))}function $e(e,t,s){let a=null;if(s.kludges.keyboard&&!s.kludges.keyboard.inline){const t=Object.assign(s.kludges.keyboard,{author_id:s.userId});a=e.set(N.setKeyboard.bind(null,s.peerId,t))}else{const t=(0,O.getKeyboard)(e,s.peerId);t&&t.one_time&&t.author_id!==(0,F.getAuthorId)(e,s)&&(a=e.set(N.deleteKeyboard.bind(null,s.peerId)))}s.peerId===(0,te.getPeer)(e)&&a&&a.then(t.fixKeyboard)}function Ye(e,t,s,n,i,_,m,h,v,f,b,w,C,y,I,T,L,A,P,x,B,R,q){let G=!1;return{changePeer(e,s){t.selectPeer(e,s)},cancelSearch(e){Ge(e,n,t)},loadingPeer(e){Ne(e,s,i)},restoreDialogs(e,s,a){t.restoreDialogs(e,s,a)},showChatInvitationBox(e,s){(0,H.showChatInvitationBox)(e,s,v,t)},toggleSettingsButton(e,t){null==b||b.toggleButton(e,t)},focusSearch(e){n.focusInput()},appendSearch(e,s,a,n){t.appendSearch(e,s,a,n)},appendDialogs(e,s){t.appendDialogs(e,s)},showCreation(e,a){Ve(e,a,f,n,t,s,i)},updateState(e,a){t.updateDialog(e,a),a.get().peer===e&&s.updateChat(a,e)},updateConvoInList(e,s){t.promoteDialog(s,e)},appendFastDialogs(e,s){t.appendFastDialogs(e,s,!0)},createCanceled(e){n.hideCancelControl(),(0,H.isClassicInterface)(e)?((0,p.setStyle)(i,{height:"auto"}),(0,p.removeClass)(i,"im-page_cropped"),setTimeout((()=>n.focusInput()),0),0===e.get().peer?t.restoreScroll(e):s.restoreScroll(e,e.get().peer)):setTimeout((()=>{0===e.get().peer?n.focusInput():s.focustTxt(e)}),0),(0,p.removeClass)(i,"im-page_creating"),e.setState({isCreating:!1})},updateMenu(e){T&&T.updateMenu(e)},goToHistoryEnd(){s.goToEnd()},updateDialog(e,s){t.updateDialog(e,s)},updateRecommendationList(e){e.set(oe.updateConvoRecommendationList).then((e=>{(0,te.isRecommendationListRerenderNeeded)(e)&&t.updateRecommendationList(e)}))},setRecommendationListVisibility:e=>t.setRecommendationListVisibility(e),focusTxt(e){s.focustTxt(e)},resync(e){(0,O.isSearching)(e)&&n.clearSearch(e),t.restoreDialogs(e,!0,!0).then((()=>{(0,H.isClassicInterface)(e)||t.focusOnSelected(e)})),f&&f.hide(e),(0,H.isCommunityInterface)(e)&&e.get().tabbedPeers.forEach((({peer:t})=>{T.updateCounter(e,t)})),(0,H.isClassicInterface)(e)?(e.get().tabbedPeers.forEach((({peer:t})=>{T.updateCounter(e,t),T.updateName(t,e)})),(0,le.updateFolderCounters)(e)):t.updateFolderCounters(e),s.cleanSelection(e.get().selectedMessages||[]),s.cancelSearch(e,!0),Ee.Ranges.isZeroOwner(e.get().peer)||s.changePeer(e,!1),(0,ne.updateUnreadCounter)(e)},toggleSettingsLoader(e,t){b.toggleLoader(e,t)},onUserActions(e,t){if((0,N.isSearchingInplace)(e.get().peer,e.get()))return;let a=e.get(),n=a.peer;if((0,H.isFullyLoadedTab)(a,n)&&!_.is_idle&&(0,O.countUnread)(e.get().peer,e.get())>0){!a.tabs[n].skipped&&s.isNewMessagesVisible(e)&&(s.hideGoToEnd(!0),s.hideGoToMention(!0),s.updateObserver(),Promise.resolve().then((()=>e.set(N.setActions))).then((()=>s.updateActions(e))))}},removeSelection(e){t.removeSelection(e),n.focusInput()},openSettings(){n.openSettings()},route(e,a,o,r){if(void 0!==e[0])return!0;e.box&&(e={box:e.box});let l=!1;return!!(e.mr||e.invite_chat_id&&o.invite_hash)||(r&&r.params&&"left_nav"===r.params._ref&&void 0===e.sel&&t.scrollUp(!0,!0),Object.keys(e).sort().forEach((e=>{switch(e){case"sel":o.q||(l=!0);const e=o.sel?(0,H.unUrlPeer)(o.sel):0;let c=r.back;if(0===e)w.get().longpoll.push([(0,Q.resetPeer)(!1,c)]);else if(e!==w.get().peer){let t="";r&&r.params&&r.params.entrypoint&&(t=r.params.entrypoint),w.get().longpoll.push([(0,Q.changePeer)(e,o.msgid||!1,!1,!1,t)])}break;case"invite_chat_id":case"invite_hash":!function(e){e.set(N.leaveInvitation).then((()=>{e.get().longpoll.push([(0,Q.resetPeer)(!1,!1)])}))}(w);break;case"tab":qe(w,f,v),l=!0;const d=o.tab||j.FOLDER_ALL;w.get().longpoll.push([(0,Q.changeTab)(d)]);break;case"act":o.act&&"create"===o.act?Ve(w,[],f,n,t,s,i):function(e,t,s,a){s&&s.hide(e,t)}(w,[],f);break;case"st":o.st&&o.sel?((0,u.curBox)()&&(0,u.curBox)().hide(),w.mutate(N.setInplaceSearch.bind(null,unescape(o.st),o.sel)),s.startSearch(w)):(w.mutate(N.cancelSearch.bind(null,a.sel)),s.cancelSearch(w,!0));break;case"q":o.q?((0,u.curBox)()&&(0,u.curBox)().hide(),n.setSearch(w,o.q,!0)):n.clearSearch(w);break;case"box":Le(w,o.box)}})),o.msgid&&(w.get().msgid=o.msgid,s.focusOnMessage()),(0,H.isClassicInterface)(w)&&void 0===e.sel&&T.updateMenu(w),l&&Ge(w,n,t),!1)},updateDialogFilters(e,s=!1){(0,O.isSearching)(e)||s||t.restoreDialogs(e),null==b||b.updateFilter(e)},removePeer(e,s){t.removeDialog(e,s),t.saveScroll(e),e.get().peer===s&&e.get().longpoll.push([(0,Q.resetPeer)()]),(0,H.isClassicInterface)(e)&&T.updateMenu(e)},newMessage(e){(0,H.isClassicInterface)(e)||t.scrollUp(!0)},onQueueEvent(e,a){if(a.entity_type===S.EntityType.Online)e.set((e=>(0,N.updateOnline)(a.data.user_id,!!a.data.online&&a.data.platform,a.data.last_seen,e))).then((e=>{(0,H.isTabLoaded)(e.get(),a.data.user_id)&&(t.updateOnline(a.data.user_id,e),s.updateOnline(a.data.user_id,e)),(0,ee.isRecommendedConvo)(e,a.data.user_id)&&t.updateRecommendedOnline(a.data.user_id,e)}))},onEvents(e,a){let r=(0,Q.compactCounterEvents)(a),l=a.filter(F.isServiceMsg),u=a.filter((e=>e.type===k.ADD_MESSAGE));const w=(0,N.checkNewPeople)(l,u,e);let y=Promise.resolve();if(w.shouldLoad&&(y=e.set(N.loadNewPeople.bind(null,w,m))),y.then((()=>{Ae(l,e,t,s),r.forEach((a=>{switch(a.type){case k.ADD_MESSAGE:const l=a.peerId,u=(0,O.getTab)(e,l),m=!u||!u.msgs||0===u.msgs.length,w=(0,H.getMessageStoreStatus)(a,e.get()),y=(0,O.isCommunityBlocked)(e,a.peerId),S=u&&!u.lastmsg,M=u&&(0,ee.isChatConvo)(u)&&u.data.closed;switch($e(e,s,a),(0,F.isCasperMessage)(a)&&Z.casperMessagesStore.add(a),w){case H.MSG_NEW:e.set(N.addMessage.bind(null,a)).then((e=>{xe(e,a).then((s=>{s&&(De(e,t),Oe(e,a.peerId,a.chat_local_id))}))})),Ue(e,i),function(e,t){const s=(0,D.unpackStore)(e),a=s.tabs[t.peerId],n=s.active_tab,i=t.flags&k.FLAG_STEALTH;return!(!a||!n||i)&&(!(n!==j.FOLDER_ALL||(0,ee.tabIsArchived)(a)||(0,ee.isBusinessNotifyTab)(a)||(0,O.tabIsMessageRequestToChat)(a))||(n===j.FOLDER_PEER_TAGS?(0,J.applyPeerTagsFilterToTab)(s,a):(0,N.filterFromTab)(n)(a)))}(e,a)&&((0,O.tabIsMessageRequest)(u)||(a.flags&k.FLAG_OUTBOUND||e.set(N.updateFavAndTitle.bind(null,a.peerId,!0)),function(e,t){const s=t.peerId,a=e.get().tabs[s],n=t.flags&k.FLAG_OUTBOUND,i=(0,g.inArray)(t.peerId,e.get().mutedPeers),o=t.flags&k.FLAG_DELETED,r=e.get().gid,l=(0,F.isUnread)(a,t);if(!n&&!i&&!o&&l){const n=t.userId,i=function(e,t){return t<2e9&&e&&!e.match(/^\s*(Re(\(\d*\))?\:)?\s*\.\.\.\s*$/)}(t.subject,t.peerId)||"";let o,l,_=(i?i+" ":"")+t.text||"";if(t.kludges&&t.kludges.source_act&&(_=(0,d.stripHTML)((0,_e.renderServiceMsg)(e,t,a.peerId,!1))),(!e.get().notify_msg&&!Ee.Ranges.isChatOrChannelPeer(s)||r&&!e.get().mute)&&window.Notifier&&Notifier.playSound({author_id:s}),!Ee.Ranges.isChatOrChannelPeer(s))return;_=(0,g.trim)((0,d.replaceEntities)((0,d.stripHTML)(_.replace(/<br>/g,"\n").replace(/<\*>.*$/,"")))),_=(0,E.replaceMentions)(_,((e,t,s,a,n)=>n)),Ee.Ranges.isChatOrChannelPeer(s)?(o=(0,V.oCacheGet)(e,n).name,a.tab&&(o+=" » "+a.tab),l=(0,V.oCacheGet)(e,n).photo):(o=a.tab,l=a.photo);const u=t.attaches[0];if(u&&"mail"===u.type)_+="\n["+c.getLang("mail_added_msgs")+"]";else if(u){const e="doc"===u.type&&"graffiti"===u.kind?"graffiti":u.type;_+="\n["+c.getLang("mail_added_"+e)+"]"}o=(0,g.trim)((0,d.replaceEntities)((0,d.stripHTML)((o||"").replace("&nbsp;"," ")))),window.Notifier&&Notifier.proxyIm({id:t.messageId,text:_,author_id:s,title:o,author_photo:l})}}(e,a)),t.updateTyping(a.peerId,e),(0,O.isSearching)(e)?t.updateDialog(a.peerId,e):t.promoteDialog(e,a.peerId));const n=(0,O.isCommunityBlocked)(e,a.peerId),o=u&&!u.offset,r=u&&(0,ee.isChatConvo)(u)&&!u.data.closed&&M;(y&&!n||S&&!o||r)&&(r&&(0,N.setActions)((0,D.unpackStore)(e)),s.updateActions(e)),(0,H.isClassicInterface)(e)?(T.updateCounter(e,a.peerId),T.updateMenu(e)):null==b||b.updateFilter(e),e.set(N.updateActivity.bind(null,a)).then(Ke.bind(null,e,s,t,a.peerId)),s.addMessage(e,a),Fe(a)||!(0,H.isFullyLoadedTab)(e,a.peerId)||a.local||e.set(N.loadMedia.bind(null,a)).then((e=>{s.replaceAttachmentPlaceholders(e,a),(0,ae.videoAutoPlayHandler)()})),a.kludges.has_template&&e.set((e=>(0,N.addCarouselTemplateToStore)(a,e))).then((e=>{s.replaceBotCarouselPlaceholder(e,a)})),(0,U.statlogsSendingTimeStart)(e,a,"send","opt_to_lp");break;case H.MSG_LOCAL_DUPLICATE:Fe(a)||e.set(N.loadMedia.bind(null,a)).then((e=>{s.replaceAttachmentPlaceholders(e,a)})),e.set(N.replaceMessage.bind(null,a)),s.replaceMessageAttrs(a,e),t.updateDialog(a.peerId,e),e.get().active_tab===j.FOLDER_ALL&&(0,ee.isRecommendedConvo)(e,a.peerId)&&this.updateRecommendationList(e),a.randomId&&(0,U.statlogsSendingTimeEnd)(e,a,"send","opt_to_lp");break;case H.MSG_DUPLICATE:(0,O.isSearching)(e)||t.promoteDialog(e,a.peerId)}(0,O.tabIsMessageRequest)(u)&&(0,H.checkMessageRequestsTab)(e,t.update);(w===H.MSG_LOCAL_DUPLICATE&&1===u.offset||w===H.MSG_NEW&&S&&!a.local)&&e.set((t=>(0,de.loadPeer)(t,l,0,!1,!1,"emptyPinnedCrutch").then((t=>((0,X.updateListedConvos)(t,(0,O.getTab)(t,l),!1,(e=>(0,N.addDialog)(l,e,t)),((e,s,a)=>(0,N.shouldIncludeDialog)(t,e,s,a))),l===e.get().peer?(0,N.setActions)(t):t))))).then((e=>t.promoteDialog(e,l))),u&&m&&u.peerId===(0,te.getPeer)(e)&&x();break;case k.EDIT_MESSAGE:case k.REPLACE_MESSAGE:{const n=(0,O.getMessage)(e,a.peerId,a.messageId),i=Boolean((null==n?void 0:n.flags)&k.FLAG_HAS_REACTIONS);if(Boolean(a.flags&k.FLAG_HAS_REACTIONS)!==i)return void e.set((e=>(0,re.setMessageFlag)(e,a.peerId,a.messageId,k.FLAG_HAS_REACTIONS,!0)));e.set(N.editMessage.bind(null,a)).then((e=>{if(xe(e,a).then((s=>{s&&(De(e,t),Oe(e,a.peerId,a.chat_local_id))})),$e(e,s,a),a.kludges.is_expired)return(0,H.removeExpiredMessageIfNeed)(a,s.handleMessageExpiration),void t.updateDialog(a.peerId,e);t.updateDialog(a.peerId,e),s.updateTyping(a.peerId,e),s.editMessage(e,a),Fe(a)||!(0,H.isFullyLoadedTab)(e,a.peerId)||a.local||e.set(N.loadMedia.bind(null,a)).then((e=>s.replaceAttachmentPlaceholders(e,a))),(null==n?void 0:n.kludges.reactions)&&!a.kludges.reactions&&(0,se.setMessageReactions)(e,a.peerId,a.messageId,n.kludges.reactions).then((t=>n.kludges.reaction_id?(0,se.setMyMessageReaction)(e,a.peerId,a.messageId,n.kludges.reaction_id):Promise.resolve(t))).then((e=>s.updateMessageReactions(e,a.peerId,a.messageId))),a.kludges.has_template&&e.set((e=>(0,N.addCarouselTemplateToStore)(a,e))).then((e=>{s.replaceBotCarouselPlaceholder(e,a)}))}));break}case k.REACTION_CREATE_OR_EDIT_EVENT:{var r;if(!(0,$.partConfigEnabled)("messages_reactions"))break;const{subtype:t,peerId:n,cmid:i,reactionCounters:o,reactionId:l}=a,c=1===t||3===t,d=(0,te.getPeer)(e),_=Number(null==(r=(0,ge.getMessageByCmid)(e,n,i))?void 0:r.messageId);if(!_)break;e.set((e=>(0,se.setMessageReactions)(e,n,_,o).then((e=>c?(0,se.setMyMessageReaction)(e,n,_,l):Promise.resolve(e))))).then((e=>{const t=(0,ge.getMessageReactedPeerIds)(e,n,i).filter((t=>!(0,V.oCacheExists)(e,t)));return 0===t.length?Promise.resolve(e):(0,N.loadChatMember)({[n]:t},e)})).then((e=>{if(d===n&&s.updateMessageReactions(e,n,_),(0,H.isFullyLoadedTab)(e,n))return(0,N.addMessageReactionsToHistory)(n,_,e)}));break}case k.INVALIDATE_MESSAGE:(0,N.reloadMessage)(a.messageId,e.get()).then((t=>{const s=(0,Y.getMessageFromTuple)(t);return e.set((e=>(0,N.editMessage)(s,e))).then((()=>s))})).then((a=>{s.editMessage(e,a),t.updateDialog(a.peerId,e),!Fe(a)&&(0,H.isFullyLoadedTab)(e,a.peerId)&&e.set((e=>(0,N.loadMedia)(a,e))).then((e=>s.replaceAttachmentPlaceholders(e,a)))}));break;case k.UNREAD_REACTIONS:(0,$.partConfigEnabled)("messages_reactions")&&e.set((e=>(0,oe.setUnreadReactions)(e,a.peerId,a.cmids))).then((e=>{t.updateCounter(e,a.peerId),a.peerId===(0,te.getPeer)(e)&&s.updateGoToReactionsButton(e,document),(0,H.isClassicInterface)(e)&&T.updateCounter(e,a.peerId)}));break;case k.READ_INBOUND:case k.READ_INBOUND_BY_CMID:e.set((e=>(0,N.markInboundMessagesAsRead)(a,e))).then((e=>{t.updateCounter(e,a.peerId),a.peerId===(0,te.getPeer)(e)&&(s.updateGoToEnd(e,!0),s.updateGoToMention(e,!0),s.updateObserver()),(0,H.isClassicInterface)(e)&&T.updateCounter(e,a.peerId),(0,O.isSearching)(e)||t.restoreDialogs(e),null==b||b.updateFilter(e)}));break;case k.READ_OUTBOUND:case k.READ_OUTBOUND_BY_CMID:e.set(N.markOutboundMessagesAsRead.bind(null,a)).then((e=>{t.updateCounter(e,a.peerId),s.markMessagesAsRead(e,a)}));break;case k.UNREAD_COUNT:e.set((e=>(0,se.setUnreadCounters)(a,e))).then((()=>{null==b||b.updateFilter(e);const{showOnlyNotMuted:s}=a;s!==(0,te.getLocalSettingsValue)(e,"show_only_not_muted_messages")&&e.set((e=>(0,se.setLocalSettingsValue)("show_only_not_muted_messages",s,e)));let n=Promise.resolve();a.businessNotifyUnread>0&&1===e.get().settings.business_notify_folder_hidden&&(n=e.set((e=>(0,se.setLocalSettingsValue)("business_notify_folder_hidden",0,e))),(0,de.toggleHideFolderHandler)((0,D.unpackStore)(e),ce.ConvoListFolder.BUSINESS_NOTIFY,!1)),n.then((s=>{(0,H.isClassicInterface)(e)?((0,le.updateFolderCounters)(e),e.get().tabbedPeers.forEach((({peer:t})=>{T.updateCounter(e,t)}))):t.updateFolderCounters(e)}))}));break;case k.SET_FLAGS:case k.REPLACE_FLAGS:case k.RESET_FLAGS:switch(!0){case Boolean(a.flags&k.FLAG_DELETED):case Boolean(a.flags&k.FLAG_SPAM):a.type!==k.SET_FLAGS||(0,H.isAlreadyDeleted)(e,a.peerId,a.messageId)||e.get().blockedFlagUpdates[a.peerId]||h(a);break;case a.flags===k.FLAG_IMPORTANT:{const t=a.type===k.SET_FLAGS;e.set((e=>(0,N.updateImportant)(t?1:-1,a.messageId,e))),e.set((e=>(0,N.updateFavMessage)([a.messageId],a.peerId,t,e))).then((()=>{s.markImportant(a.messageId,t,e)}));break}case Boolean(a.flags&k.FLAG_AUDIO_MESSAGE_LISTENED):e.set((e=>(0,re.setMessageFlag)(e,a.peerId,a.messageId,k.FLAG_AUDIO_MESSAGE_LISTENED,!0))).then((e=>{const{peerId:t,messageId:n}=a,i=(0,O.getTab)(e,t);if((0,te.getPeer)(e)===t&&s.markMessageAsListened(e,t,n),i&&(0,H.isFullyLoadedTab)(e,t)){const e=(0,me.unpackHistory)(i.history);i.history=(0,H.updateListenedMark)(e,n)}}))}break;case k.RECORDING_AUDIO:ze(e,s,t,a,N.ACTIVITY_TYPE_RECORDING_AUDIO);break;case k.TYPING:ze(e,s,t,a,N.ACTIVITY_TYPE_TYPING);break;case k.NOTIFY_SETTINGS_CHANGED:!function(e,t,s,a){e.set(N.setMutedPeer.bind(null,s,a)).then(t().updateState.bind(null,s))}(e,v,a.peerId,!a.sound);break;case k.CONVO_MAJOR_ID_CHANGED:e.set((e=>{const{peerId:t,majorId:s}=a,n=(0,O.getTab)(e,t);return(s&&n?Promise.resolve(e):(0,de.loadPeer)(e,t,0,!1,!1,"sortingChange")).then((e=>{const a=(0,O.getTab)(e,t);return a.major_sort_id=s,(0,X.updateListedConvos)(e,a,!1,(s=>(0,N.addDialog)(t,s,e)),((t,s,a)=>(0,N.shouldIncludeDialog)(e,t,s,a))),(0,N.setActions)(e),Promise.resolve(e)}))})).then((e=>{const{peerId:n}=a;(0,O.getTab)(e,n)&&!(0,O.isSearching)(e)&&t.promoteDialog(e,n),n===e.get().peer&&s.updateActions(e)}));break;case k.CONVO_MINOR_ID_CHANGED:e.set((e=>{const{peerId:t,minorId:s}=a,n=(0,O.getTab)(e,t);return n?(n.minor_sort_id=s,Promise.resolve(e)):Promise.resolve(e)})).then((e=>{const{peerId:s}=a;(0,O.getTab)(e,s)&&!(0,O.isSearching)(e)&&t.promoteDialog(e,s)}));break;case k.RESYNC:e.get().longpoll.pause(),e.set(N.resync).then(v().resync).then((()=>e.get().longpoll.resume()));break;case k.TRANSITION:C.transition(a.state);break;case k.RESET_PEER:if(a.removeActivePeer){const t=e.get().tabbedPeers.filter((({peer:t,type:s})=>t!==e.get().peer&&"perm"===s));e.setState({tabbedPeers:t})}!function(e,t,s,a){e.set(N.cancelRecording).then((()=>{s.cancelRecording()})),AudioMessagePlayer.loaded&&AudioMessagePlayer.detachPlayer(),t.removeSelection(e),(0,p.removeClass)(a,"im-page_history-show"),s.flushDraft(e),s.stopLoading(),s.destroyPeerProfile(),(0,O.isAnyMessageBeingEdited)(e)&&s.cancelEditing();let n=e.get().peer;e.set(N.changePeer.bind(null,0,!1,"")).then((()=>{window.tooltips&&window.tooltips.hideAll(),He(),(0,H.isClassicInterface)(e)&&t.activate(),s.changePeer(e),(0,H.isClassicInterface)(e)&&t.restoreScroll(e),setTimeout((()=>{e.get().longpoll.push([(0,Q.transitionEvent)("search")])}),13),(0,H.isLocksAvailable)(e)&&(0,H.isPeerBlockedByMe)(n,e)&&e.set(N.releaseBlock.bind(null,n))}))}(e,t,s,i),a.cancelSearch&&Ge(e,n,t),(0,H.isClassicInterface)(e)&&T.updateMenu(e),(0,H.isClassicInterface)(e)&&e.get().active_tab===j.FOLDER_ALL&&this.updateRecommendationList(e),n.focusInput(),(0,H.isCommunityInterface)(e)&&(n.initPeerTagsFilter(e),t.renderPeerTags(e));break;case k.CHANGE_TAB:(0,O.isSearching)(e)&&n.clearSearch(e);const I=e.get().active_tab;(0,H.changeTab)(a.tab,e,v,N.changeDialogsTab).then((e=>{null==b||b.updateFilter(e),a.tab===j.FOLDER_PEER_TAGS&&I!==a.tab&&n.initPeerTagsFilter(e),a.tab===j.FOLDER_ALL&&this.updateRecommendationList(e)}));break;case k.RESET_DIRECTORIES:case k.SET_DIRECTORIES:case k.REPLACE_DIRECTORIES:{const{type:n,peerId:i,mask:o}=a;if(o===k.FOLDER_HAS_BANNER)break;const r=o===k.FOLDER_AD_TAG;e.set((e=>(0,N.updateFolderState)(i,o,n,a.local,r,e))).then((e=>{(0,O.isSearching)(e)||n===k.RESET_DIRECTORIES&&o===j.FOLDER_MASKS[j.FOLDER_IMPORTANT]||n===k.RESET_DIRECTORIES&&o===j.FOLDER_MASKS[j.FOLDER_MESSAGE_REQUEST]||n===k.SET_DIRECTORIES&&o===j.FOLDER_MASKS[j.FOLDER_MESSAGE_REQUEST_REJECTED]||n===k.REPLACE_DIRECTORIES||t.restoreDialogs(e),t.updateDialog(i,e),(0,H.isClassicInterface)(e)&&T.updateCounter(e,i),e.get().peer===i&&s.changedMessageSelection(e)}));break}case k.DELETE_DIALOG:a.leaveChat||void 0===a.leaveChat?e.set(N.deletedDialog.bind(null,a.peerId,Promise.resolve([]))).then((()=>{v().removePeer(e,a.peerId),v().updateDialogFilters(e),(0,N.removeFromRecentSearch)(a.peerId,cur.imDb),e.set(N.preloadSearchIndex.bind(null,cur.imDb))})):e.set(N.flushDialog.bind(null,a.peerId,Promise.resolve([]))).then((()=>{(0,N.loadActualLastMessage)(e,a.peerId).then((()=>v().updateState(a.peerId,e)))}));break;case k.CHANGE_PEER:je(e,a,t,s,n,i,T,f,v);break;case k.MUTEX:const L={[a.peerId]:a},A=(0,H.isPeerBlocked)(a.peerId,e);e.set(N.updateBlockStates.bind(null,L)).then((()=>{t.updateDialog(a.peerId,e);let n=(0,H.isPeerBlocked)(a.peerId,e);(0,H.isFullyLoadedTab)(e.get(),a.peerId)&&A!==n&&s.updateChat(e,a.peerId)}));break;case k.FAILED_MESSAGE:e.set(N.setMessageErrored.bind(null,a.peerId,a.message)).then((()=>{s.setMessageErrored(a.peerId,a.message,a.error,e),t.setDialogFailed(a.peerId,a.message.messageId,e)}));break;case k.RESEND:const P=a.message.messageId;e.set(N.resendMessage.bind(null,a.peerId,P,a.message)).then((()=>{s.resendMessage(a.peerId,P),t.promoteDialog(e,a.peerId)}));break;case k.PEER_TAGS_CHANGED_EVENT:(0,J.onPeerTagsChangeEvent)(e,t,a);break;case k.PEER_PROFILE_TAGS_CHANGED_EVENT:(0,J.onPeerProfileTagsChangedEvent)(e,t);break;case k.CONVERSATION_UPDATED:We(e,a,v,s,t);break;case k.WAITING_FOR_RECONNECT:setTimeout((()=>{Ze(i,!0,e),s.setNetworkWaitingStatus(a.timeout-1,e)}),1e3);break;case k.RECONNECTING:Ze(i,!0,e),s.setNetworkReconnectingStatus(e);break;case k.RECONNECTED:Ze(i,!1,e),setTimeout(s.clearNetworkStatus,0);o.browser.chrome&&!(0,H.isClassicInterface)(e)&&e.get().peer&&(_.is_idle?G||(_.once("unidle",(()=>{G=!1,t.forceScrollReinit()})),G=!0):t.forceScrollReinit());break;case k.KEYBOARD_CALLBACK_RECEIVED:{const t=(0,te.getPressedButtonState)(a.event_id,e);t&&(e.set((e=>(0,se.unsetPressedCallbackButton)({peerId:a.peer_id,eventId:a.event_id},e))),t.onCallback(),(0,ie.handleCallbackAction)(a,e));break}case Q.CHANGE_VOICE_UI:{const t=(0,te.getPeer)(e);if(!t)return;const a=(0,O.getTab)(e,t),n=null==a?void 0:a.msgs;if(!a||!n)return;const i=Object.values(n);for(let t=i.length-1;t>=0;t--){const n=(0,ue.parseMessage)(i[t]);(0,H.isAlreadyDeleted)(e,a.peerId,n.messageId)||!(0,F.isAudioMsg)(n)&&!(0,ge.hasForwards)(n)||(s.editMessage(e,n),e.set((e=>(0,N.loadMedia)(n,e))).then((e=>s.replaceAttachmentPlaceholders(e,n))))}break}}}))})),(0,$.partConfigEnabled)("marusya_web_support_proccess_commands")){const e=a.filter(ve.isEventForMarusia);e.length&&(0,fe.loadMarusiaSdk)().then((t=>{t&&t.onAddMessage(e.map(be.convertImMessageToMarusia))}))}},updateHistory:e=>s.updateHistory(e),updateChatInfo(e){s.updateChatTopic(e,w),(0,H.isClassicInterface)(w)&&T.updateName(e,w),w.get().peer===e&&s.updateActions(w)},cancelRecording:()=>w.set(N.cancelRecording).then((()=>s.cancelRecording())),fixHeight(){x()},toggleFolder(e,s){t.toggleFolder(e,(()=>this),s)},updateFolderCounters(e){t.updateFolderCounters(e)},hideFolderButton(e,s){const n=(0,D.unpackStore)(e);e.set((0,a._)((function*(t){switch(s){case ce.ConvoListFolder.BUSINESS_NOTIFY:return(0,se.setLocalSettingsValue)("business_notify_folder_hidden",1,t);case ce.ConvoListFolder.ARCHIVE:{const{archiveMentionsMap:s}=e.get();return cur.imDb.updateByKey("archive-mentions-map",Array.isArray(s)?{}:s),cur.imDb.updateByKey("archives_folder_hidden",1),(0,se.setLocalSettingsValue)("archives_folder_hidden",1,t)}default:return Promise.resolve(t)}}))).then((e=>((0,H.isClassicInterface)(e)||t.updateFolderCounters(e),(0,de.toggleHideFolderHandler)(n,s,!0))))},makeArchiveVisible(e){De(e,t)},actualizeArchiveVisibilityOnUnidle(e){!function(e,t){const s=e.get().settings.archives_folder_hidden,a=cur.imDb.selectByKey("archives_folder_hidden");a&&!s?e.set((e=>(0,se.setLocalSettingsValue)("archives_folder_hidden",1,e))).then((()=>{(0,H.isClassicInterface)(e)||t.updateFolderCounters(e)})):null===a&&s&&e.set((e=>(0,se.setLocalSettingsValue)("archives_folder_hidden",null,e))).then((()=>{(0,H.isClassicInterface)(e)||t.updateFolderCounters(e)}))}(e,t)},addEntityToArchiveMentionsMap(e,t){Oe(e,t)},applySearchAction(e,t,s){n.applySearchAction(e,t,s)},deselectAllMessages(e){s.deselectAll(e)},unmount(){(0,M.destroyModule)(e),clearInterval(w.get().update_title_to),_.stop(),B(),R(),Z.casperMessagesStore.destroy(),t.unmount();let a=window.devicePixelRatio>=2?"_2x":"";(0,r.setFavIcon)("/images/icons/favicons/fav_logo"+a+".ico"),s.unmount(),n.unmount(),(0,l.cancelStackFilter)("im_peer"),null==b||b.unmount(),f&&f.unmount(),T&&T.unmount(),L&&L(),y&&y(),(0,H.isLocksAvailable)(w)&&w.get().peer&&w.set(N.releaseBlock.bind(null,w.get().peer)),A.unmount(),q.unmount(),T&&T.unmount(),P.unmount(),clearInterval(I),cur.imDb.unmount(),cur.imDb=!1,(0,$.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,fe.loadMarusiaSdk)().then((e=>{e&&e.dispose()})),ye.MediaScopeStats.stop()}}}function Qe(e,t,s,a){const n=t.get();Ee.Ranges.isZeroOwner(n.peer)||e().onUserActions(t,a),n.update_old_title&&t.set(N.updateFavAndTitle.bind(null,!1,!1))}function Xe(e,t){const s=(0,p.ge)("page_header"),a=(0,p.geByClass1)("_im_page_history",e),n=(0,p.clientHeight)()-s.offsetHeight-Me-2,i=(0,H.isClassicInterface)(t)?Te:Ie;let o={page:Math.max(n,i)};if((0,H.isClassicInterface)(t)){let e=(0,H.getClassicChatHeight)();e=e>0?Math.min(e-s.offsetHeight-Me-2,n):n;const t=(0,p.hasClass)(a,"im-page--history_empty-hist")?e:n;o.history=Math.max(e,i),o.chat=Math.max(t,i)}return o}function Je(e,t,s,a,n,i=!0,r=!1){if((0,D.isFullScreen)())return;const l=Xe(e,t);if((0,p.setStyle)(e,{minHeight:l.page}),(0,H.isClassicInterface)(t)&&(void 0===t.get().chatResizeInitialized&&t.set(N.initializeChatResize),(0,p.setStyle)(e,{height:t.get().isCreating?l.page:"auto"}),(0,p.setStyle)((0,p.geByClass1)("_im_page_dialogs",e),{minHeight:l.page}),(0,p.setStyle)((0,p.geByClass1)("_im_page_history",e),{minHeight:l.history,position:"relative",top:0}),(0,p.setStyle)((0,p.geByClass1)("_im_chat_body_abs",e),{minHeight:l.chat,height:l.chat,position:"relative",top:0})),o.browser.safari&&r&&"function"==typeof r&&r(),a&&a.updateScroll(),n&&n.updateScroll&&n.updateScroll(),s){let e=s.updateScroll();s.scrollFix(t,t.get().peer,e)}i&&setTimeout((()=>Je(e,t,s,a,n,!1)),100)}function et(e,t){e.get().resendAllOnOnline&&t()}function tt(){const e=document.querySelector(".im_page");!function(e){let t="safari-repaint";e.forEach((function(e){(0,p.hasClass)(e,t)&&(0,p.removeClass)(e,t),(0,p.addClass)(e,t)})),setTimeout((function(){e.forEach((function(e){(0,p.removeClass)(e,t)}))}),100)}([(0,p.geByClass1)("_im_dialog_actions",e),(0,p.geByClass1)("_im_chat_input_w",e),(0,p.ge)("side_bar"),(0,p.geByClass1)("_im_right_menu",e),(0,p.geByClass1)("_im_dialogs_footer",e),(0,p.geByClass1)("_im_dialogs_search",e)])}function st(e,t){try{var s;(0,$.partConfigEnabled)("im_chasiky_debug")&&(window.meBufferLog={});const a=t.get();let n,l=window.devicePixelRatio>=2?"_2x":"",c=[];(0,r.setFavIcon)("/images/icons/favicons/fav_im"+l+".ico"),Je(e,t,!1,!1,!1,!0);let{callMutations:d,bindMutations:u}=(0,M.createMutations)(Ye),g=a.useFcLongpoll&&vk.lpConfig.enabled&&Notifier.getLpInstance&&Notifier.getLpInstance(),m=g?Notifier.getLpInstance():t.get().gid?(0,T.startLongPollForGroup)(a.lpConfig):(0,T.startLongPoll)(a);m.onData(A),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 1, callback set");const E=Notifier.getEventQueueInstance&&Notifier.getEventQueueInstance(),S=E?E.subscribe((e=>d().onQueueEvent(t,e))):()=>{};function A(...e){if((0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug"))try{d().onEvents(t,e)}catch(e){const t=new Error("vkm_yakimchuk_38442_debug error");throw(0,R.logError)(t,{breadcrumb:{message:"Log",data:{id:vk.id,mountLog:c}},environment:"debugLog",error:t.message,stack:t.stack}),t}else d().onEvents(t,e)}function F(){g?m.offData(A):m.stop()}let U=(0,p.geByClass1)("_im_dialogs_search",e),j=(0,p.geByClass1)("_im_dialogs_footer",e),q=(0,i.mount)((0,p.geByClass1)("_im_page_dcontent",e),t,d,U);q.renderPeerTags(t),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 2, dialog mutations rendered");let K,Y,Q=(0,v.mount)(U,t,d),X=j?(0,f.mount)(j,t,d):null,J=(0,x.mount)(t),se=(0,w.mount)(t,document.body);if((0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 3, parts mounted"),cur.imDb=(0,B.mount)(t.get().gid?-t.get().gid:vk.id),cur.imDb.updateByKey("archives_folder_hidden",t.get().settings.archives_folder_hidden),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 4, db updated"),t.set(N.preloadSearchIndex.bind(null,cur.imDb)),function(e){return Re.apply(this,arguments)}(t).then((e=>{e&&d().makeArchiveVisible(t)})),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 5, parts mounted"),(0,H.isClassicInterface)(t)){let Te=(0,p.geByClass1)("_im_ui_peers_list",e.parentNode);K=(0,P.mount)(Te,t,d),Y=function(e,t,s,a){if(o.browser.mobile)return!1;let n=[t,s,(0,p.geByClass1)("_im_chat_input_w",a),(0,p.geByClass1)("_im_dialog_actions",a),(0,p.geByClass1)("_im_dialog_header",a)],i=null,r=(0,p.hasClass)(e,"im-page--header_static"),l=(0,p.ge)("im-group-online-disabled-notice");function c(){let t=(0,y.getNativeOption)("scrollLeft"),s=(0,p.hasClass)(e,"im-page--header_static"),a=[];i!==t?a=n.slice().concat([e]):s!==r&&(a=[e]),i=t,r=s,a.length>0&&a.forEach((a=>{let n=e===a&&s?0:-t;(0,p.setStyle)(a,{[cssTransformProp]:0===n?"unset":"translateX("+n+"px)"})}))}return l&&n.push(l),n=n.concat((0,p.geByClass)("_im_aside_notice"),(0,p.geByClass)("_im_aside_promo_block")),(0,_.addEvent)(window,"scroll",c),c(),()=>{(0,_.removeEvent)(window,"scroll",c)}}(U,j,(0,p.geByClass1)("_im_right_menu",e.parentNode),e)}(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 6"),(0,H.isClassicInterface)(t)&&a.peer&&q.deactivate(),a.gid||(n=(0,b.mount)((0,p.geByClass1)("_im_dialogs_creation",e),t,d));let ae=(0,h.mount)((0,p.geByClass1)("_im_page_history",e),t,q,K,d);(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 7, history mounted");const ne=a.isCreating,ie=ne?"create":0===a.peer?"search":"default";ne&&n.show(t,[]);let re=(0,I.create)(t,ie,q,ae,Q,n),le=(0,G.mount)(t,re);ae.renderPeerProfile(t),ae.updateScroll(),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 8, history updated");let ce=Qe.bind(null,d,t,re);if(a.peer&&(t.set(N.prepareCasperMessagesFromMessages.bind(null,a.peer)),(0,$.partConfigEnabled)("messages_reactions"))){const Ae=(0,ee.getConvoReactedPeerIds)(a,a.peer).filter((e=>!(0,V.oCacheExists)(a,e)));Ae&&(0,N.loadChatMember)({[a.peer]:Ae},a)}Ee.Ranges.isZeroOwner(a.peer)||setTimeout((()=>Pe(t,ae)),10);let _e=new z.IdleManager({id:"im",element:document,focusElement:window,triggerEvents:"mouseover mousedown keypress"});(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 7, idle manager run");const ue=(0,W.debounce)(tt,300),ge=Je.bind(null,e,t,ae,q,n,!1,ue),me=et.bind(null,t,ae.resendAll);t.setState({longpoll:m}),t.set(N.setExecStack.bind(null,[])),_e.on("unidle",(function(){var e;null==(e=d())||e.actualizeArchiveVisibilityOnUnidle(t),m.abortWaiting(),ce()})),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 8, some stuff done"),ye.MediaScopeStats.start("vk"),_e.start(),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 9, im started"),nav.objLoc.box&&(Le(t,nav.objLoc.box),(0,C.updateLocation)({box:null})),nav.objLoc.mr&&Ee.Ranges.isChatOrChannelPeer(Number(nav.objLoc.mr))&&(0,H.showChatInvitationBox)(t,nav.objLoc.mr,d,q),(null==(s=window.nav.objLoc)?void 0:s.openSettings)&&(Q.openSettings(),(0,C.updateLocation)({openSettings:null}));const pe=function(e){const t=e.get();if(!(0,H.isLocksAvailable)(e))return null;const{stop:s}=(0,L.createWorker)(t.mutex_key,(function(e){t.longpoll.push([k.mutexEvent(e)])}),(function(e,s){return(0,N.getMutexQueue)(t.gid).then((([e])=>e))}));return s}(t);let ve;if((0,H.isLocksAvailable)(t)&&(ve=setInterval(H.blockLatencyCompensation.bind(null,t,a.longpoll),2e3)),t.get().invitation&&(0,H.showInvitationBox)(t,t.get().invitation,N.leaveInvitation),(0,H.isClassicInterface)(t)&&(0,O.existsIncomingMessageRequest)(t)){const xe=document.getElementById("ui_rmenu_mr");xe&&xe.classList.remove("unshown")}let fe=(0,D.throttleAccumulate)(ke.bind(null,t,ae,q,K),200),be=H.hideTopNotice.bind(null,t),we=H.hideAsideNotice.bind(null,t),Ce=e=>function(e,t,s,a,{type:n,message:i}){switch(n){case Z.EXPIRING:return t.updateCasperMessageStatus(i);case Z.EXPIRING_SOON:return t.updateCasperMessageStatus(i,!0);case Z.EXPIRED:(0,O.isCasperChat)(e,i.peerId)?a(i):(t.handleMessageExpiration(i),s.updateDialog(i.peerId,e))}}(t,ae,q,fe,e);Z.casperMessagesStore.subscribe(Ce),Z.casperMessagesStore.setTimeshift(a.timeshift);const Me=e=>{const s=e.target.closest("._im_new_ui_banner");s&&(s.hidden=!0,(0,de.toggleHideFolderNoticeHandler)(t.get(),"new_ui_banner",1))};(0,Se.onDomReady)((()=>{t.set(oe.updateConvoRecommendationList).then((e=>{(0,te.isRecommendationListRerenderNeeded)(e)&&q.updateRecommendationList(e)}))})),(0,he.initWidgets)(e),(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 9, widgets init done");const Ie=(0,M.createModule)({handlers:(s,a)=>{s(document,"mousemove mousedown keypress",ce),s(window,"resize",ge),s(window,"online",me),a(e,"click",H.HIDE_TOP_NOTICE_CLASS,be),a((0,p.gpeByClass)("_im-page-wrap",e),"click",H.HIDE_ASIDE_NOTICE_CLASS,we),a((0,p.gpeByClass)("_im-page-wrap",e),"click",H.HIDE_ASIDE_PROMO_BLOCK_CLASS,H.hideAsidePromoBlock),a((0,p.gpeByClass)("_im-page-wrap",e),"click",H.INSTALL_VKADMIN_LINK,H.installVKAdminApp),(0,H.isClassicInterface)(t)&&!(0,H.isCommunityInterface)(t)&&a((0,p.gpeByClass)("_im-page-wrap",e),"click","_im_new_ui_banner_close",Me),o.browser.safari&&s(document,"visibilitychange",tt)}});return(0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")&&c.push("mount 10, before bindMutations"),u(Ie,q,ae,Q,e,_e,m,fe,d,n,X,t,re,pe,ve,K,Y,J,le,ge,F,S,se)}catch(Be){if((0,$.partConfigEnabled)("vkm_yakimchuk_38442_debug")){const De=new Error("vkm_yakimchuk_38442_debug error exception");(0,R.logError)(De,{breadcrumb:{message:Be.message,data:{id:vk.id,message:Be.message,stack:Be.stack}},environment:"debugLog",error:De.message,stack:De.stack})}}}},457321:(e,t,s)=>{"use strict";s.d(t,{mount:()=>se});var a=s(15080),n=s(301230),i=s(196026),o=s(29271),r=s(725296),l=s(562112),c=s(953908),d=s(795558),_=s(82161),u=s(875610),g=s(702929),m=s(527405),p=s(514986),h=s(985127);let v,f,b,w,C,y,E,S,M,I,T,k,L,A,P,x,B,R=600,D=n.browser.msie&&(0,_.intval)(n.browser.version)<10?window.XDomainRequest:window.XMLHttpRequest;function O(e){let t=e%60;return parseInt(e/60)+":"+(t<10?"0":"")+t}let F=!1,N=!1,U=100;function H(e){const{peer:t}=e.get();(0,m.isFullyLoadedTab)(e,t)&&!(0,m.isAnyMessageBeingEdited)(e)&&Date.now()-((0,m.getTab)(e,t).lastTyping||0)>1e3*u.ACTIVITY_PERIOD&&e.set(u.sendRecordingAudio.bind(null,t))}function j(e){if(N)return;N=!0,(0,m.lockButton)(y);let t={peer:T.get().peer,from_place:cur.docsChooseFrom,imhash:cur.docsChooseImHash,blockPersonal:cur.docsChooseBlockPersonal,mail_add:cur.docsChooseMailAdd};(function(e){return new Promise(((t,s)=>{let a=e.getFormData(),n=new D;n.onload=n.onerror=function(e){let a=e.currentTarget.response;200==this.status&&a.length>0&&"{"==a[0]?(a=JSON.parse(a),t(a)):s()},n.open("POST",B.upload_url,!0),n.send(a)}))})(e).then((e=>e.file?new Promise(((s,a)=>{ajax.post("/docs.php",(0,_.extend)({act:"a_save_doc",from:"choose",from_place:t.from_place,imhash:t.imhash,blockPersonal:t.blockPersonal,mail_add:t.mail_add},e),{onDone:(e,a)=>{z(),A([["doc",e+"_"+a,"audiomsg"]],{},t.peer),X(),s()},onFail:function(e){a(e)},progress:null})})):Promise.reject())).then((()=>{(0,m.unlockButton)(y),N=!1})).catch((()=>{N=!1,(0,m.unlockButton)(y),(0,p.showFastBox)(o.getLang("global_error"),o.getLang("mail_audio_message_upload_error"))}))}function q(){x(),f.innerHTML=O(F.duration),F.duration>=R&&Q()}function G(e){e.set(u.cancelRecording).then($)}function V(){x(),Promise.all([(0,h.voiceMessagePlayerLoader)(),(0,h.speechLoader)()]).then((()=>{F||(F=Speech.newRecorder(),(0,c.addEvent)(F,"progress",q)),AudioMessagePlayer.detachPlayer(),AudioMessagePlayer.pauseGlobalMedia(),F.record().then((()=>{var e;e=T,B.isRecording=!0,(0,i.cancelStackPush)("audio_message_cancel",G.bind(null,e)),(0,r.hideProgress)((0,d.geByClass1)("im-audio-message-send-wrapper",v)),f.innerHTML="0:00",(0,d.addClass)(v,"im-audio-message_recording"),(0,d.removeClass)(v,"im-audio-message_recorded"),function(){v&&v.classList&&v.classList.remove("im-audio-message-input--hidden");(0,d.geByClass1)("_im_chat_input_parent",I).classList.add("im-chat-input--hidden")}(),L=window.Speech.createVisualization("wave",F.source,b,{color:getComputedStyle(document.body).getPropertyValue("--white")}),L.start();let t=b.getBoundingClientRect();U=(t.right-t.left)/3})).catch((e=>{let t;switch(AudioMessagePlayer.resumeGlobalMedia(),e.name){case"DevicesNotFoundError":case"NotFoundError":case"NotAllowedError":t=o.getLang("mail_audio_message_device_error");break;case"PermissionDeniedError":case"PermissionDismissedError":t=o.getLang("mail_audio_message_permission_error");break;case"Unsupported":t=o.getLang("mail_audio_message_unsupported_error");break;default:t=o.getLang("global_unknown_error")}(0,p.showFastBox)(o.getLang("global_error"),t),console.error(e)}))}))}function K(){F&&F.stop(),L&&(L.destroy(),L=null)}function z(){B.isRecording=!1,(0,i.cancelStackFilter)("audio_message_cancel")}function Z(){W(),j(F)}function W(){AudioMessagePlayer.loaded&&AudioMessagePlayer.resumeGlobalMedia(),(0,c.removeEvent)(F,"finish",W),(0,c.removeEvent)(F,"finish",Z),function(e){let t=URL.createObjectURL(F.buffer);(0,d.domData)(k,"duration",F.duration),(0,d.domData)(k,"ogg",t),(0,d.domData)(k,"mp3",t),(0,d.geByClass1)("audio-msg-track--duration",k).innerHTML=O(F.duration),(0,d.geByClass1)("audio-msg-track--wave-wrapper",k).innerHTML=AudioMessagePlayer.getWave(F.wave,U)}(),(0,d.removeClass)(v,"im-audio-message_recording"),(0,d.addClass)(v,"im-audio-message_recorded")}function $(e=!0){z(),AudioMessagePlayer.loaded&&(AudioMessagePlayer.resumeGlobalMedia(),AudioMessagePlayer.detachPlayer()),(0,c.removeEvent)(F,"finish",W),(0,c.removeEvent)(F,"finish",Z),K(),X(),e&&P()}function Y(){F.isRecording?((0,c.addEvent)(F,"finish",Z),(0,c.removeEvent)(F,"finish",W),K()):j(F)}function Q(){(0,c.addEvent)(F,"finish",W),(0,c.removeEvent)(F,"finish",Z),K()}function X(){(0,d.removeClass)(v,"im-audio-message_recorded"),(0,d.removeClass)(v,"im-audio-message_recording"),v&&v.classList&&v.classList.add("im-audio-message-input--hidden"),(0,d.geByClass1)("_im_chat_input_parent",I).classList.remove("im-chat-input--hidden")}function J(){S=(0,d.ge)("audiomsg_record"),k=(0,d.ge)("audiomsg_player"),I=(0,d.geByClass1)("_im_chat_input_w"),v=(0,d.geByClass1)("im-audio-message-input",I),f=(0,d.geByClass1)("audio-msg-track--duration",v),b=(0,d.geByClass1)("audio-msg-track--wave",v),C=(0,d.geByClass1)("im-audio-message--cancel-btn",v),y=(0,d.geByClass1)("_im_audio_send",v),E=(0,d.geByClass1)("audio-msg-track--btn",v),M=(0,d.geByClass1)("im-chat-input--text",I);let e=(0,d.geByClass1)("im-chat-input--textarea",I);(0,d.addClass)(e,"_voice_field_wrap"),(0,c.addEvent)(w,"click",V),(0,c.addEvent)(C,"click",$),(0,c.addEvent)(y,"click",Y),(0,c.addEvent)(E,"click",Q)}function ee(){!function(){F&&(0,c.removeEvent)(F,"progress",q);(0,c.removeEvent)(w,"click",V),(0,c.removeEvent)(C,"click",$),(0,c.removeEvent)(y,"click",Y),(0,c.removeEvent)(E,"click",Q)}(),S=k=v=f=b=w=C=y=E=null}function te(e,t,s){return{cancelRecording:$,start:function(){V()},unmount(){$(!1),ee()}}}function se(e,t,s,n,i){T=t,B=t.get().audio_msg,x=H.bind(null,t),A=s,P=i,(0,g.initFailBack)(),(0,m.getAvailableMicrophones)().then((e=>{const s=e.length>0;s?(J(),n()):(0,l.setCookie)("remixvoice","0",7),t.set(u.setVoiceMessageAvail.bind(null,s))})).catch((e=>{throw(0,l.setCookie)("remixvoice","0",7),e}));let{bindMutations:o}=(0,a.createMutations)(te);return o(e,t,s)}},481792:(e,t,s)=>{"use strict";s.d(t,{default:()=>n});var a=s(795558);const n={onNewMessagesChunk:function(e){const t=(0,a.geByClass)("post");LongView.clearElemsCache&&LongView.clearElemsCache(),t.forEach((e=>LongView.register(e,"im")))},onHistoryScroll:function(e){LongView.onScroll(e,window.innerHeight)}}},245234:(e,t,s)=>{"use strict";s.d(t,{mount:()=>B});var a=s(120051),n=s(664988),i=s(82161),o=s(795558),r=s(953908),l=s(552666),c=s(527405),d=s(875610),_=s(95638),u=s(15080),g=s(728785),m=s(962983),p=s(705758),h=s(320422),v=s(29271),f=s(931917);const b="RightMenuBlockInfo",w="RightMenuBlockInfo__averageTimeHint",C="RightMenuBlockInfo__mute",y="RightMenuBlockInfo__mute--hidden",E="RightMenuBlockInfo__mute--muted",S=Object.values(g.ConvoListFolder);function M(e){let t=e.get().tabbedPeers.map((t=>e.get().tabs[t.peer]||e.get().mapped_index&&e.get().mapped_index[t.peer])).filter((e=>e)).filter((e=>!e.deletedDialog)).map((({peerId:e})=>({type:"peer",peer:e})));return t.length>0&&(t=[{type:"sep"}].concat(t)),t}function I(e,t){if("sep"===t.type)return(0,i.getTemplate)("im_right_menu_sep",{});let s=`${(0,c.getBaseLink)(e)}?sel=${t.peer}&tab=${e.get().active_tab}`,a=(0,c.getBareTab)(t.peer,e),o=f.Ranges.isContactId(t.peer)?(0,c.prepareContactName)(a.tab):a.tab,r="";switch(!0){case a.unread>0:r=a.unread;break;case(0,c.isTabMarkedUnread)(a):r=1}return r=(0,i.getTemplate)("im_right_menu_ct",{count:r}),(0,i.getTemplate)("im_right_menu_tpl",{href:s,label:o,peer:t.peer,attrs:`title="${(0,n.stripHTML)(a.tab)}"`,cls:a.unread>0?"im-right-menu--unread":"",extra:r})}function T(e,t,s,a){let n=(0,o.gpeByClass)("_im_peer_tab",a),l=(0,i.intval)((0,o.domData)(n,"list-id")),c=e.get().tabbedPeers.filter((({peer:e})=>e!==l));return e.set(d.updateTabbedPeers.bind(null,c,!0)).then((()=>{if(k(t,e),l===e.get().peer)e.get().longpoll.push([(0,_.resetPeer)()]);else if(0!==e.get().peer){let e=(0,o.gpeByClass)("_im_right_menu",a);uiRightMenu.hideSliding(e)}})),(0,r.cancelEvent)(s),!1}function k(e,t){return e.pipeReplace(Promise.resolve(M(t)))}function L(e,t,s,a){return{updateMenu(t){!function(e,t){(0,o.geByClass)("_im_peer_tab",e).forEach((e=>{let s=(0,m.fromQueryString)((0,o.attr)(e,"href").split("?")[1]);s.tab!==t.get().active_tab&&(0,o.attr)(e,"href",`${(0,c.getBaseLink)(t)}?sel=${s.sel}&tab=${t.get().active_tab}`)}))}(e,t);const a=(0,o.gpeByClass)("_im_right_menu",e);k(s,t).then((()=>{let e;e=t.get().peer?(0,o.ge)("ui_rmenu_peer_"+t.get().peer):(0,o.ge)("ui_rmenu_"+t.get().active_tab),e&&uiRightMenu.switchMenu(e,!0),uiRightMenu.hideProgress(a)}))},updateName(e,t){let s=(0,o.ge)("ui_rmenu_peer_"+e);if(s){let a=(0,o.geByClass1)("ui_rmenu_label-text",s),n=t.get().tabs[e].tab;(0,o.val)(a,n)}},updateCounter(e,t){let s=(0,o.ge)("ui_rmenu_peer_"+t);if(s){let a=(0,o.geByClass1)("_im_r_ct",s);const n=(0,c.getTab)(e,t);let i="";switch(!0){case n.unread>0:i=n.unread;break;case(0,c.isTabMarkedUnread)(n):i=1}(0,o.val)(a,i),s.classList.toggle("im-right-menu--unread",n.unread>0||(0,c.isTabMarkedUnread)(n))}},unmount(){(0,u.destroyModule)(a),s.unmount()}}}function A(e,t,s){1===s.which&&(e.get().peer&&e.get().longpoll.push([(0,_.resetPeer)()]),e.get().longpoll.push([(0,_.changeTab)(t)]),(0,r.cancelEvent)(s))}function P(e){(0,h.showTooltip)(e.currentTarget,{text:v.getLang("mail_admin_av_time"),dir:"bottom",needLeft:!0,typeClass:"tt_default_right RightMenuBlockInfo__averageTimeTooltip",width:210,shift:[-14,8],slide:15})}function x(e,t,s){e.set((e=>(0,d.toggleCommunityMute)(!t,e))).then((()=>s.classList.toggle(E,e.get().mute)))}function B(e,t,s){let n=(0,a.mount)(e,(0,l.default)({limit:50,offset:0,noScroll:!0,elements:M(t)}),(()=>({idFn:e=>e.peer||"000",renderFn:I.bind(null,t)}))),d=T.bind(null,t,n);const g=(0,o.geByClass1)(b),m=(0,o.geByClass1)(w,g),h=(0,o.geByClass1)(C,g),v=(0,u.createModule)({handlers:(s,a)=>{a(e,"click","_im_r_cl",d),a(e,"click","_im_peer_tab",((e,s)=>{if((0,r.checkEvent)(e))return;const a=(0,i.intval)((0,o.domData)(s,"list-id"));(0,p.unpackStore)(t).longpoll.push([(0,_.changePeer)(a,!1,!0,!0,"right_menu")]),(0,r.cancelEvent)(e)})),S.forEach((a=>{s((0,o.geByClass1)(`_ui_item_${a}`,e.parentNode),"mousedown",A.bind(null,t,a))})),m&&s(m,"mouseover",P),(0,c.isCommunityInterface)(t)&&h&&s(h,"click",(e=>x(t,!1,e.currentTarget)))}});return(0,c.isCommunityInterface)(t)&&h&&(x(t,!0,h),h.classList.remove(y)),L(e,0,n,v)}},530097:(e,t,s)=>{"use strict";s.d(t,{CONVO_MORE_CLASS:()=>L,mount:()=>$});var a=s(434788),n=s(875610),i=s(196026),o=s(82161),r=s(222009),l=s(527405),c=s(753455),d=s(15080),_=s(836791),u=s(525207),g=s(945263),m=s(215066),p=s(936134),h=s(731062),v=s(95638),f=s(227575),b=s(320422),w=s(29271),C=s(523305),y=s(728785),E=s(795558),S=s(502478),M=s(976231),I=s(993901);const T=(0,p.debounce)(g.statlogsProbValueEvent,1e3),k="_im_gim_mute",L="_im_search_more",A="_im_search_cancel",P="im-dialog-select_rotated",x="im-dialog-select_hidden",B="_im_dialogs_header_controls",R="im-page--dialogs-header-controls_hidden",D="_im_search_more_action",O="_im_create_convo",F="_im_create_call",N="_im_peer_tags_filter_control",U="_im_peer_tags_filter_checkbox",H="_im_peer_tags_filter_pane_item";function j(e,t,s,a,l,c,d){const _=(0,o.trim)(c);if((0,r.isSearchingValue)(e,_)){const s=()=>d.clearSearch(e,t);_?(e.setState({recentSearch:!1}),l.stop()):l.replaceOrAdd(s),(0,i.cancelStackPush)("im_search",s),_&&e.set((e=>(0,n.setCurrentSearch)(_,!1,e))).then(t),a.classList.add("im-page--dialogs-search_fill","_im_d_search"),(0,S.isCommunityInterface)(e)||d.showCancelControl()}else _||(l.stop(),e.set((e=>(0,n.setCurrentSearch)("",!1,e))).then(t),a.classList.remove("im-page--dialogs-search_fill","_im_d_search"),(0,S.isCommunityInterface)(e)||d.hideCancelControl())}function q(e,t,s){return function(...a){(0,r.getSearchText)(t)===e&&s(...a)}}function G(e,t,s){const a=(0,r.getSearchText)(s);return T(.01,"im_search_stat",1,"search_start"),(0,n.updateSearchQuery)(a),s.setState({recentSearch:!1}),e().toggleSettingsButton(s,!!a),a?(s.get().dialog_search_going=!0,function(e,t,s){const a=q(e,s,(e=>t().appendFastDialogs(s,e)));return(0,n.searchTopConv)(e,s.get()).then((e=>{const t=e.filter((e=>"/images/deactivated_50.png"!==e.photo||"DELETED"!==e.tab));return a(t),t}))}(a,e,s).then((n=>{const i=n.map((e=>e.peerId));return t(a,e,i,s)})).then((()=>{s.get().dialog_search_going=!1})).catch((()=>{}))):(e().restoreDialogs(s,!1,!0),(0,m.removeSearchPositionTracker)("messages"),Promise.resolve(!1))}function V(e,t,s,a){const i=a.get(),o=q(e,a,(e=>t().appendDialogs(a,e))),r=q(e,a,t().appendSearch);return(0,l.isPendingForward)(a)?(0,n.searchHints)(e,s,"all",{},i).then(o):Promise.all([(0,n.searchHints)(e,s,"all",{},i).then(o),(0,n.searchMessages)(e,i)]).then((([,[e,t]])=>{r(a,e,t,!0)}))}function K(e,t,{target:s}){e.set((e=>(0,n.toggleCommunityMute)(t,e))).then((()=>{s.classList.toggle("im-page--gim-mute_muted",e.get().mute),t&&z(e,{target:s})}))}function z(e,{target:t}){return(0,b.showTooltip)(t,{text:()=>e.get().mute?w.getLang("mail_im_sound_off"):w.getLang("mail_im_sound_on"),black:1,shift:[13,9],appendCls:"js-im-page"})}function Z(e,t,s,a,n,i){switch(n){case"contacts":a.show();break;case"favorites":nav.go("/im?box=fav");break;case"spam":(0,l.showSpamLayer)(t,_.mount,i);break;case"settings":s.show();break;case y.ConvoAction.CALL_AUDIO:case y.ConvoAction.CALL_VIDEO:case y.ConvoAction.CALL_APP:(0,l.startCallFromIm)(t,null,n===y.ConvoAction.CALL_VIDEO,[],l.CALL_ENTRY_POINT_LIST,n===y.ConvoAction.CALL_APP);break;case y.ConvoAction.CALL_BY_NAME:(0,l.startCallFromIm)(t,null,!1,null,l.CALL_ENTRY_POINT_LIST,!1,!0);break;case y.ConvoAction.BUSINESS_NOTIFY:case y.ConvoAction.ARCHIVE:{if(t.get().active_tab===n)break;if(e().toggleFolder(t,n),(0,r.isClassicInterface)(t)){const e=document.getElementById(`ui_rmenu_${n}`);e?M.default.switchMenu(e):M.default.unselectAll(document.querySelector("._im_right_menu"))}const s=i.target.closest("._ui_menu_wrap");s&&uiActionsMenu.hide(s);break}}}function W(e,t,s,a,n,o,r,l,c,_,u,g){return{focusInput(){uiSearch.focus(a.parentNode)},hideCancelControl(){s.classList.remove(R),t.classList.add(x),t.classList.remove(P)},showCancelControl(){s.classList.add(R),t.classList.add(P),t.classList.remove(x)},setSearch(e,t,s=!1){const n=s?_:()=>{};a.value=t,j(e,n,0,a,o,t,c())},clearSearch(e,t){(0,i.cancelStackFilter)("im_search"),(0,S.isCommunityInterface)(e)||c().hideCancelControl(),uiSearch.reset(a),e.setState({recentSearch:!1}),j(e,t||(()=>{}),0,a,o,a.value,c())},initPeerTagsFilter(e){(0,C.initPeerTagsFilter)(e)},applySearchAction(e,t,s){Z(r,e,u,g,t,s)},openSettings(){u.show()},unmount(){o.stop(),u.hide(),(0,d.destroyModule)(l),uiSearch.destroy(n),(0,i.cancelStackFilter)("im_search")}}}function $(e,t,s){const{callMutations:i,bindMutations:o}=(0,d.createMutations)(W),_=new u.Settings(t,s),g=new I.ContactList(t,s),m=(0,E.geByClass1)(B,e),p=(0,E.geByClass1)(O,e),y=(0,E.geByClass1)(F,e),M=(0,E.geByClass1)(A,e),T=(0,E.ge)("im_dialogs_search",e),P=(0,E.geByClass1)(k,e),x=(0,E.geByClass1)("_im_av_time",e),R=(0,E.geByClass1)(N,e),q=(0,E.geByClass1)(L,e),$=(0,c.default)("im_search",[L,O,F,"_im_page_dcontent","_im_d_search","_im_dialog"]),Y=(0,h.debouncedPromise)(V,300),Q=e=>G(s,Y,e),X=e=>j(t,Q,0,T,$,e,i()),J=()=>i().clearSearch(t,Q),ee=(0,E.geByClass1)("_im_dialogs_search_input",e);uiSearch.init(ee,{onChange:X}),T.value&&setTimeout((()=>X(T.value)),0);const te=e=>{(0,b.showTooltip)(e.target,{text:w.getLang("mail_admin_av_time"),dir:(0,E.geByClass1)("_im_top_notice")||(0,E.geByClass1)("im-page--dialogs--group-status")?"down":"up",shift:[0,8]})},se=()=>{let e;e=0===t.get().peer||(0,l.isPendingForward)(t)?"search":"default",(0,r.isSearching)(t)||s().toggleSettingsButton(t,!1),t.get().longpoll.push([(0,v.transitionEvent)(e)])},ae=()=>{(0,r.isSearching)(t)&&s().toggleSettingsButton(t,!0),function(e,t,s,i,o,c){if((0,r.isSearching)(e))return;const d=cur.imDb.select(f.RECENT_SEARCH_OP);if(0===d.length&&!(0,r.doPopularSuggExist)(e))return;e.setState({recentSearch:!0}),j(e,(()=>{(0,r.isSearching)(e)||(i.stop(),o().toggleSettingsButton(e,!1),o().restoreDialogs(e,!1,!0))}),0,s,i,"",c);const _=d.filter((t=>!(0,l.isTabLoadedWithMessage)(e.get(),t))),u=d.filter((t=>(0,l.isTabLoadedWithMessage)(e.get(),t))).reduce(((t,s)=>(t[s]=(0,r.getTab)(e,s),t)),{});e.get().topConvTree.then((t=>{const s=t.list.filter((e=>_.includes(e[0]))).reduce(((e,t)=>(e[t[0]]=(0,n.localIndexToDialog)(t),e)),{}),i=(0,a._)({},s,u);return o().appendFastDialogs(e,d.map((e=>i[e]))),s})).then((t=>(0,n.searchHints)("",Object.keys(t),!1,{},e.get()))).then((t=>{o().appendDialogs(e,t)}))}(t,0,T,$,s,i())},ne=(e,a)=>{const n=a.dataset.action;Z(s,t,_,g,n,e)},ie=(0,d.createModule)({handlers:(a,n)=>{a(M,"click",J),a(M,"mouseover",(()=>function(e,t){return(0,b.showTooltip)(t,{appendEl:document.body,text:w.getLang("mail_cancel"),black:1,shift:[3,-1],appendCls:"js-im-page"})}(0,M))),a(p,"click",(()=>s().showCreation(t))),(0,E.domData)(y,"disable-click")||a(y,"click",(()=>{(0,l.startCallFromIm)(t,null,!1,null,l.CALL_ENTRY_POINT_LIST)})),n(e,"click",D,ne),x&&a(x,"mouseover",te),(0,S.isCommunityInterface)(t)&&P&&(a(P,"click",(e=>K(t,!0,e))),a(P,"mouseover",(e=>z(t,e)))),a(T,"click",ae),a(T,"blur",se),a(T,"focus",(()=>{t.get().longpoll.push([(0,v.transitionEvent)("search")])})),a(q,"mouseenter",(e=>{var s,a;const n=q.parentNode;null==(s=n.querySelector("._is_active"))||s.classList.remove("_is_active"),null==(a=n.querySelector(`[data-action='${t.get().active_tab}']`))||a.classList.add("_is_active")})),(0,S.isCommunityInterface)(t)&&R&&(n(e,"change",U,(e=>(0,C.onPeerTagsFilterCheckboxChange)(e,t))),n(e,"click",H,(e=>(0,C.onPeerTagsFilterPaneItemClick)(e,t))))}});return(0,S.isCommunityInterface)(t)&&(R?(0,C.initPeerTagsFilter)(t):P&&K(t,!1,{target:P})),o(e,M,m,T,ee,$,s,ie,i,Q,_,g)}},849965:(e,t,s)=>{"use strict";s.d(t,{doesSearchResultContainConversations:()=>u,mount:()=>g});var a=s(705758),n=s(795558),i=s(82161),o=s(15080),r=s(875610),l=s(527405),c=s(95638);function d(e,t,s,o){let d=(0,i.intval)((0,n.domData)(o,"msgid"));if((0,a.getSelectionText)())return;if((0,l.checkSelectClick)(s))return;let _=(0,i.intval)((0,n.domData)(o,"peer"));return e.set(r.cancelSearch.bind(null,_)),e.get().longpoll.push([(0,c.changePeer)(_,d,!1,!1,t)]),!1}function _(e,t){return{isAll:e=>(0,r.isSearchAllLoaded)(e.get().peer,e.get()),loadMore:e=>function(e){return(0,r.isSearchAllLoaded)(e.get().peer,e.get())?Promise.resolve(""):(0,r.searchMessagesInplace)(e.get().peer,e.get())}(e),unmount(){(0,o.destroyModule)(t)}}}function u(e){return e.findIndex((e=>"number"==typeof e.peerId&&e.href))>-1}function g(e,t,s){let a=d.bind(null,t,s);return _(0,(0,o.createModule)({handlers:(t,s)=>{s(e,"click","_im_mess",a)}}))}},616829:(e,t,s)=>{"use strict";s.d(t,{mount:()=>h});var a=s(15080),n=s(29271),i=s(82161),o=s(795558),r=s(527405),l=s(875610),c=s(222009),d=s(220661),_=s(797673),u=s(931917);const g="_im_retry_media",m="_im_replied_message";function p(e,t,s,a,p){if((0,l.isSearchingInplace)(e.get().peer,e.get()))return;if((0,o.hasClass)(p,r.FAILED_CLASS)||(0,o.hasClass)(p,r.SENDING_CLASS)||(0,o.hasClass)(p,"_im_mess_srv"))return;if((0,r.checkSelectClick)(a,p)||(0,c.isAnyMessageBeingEdited)(e))return;if("A"===a.target.tagName)return;if((0,o.domClosest)(m,a.target))return;if(a.target.classList.contains(g))return;if(a.target.closest("."+r.MESSAGE_KEYBOARD_BUTTON_CLASS))return;if(a.target.closest("."+r.BOT_CAROUSEL_CLASS))return;if(a.target.closest("."+d.WIDGET_ACTIONS))return;if(a.target.closest("."+r.MESSAGE_ASR_COLLAPSE_TOGGLE_BUTTON))return;if(a.target.classList.contains(_.AUDIO_MSG_AUTOSHOW_SETTING_HINT))return;if((0,o.domClosest)("scroll-button--right",a.target)||(0,o.domClosest)("scroll-button--left",a.target))return;const h=(0,i.intval)((0,o.domData)(p,"msgid")),v=e.get().peer;if((0,r.isAlreadyDeleted)(e,v,h))return;let f,b;f=a.shiftKey?(0,c.getMessageRangeFromSelection)(e,v,h):[h],e.set(l.addSelection.bind(null,f)).then((()=>{const a=(0,c.getSelectedMessages)(e);let r=!1;f.forEach((e=>{const t=(0,o.geByClass1)("_im_mess_"+e,s);if(t){const s=(0,i.inArray)(e,a);r|=s,(0,o.toggleClass)(t,"im-mess_selected",s);let l=s?n.getLang("mail_deselect_message"):n.getLang("mail_select_message");const c=(0,o.geByClass1)("_im_mess_blind_label_select",t);(0,o.attr)(c,"aria-label",l)}})),r&&(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()),t().changedMessageSelection(e)})).then((()=>{1!==e.get().selectedMessages.length||b?b&&b.hide():b=function(e){const t=e.get();if(t.pinnedMessagesPromo&&u.Ranges.isChatOrChannelPeer(t.peer)){const t=(0,o.geByClass1)("_mess-action-promo"),s=new ElementTooltip(t,{autoShow:!1,appendTo:t,content:(0,i.getTemplate)("im_pinned_messages_promo",{content:n.getLang("mail_pinned_messages_promo_tooltip")}),forceSide:"bottom",cls:"feature_intro_tt",width:260,onHide:function(){e.setState({pinnedMessagesPromo:!1}),(0,l.hidePromoTooltip)()}});return s.show(),s}}(e)}))}function h(e,t,s){const n=p.bind(null,t,s,e),i=(0,a.createModule)({handlers:(t,s)=>{s(e,"click","_im_mess",n)}});return function(e,t){return{cleanSelection(t){t&&Array.isArray(t)&&t.length&&t.map((t=>(0,o.geByClass1)("_im_mess_"+t,e))).filter((e=>e)).forEach((e=>(0,o.removeClass)(e,"im-mess_selected")))},unmount(){(0,a.destroyModule)(t)}}}(e,i)}},418252:(e,t,s)=>{"use strict";s.d(t,{mount:()=>b});var a=s(15080),n=s(29271),i=s(795558),o=s(527405);const r="._im_sick_reload",l="._im_sick_timer",c=5e3,d=6e5,_=30,u=400;let g,m;function p(e){const t=(0,i.ge)("page_header"),s=(0,i.clientHeight)()-t.offsetHeight-_-2,a=u;(0,i.setStyle)(e,{height:Math.max(s,a)})}function h(e){const t=(0,o.formatTimespan)(Math.floor(Math.max(e,0)/1e3),!0);return t?n.getLang("mail_sick_timer").replace(/{timer}/gi,t):""}function v(){nav.reload({force:!0})}function f(e){return{unmount(){clearInterval(m),clearTimeout(g),(0,a.destroyModule)(e)}}}function b(e,t,s){p(e);const{bindMutations:n}=(0,a.createMutations)(f),i=n((0,a.createModule)({handlers:(t,s)=>{t(e.querySelector(r),"click",v),t(window,"resize",p.bind(null,e))}})),o=function(){const e=localStorage.getItem("im_sick_timer"),t=e?Math.min(2*parseInt(e),d):c;return localStorage.setItem("im_sick_timer",t),t}(),_=e.querySelector(l),u=+new Date;return _.innerHTML=h(o),m=setInterval((()=>{_.innerHTML=h(u+o-new Date)}),500),g=setTimeout(v,o),i}},836791:(e,t,s)=>{"use strict";s.d(t,{mount:()=>A});var a=s(953908),n=s(29271),i=s(584356),o=s(82161),r=s(795558),l=s(514986),c=s(875610),d=s(527405),_=s(15080),u=s(616829),g=s(552666),m=s(95638),p=s(321342),h=s(854099),v=s(179936);const f="_im_spam_not_spam",b="_im_spam_spam",w="_im_spam_flush";function C(e,t,s,a){if(e.loading||e.all)return;if(s.scrollTop+window.innerHeight-s.scrollHeight>-300){let s=(0,r.geByClass1)("_im_peer_history",t.bodyNode);e.loading=!0,(0,d.wrapLoading)(s)((0,c.loadSpam)(e.offset,a.get().gid).then((([t,n,i,o])=>{e.all=o.all,e.offset=o.offset,e.all?(0,r.addClass)(s,"im-important_all"):e.loading=!1,a.set((e=>(0,c.mergeTabs)(e,(0,d.tabFromIds)(o.msgs,o.hash))));let l=(0,r.ce)("div");l.innerHTML=n,s.appendChild(l),(0,p.ensureDomHasActions)(s)})),"bottom")}}function y(e,t){let s=t.get().selectedMessages,a=(0,r.geByClass1)("_im_spam_box",e.bodyNode),i=(0,r.geByClass1)("ui_tab_sel",e.bodyNode);if(s.length>0){let e=n.getLang("mail_selected",s.length);e=e.replace("{count}",s.length),(0,r.val)(i,e+function(){const e=(0,v.getIcon16Cancel)().icon;return`<button aria-label="${n.getLang("mail_deselect_all")}" type="button" class="im-deselect ${d.DESELECT_ALL_CLASS}">${e}</button>`}())}else(0,r.val)(i,n.getLang("mail_spam"));if(0===s.length)(0,r.removeClass)(a,"im-important-box_with-sel");else{(0,r.addClass)(a,"im-important-box_with-sel");const e=document.querySelector(`.${b}`),t=document.querySelector(`.${f}`);e&&t&&(h.FlatButton.setLabel(e,n.getLang("mail_im_mark_delspam",s.length)),h.FlatButton.setLabel(t,n.getLang("mail_im_mark_notspam",s.length)))}}function E(e,t,s){let a=e.get().selectedMessages;e.set(c.cleanSelected).then(s.cleanSelection.bind(null,a)).then((s=>y(t,e)))}function S(e,t,s,a){let n=(0,r.gpeByClass)("_im_mess",a,t);if(!n)return;let i=(0,o.intval)((0,r.domData)(n,"msgid"));n&&((0,c.removeMessageSend)([i],0,e.get().tabs[0].hash,"undel",e.get()),(0,d.restoreMessage)(i,0,t))}function M(e,t,s){let a=e.get().selectedMessages;(0,c.removeMessageSend)(a,0,e.get().tabs[0].hash,"delete",e.get()),(0,d.removeMessagesWithRestore)(a,0,"delete",t),E(e,t,s)}function I(e,t,s){let a=e.get().selectedMessages;(0,c.removeMessageSend)(a,0,e.get().tabs[0].hash,"nospam",e.get()),a.map((e=>(0,r.geByClass1)("_im_mess_"+e))).filter((e=>e)).forEach((e=>{let t=(0,o.intval)((0,r.domData)(e,"peer")),s=(0,o.intval)((0,r.domData)(e,"msgid"));(0,r.val)(e,(0,d.renderGoTo)(t,s)),(0,r.addClass)(e,"im-mess_light")})),E(e,t,s)}function T(e,t,s,n,i){let l=(0,r.gpeByClass)("_im_mess",i,t.bodyNode),c=(0,o.intval)((0,r.domData)(l,"peer")),d=(0,o.intval)((0,r.domData)(l,"msgid"));return t.hide(),s().unmount(),e.get().longpoll.push([(0,m.changePeer)(c,d,!1,!1,"spam_box")]),(0,a.stopEvent)(n),(0,a.cancelEvent)(n),!1}function k(e,t,s,a){const o=(0,l.showFastBox)({title:n.getLang("mail_deleteall1"),bodyStyle:"padding: 20px; line-height: 160%;"},n.getLang("mail_delete_all_spam"),n.getLang("mail_delete"),(()=>{(0,c.flushSpam)(e,a).then((([e,t])=>{(0,i.showDoneBox)(t)})),o.hide(),t.hide(),s().unmount()}),n.getLang("mail_close"),(()=>o.hide()))}function L(e,t){return{unmount(){t.unmount(),(0,_.destroyModule)(e)}}}function A(e,t,s){let a=(0,r.ge)("box_layer_wrap"),{callMutations:n,bindMutations:i}=(0,_.createMutations)(L),o=(0,g.default)({peer:0,oCache:{},tabs:(0,d.tabFromIds)(s.msgs,s.hash),gid:t.get().gid}),l=C.bind(null,{all:s.all,loading:!1,offset:s.offset},e,a,o),c=S.bind(null,o,e.bodyNode),m=T.bind(null,t,e,n),h=k.bind(null,s.hash,e,n,t.get().gid),v=(0,u.mount)(e.bodyNode,o,(t=>({changedMessageSelection:y.bind(null,e)}))),A=M.bind(null,o,e.bodyNode,v),P=I.bind(null,o,e.bodyNode,v),x=E.bind(null,o,e,v);(0,p.ensureDomHasActions)(e.bodyNode);return i((0,_.createModule)({handlers:(t,s)=>{t(a,"scroll",l),s(e.bodyNode,"click",b,A),s(e.bodyNode,"click",f,P),s(e.bodyNode,"click",w,h),s(e.bodyNode,"click",d.RESTORE_CLASS,c),s(e.bodyNode,"click","_im_go_to",m),s(e.bodyNode,"click",d.DESELECT_ALL_CLASS,x)}}),v)}},717150:(e,t,s)=>{"use strict";s.d(t,{mount:()=>St});var a=s(11010),n=s(434788),i=s(835200),o=s(196026),r=s(643897),l=s(953908),c=s(795558),d=s(82161),_=s(457321),u=s(85981),g=s(179880),m=s(875610),p=s(527405),h=s(945263),v=s(222009),f=s(783400),b=s(778930),w=s(273555),C=s(705758),y=s(15080),E=s(659397),S=s(514986),M=s(320422),I=s(221780),T=s(501087),k=s(936134),L=s(857861),A=s(489141),P=s(37396),x=s(755320),B=s(590646),R=s(106455),D=s(375353),O=s(95638),F=s(408014),N=s(502478),U=s(95432),H=s(839470),j=s(638871),q=s(300069),G=s(540537),V=s(931917),K=s(391199),z=s(239301),Z=s(661893);const W=4,$=5,Y=6,Q=7,X=9,J=11,ee=12,te=13,se=14,ae=16,ne=19,ie=20,oe=23,re=26,le=28,ce=29,de=62,_e=2e3,ue="_im_media_selector",ge="_im_media_fwd",me="_im_replied_content",pe="_im_fwd_close",he="_im_remove_replied",ve="_im_peer_mute_unmute",fe="_im_peer_return_to_chat",be="_mr_button_accept",we="_mr_button_reject",Ce="_im_submit_btn",ye="_im_media_preview",Ee="_im_chat_audio_input_parent",Se="MassMentionWarning",Me="MassMentionWarning--hidden",Ie="MassMentionWarning__close",Te="app_action_mini_apps",ke="app_action_mini_apps_ab_direct",Le="app_action_mini_apps_ab_chat";function Ae(e,t){if(!e)return!1;window.tooltips&&tooltips.hide(e,t)}function Pe(e,t,s,a,n,o,r=!0){if(dt(t,a))return Promise.resolve(!1);let l=Ue(a);const c=(0,v.getTab)(a,t);l.getBoundAttach(s.message)&&!/^https:\/\/(\w)+se\.mvk\.com\//.test(s.message)&&(s.message=""),s.share_url=l.getShareUrl(),s.cancelled_shares=l.getCancelledShares();let _=(0,w.random)(),u={peerId:t,messageId:"rid"+_,flags:i.FLAG_OUTBOUND,date:(0,d.intval)(Date.now()/1e3)-a.get().timeshift,subject:"",text:(0,p.replaceSpecialSymbols)((0,d.clean)(s.message)).replace(/\n/gi,"<br>"),local:!0,kludges:{emoji:!0,from_admin:a.get().gid?vk.id:null},type:i.ADD_MESSAGE,attaches:(g=s.attaches,g.map((e=>({id:e[1],type:e[0],kind:e[2]||null})))),minorSortId:c.minor_sort_id};var g;return(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(t)&&(u.kludges.payload=s.payload),(0,H.partConfigEnabled)("im_chasiky_debug")&&(window.meBufferLog[_]=[{text:u.text,timestamp:Date.now(),ts:window.lpConnect.options.ts}]),s.rid=_,s.mess=u,e(t,s),a.get().longpoll.push([u]),r&&o().clearText(t,a),n().newMessage(a),Promise.resolve(!0)}function xe(e,t,s,a,n,i,o,l=!1){l||(l=e.get().peer);const c=Ue(e),_=Be(c,o),u=_?c.dData.attaches.map((e=>[e.type,e.id])):[],g={message:"",attaches:[].concat(u,i)};o&&(0,d.extend)(g,o),Re(e,t,!1).then((()=>Pe(s,l,g,e,t,a,!1).then((s=>(_&&Ye(e,n,t),Promise.resolve(s)))))).catch((t=>{(0,r.debugLog)(t),Ne(e,n)}))}function Be(e,t){const s=e.dData,a=t&&t.sticker_referrer,n=a&&0===a.indexOf("suggestion"),i=t&&t.is_hintach_item;return(!s.txt.trim()||n||i)&&0===s.attaches.filter((e=>"reply"!==e.type)).length}function Re(e,t,s){return e.get().tabs[e.get().peer].skipped>0?(t().loadingPeer(e),e.setState({no_moving_down:!0}),e.set(m.changePeer.bind(null,e.get().peer,!1,!1)).then((()=>e.set((t=>(0,G.loadPeer)(t,e.get().peer,-1,!0,!1,"toEnd"))))).then((()=>(t().changePeer(e,!1),e.setState({no_moving_down:!1}),s)))):Promise.resolve(s)}function De(e,t,s){const a=!!(0,d.intval)((0,c.domData)(s,"val"));a!==cur.ctrl_submit&&(cur.ctrl_submit=a,(0,j.setInfo)("messages_multiline_input",String(Number(a))).then((()=>{})),e.set((e=>(0,q.setLocalSettingsValue)("ctrl_submit",Number(a),e))))}function Oe(e,t,s,a){return!e.get().delayed_ts&&setTimeout((()=>{e.set(m.setDelayedMessage.bind(null,!1,!1)).then((()=>{s(...a)}))}),t)}function Fe(e=I.getLang("mail_send_error")){const t=I.getLang("global_error");(0,S.showFastBox)({title:t},e,I.getLang("mail_ok"),(()=>{nav.reload({force:!0})}))}function Ne(e,t){document.activeElement&&document.activeElement.blur(),Fe();let s=(0,c.geByClass1)("_im_send",t);return e.set(m.toggleSendingAbility.bind(null,!0)).then((()=>{(0,p.lockButton)(s)}))}function Ue(e){return e.get().tfdraft||new P.ImDraft}function He(e,t,s,a,n,i){const o=(0,N.getPeer)(e),l=(0,v.getCurrentKeyboard)(e)||{},{one_time:d=!1}=l,_=(0,c.geByClass1)("_im_send",a);return Promise.resolve().then((()=>{if((0,v.isSendingAvailable)(e)){if((0,m.isAnythingLoading)(e.get())||!(0,p.isFullyLoadedTab)(e,e.get().peer)){let t=Oe(e,_e,He,(0,C.toArray)(arguments));return e.set(m.setDelayedMessage.bind(null,!0,t)).then((()=>{(0,p.lockButton)(_)}))}return clearTimeout(e.get().delayed_ts),e.set(m.setDelayedMessage.bind(null,!1,!1)).then((()=>(0,p.unlockButton)(_))).then(Re.bind(null,e,t)).then((()=>{const a=i.keyboardAuthorId,r=i.action||{},l=r.attaches||[],c=(0,E.decodeHTMLEntities)(r.payload||"");let d=(0,E.decodeHTMLEntities)(r.label||"");if(V.Ranges.isChatOrChannelPeer(o)){d=`@${(0,B.oCacheGet)(e,a).link.slice(1)} ${d}`}return(0,h.statlogsValueEvent)("message_send_from_keyboard",0,e.get().id,o,a),Pe(s,o,{message:d,attaches:l,payload:c},e,t,n,!1)})).then((()=>d?e.set(m.deleteKeyboard.bind(null,o)):Promise.resolve())).then((()=>n().fixKeyboard()))}})).catch((t=>{(0,r.debugLog)(t),Ne(e,a)}))}function je(e,t,s,a,n,i,o=[],l){return Promise.resolve().then((()=>{let r=(0,c.geByClass1)("_im_send",a);if(!(0,v.isSendingAvailable)(e))return!1;if((0,m.isAnythingLoading)(e.get())||!(0,p.isFullyLoadedTab)(e,e.get().peer)){let t=Oe(e,_e,je,(0,C.toArray)(arguments));return e.set(m.setDelayedMessage.bind(null,!0,t)).then((()=>{(0,p.lockButton)(r)}))}clearTimeout(e.get().delayed_ts),n().saveText(e);let d=!1,_=Ue(e),u=_.dData.attaches.map((e=>{var t;if("poll"==e.type){let t=i.pollData();return t||(d=!0),[e.type,e.id,t]}return"share"==e.type&&(null==(t=e.object)?void 0:t.extpage_raw)?[e.type,e.object.extpage_raw]:[e.type,e.id]})).concat(o);if(d)return!1;const g=e.set(m.setDelayedMessage.bind(null,!1,!1)).then((()=>{(0,p.unlockButton)(r)}));let h=(0,N.getPeer)(e);return g.then((()=>{let i=_.dData.txt,o=t().getEditingMessage();if(!o&&!i&&!u.length)return;if(o)return i||u.length&&!_.hasOnlyReplies(o)?(0,p.isMessageTooLong)(i)?void(0,S.showFastBox)(I.getLang("global_error"),I.getLang("mail_err_edit_too_long")):(t().cancelEditing(),void((0,A.wasMessageReallyModified)(e,o,_)&&((0,A.replaceMsgAfterEdit)(e,o,i,u,_.getShareUrl(),_.getCancelledShares()),t().sendEditMessage(e,o),e.get().longpoll.push([(0,O.editMessageLocallyEvent)(o)])))):void function(e,t,s,a){const n=e.get(),i=n.peer,o=(0,S.showFastBox)({title:I.getLang("mail_dialog_msg_delete_title")},I.getLang("mail_dialog_msg_delete_for_all"),I.getLang("mail_delete"),(function(e){(0,m.removeMessageSend)([a],i,null,"deleteforall",n),o.hide(),t().cancelEditing()}),I.getLang("global_cancel"),(function(){o.hide(),ze((0,c.geByClass1)("_im_text",s))}))}(e,t,a,o.messageId);let r=(0,p.splitMessageToParts)(i,u).map((a=>{const i={message:a.msgText||"",attaches:a.attaches||[]};return(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(h)&&l&&(i.payload=JSON.stringify(l)),Pe(s,h,i,e,t,n)}));return Promise.all(r)})).then(Re.bind(null,e,t))})).catch((t=>{(0,r.debugLog)(t),Ne(e,a)}))}function qe(e,t,s){return e.set(m.deliverMessage.bind(null,t,s,{}))}function Ge(e,t,s,a){e.get().longpoll.push([(0,O.failedMessage)(t,s.mess,a)])}function Ve(e,t,s,n,i,o,r,l,d){let _,u=(0,k.debounce)(_t.bind(null,e,s),500);let g=Emoji.init((0,c.geByClass1)("_im_text",t),{ttDiff:93,rPointer:!0,ref:"im",onSend:()=>bt(e,t).then((0,a._)((function*(t){let s;const a=e.get().peer;if((0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(a)){const e=yield(0,z.loadMarusiaSdk)();if(s={communication_type:K.CommunicationType.text,voice_assistant:{support_process_commands_by_ids:!0}},e&&!e.canSentMessage())return void e.onClick()}return t&&n([],s)}))),controlsCont:t,forceTxt:!e.get().editable,checkEditable:function(s,a){let n=e.get().peer,i=Emoji.val(a);V.Ranges.isZeroOwner(n)||dt(n,e)||Ue(e).dData.txt==i||!i||function(e){let t=e.get().peer;(0,p.isFullyLoadedTab)(e,t)&&!(0,v.isAnyMessageBeingEdited)(e)&&Date.now()-((0,v.getTab)(e,t).lastTyping||0)>1e3*m.ACTIVITY_PERIOD&&e.set(m.sendTyping.bind(null,t))}(e),wt(e,t,i),yt(e,t,i),u(a);let o=t.offsetHeight;if(_&&_!==o){let t=l().updateScroll();l().scrollFix(e,e.get().peer,t)}_=o},onStickerSend:(e,t,s)=>i([["sticker",e,s]],{sticker_referrer:t}),onUGCStickerSend:(e,t)=>i([["ugc_sticker",`${e.owner_id}_${e.id}`]],{sticker_referrer:t}),onHintachSend:(e,t)=>o([[e,t]],{is_hintach_item:!0}),uploadActions:r,suggestionsConfig:e.get().suggestionsConfig,clearText:function(){d().clearText(e.get().peer,e)}});return Emoji.emojiLoadMore(g,{},(()=>l().renderStickersPanel(e))),e.setState({emojiOptId:g}),(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(e.get().peer)&&Emoji.toggleStickers(g,!0),g}function Ke(e,t,s){const a=e.get().peer;if((0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(a))return;const n=Emoji.val((0,c.geByClass1)("_im_text",t));(0,v.isAnyMessageBeingEdited)(e)&&""!==n||bt(e,t).then((t=>{const a=(0,d.intval)((0,c.domData)(s.target,"tttype"));(2===a&&!0!==t||1===a&&!0===t||3!==a&&""===n)&&window.tooltips&&tooltips.destroy(s.target,{fasthide:!0});const i=Ue(e).dData.attaches.length>0;if((0,v.isAnyMessageBeingEdited)(e)&&""===n&&!i)return(0,c.domData)(s.target,"tttype",3),(0,M.showTooltip)(s.target,{text:I.getLang("mail_delete_for_all"),black:!0,force:3!==a,appendParentCls:"_im_chat_input_parent",shift:[-8,-10]});if(!0!==t)return(0,c.domData)(s.target,"tttype",1),(0,M.showTooltip)(s.target,{text:(0,p.isCommunityInterface)(e)?I.getLang("mail_send2"):I.getLang("mail_added_audiomsg"),black:!0,force:1!==a,appendParentCls:"_im_chat_input_parent",shift:[-8,-10]});(0,c.domData)(s.target,"tttype",2);return(0,M.showTooltip)(s.target,{text:(()=>{const t=e.get().settings.ctrl_submit?1:0;return(0,d.getTemplate)("ctrl_submit_hint",{enter_on:t?"":"on",ctrl_on:t?"on":""})})(),dir:"down",shift:[-28,-5],needLeft:!0,className:"im-chat-input--tt",hasover:!0,force:2!==a,showdt:700,zIndex:200,hidedt:700,appendParentCls:"_im_chat_input_parent",onCreate(){radioBtns.im_submit={els:(0,C.toArray)((0,c.geByClass)(Ce)),val:e.get().settings.ctrl_submit?1:0}},onHide(){window.tooltips&&tooltips.destroy(s.target,{fasthide:!0})}})}))}function ze(e){Emoji.focus(e,!0),setTimeout(Emoji.correctCaret.pbind(e),10)}function Ze(e,t){Emoji.val(e,(0,d.clean)(t)),ze(e)}function We(e,t,s,a){const n=e.getFwdRaw(),i=t.querySelector(`.${ge}`),o=t.parentNode.querySelector(`.${me}`);if(!((0,v.getCurrentKeyboard)(a)||{}).hide&&n&&s.toggleKeyboard(!0),i.innerHTML="",o.innerHTML="",n){const t=function(e,t){if(e.get().isEditing){const t=(0,p.getNowEditingMessage)(e);return t&&(0,f.hasReply)(t)}return"reply"===t.type}(a,n),s=t?o:i,r=n.object;s.innerHTML=t?$e(r):function(e,t,s,a){if(s.object&&s.object.authorName){const t=(0,p.renderShortText)(0,"",a.text,!0,(0,x.convertKludgesToAttaches)(a.kludges,0));return(0,d.getTemplate)("im_attach_mess",{title:a.authorName,messages:t,date:(0,I.getSmDate)(a.date,e.get().timeshift)})}return(0,d.getTemplate)("im_attach_mess",{title:I.getLang("mail_im_fwd_msgs_title"),messages:(0,d.getTemplate)("im_dialog_media",{name:I.getLang("mail_title_X_msgs",t.getFwdCount())}),date:""})}(a,e,n,r)}}function $e(e){const t=(0,p.renderShortText)(0,"",e.text,!0,(0,x.convertKludgesToAttaches)(e.kludges,0));return(0,d.getTemplate)("im_replied_message",{authorName:e.authorName,text:t})}function Ye(e,t,s){return e.set(m.forwardMessages.bind(null,null,Ue(e),!1)).then((()=>{const a=t.querySelector(`.${ge}`),n=t.parentNode.querySelector(`.${me}`),i=document.querySelector(`.${Ee} .${me}`);n&&n.children.length&&(n.innerHTML="",Je(e,s)),i&&i.children.length&&(i.innerHTML="",Je(e,s)),a&&a.children.length&&(a.innerHTML="",Je(e,s)),wt(e,t)}))}function Qe(e,t,s){const a=(0,N.getPeer)(e);e.set(m.acceptMessageRequest.bind(null,a)).then((()=>{ft(e,a,t),s()})).catch((()=>Fe()))}function Xe(e,t,s){const a=(0,N.getPeer)(e);e.set((e=>(0,m.rejectMessageRequest)(a,!1,e))).then((()=>{(0,p.isClassicInterface)(e)&&t(e),s(e,a),a===e.get().peer&&e.get().longpoll.push([(0,O.resetPeer)()])})).catch((()=>Fe()))}function Je(e,t){const s=t().updateScroll();t().scrollFix(e,e.get().peer,s)}function et(e,t,s,a){let n=e.get().peer,i=(0,d.inArray)(n,e.get().mutedPeers);e.set(m.toggleMutePeer.bind(null,n,!i,-1)).then(s().updateState.bind(null,n)),(0,l.cancelEvent)(a)}function tt(e,t,s,a){let n=e.get().peer;e.set(m.returnToChat.bind(null,n)).then((e=>e.set(m.getPinnedMessage.bind(null,n)))).then(s().updateChatTopic.bind(null,n)),(0,l.cancelEvent)(a)}const st="close",at="open",nt="hide";function it(e,t,s,a,n,i,o,r){if(o!==st&&o!==at&&o!==nt)throw new Error(`Action "${o}" not found`);const l=e.get(),d=(0,v.getCurrentKeyboard)(e),_=(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(l.peer);((0,p.isCommunityInterface)(e)||!d||l.isEditing||_)&&(o=nt);const u=o===st||o===nt;let g=Promise.resolve();u||s.isMounted||(g=s.init());const m=!d&&o!==at;return g.then((()=>((0,c.toggleClass)(t,"im-chat-input_open-keyboard",!u),(0,c.toggleClass)(t,"im-chat-input_close-keyboard",u&&o!==nt),(0,c.toggleClass)(a,"im_chat-input--keyboard-button_hidden",o===nt),s.toggle(l.peer,u,i)))).then((()=>{if(!m||r){let t=n().updateScroll();return n().scrollFix(e,l.peer,t)}}))}function ot(e,t){if((0,v.isAnyMessageBeingEdited)(e))return!1;const s=e.get();if((0,p.isCommunityInterface)(e))return!1;if(!(0,F.getCurrentTab)(e).moneyTransferAvail)return!1;if(V.Ranges.isGroupId(t))return s.moneyTransferCommAvail;if(V.Ranges.isUserIdTransitional(t)){const e=(0,d.inArray)(t,s.moneyTransferExcept);return t!=vk.id&&!e&&!V.Ranges.isContactId(t)}return!1}function rt(e,t){if((0,v.isAnyMessageBeingEdited)(e))return!1;return!!e.get().moneyRequestAvail&&(!!(0,F.getCurrentTab)(e).moneyRequestAvail&&(!(!V.Ranges.isGroupId(t)&&!V.Ranges.isChatOrChannelPeer(t))||!!V.Ranges.isUserIdTransitional(t)&&(t!=vk.id&&!V.Ranges.isContactId(t))))}function lt(e,t,s,a,i,o,r,l,_,u,g,m,h,f,b,w){return{restoreKeyboard(){this.toggleKeyboard(!!(ls.get("is_keyboards_hide")||{})[(0,N.getPeer)(e)])},toggleKeyboard:(t=!(0,v.getCurrentKeyboard)(e).hide,s=!0)=>it(e,a,m,g,o,s,t?st:at),initKeyboard(){if(!e.get().peer||!(0,v.getCurrentKeyboard)(e))return Promise.resolve();const t=!!(ls.get("is_keyboards_hide")||{})[(0,N.getPeer)(e)];return it(e,a,m,g,o,!0,t?st:at)},fixKeyboard(){const t=(0,v.getCurrentKeyboard)(e);let s;return s=t?t.hide?st:at:nt,it(e,a,m,g,o,!0,s,!0)},hideKeyboard:()=>it(e,a,m,g,o,!1,nt),updateMediaSelectorOptions(e){const t=e.get().peer,s=(0,n._)({gift:(0,p.isGiftOptionAvailableForPeer)(e,t)&&!(0,v.isAnyMessageBeingEdited)(e),money:(0,p.isMoneyOptionAvailableForPeer)(e,t)&&!(0,v.isAnyMessageBeingEdited)(e),poll:V.Ranges.isChatOrChannelPeer(t),app_action_mini_apps:(0,p.isAppActionOptionAvailableForPeer)(t),app_action_games:(0,p.isAppActionOptionAvailableForPeer)(t)},function(e,t){const s=!(0,p.isPeerCurrentUser)(e)&&!(0,p.isCommunityInterface)(t);return{[ke]:s&&V.Ranges.isUserId(e),[Le]:s&&V.Ranges.isChatOrChannelPeer(e)}}(t,e)),i=(0,c.geByClass1)("ms_items_more",a);Object.entries(s).forEach((([e,t])=>{const s=(0,c.geByClass1)("ms_item_"+e,i);(0,c.toggleClass)(s,"ms_item--hidden",!t),t?(0,c.show)(s):(0,c.hide)(s)}))},restoreDraft(e,n,i){t.chosenMedias.length>0&&(e.setState({removingMedias:!0}),t.unchooseMedia(),t.chosenMedias=[],e.setState({removingMedias:!1})),this.updateMediaSelectorOptions(e);const r=e.get().peer,l={im:!0,fromId:-(0,v.getGroupId)(e)||vk.id,peer:r,moneyTransfer:{request:rt(e,r),send:ot(e,r)}},c=(0,N.getEmojiOptId)(e);if(void 0===c?e.setState({suggestionsConfig:l}):Emoji.setSuggestionsConfig(c,l),V.Ranges.isZeroOwner(r))return Promise.resolve();let d=Ue(e);return Emoji.val(s)!==d.dData.txt?(Ze(s,d.dData.txt),yt(e,a,d.dData.txt)):ze(s),(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&((0,x.isMarusiaPeer)(r)?((0,z.loadMarusiaSdk)().then((t=>{var a,n,i;(0,x.isMarusiaPeer)(e.get().peer)&&(t&&t.init({iconContainer:document.querySelector("._im_send"),suggestContainer:document.querySelector("._marusia_suggest"),draftText:d.dData.txt,unreadMessages:null!=(i=null==(a=e.get().tabs[r])?void 0:a.unread)?i:0,needOnboarding:null==(n=e.get().tabs[r])?void 0:n.is_new,textInput:s,setTextValue:Ze}))})),void 0!==c&&Emoji.toggleStickers(c,!0)):((0,z.loadMarusiaSdk)().then((e=>{e&&(e.stopListening(),e.hide())})),void 0!==c&&Emoji.toggleStickers(c,!1))),d.prepareObjects(e.get().gid,n&&n.messageId).then((()=>{if(ft(e,r,s)||r!=e.get().peer)return;let n=d.dData.attaches;for(let e=0;e<n.length;e++)t.chooseMedia(n[e].type,n[e].id,n[e].object||{});if(We(d,a,this,e),i){let t=o().updateScroll();o().scrollFix(e,r,t)}wt(e,a,d.dData.txt)}))},sendMessage(){i([])},sendMessageFromKeyboard:(...t)=>He.call(null,e,o,f,a,...t),choose(e,s,a){t.chooseMedia(e,s,a)},updateChosenMedia(e,s,a){t.updateChosenMedia(e,s,a)},canAddMedia:()=>!t.hasRestrictingAttach()&&!dt(e.get().peer,e),isEmpty:e=>!(0,d.trim)(Emoji.val(s))&&!Ue(e).hasAttaches(),unchoose(e){t.unchooseMedia(e)},attachCount:()=>t.attachCount(),progress(e,s,a){t.showMediaProgress(e,s,a)},updateState(e){this.restoreKeyboard(),ft(e,e.get().peer,s)},focusOn(e){Emoji.editableFocus(s,!1,!0)},setDraft(e,s,a=!0){const n=(0,v.getTab)(e,e.get().peer);(0,F.doesChatTabHaveFlag)(n,1024)&&!e.get().gid||(t.cancelCheckUrl(),h&&h.update(),e.setState({tfdraft:s}),s&&this.restoreDraft(e,o().getEditingMessage(),a))},clearText(e,n){Ue(n).clear(),t.cancelCheckUrl(),t.unchooseMedia(),t.chosenMedias=[],Emoji.val(s,""),Ye(n,a,o);let i=o().updateScroll();o().scrollFix(n,n.get().peer,i)},attachMessages(e,t){if(e.get().peer!==t)return;We(Ue(e),a,this,e);let s=o().updateScroll();o().scrollFix(e,t,s),wt(e,a)},detachMessages(t){const s=Ue(e).getFwdRaw();if(s){if(!!s.id.split(";").find((e=>Math.abs(e)===t.messageId)))return Ye(e,a,o).then((()=>{let t=o().updateScroll();o().scrollFix(e,e.get().peer,t)}))}return Promise.resolve()},cancelRecording(){null==u||u.cancelRecording()},reHeight(e){let t=o().updateScroll();o().scrollFix(e,e.get().peer,t)},isBlocked:()=>dt(e.get().peer,e),toggleStickers(e,t){Emoji.toggleStickers((0,N.getEmojiOptId)(e),!t)},saveText(e){Ue(e).setText(Emoji.val((0,c.geByClass1)("_im_text",a)))},resendAll(){b()},resendPeer(){w(e.get().peer)},unmount(){(0,y.destroyModule)(_),t.destroy(),l.unmount(),m.unmount(),h&&h.unmount(),Emoji.destroy((0,N.getEmojiOptId)(e)),null==u||u.unmount()}}}function ct(e,t){return!!V.Ranges.isChatOrChannelPeer(e)&&t.get().tabs[e].data.kicked}function dt(e,t){return ct(e,t)||(0,v.getTab)(t,e)&&(0,v.getTab)(t,e).block_error>0||(0,p.isLocksAvailable)(t)&&(0,p.isPeerBlocked)(e,t)}function _t(e,t,s){let a=e.get().peer,n=Emoji.val(s);V.Ranges.isZeroOwner(a)||Ue(e).dData.txt==n||dt(a,e)||(t.checkMessageURLs(n,!0,_e),Ue(e).setText(n))}function ut(e){let t=Ue(e).getFwdRaw();t&&window.showForwardBox({act:"a_show_forward_box",will_fwd:t.id,gid:e.get().gid})}function gt(e,t){e.disabled=!0,e.contentEditable="false",(0,c.addClass)(e,"im-chat-input--text_disabled"),(0,c.addClass)(t,"im-chat-input_error"),(0,c.addClass)((0,c.geByClass1)("_im_page_history"),"is_tf_blocked")}function mt(e,t){e.disabled=!1,e.contentEditable="true",(0,c.removeClass)(e,"im-chat-input--text_disabled"),(0,c.removeClass)(t,"im-chat-input_error"),(0,c.removeClass)((0,c.geByClass1)("_im_page_history"),"is_tf_blocked")}const pt="renewSubscriptionButton",ht="im-chat-input--donut",vt="im-chat-input--business-notify";function ft(e,t,s){const a=(0,c.gpeByClass)("_im_chat_input_parent",s),n=(0,c.geByClass1)("_im_chat_input_error",a),i=(0,c.geByClass1)("im-chat-input--error",a);let o=(0,v.getTab)(e,t);const r=dt(t,e);if(r){gt(s,a);let r=function(e,t,s){switch(s.block_error){case Q:case $:return I.getLang("mail_peer_deleted");case se:return I.getLang("mail_community_deleted");case J:return I.getLang("mail_group_banned_messages");case le:return I.getLang("mail_cant_send_messages_by_time");case ce:return I.getLang("mail_cant_send_messages_by_web_bot");case W:case Y:case X:case ne:case ie:case te:return V.Ranges.isGroupId(t)?I.getLang("mail_send_privacy_community_error"):I.getLang("mail_send_privacy_error");case oe:let s=(0,B.oCacheGet)(e,t);return(0,I.langSex)(s.sex,I.getLang("mail_blacklist_user","raw")).replace("{user}",s.kick_name);case ee:return I.getLang("mail_cant_send_messages_to_community");case ae:return I.getLang("mail_chat_youre_kicked");case re:return I.getLang("mail_chats_is_disabled");case 0:if(ct(t,e))return I.getLang("mail_chat_youre_kicked");const a=e.get().block_states[t].name;return I.getLang("mail_community_answering").replace("{username}",a);case de:return I.getLang("mail_chats_user_not_don_error");default:return I.getLang("mail_send_privacy_error")}}(e,t,o);const l=function(e,t){var s;return(null==(s=(0,v.getTab)(t,e))?void 0:s.block_error)===de}(t,e),_=i.querySelector(`[data-type="${pt}"]`);if(l&&(null==i||i.classList.add(ht),!_)){const e="im",t=document.createElement("button");t.textContent=I.getLang("mail_renew_subscription"),t.classList.add("flat_button"),t.dataset.type=pt,t.onclick=()=>(0,U.showDonutSubscribePopup)(null,null,o.ownerId,e,{type:"subscribe",params:{act:"subscribe_popup"}}),i.append(t)}if(_&&!l&&(null==i||i.classList.remove(ht),_.remove()),(0,v.isChannelPeer)(o)&&(0,c.addClass)((0,c.geByClass1)("_im_page_history"),"is_channel"),(0,F.isBusinessNotifyTab)(o)&&(null==i||i.classList.add(vt)),(0,p.isFvkcomgroup)(e,t)&&!e.get().gid){(0,c.addClass)(a,"is-f-vkcomgroup");let s=(0,d.inArray)(t,e.get().mutedPeers);r=(0,v.isChatActive)(o)?(0,d.getTemplate)("sImPeerMuteUnmute",{text:s?I.getLang("mail_im_unmute"):I.getLang("mail_im_mute"),type:s?"unmute":"mute"}):(0,d.getTemplate)("sImPeerReturnToChat",{text:I.getLang("mail_return_to_vkcomgroup")})}else(0,c.removeClass)(a,"is-f-vkcomgroup");return(0,c.val)(n,r),!0}var l;!r&&(null==i?void 0:i.classList.contains(ht))&&(null==i||i.classList.remove(ht),null==(l=null==i?void 0:i.querySelector(`[data-type="${pt}"]`))||l.remove());return o&&(0,p.tabIsMessageRequest)(o)&&!(0,p.tabIsRejectedMessageRequest)(o)&&!(0,H.partConfigEnabled)("simplified_start_conversation")?(gt(s,a),(0,c.addClass)(a,"is-message_request"),(0,c.val)(n,(0,d.getTemplate)("sImPeerAcceptOrRejectMessageRequest",{cls_accept:be,cls_reject:we})),!0):(a.classList.contains("is-message_request")&&(mt(s,a),(0,c.removeClass)(a,"is-message_request"),(0,c.val)(n,"")),s.disabled&&((0,c.removeClass)(a,"is-f-vkcomgroup"),(0,c.removeClass)((0,c.geByClass1)("_im_page_history"),"is_channel"),mt(s,a),(0,c.removeClass)(a,"is-message_request"),(0,c.val)(n,"")),!1)}function bt(e,t,s){return Promise.resolve().then((()=>{const a=null!=s?s:Emoji.val((0,c.geByClass1)("_im_text",t));if((0,d.trim)(a))return!(0,v.isAnyMessageBeingEdited)(e)||!(0,p.isMessageTooLong)(a);const n=Ue(e),i=(0,p.getNowEditingMessage)(e);return n.hasAttaches()&&!n.hasOnlyReplies(i)}))}function wt(e,t,s){const a=(0,c.geByClass1)("_im_send",t.parentNode);Ae(a,{fasthide:!0}),Promise.all([bt(e,t,s),(0,p.isVoiceMessageAvailable)(e)]).then((([t,s])=>{if((0,v.isAnyMessageBeingEdited)(e))(0,c.toggleClass)(a,"is_input_empty",!t),(0,c.attr)(a,"aria-label",I.getLang("mail_im_edit"));else{(0,c.toggleClass)(a,"im-send-btn_audio",!t&&s),(0,c.toggleClass)(a,"im-send-btn_send",t),t&&(0,c.removeClass)(a,"im-send-btn_saudio");const e=t?I.getLang("mail_send2"):I.getLang("mail_added_audiomsg");(0,c.attr)(a,"aria-label",e)}}))}function Ct(e){const t=(0,c.geByClass1)(Se,e);t.classList.contains(Me)||t.classList.add(Me)}function yt(e,t,s){const a=(0,F.getCurrentTab)(e);if(!a)return;if(!V.Ranges.isChatOrChannelPeer(a.peerId)||(0,v.isChannelPeer)(a))return Ct(t);const n=(s.match(D.MASS_MENTION_REGEXP)||[]).map((e=>e.slice(1)));if(0===n.length)return Ct(t),void e.set((e=>(a.dontReopenWarningForCurrentMassMention=!1,Promise.resolve(e))));const i=(0,c.geByClass1)(Se,t),o=(0,c.geByClass1)("MassMentionWarning__title",i),r=(0,c.geByClass1)("MassMentionWarning__text",i),l=(e,t)=>{a.dontReopenWarningForCurrentMassMention||(o.innerHTML!==e&&(o.innerHTML=e),r.innerHTML!==t&&(r.innerHTML=t),i.classList.remove(Me))},d=D.MASS_MENTION_ALIASES.all.some((e=>n.includes(e))),_=D.MASS_MENTION_ALIASES.online.some((e=>n.includes(e)));switch(!0){case d&&a.membersCount>=11:return l(I.getLang("mail_im_mass_mention_warning_title"),I.getLang("mail_im_mass_mention_warning_many_people_mentioned_text",a.membersCount-1));case _&&a.membersCount>=30:return l(I.getLang("mail_im_mass_mention_warning_title"),I.getLang("mail_im_mass_mention_warning_maybe_many_people_mentioned_text"));default:return Ct(t)}}function Et(e){const t=e.get().mediaTypes||[["photo",I.getLang("mail_added_photo")],["video",I.getLang("profile_wall_video")],["audio",I.getLang("profile_wall_audio")],["doc",I.getLang("profile_wall_doc")],["map",I.getLang("profile_wall_map")],["gift",I.getLang("profile_wall_gift")]];return(e.get().moneyTransferAvail||e.get().moneyRequestAvail)&&t.push(["money",I.getLang("profile_wall_money")]),function(e,t){let[s,a]=t.get().mediaTypesServiceAB||[];if(!s&&!a)return e;[s,a]=s<=a?[s,a+1]:[s,a];const n=e.findIndex((([e])=>e===Te)),[[,...i]]=e.splice(n,2);return e.splice(s,0,[ke,...i]),e.splice(a,0,[Le,...i]),e}(t,e)}function St(e,t,s,n,i){cur.share_timehash=t.get().share_timehash;let{callMutations:r,bindMutations:l}=(0,y.createMutations)(lt),h=(0,L.mount)(e,t,r),f=qe.bind(null,t);ls.remove("im_send_queue_2"+vk.id),ls.remove("im_send_queue_1"+vk.id);const{pushMessage:w,inspectQueue:C,resend:E,resendAll:S,resendPeer:k,setErrored:P,complete:B}=(0,b.initQueue)(f,Ge.bind(null,t),{store:!0,key:"im_send_queue_"+vk.id,waitCommit:!0});let D=xe.bind(null,t,i,w,r,e),U=xe.bind(null,t,i,w,r,e),j=ut.bind(null,t);(0,c.hide)((0,c.geByClass1)("ms_items_more_helper",e));const q=Et(t);let G,W=new window.MediaSelector((0,c.geByClass1)(ue,e),ye,q,{from:"message",maxShown:0,vectorIcon:!0,ignoreMobile:!0,onAddMediaChange:function(s,a,n,o){return s&&r().toggleKeyboard(!0),function(e,t,s,a,n,i,o,r,l){if(t.get().removingMedias)return;if("album"===n||"page"===n||"mail"===n||"reply"===n)return!1;if("share"===n&&!o.title)return!1;var c,d;i&&"string"==typeof n?(r&&Ue(t).addBindUrl(r,n,i),Ue(t).addAttach(n,i,o)):(Ue(t).syncWithSelector(l),"number"==typeof i&&l.chosenMedias[i]&&(c=l.chosenMedias[i],d=Ue(t),("string"==typeof c[0]&&"string"==typeof c[1]&&c[1]||"string"==typeof c[0]&&"group"===c[0])&&d.dData.cancelled.push(`${c[0]},${c[1]}`)));const _=e().updateScroll();if(e().scrollFix(t,t.get().peer,_),t.get().delayed_message&&!(0,m.isAnythingLoading)(t.get()))return s([]),!1;wt(t,a)}(i,t,G,e,s,a,n,o,W)},onMediaChange:function(){return function(e,t,s,a,n){if(t.get().removingMedias)return;let i=n.getMedias().find((e=>"poll"===e[0]));i&&Ue(t).addAttach(i[0],i[1],n.pollData(!0,!0)),wt(t,a)}(0,t,0,e,W)},editable:1,onChangedSize:function(){let s=i().updateScroll();i().scrollFix(t,t.get().peer,s),function(e){const t=(0,c.ge)(ye).offsetHeight;(0,c.toggleClass)(e,"im-chat-input--overflowed",t>400)}(e)},sortable:1,teWidth:150,mail:1,teHeight:100,toId:t.get().gid?-t.get().gid:void 0,blockPersonal:t.get().gid?1:0,docParams:t.get().gid?{imhash:t.get().upload_doc_opts.opts.imhash,from:"from_gim"}:{}});G=je.bind(null,t,i,w,e,r,W);let $=Ke.bind(null,t,e),Y=(0,c.geByClass1)("_im_send",e);const Q=(0,p.isCommunityInterface)(t)?null:(0,_.mount)(e,t,xe.bind(null,t,i,w,r,e),(()=>{(0,c.addClass)(Y,"im-send-btn_audio"),(0,c.removeClass)(Y,"im-send-btn_static")}),(()=>{r().restoreKeyboard()}));!function(e,t){const s=(0,c.geByClass1)("_im_text",e);(window.Wall?Promise.resolve():window.stManager.add([window.jsc("web/page.js")])).then((function(){Wall.initComposer(s,{lang:{introText:I.getLang("profile_mention_start_typing"),noResult:I.getLang("profile_mention_not_found")},toup:!0,getValue:()=>V.Ranges.isChatOrChannelPeer(t.get().peer)?(window.Emoji&&Emoji.editableVal||c.val)(s):"",onShow:()=>{(0,c.addClass)(e,"im_mention_shown");let t=data(s,"composer");if(t&&t.wdd&&t.wdd.shown){let e=0,s=!1,a=function(){t.ignoredTerm=t.curTerm,t.curTerm=!1,(0,c.val)(t.wddInput,""),Composer.toggleSelectList(t)};(0,d.each)(t.wdd.shown,(function(){this[0]&&(e++,"@"+t.curTerm==this[2]&&(s=!0))})),!e||s&&1==e?a():(0,o.cancelStackPush)("im_mention",a)}},onHide:()=>{(0,c.removeClass)(e,"im_mention_shown"),(0,o.cancelStackFilter)("im_mention")},searchKeys:[1,7,9],wddOpts:{}})}))}(e,t),t.get().textMediaSelector=W,t.set(m.initTextStore.bind(null,C,E,P,B));let X=(0,c.geByClass1)("_im_text",e);setTimeout((()=>{(0,N.getPeer)(t)&&r().setDraft(t,(0,v.getTabDraft)((0,F.getCurrentTab)(t))),Ve(t,e,W,G,D,U,h,i,r),r().updateMediaSelectorOptions(t)}),0);let J=Ye.bind(null,t,e,i),ee=Qe.bind(null,t,X,(()=>{const e=i().updateScroll();i().scrollFix(t,(0,N.getPeer)(t),e)})),te=Xe.bind(null,t,s,n),se=et.bind(null,t,e,i),ae=tt.bind(null,t,e,i),ne=De.bind(null,t);ft(t,t.get().peer,X);const ie=e.querySelector("._im_keyboard_button"),oe=(0,u.mount)(t,e,He.bind(null,t,i,w,e,r),r),re=(0,p.isCommunityInterface)(t)?(0,g.mount)(t,e.querySelector("._message_templates_container"),(e=>(0,R.setHTML)(X,e)),(t=>(0,c.toggleClass)(e,"im-chat-input--textarea_show-templates",t))):null,le=(0,y.createModule)({handlers:(s,n)=>{s(Y,"click",(()=>{Ct(e),Promise.resolve().then((()=>bt(t,e))).then((0,a._)((function*(e){if(e||(0,v.isAnyMessageBeingEdited)(t)){let e;const s=t.get().peer;if((0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,x.isMarusiaPeer)(s)){e={communication_type:K.CommunicationType.text,voice_assistant:{support_process_commands_by_ids:!0}};const t=yield(0,z.loadMarusiaSdk)();if(t&&!t.canSentMessage())return void t.onClick()}G([],e)}else(0,x.isMarusiaPeer)(t.get().peer)?(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,z.loadMarusiaSdk)().then((e=>{e&&e.onClick()})):(0,p.isVoiceMessageAvailable)(t).then((e=>{if(!e)return;const s=Ue(t);Be(s)&&function(e){const t=document.querySelector(`.${Ee} .${me}`),s=e.getFwdRaw();if(s){const e=s.object;t&&(t.innerHTML=$e(e))}else t.innerHTML=""}(s),Ae(Y,{fasthide:!0}),null==Q||Q.start(),setTimeout((()=>(0,c.removeClass)(Y,"im-send-btn_saudio")),300)}))})))})),s(Y,"mouseover",$),s(X,"focus",(()=>{t.get().longpoll.push([(0,O.transitionEvent)("message")]),cur.focused=t.get().peer})),s(X,"blur",(()=>{let e=0===t.get().peer?"search":"default";t.get().longpoll.push([(0,O.transitionEvent)(e)]),cur.focused=!1})),s(ie,"click",(()=>r().toggleKeyboard(void 0))),s(ie,"mouseover",(()=>{(0,M.showTooltip)(ie,{text(){const e=(0,v.getCurrentKeyboard)(t);return!e||e.hide?I.getLang("mail_show_keyboard"):I.getLang("mail_hide_keyboard")},black:!0,shift:[4,5]})})),s((0,c.geByClass1)(Ie),"click",(()=>{!function(e,t){Ct(t),e.set((e=>((0,F.getCurrentTab)(e).dontReopenWarningForCurrentMassMention=!0,Promise.resolve(e))))}(t,e),ze(X)})),n(e.parentNode,"click",ve,se),n(e.parentNode,"click",fe,ae),n(e.parentNode,"click",he,J),n(e.parentNode,"click",be,ee),n(e.parentNode,"click",we,te),n(e,"click",pe,J),n(e,"click","_im_will_fwd",j),n(e,"keydown","_im_text",(e=>function(e,t,s,a){if(38===a.which&&s().isEmpty(e)&&!t().getEditingMessage()&&!Emoji.shown&&!(0,T.hasAccessibilityMode)()&&!(0,m.isAnythingLoading)(e.get())){let s=(0,A.findLastMessageToEdit)(e,(0,F.getCurrentTab)(e));if(s){if((0,x.isMarusiaPeer)(e.get().peer))return;t().startEditing((0,v.getMessage)(e,e.get().peer,s))}}}(t,i,r,e))),n(document.body,"click",Ce,ne)}}),ce=l(t,W,X,e,G,i,C,h,le,Q,ie,oe,re,w,S,k);return ce.initKeyboard(),(0,H.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,z.loadMarusiaSdk)().then((e=>{e&&(e.on("phrase_start",(e=>{(0,x.isMarusiaPeer)(t.get().peer)&&(Ze(X,e),(0,Z.disableMarusiaTextInput)(X))})),e.on("phrase_update",(e=>{(0,x.isMarusiaPeer)(t.get().peer)&&Ze(X,e)})),e.on("phrase_finish",(e=>{(0,x.isMarusiaPeer)(t.get().peer)&&(Ze(X,e),(0,Z.enableMarusiaTextInput)(X))})),e.on("send_message",(e=>{(0,x.isMarusiaPeer)(t.get().peer)&&Pe(w,Z.MARUSIA_PEER_ID,{message:e.text,payload:JSON.stringify(e.payload),attaches:[]},t,i,r)})),e.on("error",(()=>{(0,x.isMarusiaPeer)(t.get().peer)&&(Ze(X,void 0),(0,Z.enableMarusiaTextInput)(X))})),e.on("suggest_update",(()=>{if((0,p.isClassicInterface)(t)){let e=i().updateScroll();i().scrollFix(t,t.get().peer,e)}else i().scrollBottom()})))})),ce}},406762:(e,t,s)=>{"use strict";s.d(t,{mount:()=>x});var a=s(434788),n=s(15080),i=s(29271),o=s(514986),r=s(795558),l=s(875610),c=s(222009),d=s(527405),_=s(896879),u=s(795557),g=s(82161),m=s(320422),p=s(945263),h=s(196655),v=s(931917);const f="_im_top_banner_button",b="_im_top_banner_hide",w="_im_top_banner_reject_mr",C="_im_top_banner_business_notify",y="_im_top_banner_spam",E="_im_top_banner_friend_add",S="_im_top_banner_button_gifts",M="_im_call_banner_join_btn",I="hiddenCallBanners";function T(e){return!e.children.length}function k(e,t,s={}){const a=(0,r.geByClass1)("_im_dialog_header",e);(0,r.toggleClass)(a,"im-page--chat-header_top-banner",t),(0,r.toggleClass)(a,"im-page--chat-header_top-banner--mr",!!s.messageRequest),(0,r.toggleClass)(a,"im-page--chat-header_top-banner--business-notify",!!s.businessNotify),(0,r.toggleClass)(a,"im-page--chat-header_top-banner--spam",!!s.spam)}function L(e,t){const s=(0,r.geByClass1)(b,e);s&&window.tooltips&&tooltips.hide(s),k(e,!1),t.innerHTML=""}function A(e,t,s){const a=t.participants,n=a.count>0?(0,i.langNumeric)(a.count,i.getLang("mail_im_n_chat_members","raw")):"";return(0,g.getTemplate)("sImCallBannerContent",{user_list:(0,h.renderCallUserList)(e,a.list),title:i.getLang("calls_group_call_banner_title"),desc:n,cls:s?"CallBanner--classic":""})}function P(e){const t=e.peerId;if(v.Ranges.isChatOrChannelPeer(e.peerId)&&!(0,c.isChatActive)(e))return!1;const s=e.callInProgress,a=cur.imDb.selectByKey(I);return a?!(!s||a[t]&&a[t]===s.join_link):!!s}function x(e,t,s){const h=(0,r.geByClass1)("_im_top_banner",e),v=(0,n.createModule)({handlers:(n,_)=>{const u=(0,r.geByClass1)("_im_dialog_header",e);_(e,"click",b,(()=>{const n=t.get().peer,i=(0,c.getTab)(t,n);P(i)?function(e){const t=e.peerId,s=e.callInProgress,n=cur.imDb.selectByKey(I)||{};cur.imDb.updateByKey(I,(0,a._)({},n,{[t]:s.join_link}))}(i):t.set((e=>(0,l.hideTopBannerAction)(n,e))),L(e,h);const o=!!(0,d.renderPinnedMessage)(t);(0,d.compensateHistoryHeightChange)(t,o,!0,s)})),_(e,"click",f,(a=>{const n=function(e,t,s,a,n){const i=e.target,r=t.get().peer;if(i.classList.contains(M)){const e=i.dataset.link;return(0,d.joinCallFromIm)(t,r,e,!1,d.CALL_ENTRY_POINT_JOIN_BANNER),!1}const c=i.dataset.payload;return c?(t.set((e=>(0,l.callbackTopBannerAction)(r,c,e))),L(s,a),!0):(i.classList.contains(w)&&(n().showMessageRequestRejectDialog(t),e.originalEvent.preventDefault()),i.classList.contains(E),i.classList.contains(C)&&(n().showBusinessNotifyDialog(),e.originalEvent.preventDefault()),i.classList.contains(S)&&((0,o.showBox)("al_gifts.php",{act:"get_gift_box",mid:r,ref:"im_birthday_banner"},{stat:["gifts.css",window.jsc("web/wide_dd.js"),"wide_dd.css"]}),(0,p.statlogsValueEvent)("gifts_im_birthday_banner","click",r),e.originalEvent.preventDefault()),!1)}(a,t,e,h,s),i=!n,r=!!(0,d.renderPinnedMessage)(t)||!n;(0,d.compensateHistoryHeightChange)(t,r,i,s)})),_(u,"mouseover",b,((e,t)=>{(0,m.showTooltip)(t,{text:i.getLang("mail_top_banner_hide"),black:1,shift:[8,4],appendEl:document.body})}))}});return{renderPeer(t){const a=(0,c.getTab)(t,t.get().peer);if(!a)return;const n=a.top_banner,i=a.callInProgress,o=!T(h),r=P(a);!r&&!n||(0,c.isSearchShown)(t)?o&&L(e,h):(k(e,!0,{messageRequest:n&&"message_request_banner"===n.name,businessNotify:n&&"business_notify_banner"===n.name,spam:n&&"spam_dialog"===n.name}),h.innerHTML=r?function(e,t){return(0,g.getTemplate)("im_top_banner",{text:A(e,t,(0,c.isClassicInterface)(e)),icon:"",buttons:[(0,g.getTemplate)("sImCallBannerButton",{call_link:t.join_link}),(0,g.getTemplate)("im_top_banner_hide_btn",{})].join(""),classes:"im-top-banner_call"})}(t,i):function(e){const t=e.icon?(0,g.getTemplate)("im_top_banner_icon",{icon:e.icon}):"";let s=e.text;"employees_banner"===e.name&&(s=(0,u.replaceHyperLinks)(s,(e=>(0,u.linksReplacer)(e))),s=(0,_.replaceMentions)(s));let a=(e.buttons||[]).map((e=>{let t="";switch(e.layout){case"tertiary":t="im-top-banner--button-tertiary";break;case"secondary":t="secondary";break;default:t="blue_button"}switch(e.type){case"link":return(0,g.getTemplate)("im_top_banner_button_link",{link:e.link,text:e.text,css_class:t});case"reject_mr":return t+=` ${w}`,(0,g.getTemplate)("im_top_banner_button_link",{link:e.link,text:e.text,css_class:t});case"business_notify":return t+=` ${C}`,(0,g.getTemplate)("im_top_banner_button_link",{link:e.link,text:e.text,css_class:t});case"spam":return t+=` ${y}`,(0,g.getTemplate)("im_top_banner_button_link",{link:e.link,text:e.text,css_class:t});case"gifts_link":return t+=` ${S}`,(0,g.getTemplate)("im_top_banner_button_link",{link:e.link,text:e.text,css_class:t});case"friend_add":return t+=` ${E}`,(0,g.getTemplate)("im_top_banner_button",{callback_data:e.callback_data,text:e.text,css_class:t});default:return(0,g.getTemplate)("im_top_banner_button",{callback_data:e.callback_data,text:e.text,css_class:t})}}));return!1!==e.can_hide&&(a=a.concat([(0,g.getTemplate)("im_top_banner_hide_btn",{})])),(0,g.getTemplate)("im_top_banner",{text:s,icon:t,buttons:a.join(""),classes:{message_request_banner:"im-top-banner--mr",business_notify_banner:"im-top-banner--business-notify",spam_dialog:"im-top-banner--spam"}[e.name]})}(n),n&&"birthday"===n.name&&(0,p.statlogsValueEvent)("gifts_im_birthday_banner","view",t.get().peer));const l=!T(h);(0,d.compensateHistoryHeightChange)(t,l,o,s)},unmount(){(0,n.destroyModule)(v)}}}},857861:(e,t,s)=>{"use strict";s.d(t,{mount:()=>L});var a=s(514986),n=s(254667),i=s(504867),o=s(265865),r=s(953908),l=s(82161),c=s(795558),d=s(29271),_=s(15080),u=s(250783),g=s(875610),m=s(755320),p=s(839470);const h="_im_upload_dropbox",v="jpg jpeg png gif heic heif".split(" "),f=["application/vnd.rn-realmedia-vbr","application/vnd.rn-realmedia"];function b(e){let t=v.slice(0,v.length);if("types"===e){const e=t.length;for(let s=0;s<e;++s)t.push(t[s].toUpperCase());return"*."+t.join(";*.")}return"accept"===e?"."+v.join(",."):"mask"===e?v.join("|"):""}function w(e,t,s){let i=void 0!==t.ind?t.ind:t,o=t.fileName?i+"_"+t.fileName:t;if((0,c.re)("upload"+o+"_progress_wrap"),e().unchoose(o),!(0,c.geByClass1)("popup_box_container")){let e=d.getLang("mail_add_doc_error");"wrong_music_file"===s?e=d.getLang("mail_upload_music_fail"):"wrong_arch_file"===s||"wrong_arch_mp3_file"===s?e=d.getLang("mail_upload_arch_fail"):"photo"===Upload.options[i].file_name?e=d.getLang("mail_add_photo_error"):"video_file"===Upload.options[i].file_name?e=d.getLang("video_upload_error"):"wrong_mp3_file"===s&&(e=d.getLang("docs_upload_mp3_fail")),setTimeout((0,a.showFastBox)({title:d.getLang("global_error")},e).hide,2e3)}(0,n.topError)("Upload failed",{dt:-1,type:102,url:((0,c.ge)("file_uploader_form"+i)||{}).action}),Upload.embed(i)}function C(e){const t=void 0!==e.ind?e.ind:e,s=(e.fileName||e.filename||"").replace(/[&<>"']/g,""),a=s?t+"_"+s:e;let n=(0,c.ge)("upload"+a+"_progress_wrap");return n&&(0,c.hide)((0,c.geByClass1)("progress_x",n)),a}function y(e,t){if(!e().canAddMedia())return"none";if(!t.items||!t.items.length)return"media";const s="^("+b("mask")+")";return[].slice.call(t.items).every((e=>{let t=e.type.split("/");return new RegExp(s,"i").test(t[1])}))?"photo":[].slice.call(t.items).every((e=>"video"===e.type.split("/")[0]||~f.indexOf(e.type)))?"video":"doc"}function E(e){let t=(0,c.geByClass1)(h),s=(0,c.geByClass1)("im-page--chat-header").getBoundingClientRect(),a=(0,c.geByClass1)("im-chat-input").getBoundingClientRect();(s.width<10||a.bottom-s.bottom<10)&&(e="none"),t.style.top=s.bottom+"px",t.style.left=s.left+1+"px",t.style.width=s.width-2+"px",t.style.height=a.bottom-s.bottom+"px",t.setAttribute("data-mode",e),"none"!==e&&t.classList.add("im-dropbox--visible")}function S(){(0,c.geByClass1)(h).classList.remove("im-dropbox--visible")}function M(e,t,s){return{loaded:t,total:s,fileName:e.fileName?e.fileName.replace(/[&<>"']/g,""):void 0}}function I(e,t,s,a){"string"==typeof t&&t.indexOf("TERMINATED")>-1||(t=JSON.parse(t),Upload.onUploadError(e,t.error)),a().reHeight(s)}function T(e,t,s,a,n){let r=t.get().upload_opts,d=(0,c.geByClass1)("_im_upload_photo",n),_=(0,c.geByClass1)("_im_drop_photo",n);return Upload.init(d,r.url,r.params,{accept:b("accept"),file_name:"photo",file_size_limit:26214400,file_types:b("types"),file_match:r.opts.ext_re,lang:r.opts.lang,multiple:1,multi_progress:1,max_files:10,chooseBox:1,clear:1,type:"photo",max_attempts:3,server:r.opts.server,error:r.opts.default_error,error_hash:r.opts.error_hash,dropbox:_,dragEl:document.body,onNoFilteredCallback(e){Upload.onFileApiSend(a,e)},onUploadStart(e,t){delete cur.notStarted,this.onUploadProgress(e,0,0)},onUploadComplete(e,a){let n=(0,o.parseJSON)(a);n.photos?function(e,t,s,a){const n=C(e);ajax.post("al_photos.php",(0,l.extend)({act:"choose_uploaded"},t),{onDone:function(e,t){a().choose("photo",e,(0,l.extend)(t,{upload_ind:n}))},onFail:w.bind(null,a,e)})}(e,n,0,s):I(e,a,t,s)},onUploadProgress(e,t,a){let n=void 0!==e.ind?e.ind:e;s().progress("photo",n,M(e,t,a))},onUploadError(e,t){(0,i.statlogsValueEvent)("upload_photo_fails",1,r.opts.server,t),w(s,e,t)},onDragEnter(e){if((0,p.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,m.isMarusiaPeer)(t.get().peer))return;const a=(0,c.geByClass1)("im-audio-message_recording");e.dataTransfer&&!a&&E(y(s,e.dataTransfer))},onDragOut(){S()},onDrop(){S()}})}function k(e,t,s,a){let n=t.get().upload_doc_opts,r=(0,c.geByClass1)("_im_upload_doc",a),d=(0,c.geByClass1)("_im_drop_doc",a);return Upload.init(r,n.url,n.params,{file_name:"file",file_size_limit:1024*(parseInt(n.opts.file_size_limit_in_MB)||2048)*1024,file_types:"*.*;",lang:n.opts.lang,multiple:1,multi_progress:1,max_files:10,chooseBox:1,clear:1,type:"doc",max_attempts:3,server:n.opts.server,error:n.opts.default_error,error_hash:n.opts.error_hash,dropbox:d,dragEl:document.body,onUploadStart(e,t){delete cur.notStarted,this.onUploadProgress(e,0,0)},onUploadComplete(e,a){let i=(0,o.parseJSON)(a);i.file?function(e,t,s,a){const n=C(e);let i={act:"a_save_doc",blockPersonal:1,from:"choose",mail_add:1};s.opts.imhash&&(i=(0,l.extend)(i,{from_place:"from_gim",imhash:s.opts.imhash})),ajax.post("docs.php",(0,l.extend)(i,t),{onDone:function(e,t,s){a().choose("doc",e+"_"+t,(0,l.extend)(s,{upload_ind:n}))},onFail:w.bind(null,a,e)})}(e,i,n,s):I(e,a,t,s)},onUploadProgress(e,t,a){let n=void 0!==e.ind?e.ind:e;s().progress("doc",n,M(e,t,a))},onUploadError(e,t){(0,i.statlogsValueEvent)("upload_doc_fails",1,n.opts.server,t),w(s,e,t)}})}function L(e,t,s){(0,r.removeEvent)(document.body,"dragover dragenter");const n=(0,c.geByClass1)(h);let l=k(0,t,s,n),v=function(e,t,s,a,n){let r=t.get().upload_video_params;if(!r)return;let l=(0,c.geByClass1)("_im_upload_video",n),d=(0,c.geByClass1)("_im_drop_video",n);return r.options.visible_dropbox=!1,(0,u.getUploadModule)(l,d,r,null,{onUploadStart:function(e,t){delete cur.notStarted,this.onUploadProgress(e,0,0)},onUploadComplete:function(e,a){let n=(0,o.parseJSON)(a);n.video_id?(0,u.onVideoUploaded)(e,n,t.get().textMediaSelector,((e,s)=>{const a=document.querySelector('[data-video="'+s+'"]'),n=e.editable.sizes.x[0]||e.thumb;if(a&&n){a.style.backgroundImage=`url(${n})`;const e=(0,c.gpeByClass)("_im_mess",a);"im"===cur.module&&e&&(0,g.updateVideoThumb)(t,e)}})):I(e,a,t,s)},onUploadProgress:function(e,t,a){let n=void 0!==e.ind?e.ind:e;s().progress("video",n,M(e,t,a))},onUploadError:function(e,t){(0,i.statlogsValueEvent)("upload_video_fails",1,r.options.server,t),w(s,e,t)},onNoFilteredCallback:function(e){Upload.onFileApiSend(a,e)},onDragEnter:function(e){if((0,p.partConfigEnabled)("marusya_web_support_proccess_commands")&&(0,m.isMarusiaPeer)(t.get().peer))return;const a=(0,c.geByClass1)("im-audio-message_recording");e.dataTransfer&&!a&&E(y(s,e.dataTransfer))},onDragOut:function(){S()},onDrop:function(){S()}})}(0,t,s,l,n),f=T(0,t,s,v,n);cur.lang.attachments_limit=t.get().upload_opts.opts.lang.max_files_warning;const C=(0,_.createModule)({handlers:e=>{let t=(0,c.ge)("im_full_upload");e(t,"change",(function n(i){if(!window.Upload||!i.target.files)return;if(s().canAddMedia()){const e=Array.from(i.target.files),t=e.filter((e=>Upload.checkFileType(e.name,b("types")))),s=e.filter((e=>Upload.checkFileType(e.name,(0,u.getUploadVideoExtMasks)("types"))));Upload.onFileApiSend(f,t),Upload.onFileApiSend(v,s)}else(0,a.showFastBox)(d.getLang("global_error"),d.getLang("global_error"));(0,_.destroyModule)(C);const o=t.cloneNode();o.value="",t.parentNode.replaceChild(o,t),t=o,e(t,"change",n)}))}});return{paste(e){Upload.onFileApiSend(f,e)},unmount(){(0,_.destroyModule)(C),Upload.deinit(f),Upload.deinit(v),Upload.deinit(l)}}}},95933:(e,t,s)=>{"use strict";s.d(t,{mount:()=>f});var a=s(320422),n=s(664988),i=s(82161),o=s(795558),r=s(29271),l=s(875610),c=s(15080);const d="_ui_multiselect_cancel";function _(e,t){return t.selection||(t.selection=[]),t.selection.push(e),Promise.resolve(t)}function u(e){return e.selection=[],Promise.resolve(e)}function g(e,t){return t.selection=t.selection.filter((t=>t.id!==e)),Promise.resolve(t)}function m(e,t,s,a,n,r,l){let c=(0,i.intval)((0,o.domData)(l,"peer"));tooltips.hide(l),t.set(g.bind(null,c)).then((i=>{h(e,a,t,n),s().selectionDeleted(t,c)}))}function p(e,t,s,a){e.set(l.setCurrentSearch.bind(null,s,!1)).then(t().onChange)}function h(e,t,s,a){let i=s.get().selection,l=uiSearch.getFieldEl(e);uiSearch.focus(e),i.length>0?(0,o.attr)(l,"placeholder",""):(0,o.attr)(l,"placeholder",(0,n.unclean)(r.getLang("mail_search_creation"))),t.innerHTML=i.map((e=>['<div class="token">',`<div class="token_title">${e.name}</div>`,`<div data-peer="${e.id}" class="token_del ${d}"></div>`,"</div>"])).reduce(((e,t)=>e.concat(t)),[]).join(""),(0,o.toggleClass)(e,"ui_multiselect_has_selection",i.length>0),(0,o.domFC)(e).scrollTop+=50,a()}function v(e,t){return(0,a.showTooltip)(t,{text:r.getLang("mail_create_chat_remove_user"),black:1,shift:[15,8],appendParentCls:"_wrap"})}function f(e,t,s){uiSearch.init(e,{onChange:p.bind(null,t,s)});let a=uiSearch.getFieldEl(e),n=(0,o.ce)("div",{className:"_ui_multiselection ui_multiselect_cnt"});a&&a.parentNode.insertBefore(n,a);let i=function(e){let t=0;return function(){let s=e.offsetWidth;(0,o.setStyle)(e,{width:1});let a=e.offsetLeft;t!==a?(t=a,s=e.parentNode.offsetWidth,(0,o.setStyle)(e,{width:Math.max(30,s-a-20)})):(0,o.setStyle)(e,{width:s})}}(a);t.set(u);let r=m.bind(null,e,t,s,n,i),l=t=>{document.activeElement!==a&&uiSearch.focus(e)};const f=(0,c.createModule)({handlers:(t,s)=>{s(e,"click",d,r),s(e,"mouseover",d,v),t(e,"click",l)}});return{addSelection:(s,a)=>t.set(_.bind(null,{id:s,name:a})).then(h.bind(null,e,n,t,i)),removeSelection:s=>t.set(g.bind(null,s)).then(h.bind(null,e,n,t,i)),resetSelection(){!function(e,t,s,a){e.set(u).then(h.bind(null,t,s,e,a))}(t,e,n,i)},focus(){uiSearch.focus(e)},save(){t.stash(),h(e,n,t,i)},restore(){t.pop(),h(e,n,t,i)},unmount(){uiSearch.destroy(e),(0,c.destroyModule)(f)}}}},120051:(e,t,s)=>{"use strict";s.d(t,{mount:()=>T});var a=s(527405),n=s(82161),i=s(795558),o=s(705758),r=s(2914),l=s(15080);function c(e,t){return(0,o.toArray)(e).find((e=>(0,i.domData)(e,"list-id")===t))}function d(e,t){return(0,o.toArray)(e).findIndex((e=>(0,i.domData)(e,"list-id")===t))}function _(e,t,s,a){if(s){u(e,t,a);const n=(0,i.domData)(s,"list-id"),o=n&&c(t.children,n);o&&a.forEach((e=>(0,i.addClass)(o,e))),e.setState({hoveredListItemId:n})}}function u(e,t,s){const a=(0,i.domQuery)("."+s.join("."),t);a&&(0,o.toArray)(a).forEach((e=>{s.forEach((t=>(0,i.removeClass)(e,t)))})),e.setState({hoveredListItemId:null})}function g(e,t){const s=t&&(0,i.domQuery)("."+t.join("."),e)[0];return s?(0,i.domData)(s,"list-id"):null}function m(e,t,s){return e.map(t).reduce(((e,t)=>(e[t]=!0,e)),s)}function p(e,t,s){return{ids:m(s.get().elements,e,{}),scrolls:t,activated:!0}}function h(e,t,s){return s.elements=s.elements.filter((s=>t(s)!==e)),delete s.ids[e],Promise.resolve(s)}function v(e,t,s){let a=[];s.elements=s.elements.map((s=>{const n=t(s),i=e.filter((e=>t(e)===n))[0];return a.push(n),i||s}));let i=e.filter((e=>!(0,n.inArray)(t(e),a)));return s.elements=s.elements.concat(i),Promise.resolve(s)}function f(e){let t={};return e.forEach((e=>{"r"===e[0]&&t[`a,${e[1]}`]?delete t[`a,${e[1]}`]:t[`${e[0]},${e[1]}`]=e})),Object.keys(t).map((e=>t[e]))}function b(e,t,s,a,n,o,r){for(let t=0;t<a;t++)e=(0,i.domNS)(e);let l=(0,i.se)(n(t));return(0,i.domData)(l,"list-id",s),e?o.insertBefore(l,e):o.appendChild(l),r&&r(l),e}function w(e,t,s,a,n){const r=a.get(),l=r.limit,c=r.offset,d=function(e,t){const s=t.get();return!s._sortedEls&&e&&t.setState({elements:s.elements.sort(e),_sortedEls:!0}),t.get().elements}(s().sortFn,a).slice(0,c+l),_=(0,o.toArray)(e.children).map((e=>(0,i.domData)(e,"list-id"))).filter((e=>!!e)),u=d.map((e=>s().idFn(e).toString())),g=function(e,t){let s=[],a=Math.max(e.length,t.length);for(let n=0;n<a;n++){let a=e[n],i=t[n];!a&&i?s.push(["a",i,n]):a&&!i?s.push(["r",a,n]):a!==i&&(s.push(["r",a,n]),s.push(["a",i,n]))}let n=f(s),i=f(s.reverse());return n.length>i.length?i:n}(_,u);if(function(e,t,s,a,n){if(0===t.length)return;const o=(t=t.sort(((e,t)=>e[2]-t[2]))).filter((e=>"a"===e[0])),r=t.filter((e=>"r"===e[0]));if(r.map((t=>e.children[t[2]])).forEach((e=>(0,i.re)(e))),0===o.length)return;let l=o.shift(),c=l[2],d=b(e.children[c],s[l[2]],l[1],0,a,e,n);for(let t=0;t<o.length;t++)l=o[t],d=b(e.children[c],s[l[2]],l[1],l[2]-c,a,e,n),c=l[2]}(e,g,d,s().renderFn,s().onRenderFn),function(e,t){e.get().loading?t.update(!1,!0):(e.get().loading=!0,t.update(!1,!0),e.get().loading=!1)}(a,t),n)return g.filter((e=>"a"==e[0])).map((e=>parseInt(e[1])))}function C(e,t,s,a,n=!1,i=0,o=0){const r=e.get(),l=t.getContainer().children,c=d(l,a||r.hoveredListItemId);if(c<0)return;let _;_=r.limit+r.offset<c?e.setState({offset:c-r.limit+1}).then(w.bind(null,t.getContainer(),t,s)):Promise.resolve(),_.then((()=>{const e=l[c],s=t.scrollTop(),a=t.getScrollHeight(),r=e.offsetHeight;i="center"===i?-.5*a:i,o="center"===o?a/2:o;let d=n?function(e){t.smoothScroll(e-t.scrollTop())}:t.scrollTop.bind(t);const _=s+i>e.offsetTop,u=r+e.offsetTop>s+a-o;_?d(e.offsetTop-i):u&&d(e.offsetTop-a+r+o)}))}function y(e,t,...s){return e.get().loading||e.get().stop||!e.get().activated?Promise.resolve([]):(e.get().loading=!0,t(...s).then((()=>{e.get().loading=!1})))}function E(e,t,s){return s.scrolls||(s.scrolls={}),s.scrolls[e]&&!t||(s.scrolls[e]={scrolled:s.scrolled||0,scrollItem:s.scrollItem}),Promise.resolve(s)}function S(e,t,s,n){const i=e.get(),o=i.elements,r=n.getContainer();let l=e.setState({offset:i.offset+i.limit}).then((()=>{let s,a=i.offset,l=i.limit;return l+a>o.length?s=t().more(a,l).then((t=>!1===t?[]:(0===t.length&&e.setState({stop:!0}),t))).then(I.bind(null,e,r,n,t,i.pipeId)):(s=Promise.resolve(),w(r,n,t,e)),s}));if(!s){const e=o.length>0?"im-preloader_fixed-bottom":"im-preloader_fixed-center";(0,a.wrapLoading)(r)(l,"bottom",e)}return l}function M(e,t){let s=e.get().pipeId;return!(void 0!==s&&void 0!==t&&s!==t)}function I(e,t,s,a,n,i){return!!M(e,n)&&e.setState(function(e,t,s){const a=e.filter((e=>!s.ids[t(e)]));return{_sortedEls:!1,els:a,ids:m(a,t,s.ids),elements:s.elements.concat(a)}}(i,a().idFn,e.get())).then(w.bind(null,t,s,a))}function T(e,t,s){const a=y.bind(null,t,S.bind(null,t,s)),i=(e,a)=>{(t.get().activated||e)&&(void 0!==a&&t.get().elements.length>0&&t.setState({scrolled:a}),s().onScroll&&s().onScroll())},f=(0,r.createScroll)(e,{noScroll:t.get().noScroll,nativeScroll:t.get().nativeScroll,scrollChange:i.bind(null,!1),more:!!s().more&&a.bind(null,!1)}),b=(0,l.createModule)({handlers:(a,n)=>{n(e,"click",t.get().elCls,s().onClick)}});return t.setState(p(s().idFn,{},t)),{pipe:(e,a)=>(t.setState({pipeId:a}),e.then(I.bind(null,t,f.getContainer(),f,s,a))),replacePreserveOrder:e=>t.set(v.bind(null,e,s().idFn)).then(w.bind(null,f.getContainer(),f,s)),pipeReplace:(e,a,n=!1)=>(t.setState({pipeId:a,stop:!1}),e.then((e=>{if(M(t,a))return t.setState({elements:e,_sortedEls:!1,ids:m(e,s().idFn,{})}).then(w.bind(null,f.getContainer(),f,s,t,n))}))),wipe(){f.getContainer().innerHTML=""},deactivate(){t.setState({activated:!1})},activate(){t.setState({activated:!0})},saveScroll:(e,s)=>t.set(E.bind(null,e,s)),updateScroll(){f.update(!1,!0)},toTop(e,t=!1){t?f.smoothScroll(-f.scrollTop()):f.scrollTop(0),e&&i(e,0)},scrollTop:e=>f.scrollTop(e),restoreScroll(e){const s=t.get().scrolls,a=s[e];return a&&(t.setState({scrolls:(0,n.extend)({},s,{[e]:null})}),f.scrollTop(a.scrolled)),!!a},unsetScroll(e){t.setState({scrolls:(0,n.extend)({},t.get().scrolls,{[e]:null})})},scrollPage(e,t){const s=f.scroll.scroller,a=f.scrollTop(),n=a+("up"===e?-1:1)*s.clientHeight;t?f.smoothScroll(n-a):f.scrollTop(n)},scrollToElement(e,a,n,i){C(t,f,s,e,a,n,i)},getScroller:()=>f.getScroller(),checkMore:e=>t.get().elements.length<t.get().limit?a(e,f):Promise.resolve([]),add:(e,a)=>I(t,f.getContainer(),f,s,a,e),hoverNextElement(e,a,n={}){const i=f.getContainer(),r=i.children,l=d(r,t.get().hoveredListItemId||g(i,a)),c=(0,o.toArray)(r).slice(l+1).find(s().hoverableFn);_(t,i,c,e),C(t,f,s,null,!1,n.top,n.bottom)},hoverPrevElement(e,a,n={}){const i=f.getContainer(),r=i.children,l=d(r,t.get().hoveredListItemId||g(i,a)),c=l>=0&&(0,o.toArray)(r).slice(0,l).reverse().find(s().hoverableFn);_(t,i,c,e),C(t,f,s,null,!1,n.top,n.bottom)},hoverFirstElement(e,a){const n=f.getContainer(),i=n.children,r=(0,o.toArray)(i).findIndex(s().hoverableFn),l=i[r];!t.get().hoveredListItemId&&l&&(_(t,n,l,e),C(t,f,s,r,!1,a.top,a.bottom))},hoverElement(e,a,n){const i=f.getContainer(),o=i.children,r=d(o,e),l=o[r];l&&(_(t,i,l,a),C(t,f,s,r,!1,n.top,n.bottom))},unhoverElements(e){u(t,f.getContainer(),e)},reset(){const e=t.get().scrolls;t.reset(),t.setState(p(s().idFn,e,t))},getHoveredElement:()=>c(f.getContainer().children,t.get().hoveredListItemId),getCurrentElements:()=>t.get().elements,isLoading:()=>t.get().loading,isEmpty:()=>0===t.get().elements.length,remove(e){t.set(h.bind(null,e,s().idFn)).then(w.bind(null,f.getContainer(),f,s))},unmount(){(0,l.destroyModule)(b),f.destroy()}}}},976231:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var _swc_helpers_extends__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(434788),_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(82161),_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(795558),_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(953908),_web_lib_ui__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(725296),_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(893106),_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(10645),_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(643897);const DATA_ATTR_SUBMENU_NAVIGABLE="data-uirmenu-submenu-navigable",uiRightMenu={go:function(e,t,s,a={}){if((0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_2__.checkEvent)(t))return!0;const n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",e),{navOptions:i,ignoreSelected:o=!1,switchMenuOptions:r}=a;if(!o&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_item_sel",n)==e)return!1;if(uiRightMenu.switchMenu(e,void 0,r),uiRightMenu.showProgress(e),!1===s)return!1;const l={onDone:(...t)=>{null==i||null==i.onDone||i.onDone(...t),uiRightMenu.hideProgress(e)}},c=(0,_swc_helpers_extends__WEBPACK_IMPORTED_MODULE_7__._)({},i||void 0,l);return nav.go(s||e,t,c)},switchMenu:function(e,t,s={}){const a=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",e),n=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_item_sel",a),{preventSubmenuExpand:i=!1}=s;if(e==n&&!t)return!1;const o=[],r=[];if((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(a,"_ui_rmenu_auto_expand")){const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass)("_ui_rmenu_sublist",a),s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(e,"_ui_rmenu_subitem")?(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("_ui_rmenu_sublist",e):!!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domNS)(e),"_ui_rmenu_sublist")&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domNS)(e);(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(t,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isVisible)(this)&&this!==s&&(o.push(this),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hide)(this))})),i||!s||(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isVisible)(s)||(r.push(s),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.show)(s)),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(o,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.show)(this)})),(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(r,(function(){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hide)(this)}))}return(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)(n,"ui_rmenu_item_sel"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.addClass)(e,"ui_rmenu_item_sel"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(a,"_ui_rmenu_auto_expand")?(0,_web_lib_utils_common__WEBPACK_IMPORTED_MODULE_0__.each)(o.concat(r),(function(){uiRightMenu.toggleSubmenu(this)})):(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(e,"_ui_rmenu_subitem")&&!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isVisible)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domPN)(e))&&uiRightMenu.toggleSubmenu((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domPN)(e)),!1},unselectAll:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)(e,"ui_rmenu_sliding"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_item_sel",e),"ui_rmenu_item_sel")},isSelectedItem:e=>e.classList.contains("ui_rmenu_item_sel"),showProgress:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(e,"ui_rmenu")||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",e));const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_loading_item",e);t&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)(t,"ui_rmenu_loading_item");const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_item_sel",e);(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_3__.hideProgress)(e),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_3__.showProgress)((0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domFC)(s).parentNode,"","",!1),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.addClass)(e,"ui_rmenu_loading"),(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.addClass)(s,"ui_rmenu_loading_item")},hideProgress:function(e){(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.hasClass)(e,"ui_rmenu")||(e=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",e)),(0,_web_lib_ui__WEBPACK_IMPORTED_MODULE_3__.hideProgress)(e);const t=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",e);(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)(e,"ui_rmenu_loading");const s=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("ui_rmenu_loading_item",t);s&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.removeClass)(s,"ui_rmenu_loading_item")},toggleSubmenu:function(name,ref,event){if(event&&(0,_web_lib_dom_events__WEBPACK_IMPORTED_MODULE_2__.checkEvent)(event))return;const isSubmenuNavigatedResult=toggleSubmenuNavigable(ref);if(isSubmenuNavigatedResult.navigated)return isSubmenuNavigatedResult.navGoResult;const menu=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.gpeByClass)("ui_rmenu",ref);let el,submenu;if("string"==typeof name?submenu=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("_ui_rmenu_"+name+"_list",menu):(submenu=name,name=submenu.getAttribute("data-sublist-id")),el=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.geByClass1)("_ui_rmenu_"+name+"_toggle",menu),!submenu)return!1;el&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.toggleClass)(el,"ui_rmenu_item_expanded",!(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.isVisible)(submenu)),(0,_web_lib_fx__WEBPACK_IMPORTED_MODULE_4__.slideToggle)(submenu,submenu&&(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.getSize)(submenu)[1]?100:0),setTimeout(_web_lib_layout_utils__WEBPACK_IMPORTED_MODULE_5__.updateNarrow,100);const onToggle=(0,_web_lib_dom__WEBPACK_IMPORTED_MODULE_1__.domData)(el,"on-toggle");return onToggle&&setTimeout((function(){try{eval(onToggle)}catch(e){(0,_web_lib_debug_tools__WEBPACK_IMPORTED_MODULE_6__.logEvalError)(e,onToggle)}}),150),!1},selectLabelNode:e=>null==e?void 0:e.querySelector(".ui_rmenu_label-text")};function isItemSubmenuNavigable(e){return null==e||null==e.hasAttribute?void 0:e.hasAttribute(DATA_ATTR_SUBMENU_NAVIGABLE)}function toggleSubmenuNavigable(e){if(isItemSubmenuNavigable(e)){if(!e.classList.contains("ui_rmenu_item_sel")){return{navigated:!0,navGoResult:uiRightMenu.go(e,void 0,void 0,{switchMenuOptions:{preventSubmenuExpand:!0}})}}}return{navigated:!1}}const __WEBPACK_DEFAULT_EXPORT__=uiRightMenu},649851:(e,t,s)=>{"use strict";s.d(t,{initDraggable:()=>n,removeDraggable:()=>i});var a=s(953908);function n(e,t){let s,n,i=function(a){s=void 0!==a.clientX?a.clientX:a.touches[0].clientX,n=void 0!==a.clientY?a.clientY:a.touches[0].clientY,t.onDrag&&t.onDrag.call(e,s,n)},o=function(r){t.onDrop&&t.onDrop.call(e,s,n),(0,a.removeEvent)(document,"mouseup touchend mouseleave",o),(0,a.removeEvent)(document,"mousemove touchmove",i)},r=function(r){(1===r.which||r.touches&&r.touches[0])&&((0,a.addEvent)(document,"mouseup touchend mouseleave",o),(0,a.addEvent)(document,"mousemove touchmove",i),s=void 0!==r.clientX?r.clientX:r.touches[0].clientX,n=void 0!==r.clientY?r.clientY:r.touches[0].clientY,t.onStartDrag&&t.onStartDrag.call(e,s,n),t.onDrag&&t.onDrag.call(e,s,n),(0,a.cancelEvent)(r))};e.beginDragHandler=r,(0,a.addEvent)(e,"mousedown touchstart",r)}function i(e){(0,a.removeEvent)(e,"mousedown touchstart",e.beginDragHandler)}},753455:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(795558);let n=[],i=0,o=!1;function r(e){n=n.reduce(((t,[s,a])=>a(e)?t:t.concat([[s,a]])),[])}function l(e,t=[]){return i++,{stop(){i--,function(e){n=n.filter((([t])=>t!==e)),0===i&&(document.body.removeEventListener("click",r,!0),o=!1)}(e)},replaceOrAdd(s){const i=n.filter((([t])=>e===t)),l=function(e,t){return 0===t.length?t=>(e(t),!0):s=>{const n=t.reduce(((e,t)=>e&&!(0,a.domClosest)(t,s.target)),!0);return n&&e(s),n}}(s,t);i.length>0?function(e,t){n=n.map((([s,a])=>s===e?[e,t]:[s,a]))}(e,l):function(e,t){!1===o&&(o=!0,document.body.addEventListener("click",r,!0)),n=n.concat([[e,t]])}(e,l)}}}},290183:(e,t,s)=>{"use strict";s.d(t,{create:()=>d});var a=s(552666),n=s(795558),i=s(953908),o=s(527405),r=s(165203);function l(e,t){return t.state=e,Promise.resolve(t)}function c(e,t,s,a,n){switch(t){case r.ARROW_UP:(0,o.isEditableFocused)()||(a.scroll(n,"up"),(0,i.cancelEvent)(s));break;case r.ARROW_DOWN:(0,o.isEditableFocused)()||(a.scroll(n,"down"),(0,i.cancelEvent)(s));break;case r.PAGE_UP:s.ctrlKey||(0,o.isClassicInterface)(n)||(a.scroll(n,"up",!0),(0,i.cancelEvent)(s));break;case r.PAGE_DOWN:s.ctrlKey||(0,o.isClassicInterface)(n)||(a.scroll(n,"down",!0),(0,i.cancelEvent)(s));break;case r.HOME:(0,o.isEditableFocused)()||(a.scroll(n,"up",!1,!0),(0,i.cancelEvent)(s));break;case r.END_KEY:(0,o.isEditableFocused)()||(a.scroll(n,"down",!1,!0),(0,i.cancelEvent)(s));break;case r.PRINTABLE:a.focustTxt(e)}}function d(e,t,s,d,_,u){let g=(0,a.default)({state:t||"default"});return{signal(t,a){if(!(cur.storyLayer||cur.articleEditorLayer||window.isArticleLayerOpen()))switch(g.get().state){case"default":return c(g,t,a,d,e);case"fwd":case"search":return function(e,t,s,a,l,c){switch(t){case r.ARROW_DOWN:a&&a.hoverNextDialog(c),(0,i.cancelEvent)(s);break;case r.ARROW_UP:a&&a.hoverPrevDialog(c),(0,i.cancelEvent)(s);break;case r.ENTER:(0,o.isEditableFocused)()&&!(0,n.gpeByClass)("_im_dialogs_search_input",document.activeElement)||a&&a.selectHoveredDialog(c);break;case r.PRINTABLE:l.focusInput()}}(0,t,a,s,_,e);case"create":return function(e,t,s,a,l){switch(t){case r.PAGE_UP:!s.ctrlKey&&(0,o.isClassicInterface)(l)&&(a.scroll("up"),(0,i.cancelEvent)(s));break;case r.PAGE_DOWN:!s.ctrlKey&&(0,o.isClassicInterface)(l)&&(a.scroll("down"),(0,i.cancelEvent)(s));break;case r.ARROW_DOWN:a.hoverNextElement(l);break;case r.ARROW_UP:a.hoverPrevElement(l);break;case r.ENTER:(0,n.gpeByClass)("_im_dialogs_creation_name",document.activeElement)?a.confirmCreate(l):(0,n.gpeByClass)("im-create--search",document.activeElement)&&a.selectElement(l);break;case r.PRINTABLE:a.focusSearch(l)}}(0,t,a,u,e);case"message":return function(e,t,s,a,n){switch(t){case r.HOME:case r.END_KEY:a.isEmpty(n)&&c(e,t,s,a,n);break;case r.PAGE_UP:case r.PAGE_DOWN:c(e,t,s,a,n)}}(g,t,a,d,e);default:throw new Error("Unknown state: "+g.get().state)}},transition:e=>g.set(l.bind(null,e))}}},594901:(e,t,s)=>{"use strict";s.d(t,{startLongPoll:()=>P,startLongPollForGroup:()=>A});var a=s(875610),n=s(504867),i=s(82161),o=s(552666),r=s(302925),l=s(835200),c=s(731062),d=s(778930),_=s(705758),u=s(309436),g=s(329737);const m=202,p=4,h=14,v=3e4;let f={},b=Date.now();function w(e,t){let s=Math.floor(t.status/100);t.status&&e.stat&&(t.status>=500&&t.status<600&&(0,n.statlogsValueEvent)("im_longpoll",1,s+"0x",t.getResponseHeader("x-frontend")),f[s]=f[s]?f[s]+1:1,Date.now()-b>=v&&(Object.keys(f).forEach((e=>{(0,n.statlogsValueEvent)("im_longpoll",f[e],e+"0x",t.getResponseHeader("x-frontend"))})),f={},b=Date.now()))}function C(e,t){return Promise.resolve((0,i.extend)({},t,{timeout:e<64?2*e:e}))}function y(e,t){return Promise.resolve((0,i.extend)({},t,{imTs:e}))}function E(e){e.set((e=>Promise.resolve((0,i.extend)({},e,{stopped:!0})))).then((()=>{e.get().cancelToken()}))}function S(e,t){return t.cancelToken=e,Promise.resolve(t)}function M(e,t){return t.pauses||(t.pauses=[]),t.pauses.push(e),Promise.resolve(t)}function I(e){return e.pauses||(e.pauses=[]),(0,_.lplog)("Aborting all pauses","error"),e.pauses.forEach((e=>e())),e.pauses=[],Promise.resolve(e)}function T(e,t,s,n){let{abort:i,pause:o}=n.failed?(0,c.abortablePause)(p,e):{};switch(n.failed){case 1:return(0,_.lplog)("Old timestamp, init resync","error"),e.set(M.bind(null,i)),s([l.resyncEvent()]),e.set(a.loadLongPollTs).then(o).then(k.bind(null,e,t,s));case 2:return(0,_.lplog)("Key is incorrect","error"),e.set(M.bind(null,i)),e.set(a.loadLongPollKey).then(o).then(k.bind(null,e,t,s));case 3:throw nav.reload({force:!0}),new Error("ts is very wrong");default:return e.set(y.bind(null,n.ts)).then((()=>n))}}function k(e,t,s){if(e.get().stopped)return Promise.resolve({updates:[]});if(t())return Promise.reject(new Error("pause"));const a=e.get(),n=`${a.imUrl}/${a.imPart}`,{request:i,cancel:o}=(0,r.plaingetCancelable)(n,{act:"a_check",key:a.imKey,version:h,ts:a.imTs,wait:25,mode:a.mode});return e.set(S.bind(null,o)).then((()=>i)).then((([t,s])=>(s&&w(a,s),e.set(C.bind(null,1)),JSON.parse(t)))).catch((([e,t])=>(t&&w(a,t),Promise.reject(new Error(""))))).then(T.bind(null,e,t,s))}function L(e,t,s){e.get().stopped||((0,_.lplog)("New request"),k(e,s,t).then((e=>e.map(l.constructEvent))).then((e=>((0,_.lplog)("Request success","success"),e))).then(t).catch((t=>{if(!e.get().stopped)return(0,_.lplog)("Error, waiting: "+(t.message||"no message (probably browser reset)"),"error"),e.set(C.bind(null,s()?p/2:e.get().timeout)).then((()=>{let{abort:t,pause:s}=(0,c.abortablePause)(e.get().timeout,e);return e.set(M.bind(null,t)).then(s)}));(0,_.lplog)("Stopped longpoll")})).then(L.bind(null,e,t,s)))}function A(e){const t=new window.EventEmitter,s=(0,g.createLongpollEventsQueue)(e.ts,(e=>{t.trigger("data",e)})),a=(0,u.createLongpoll)(e,s.onLp);return{onData:e=>t.on("data",e),offData:e=>t.off("data",e),push:e=>t.trigger("data",e),pause:s.pause.bind(s),resume:s.resume.bind(s),abortWaiting:a.abortWaiting.bind(a),onLp:s.onLp.bind(s),stop:a.stopConnection.bind(a),isEnabled:()=>!(!a||a.isStopped())}}function P({id:e,gid:t,key:s,ts:a,url:n,lhost:i,lpstat:r}){const l="main",c=new EventEmitter,_=window.vk.lpConfig&&window.vk.lpConfig.enabled&&window.longpollTesting_onImEvents,u=(0,d.initQueue)((function(e,t){return _&&window.longpollTesting_onImEvents(t),c.trigger("data",t),Promise.resolve({})})),{pause:g,resume:p,pushMessage:h,isPaused:v,reset:f}=u,b=(0,o.default)({id:e,gid:t,mode:m,timeout:1,imKey:s,imTs:a,imPart:n,imUrl:i,pause:!1,stat:r});return L(b,h.bind(null,l),v.bind(null,l)),{onData:e=>c.on("data",e),offData:e=>c.off("data",e),abortWaiting:()=>b.set(I),stop:E.bind(null,b),pause:g.bind(null,l),resume:p.bind(null,l),reset:f.bind(null,l),push:e=>c.trigger("data",e),isEnabled:()=>!b.get().pause&&!b.get().stopped}}},778930:(e,t,s)=>{"use strict";s.d(t,{initQueue:()=>f});var a=s(552666),n=s(82161),i=s(731062),o=s(839470);function r(e,t){return t.queues[e].currEv=!1,Promise.resolve(t)}function l(e,t){let s=t.queues[e].currEv;return s?(t.queues[e].errored.push(s),r(e,t)):Promise.resolve(t)}function c(e,t,s){return s.queues[e]?(s.queues[e].errored=t?[]:s.queues[e].errored.concat(s.queues[e].evs),s.queues[e].evs=[],r(e,s)):Promise.resolve(s)}function d(e,t,s,a){let n=a.get().queues[e];if(n&&!n.currEv&&n.evs.length>0&&!n.pause){let i=d.bind(null,e,t,s,a),o=n.evs.shift();n.currEv=o,t(e,o).then((()=>{a.get().opts.waitCommit||a.set(r.bind(null,e))})).then(i).catch((t=>a.set(l.bind(null,e)).then((()=>{s(e,function(e,t){let s=m(e,t.get()).errored;return s.length>0&&s[s.length-1]}(e,a),t)})).then(i)))}}function _(e,t,s){let a=s.queues[e];return a.errored.filter((e=>e.mess.messageId===t)).forEach((e=>{e.failed=!1,a.evs.push(e)})),a.errored=a.errored.filter((e=>e.mess.messageId!==t)),Promise.resolve(s)}function u(e){const t=Date.now();return Object.keys(e.queues).forEach((s=>g(s,e,t,18e5))),Promise.resolve(e)}function g(e,t,s=0,a=0){const n=t.queues[e],i=[];return n.errored.forEach((e=>{e.ts>=s-a?(e.failed=!1,n.evs.push(e)):i.push(e)})),n.errored=i,Promise.resolve(t)}function m(e,t){return t.queues[e]||(t.queues[e]={evs:[],pause:!1,errored:[],currEv:!1}),t.queues[e]}function p(e,t,s){return m(e,s).pause=t,Promise.resolve(s)}function h(e,t,s){return t.ts=Date.now(),m(e,s).evs.push(t),Promise.resolve(s)}function v(e){Object.keys(e.get().queues).forEach((t=>{e.set(l.bind(null,t)),e.set(c.bind(null,t,!1))}))}function f(e,t,s){let l=(0,a.default)({queues:{},debug:s&&s.debug,opts:(0,n.extend)({},s)},s);return s&&s.store?(l.setState(function(e){let t={};const s=Object.keys(e.queues),a=s.length;for(let n=0;n<a;n++){const a=s[n],i=e.queues[a];(i.currEv||i.evs.length||i.errored.length)&&(t[a]=i)}return{queues:t,opts:e.opts}}(l.get())),v(l)):v(l),{pushMessage:(s,a)=>l.set(h.bind(null,s,a)).then((n=>{(0,o.partConfigEnabled)("im_chasiky_debug")&&window.meBufferLog[a.rid].push("queue push message"),d(s,e,t,n)})),resend:(s,a=null)=>l.set(_.bind(null,s,a)).then((()=>{let n=l.get().queues[s].evs.filter((e=>e.mess.messageId===a))[0];return d(s,e,t,l),n})),resendAll:()=>l.set(u).then((()=>{Object.keys(l.get().queues).forEach((s=>{d(s,e,t,l)}))})),resendPeer:s=>l.set(g.bind(null,s)).then((()=>{d(s,e,t,l)})),reset:s=>l.set(c.bind(null,s,!0)).then((a=>{d(s,e,t,a)})),setErrored:(e,t)=>l.set((s=>(m(e,s).errored=t,Promise.resolve(s)))),pause(e){l.set(p.bind(null,e,!0))},isPaused:e=>!!m(e,l.get()).pause,complete(s,a){const n=l.get();n.queues[s].currEv&&n.queues[s].currEv.rid===a&&l.set(r.bind(null,s)).then((()=>{d(s,e,t,l)}))},resume(s){l.set(p.bind(null,s,!1)).then((0,i.pause)(.1)).then((()=>{d(s,e,t,l)}))},inspectQueue(e,t=!1){if(!l.get().queues[e])return[];let s=l.get().queues[e];return(t&&s.currEv?[s.currEv]:[]).concat(s.evs.slice()).concat(s.errored.slice().map((e=>(0,n.extend)({},e,{failed:!0})))).sort(((e,t)=>e.ts-t.ts))}}}},766981:(e,t,s)=>{"use strict";s.d(t,{createWorker:()=>g});var a=s(434788),n=s(731062),i=s(82161);let o=new Map,r=!1;function l(e){return e.queue||e.key}function c(){o.forEach((({onData:e,onUpdateKey:t,ts:s},n)=>{if(function(e){var t;return!!(null==(t=window.curNotifier)?void 0:t.addQueues)&&!curNotifier.addQueues[l(e)]}(n)){const i=(0,a._)({},n,{ts:s});Notifier.addKey(i,u.bind(null,e,t,i))}}))}function d(){r||(r=setInterval(c,3e3))}function _(e){!function(e){var t;if(!(null==(t=window.curNotifier)?void 0:t.addQueues))return!1;delete curNotifier.addQueues[l(e)]}(e),o.delete(e),0===o.size&&(clearInterval(r),r=!1)}function u(e,t,s,a,r){if(r.failed)return _(s),void function(e,t,s,a){let i;switch(e){case 1:case 2:case 3:case 5:i=a(t,e);break;case 4:i=(0,n.pause)(1).then((()=>t));break;default:throw new Error("Unkonwn error from queue: "+e)}(0,n.pause)(3).then((()=>i)).then((e=>{o.set(e,{onUpdateKey:a,onData:s,ts:e.ts}),c(),d()}))}(r.err,s,e,t);const l=(0,i.intval)(r.ts);Object.assign(s,{ts:l}),function(e,t){let s;const a=null==e?void 0:e.queue;if(a)for(let[e]of o)if((null==e?void 0:e.queue)===a){s=e;break}const n=null!=s?s:e;o.set(n,t)}(s,{onData:e,onUpdateKey:t,ts:l}),r.events.map((e=>"string"==typeof e?e.split("<!>"):e)).forEach(e)}function g(e,t,s){return Notifier.addKey(e,u.bind(null,t,s,e)),o.set(e,{onData:t,onUpdateKey:s,ts:e.ts}),d(),{stop:_.bind(null,e)}}},250783:(e,t,s)=>{"use strict";s.d(t,{default:()=>h,getUploadModule:()=>b,getUploadVideoExtMasks:()=>v,onVideoUploaded:()=>w});var a=s(514986),n=s(664988),i=s(29271),o=s(254667),r=s(504867),l=s(265865),c=s(82161),d=s(584356),_=s(953908),u=s(438221),g=s(795558),m=s(653902),p=s(313702);const h={getUploadModule:(e,t,s,a,n)=>b(e,t,s,a,n),initModalVideoUploader(e){const t=cur.videoUploadParams,s=(0,g.ge)("choose_video_upload");if(!s)return!1;this.initDragEvents();const a={};switch(e){case"article":a.onUploadProgress=()=>{},a.onUploadStartDone=e=>{null==window.cur.onMediaUploadStarted||window.cur.onMediaUploadStarted(e)},a.onUploadError=e=>{null==window.cur.onMediaUploadFail||window.cur.onMediaUploadFail(e)};break;case"market":a.onUploadStart=({file:e})=>{null==window.cur.onMediaUploadStarted||window.cur.onMediaUploadStarted(e)}}return b(s,boxLayerWrap,t,null,a)},initDragEvents(){var e;const t=e=>{cur.dragTimeout&&(clearTimeout(cur.dragTimeout),delete cur.dragTimeout);const t=(0,g.ge)("video_choose_upload_area_wrap");if((0,g.hasClass)(t,"video_choose_upload_area_enter"))return;(0,g.addClass)(t,"video_choose_upload_area_enter");const s=(0,g.ge)("video_choose_wrap"),a=(0,g.getXY)(s)[1],n=(0,g.getSize)(t)[1];return(0,g.hide)("video_choose_wrap"),(0,g.setStyle)(t,"height",(0,u.scrollGetY)()+(0,g.clientHeight)()-a+n),(0,_.cancelEvent)(e)},s=e=>(window.cur.dragTimeout&&(clearTimeout(window.cur.dragTimeout),delete window.cur.dragTimeout),window.cur.dragTimeout=setTimeout((()=>{const e=document.getElementById("video_choose_upload_area_wrap");e&&(e.classList.remove("video_choose_upload_area_enter"),e.style.height="auto",(0,g.show)("video_choose_wrap"))}),100),(0,_.cancelEvent)(e)),a=e=>{s();if(e.dataTransfer.files.length&&Upload.checkFilesSizes(window.videoInlineUploader,e.dataTransfer.files))return window.Upload&&Upload.checked&&Upload.checked[window.videoInlineUploader]&&Upload.onFileApiSend(window.videoInlineUploader,e.dataTransfer.files),(0,_.cancelEvent)(e)},n=()=>{(0,_.addEvent)(boxLayerWrap,"dragenter dragover",t),(0,_.addEvent)(boxLayerWrap,"dragleave",s),(0,_.addEvent)(boxLayerWrap,"drop",a)};n();const i=null==(e=(0,d.curBox)().getOptions())?void 0:e.onHide;setTimeout((0,d.curBox)().setOptions.pbind({onHide:()=>{if((0,_.removeEvent)(boxLayerWrap,"dragenter dragover",t),(0,_.removeEvent)(boxLayerWrap,"dragleave",s),(0,_.removeEvent)(boxLayerWrap,"drop",a),"function"==typeof i)return i()},onShow:()=>{Video.initChooseBox(),n()}}),0)}};function v(e){return"types"===e?[...m.VIDEO_UPLOAD_EXTS,...m.VIDEO_UPLOAD_EXTS.map((e=>e.toUpperCase()))].map((e=>`*.${e}`)).join(";"):"accept"===e?m.VIDEO_UPLOAD_INPUT_ACCEPT:""}function f(e){if(cur.leaving)return;const t=i.getLang("video_upload_changed");let s=!1;if((0,c.each)(window.cur.videoUploaders,((e,t)=>{Upload.isSomethingUploading(t)&&(s=!0)})),1===e){if(!s)return!0;const e=(0,a.showFastBox)({title:i.getLang("global_warning")},t,i.getLang("global_continue"),(function(){cur.leaving=!0,e.hide(),cur.onContinueCb&&cur.onContinueCb()}),i.getLang("global_cancel"),(function(){e.hide(),nav.objLoc.section="upload",nav.setLoc(nav.objLoc)}));return!1}return s?(0,n.winToUtf)(t.replace(/<\/?b>/g,"").replace(/<br\s*\/?>/g,"\n")):void 0}function b(e,t,s,n,d){if(!s)return;n=n||cur,(d=d||{}).onUploadStart||(d.onUploadStart=e=>{var t;boxQueue.hideLast(),cur.nav.push((function(e,t,s){if(!1===f(1))return cur.onContinueCb=nav.go.pbind(s),!1})),cur.prevBefUnload=window.onbeforeunload,window.onbeforeunload=f,d.onUploadProgress(e,0,0),null==(t=window.Wall)||null==t.showEditPost||t.showEditPost(),d.onUploadStartDone&&d.onUploadStartDone(e)}),d.onUploadComplete||(d.onUploadComplete=(e,t)=>{let s=(0,l.parseJSON)(t);if(s.video_id)w(e,s,n);else{"string"==typeof t&&t.indexOf("TERMINATED")>-1||Upload.onUploadError(e)}d.onUploadCompleteDone&&d.onUploadCompleteDone(),setTimeout((()=>{d.onUploadAllCompleteDone&&!window.Upload.isSomethingUploading(e.ind)&&d.onUploadAllCompleteDone()}))}),d.onUploadProgress||(d.onUploadProgress=(e,t,s)=>{let a=void 0!==e.ind?e.ind:e;(0,g.show)("_im_media_preview"),n.showMediaProgress&&n.showMediaProgress("video",a,function(e,t,s){return{loaded:t,total:s,fileName:e.fileName?e.fileName.replace(/[&<>"']/g,""):void 0}}(e,t,s))}),d.onUploadError||(d.onUploadError=(e,t)=>{(0,r.statlogsValueEvent)("upload_video_fails",1,s.options.server,t),function(e){let t=void 0!==e.ind?e.ind:e,s=e.fileName?t+"_"+e.fileName:e;if((0,g.re)("upload"+s+"_progress_wrap"),!(0,g.geByClass1)("popup_box_container")){let e=i.getLang("video_upload_error");setTimeout((0,a.showFastBox)({title:i.getLang("global_error")},e).hide,2e3)}(0,o.topError)("Upload failed",{dt:-1,type:102,url:((0,g.ge)("file_uploader_form"+t)||{}).action}),Upload.embed(t)}(e)}),cur.maxFiles=(cur.chooseParams||{}).maxFiles||10;const _=cur.maxFiles-(cur.savedVideos||[]).length;s.lang&&(cur.lang=(0,c.extend)(cur.lang||{},s.lang));const u={accept:v("accept"),file_input:null,file_name:"video_file",file_size_limit:1024*(s.options.file_size_limit_in_GB||m.VIDEO_UPLOAD_MAX_FILE_SIZE_IN_GB)*1024*1024,file_types_description:"Video files",file_types:v("types"),chooseBox:1,chunked:1,chunkSize:m.VIDEO_UPLOAD_CHUNK_SIZE,clear:1,dragEl:t===boxLayerWrap?boxLayerWrap:document.body,dropbox:t,from:s.vars.from,lang:s.lang,max_attempts:3,max_files:_,multiple:1,multi_progress:1,requestOptionsForFile:!0,type:"video",visibleDropbox:!s.options.hasOwnProperty("visible_dropbox")||s.options.visible_dropbox},p=Upload.init(e,"",{},Object.assign(u,d));return window.cur.videoUploaders||(window.cur.videoUploaders=[]),window.cur.videoUploaders.push(p),p}function w(e,t,s,n){s=s||cur;const o=void 0!==e.ind?e.ind:e,r=(e.fileName||e.filename||"").replace(/[&<>"']/g,""),l=r?o+"_"+r:e,d=t.owner_id+"_"+t.video_id,_=cur.isSnippetVideoSelection&&cur.chooseSnippetVideo;let u=(0,g.ge)("upload"+l+"_progress_wrap");u&&(0,g.hide)((0,g.geByClass1)("progress_x",u)),ajax.post("al_video.php?act=a_videos_attach_info",{videos:d},{onDone:e=>{_||s.chooseMedia("video",d,(0,c.extend)(e[d],{upload_ind:l,upload_new:!0}));const o=t.owner_id,r=t.video_id,u=t.video_hash;let m=0;const h=()=>{ajax.post("al_video.php?act=encode_progress",{owner_id:o,vid:r,hash:u,need_thumb:1},{onDone:t=>{let u=!0;if(t){if(t.error)return m=(0,p.getUploadErrorText)(t.error_details),void setTimeout((0,a.showFastBox)({title:i.getLang("global_error")},m).hide,2e3);t.thumb&&100===parseInt(t.percents,10)&&(u=!1,ajax.post("al_video.php",{act:"a_video_photo_sizes",oid:o,vid:r},{onDone:t=>{if(cur.isSnippetVideoSelection&&cur.chooseSnippetVideo)return cur.chooseSnippetVideo(d,t),void(0,g.re)("upload"+l+"_progress_wrap");s.hasChosenMedia("video",d)?s.updateChosenMedia("video",d,(0,c.extend)(t,{upload_ind:l,upload_new:!0})):n&&n(e,d)}}))}var m;u&&(_||s.hasChosenMedia("video",d))&&setTimeout(h,1e3)},onFail:()=>{m++,m<3&&setTimeout(h,2e3*m)}})};h()}})}},910682:(e,t,s)=>{"use strict";s.d(t,{Emoji:()=>c});var a=s(434788),n=s(820224),i=s(785893),o=s(659397),r=s(331092),l=s(876863);function c(e){var{emoji:t,className:s}=e,c=(0,n._)(e,["emoji","className"]);return(0,i.jsx)("i",(0,a._)({className:(0,o.classNames)(l.default.emoji,`@${(0,r.unicodeToByteHex)(t)}`,s),"data-emoji":t},c))}},331092:(e,t,s)=>{"use strict";function a(e){return encodeURIComponent(e.replace(/\uFE0F/giu,"")).replace(/%/gi,"").toLowerCase()}s.d(t,{unicodeToByteHex:()=>a})},159726:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});const a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=(()=>{if("undefined"==typeof document)return!1;const e=a[0],t={};for(const s of a){if((null==s?void 0:s[1])in document){for(const[a,n]of s.entries())t[e[a]]=n;return t}}return!1})(),i={change:n.fullscreenchange,error:n.fullscreenerror};let o={request:(e=document.documentElement,t)=>new Promise(((s,a)=>{const i=()=>{o.off("change",i),s()};o.on("change",i);const r=e[n.requestFullscreen](t);r instanceof Promise&&r.then(i).catch(a)})),exit:()=>new Promise(((e,t)=>{if(!o.isFullscreen)return void e();const s=()=>{o.off("change",s),e()};o.on("change",s);const a=document[n.exitFullscreen]();a instanceof Promise&&a.then(s).catch(t)})),toggle:(e,t)=>o.isFullscreen?o.exit():o.request(e,t),onchange(e){o.on("change",e)},onerror(e){o.on("error",e)},on(e,t){const s=i[e];s&&document.addEventListener(s,t,!1)},off(e,t){const s=i[e];s&&document.removeEventListener(s,t,!1)},raw:n};var r;Object.defineProperties(o,{isFullscreen:{get:()=>Boolean(document[n.fullscreenElement])},element:{enumerable:!0,get:()=>null!=(r=document[n.fullscreenElement])?r:void 0},isEnabled:{enumerable:!0,get:()=>Boolean(document[n.fullscreenEnabled])}}),n||(o={isEnabled:!1});const l=o}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,loadStylesheet,installedCssChunks;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var s=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(s.exports,s,s.exports,__webpack_require__),s.loaded=!0,s.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(e,t,s,a)=>{if(!t){var n=1/0;for(l=0;l<deferred.length;l++){for(var[t,s,a]=deferred[l],i=!0,o=0;o<t.length;o++)(!1&a||n>=a)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[o])))?t.splice(o--,1):(i=!1,a<n&&(n=a));if(i){deferred.splice(l--,1);var r=s();void 0!==r&&(e=r)}}return e}a=a||0;for(var l=deferred.length;l>0&&deferred[l-1][2]>a;l--)deferred[l]=deferred[l-1];deferred[l]=[t,s,a]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var s=Object.create(null);__webpack_require__.r(s);var a={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var n=2&t&&e;"object"==typeof n&&!~leafPrototypes.indexOf(n);n=getProto(n))Object.getOwnPropertyNames(n).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,__webpack_require__.d(s,a),s},__webpack_require__.d=(e,t)=>{for(var s in t)__webpack_require__.o(t,s)&&!__webpack_require__.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},__webpack_require__.f={},__webpack_require__.e=e=>Promise.all(Object.keys(__webpack_require__.f).reduce(((t,s)=>(__webpack_require__.f[s](e,t),t)),[])),__webpack_require__.u=e=>75980===e?"menu_settings.fe841ee6e9d1770c7df7.js":9375===e?"voice_message_player.050d74b181d5db2642f0.js":28762===e?"speech.5c7a8bafaa4c80a92840.js":57468===e?"SilentModeForms.8425705394906aebc7de.js":96248===e?"feed-skeleton.6830e5b139046f63a92d.js":29019===e?"ReportForm.bca17ba3f106ecbaeea6.js":34932===e?"MarketItemsCarousel.14b336a6263566074815.js":51162===e?"StickersKit.4339d749c3a9af1c83c0.js":79344===e?"sticker.8572aa685d86819d0a97.js":55489===e?"lottie-light.48f1a65d83e7d0217b60.js":7103===e?"stickers-layer-view.0f9e18fceeb83717335e.js":37211===e?"stickers-layer-purchase-details-view.ecd9d8e01b1f803b4eeb.js":39457===e?"stickers-random-selector-view.15fbf277235a4f58c348.js":78177===e?"stickers-random-selector-packs-view.82e74823176d3ebdeb11.js":34757===e?"stickers-random-selector-result-view.1613cb988c705d7da5ab.js":68346===e?"NewStickerPicker.861dc89b3c6eea368742.js":4387===e?"4387.1c74afd2b360da8601eb.js":3225===e?"marusia-fc-sdk.f08212725501740ef466.js":59240===e?"performance-stats.d89fb0a11246583657a4.js":24195===e?e+".13b2fb10985a55b7af12.js":63371===e?e+".be0b8c0c48a4a1b02a8e.js":87448===e?"df5f2238430381af4073776990037d9a.442712de4c33add780bb.js":60514===e?"36663761e4c963339956e18f6140595c.059d39c9a857698a1410.js":31848===e?"f79ca980fcc26ca55859ad5158f5fea8.6879ee938d1351b5ed4c.js":882===e?"fba43c7a1c8ad19aa306e4c66812a52a.73a4f57c56bf469f3cd0.js":void 0,__webpack_require__.miniCssF=e=>882===e?"fba43c7a1c8ad19aa306e4c66812a52a.e8339c192951ae3223aa.css":e+"."+{7103:"40a7e407b709ab3e6fbf",29019:"673778676fc8f6a95111",34757:"b5be4318cc62f878564e",34932:"4c7eb03f0588f245637d",37211:"765824321a7e8c9308b4",39457:"76704ef5d1a34fea5625",57468:"e8a9b5d3b4a38f45d2ec",75980:"519f671449550110bbb1",78177:"28f0e479ab7f49cdada2",79344:"39ec17015c909fafa936"}[e]+".css",__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},__webpack_require__.l=(e,t,s,a)=>{if(inProgress[e])inProgress[e].push(t);else{var n,i;if(void 0!==s)for(var o=document.getElementsByTagName("script"),r=0;r<o.length;r++){var l=o[r];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")=="vk:"+s){n=l;break}}n||(i=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,__webpack_require__.nc&&n.setAttribute("nonce",__webpack_require__.nc),n.setAttribute("data-webpack","vk:"+s),n.src=e),inProgress[e]=[t];var c=(t,s)=>{n.onerror=n.onload=null,clearTimeout(d);var a=inProgress[e];if(delete inProgress[e],n.parentNode&&n.parentNode.removeChild(n),a&&a.forEach((e=>e(s))),t)return t(s)},d=setTimeout(c.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=c.bind(null,n.onerror),n.onload=c.bind(null,n.onload),i&&document.head.appendChild(n)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="/dist/",loadStylesheet=e=>new Promise(((t,s)=>{var a=__webpack_require__.miniCssF(e),n=__webpack_require__.p+a;if(((e,t)=>{for(var s=document.getElementsByTagName("link"),a=0;a<s.length;a++){var n=(o=s[a]).getAttribute("data-href")||o.getAttribute("href");if("stylesheet"===o.rel&&(n===e||n===t))return o}var i=document.getElementsByTagName("style");for(a=0;a<i.length;a++){var o;if((n=(o=i[a]).getAttribute("data-href"))===e||n===t)return o}})(a,n))return t();((e,t,s,a)=>{var n=document.createElement("link");n.rel="stylesheet",n.type="text/css",n.onerror=n.onload=i=>{if(n.onerror=n.onload=null,"load"===i.type)s();else{var o=i&&("load"===i.type?"missing":i.type),r=i&&i.target&&i.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=o,l.request=r,n.parentNode.removeChild(n),a(l)}},n.href=t,document.head.appendChild(n)})(e,n,t,s)})),installedCssChunks={655:0},__webpack_require__.f.miniCss=(e,t)=>{installedCssChunks[e]?t.push(installedCssChunks[e]):0!==installedCssChunks[e]&&{882:1,7103:1,29019:1,34757:1,34932:1,37211:1,39457:1,57468:1,75980:1,78177:1,79344:1}[e]&&t.push(installedCssChunks[e]=loadStylesheet(e).then((()=>{installedCssChunks[e]=0}),(t=>{throw delete installedCssChunks[e],t})))},(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={655:0};__webpack_require__.f.j=(t,s)=>{var a=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==a)if(a)s.push(a[2]);else if(/^(75980|882)$/.test(t))e[t]=0;else{var n=new Promise(((s,n)=>a=e[t]=[s,n]));s.push(a[2]=n);var i=__webpack_require__.p+__webpack_require__.u(t),o=new Error;__webpack_require__.l(i,(s=>{if(__webpack_require__.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var n=s&&("load"===s.type?"missing":s.type),i=s&&s.target&&s.target.src;o.message="Loading chunk "+t+" failed.\n("+n+": "+i+")",o.name="ChunkLoadError",o.type=n,o.request=i,a[1](o)}}),"chunk-"+t,t)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,s)=>{var a,n,[i,o,r]=s,l=0;if(i.some((t=>0!==e[t]))){for(a in o)__webpack_require__.o(o,a)&&(__webpack_require__.m[a]=o[a]);if(r)var c=r(__webpack_require__)}for(t&&t(s);l<i.length;l++)n=i[l],__webpack_require__.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return __webpack_require__.O(c)},s=self.webpackChunkvk=self.webpackChunkvk||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var __webpack_exports__=__webpack_require__.O(void 0,[75514,98066,56990,76429,24509,76400,40885,38288,68592,72809,62638,35699,50689,31350,82198,87454,63489,93786,62182,76174,43639,43087,54134,40051,56058],(()=>__webpack_require__(166858)));__webpack_exports__=__webpack_require__.O(__webpack_exports__)})();