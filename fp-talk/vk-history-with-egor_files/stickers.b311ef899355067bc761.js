(()=>{"use strict";var e,t,i,r,s,n,a={874162:(e,t,i)=>{i.d(t,{DEFAULT_CACHE:()=>c,ORDER_ERRORS:()=>d,ORDER_ITEM_ERRORS:()=>u,SAMPLE_RECIPIENT_ID:()=>l,STICKER_ANIMATION:()=>o,STICKER_IMAGE:()=>a,STICKER_PACK_ICON:()=>s,STICKER_PACK_THUMB:()=>n});var r=i(899033);const s={square_png:{id:"square.png",width:104,height:104},square_15x_png:{id:"square_1.5x.png",width:156,height:156},square_2x_png:{id:"square_2x.png",width:208,height:208},square_3x_png:{id:"square_3x.png",width:312,height:312},square_4x_png:{id:"square_4x.png",width:416,height:416}},n={"102_png":{id:"102.png",width:102,height:102,theme:r.Theme.LIGHT},"51_png":{id:"51.png",width:51,height:51,theme:r.Theme.LIGHT},"68_png":{id:"68.png",width:68,height:68,theme:r.Theme.LIGHT},"34_png":{id:"34.png",width:34,height:34,theme:r.Theme.LIGHT},"60_png":{id:"60.png",width:60,height:60,theme:r.Theme.LIGHT},"30_png":{id:"30.png",width:30,height:30,theme:r.Theme.LIGHT},"102b_png":{id:"102b.png",width:102,height:102,theme:r.Theme.DARK},"51b_png":{id:"51b.png",width:51,height:51,theme:r.Theme.DARK},"68b_png":{id:"68b.png",width:68,height:68,theme:r.Theme.DARK},"34b_png":{id:"34b.png",width:34,height:34,theme:r.Theme.DARK},"60b_png":{id:"60b.png",width:60,height:60,theme:r.Theme.DARK},"30b_png":{id:"30b.png",width:30,height:30,theme:r.Theme.DARK},"44_png":{id:"44.png",width:44,height:44},"22_png":{id:"22.png",width:22,height:22}},a={"64_png":{id:"64.png",width:64,height:64,theme:r.Theme.LIGHT},"128_png":{id:"128.png",width:128,height:128,theme:r.Theme.LIGHT},"256_png":{id:"256.png",width:256,height:256,theme:r.Theme.LIGHT},"352_png":{id:"352.png",width:352,height:352,theme:r.Theme.LIGHT},"512_png":{id:"512.png",width:512,height:512,theme:r.Theme.LIGHT},"64b_png":{id:"64b.png",width:64,height:64,theme:r.Theme.DARK},"128b_png":{id:"128b.png",width:128,height:128,theme:r.Theme.DARK},"256b_png":{id:"256b.png",width:256,height:256,theme:r.Theme.DARK},"352b_png":{id:"352b.png",width:352,height:352,theme:r.Theme.DARK},"512b_png":{id:"512b.png",width:512,height:512,theme:r.Theme.DARK}},o={[r.Theme.LIGHT]:"animation.json",[r.Theme.DARK]:"animation.b.json"},c={products:(0,r.createProductsMap)([]),productIdsQueue:new Set,productsPromise:void 0,productPromises:new Map,stickers:new Map},l=-1;var d,u;!function(e){e.NOT_SIGNED_IN="not_signed_in",e.NO_VALID_ITEMS="no_valid_items"}(d||(d={})),function(e){e.DUPLICATE_PRODUCT="duplicate_product"}(u||(u={}))},899033:(e,t,i)=>{var r;i.d(t,{ProductsByType:()=>_,Theme:()=>r,UserProductStateKey:()=>o,createProductsMap:()=>a,imageSizeCache:()=>n,imageSizesIndex:()=>s,isBasePack:()=>c,isPackProduct:()=>d,isStyleProduct:()=>l}),function(e){e.LIGHT="light",e.DARK="dark",e.DEFAULT="light"}(r||(r={}));const s=Symbol(),n=Symbol(),a=e=>new Map(e);var o;!function(e){e.IsNew="is_new"}(o||(o={}));const c=e=>void 0!==e.sticker_ids,l=e=>void 0!==e.base_id,d=e=>c(e)&&!l(e);var u;!function(e){e.Pack="pack",e.Style="style"}(u||(u={}));class _{add(e){e&&(d(e)?this.pack.add(e):l(e)&&this.style.add(e))}getPack(){return this.pack.values().next().value}getStyles(){return Array.from(this.style.values())}getCount(){return this.pack.size+this.style.size}constructor(e=[]){this.pack=new Set,this.style=new Set,e.forEach((e=>this.add(e)))}}},457299:(e,t,i)=>{i.d(t,{getStickerAnimationUrl:()=>d,getStickerImageUrl:()=>l,getStickerPackIconUrl:()=>u,getStickersKitModule:()=>g,isSampleOrderItem:()=>_,logStickersError:()=>h});var r=i(899033),s=i(874162),n=i(970978);const a=(e,t,i,s=r.Theme.DEFAULT)=>{const n=window.devicePixelRatio,a=[t*=n,i*=n,s].toString();let o=e[r.imageSizeCache];if(o&&o.has(a)){const e=o.get(a);if(e)return e}o||(o=new Map,e[r.imageSizeCache]=o);const c=(e=>{let t=e[r.imageSizesIndex];return t||(t=Object.values(e).sort(((e,t)=>e.width-t.width||e.height-t.height)),e[r.imageSizesIndex]=t),t})(e).filter((e=>!e.theme||e.theme===s)),l=c.find((e=>e.width>=t&&e.height>=i))||c[c.length-1];return o.set(a,l),l},o=(e,t,i=r.Theme.DEFAULT)=>a(s.STICKER_IMAGE,e,t,i),c=(e,t)=>e.image.base_url+"/"+t.id+(e.image.version?`?${e.image.version}`:"");function l(e,t,i,s=r.Theme.DEFAULT){var n;if(null==(n=e.render)?void 0:n.images){const{images:r}=e.render;let n;r.sort(((e,t)=>e.width-t.width||e.height-t.height));for(const e of r)if(e.width>=t&&e.height>=i){if(e.theme===s)return e.url;n=e}if(n)return n.url}return c(e,o(t,i,s))}const d=(e,t=r.Theme.DEFAULT)=>e.animation?e.animation.base_url+"/"+s.STICKER_ANIMATION[t]+(e.animation.version?`?${e.animation.version}`:""):"",u=(e,t,i,n=r.Theme.DEFAULT)=>((e,t)=>e.icon.base_url+"/"+t.id+(e.thumb.version?`?${e.thumb.version}`:""))(e,((e,t,i=r.Theme.DEFAULT)=>a(s.STICKER_PACK_ICON,e,t,i))(t,i,n)),_=e=>e.recipient_id===s.SAMPLE_RECIPIENT_ID,g=()=>i.e(51162).then(i.bind(i,406857)),h=e=>{(0,n.logError)(new Error(`Stickers: ${e}`))}},537783:(e,t,i)=>{i.d(t,{InitOptionsProvider:()=>o,useInitOptions:()=>c});var r=i(434788),s=i(820224),n=i(667294);const a=(0,n.createContext)({}),o=a.Provider;function c(){const e=(0,n.useContext)(a),{payload:t}=e,i=(0,s._)(e,["payload"]);return(0,r._)({},t,i)}},390420:(e,t,i)=>{i.d(t,{stickers:()=>r});const r=(0,i(210929).createDomain)()},153536:(e,t,i)=>{i.d(t,{buyFx:()=>o});var r=i(11010),s=i(393356),n=i(390420),a=i(494774);const o=n.stickers.createEffect((0,r._)((function*(){const e=window.Stickers.Cart.create([a.RANDOM_PRODUCT_ID]);yield e.load();const t=yield e.order({v:s.API_VERSION,ignoreEmptyError:!0,emptyErrorLoader:!1}).catch((()=>null));return t&&t.random_selector_result&&!t.error?t:null})))},933494:(e,t,i)=>{i.d(t,{showSnackbar:()=>r});const r=(0,i(210929).createEvent)()},494774:(e,t,i)=>{i.d(t,{RANDOM_PRODUCT_ID:()=>r,StickersGroup:()=>n,UGC_STICKERS_APP_ID:()=>s});const r=10101,s=51538586;var n;!function(e){e.LAYER="layer"}(n||(n={}))},276782:(e,t,i)=>{i.d(t,{openProductModal:()=>r});const r=i(390420).stickers.createEvent()},438470:(e,t,i)=>{i.d(t,{openRandomSelectorPacksModal:()=>r});const r=i(390420).stickers.createEvent()},727211:(e,t,i)=>{i.d(t,{openRandomSelectorResultModal:()=>r});const r=i(390420).stickers.createEvent()},424812:(e,t,i)=>{var r,s,n,a=i(434788),o=i(211314),c=i(814323),l=i(167198),d=i(902220),u=i(991243),_=i(753884),g=i(385036),h=i(374884);(null==(r=window.vk)||null==(s=r.pe)?void 0:s.static_manager_dynamic_imports)&&(null==(n=window.vk)?void 0:n.stDomain)&&(i.p=window.vk.stDomain+"/dist/"),window.StickersAnimation=c.StickersAnimation,window.StickersSettings=l.StickersSettings,window.Stickers=(0,a._)({},o.Stickers,{Cart:d.Cart,getPurchaseResult:u.getPurchaseResult,giftStickerProducts:_.giftStickerProducts,openStickersLayerView:g.openStickersLayerView,openStickersRandomSelectorView:h.openStickersRandomSelectorView});try{window.stManager.done(window.jsc("web/stickers.js"))}catch(e){}},898718:(e,t,i)=>{i.d(t,{getCache:()=>l,getPackByStickerId:()=>h,getSticker:()=>u,getStickers:()=>_,updateCache:()=>d});var r=i(434788),s=i(363444),n=i(874162),a=i(899033),o=i(581522),c=i(531730);const l=()=>{if(!window.stickersCache){const e=c.ls.get("stickers_cache");window.stickersCache=(0,r._)({},n.DEFAULT_CACHE,e)}return window.stickersCache},d=e=>{window.stickersCache=(0,r._)({},l(),e)},u=e=>l().stickers.get(e),_=e=>{const{stickers:t}=l();return e.map((e=>t.get(e)))},g=e=>{const t=u(e);if(!t||!t.pack_id)return null;const i=(0,o.getProductFromCache)(t.pack_id);return i&&(0,a.isBasePack)(i)?i:null},h=e=>{const t=g(e);return t?Promise.resolve(t):new Promise((t=>{s.ajax.post("stickers.php",{act:"get_products",sticker_ids:[e]},{onDone(i){(0,o.cacheProductsData)(i),t(g(e))},onFail:e=>(console.error(e),t(null),!0)})}))}},902220:(e,t,i)=>{i.d(t,{Cart:()=>d});var r=i(434788),s=i(820224),n=i(363444),a=i(383320),o=i(874162),c=i(581522),l=i(584356);class d{static create(e,t=[]){const i=e.map((e=>({product_id:e,amount:1})));return new d(i,t)}copy(){const e=new d(this.getItems(),this.getRecipientIds());return e.setOrder(this.getOrder()),e}getItems(){return Array.from(this.items.values())}setItems(e){this.items=new Map(e.map((e=>[e.product_id,e])))}loadItems(){const e=Array.from(this.items.keys());return(0,c.getProducts)(e).then((()=>{for(const e of Array.from(this.items.values()))e.product=(0,c.getProductFromCache)(e.product_id)}))}getProducts(){return(0,c.getProductsFromCache)(Array.from(this.items.keys()))}hasProduct(e){return this.items.has(e)}addProduct(e,t=!1){if(!this.hasProduct(e)){const i={product_id:e,amount:1};t?this.setItems([...this.getItems(),i]):this.setItems([i,...this.getItems()]),this.onChange&&this.onChange()}}removeProduct(e){this.hasProduct(e)&&(this.items.delete(e),this.onChange&&this.onChange())}getRecipientIds(e=!1){return this.recipientIds.size?Array.from(this.recipientIds.values()):this.isGift&&e?[o.SAMPLE_RECIPIENT_ID]:[]}setRecipientIds(e){this.recipientIds=new Set(e)}hasRecipientId(e){return this.recipientIds.has(e)}addRecipientId(e){this.hasRecipientId(e)||(this.recipientIds.add(e),this.onChange&&this.onChange())}removeRecipientId(e){this.hasRecipientId(e)&&(this.recipientIds.delete(e),this.onChange&&this.onChange())}setOrder(e){if(this._order=e,e){this.recipientIds.clear();for(const t of e.items)t.recipient_id!==o.SAMPLE_RECIPIENT_ID&&this.recipientIds.add(t.recipient_id)}}loadOrder(e){const t=e.items.map((e=>e.product_id));return(0,c.getProducts)(t).then((t=>(0,r._)({},e,{items:e.items.map(((e,i)=>(0,r._)({},e,{product:t[i]})))})),(()=>e))}getOrder(){return this._order}getRecipientsMap(){return this.recipients}getRecipients(){return Array.from(this.recipients.values())}getRecipientById(e){return this.recipients.get(e)}addRecipients(e){this.recipients=new Map([...this.getRecipients(),...e].map((e=>[e[0],e])))}getJSON(){return JSON.stringify({items:this.getItems().map((e=>(0,r._)({},e,{product:void 0}))),recipient_ids:this.getRecipientIds(!0)})}isLoaded(){return null!==this.getOrder()}cancelLoad(){this.loadTimeout&&(window.clearTimeout(this.loadTimeout),this.loadTimeout=null),this.loadCancellationToken&&(this.loadCancellationToken.cancel(),this.loadCancellationToken=null)}load(e=!1){return this.cancelLoad(),new Promise((t=>{this.loadTimeout=window.setTimeout((()=>{this.loadCancellationToken=new a.AjaxCancellationToken,n.ajax.post("stickers.php",{act:"preview_products_order",cart:this.getJSON(),with_suggested_recipients:e?1:0},{cancellationToken:this.loadCancellationToken,onDone:e=>{(0,c.cacheProductsData)(e),Promise.all([this.loadItems(),this.loadOrder(e.order)]).then((([,i])=>{this.setOrder(i),e.recipients&&this.addRecipients(e.recipients),t(this)}),(()=>{}))},onFail:e=>(e&&window.__dev&&console.error(e),t(this),!0)})}),300)}))}order(e={}){var{ignoreEmptyError:t,emptyErrorLoader:i}=e,r=(0,s._)(e,["ignoreEmptyError","emptyErrorLoader"]);return new Promise((e=>{var s;n.ajax.post("stickers.php",{act:"order_products",cart:this.getJSON(),hash:r.hash||(null==(s=this.getOrder())?void 0:s.hash),message:r.message,is_private:r.is_private?1:0,ref:r.ref,gift_ref:r.gift_ref,v:r.v},{onDone:t=>{requestAnimationFrame((()=>{(0,l.hideBoxLoader)()})),(0,c.cacheProductsData)(t),t.result.random_selector_result=t.random_selector_result,Promise.all([this.loadOrder(t.order),this.loadOrder(t.result)]).then((([t,i])=>{this.setOrder(t),e(i)}),(()=>{}))},onFail:r=>!r&&t?(i&&requestAnimationFrame((()=>{(0,l.showBoxLoader)()})),!0):(r&&console.error(r),e(null),!0)})}))}constructor(e,t=[]){this.loadTimeout=null,this.loadCancellationToken=null,this.isGift=!1,this.onChange=null,this._order=null,this.setItems(e),this.recipientIds=new Set(t),this.recipients=new Map}}},580284:(e,t,i)=>{i.d(t,{default:()=>w});var r=i(785893),s=i(667294),n=i(584356),a=i(221780),o=i(29271),c=i(549309),l=i(910434),d=i(688731),u=i(635127),_=i(723170),g=i(671459),h=i(899033),p=i(457299),f=i(138255),m=i(445664),k=i(260795),S=i(358740),v=i(659397);const w=({cart:e,options:{ref:t,gift_ref:i},closeBox:w,updateBox:y})=>{const[P,b]=(0,f.useCart)(e),L=!P.isLoaded()&&b;(0,s.useEffect)((()=>{y()}),[L]);const C=P.getRecipientIds(),I=P.getOrder(),E=I&&!I.error&&I.items.find((e=>!e.error&&!(0,p.isSampleOrderItem)(e))),[T,A]=function(e){if(!e)return[null,null];let t;for(const i of e.items){const{product:e}=i;if(e&&(0,h.isPackProduct)(e)){t=e;break}}let i=e.items.filter((({product:e})=>null==e?void 0:e.can_gift));const r=i.filter((e=>!e.error&&!(0,p.isSampleOrderItem)(e)));r.length&&(i=r);const s=new h.ProductsByType(i.map((e=>e.product))),n=s.pack.values().next().value,c=Array.from(s.style);let l="",d="";if(1===c.length)l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_1_style"),"title",c[0].title),n?d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_with_pack"),"title",n.title):t&&(d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_for_pack"),"title",t.title));else if(n){if(l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_pack"),"title",n.title),c.length)switch(c.length){case 2:d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_with_2_styles"),"title1",c[0].title,"title2",c[1].title);break;case 3:d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_with_3_styles"),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title);break;case 4:d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_with_3_styles_and_1_more"),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title);break;default:const e=c.length-3;d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_with_3_styles_and_n_more",e),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title,"n",e)}}else if(c.length){switch(c.length){case 2:l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_2_styles"),"title1",c[0].title,"title2",c[1].title);break;case 3:l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_3_styles"),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title);break;case 4:l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_3_styles_and_1_more"),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title);break;default:const e=c.length-3;l=(0,a.langStr)(o.getLang("purchases_stickers_gift_title_3_styles_and_n_more",e),"title1",c[0].title,"title2",c[1].title,"title3",c[2].title,"n",e)}t&&(d=(0,a.langStr)(o.getLang("purchases_stickers_gift_description_for_pack"),"title",t.title))}c.length?d+=" "+o.getLang("purchases_stickers_gift_description_styles"):d+=" "+o.getLang("purchases_stickers_gift_description");return[l,d]}(I),[,R]=(0,s.useState)(null);(0,s.useLayoutEffect)((()=>{const e=P.getRecipients();if(R(window.WideDropdown.init("StickerProductsGiftRecipientsDropdown",{defaultItems:e,items:e,noResult:o.getLang("gifts_nobody_found"),introText:o.getLang("gifts_start_typing_recipient"),maxItems:20,onChange:(e,t)=>{1===e?P.addRecipientId(+t):P.removeRecipientId(+t)}})),C.length)for(const e of C){const t=P.getRecipientById(e);t&&window.WideDropdown.select("StickerProductsGiftRecipientsDropdown",!1,t)}else window.WideDropdown.focus("StickerProductsGiftRecipientsDropdown");return()=>{window.WideDropdown.deinit("StickerProductsGiftRecipientsDropdown")}}),[L]);const[j,x]=(0,s.useState)(""),[D,N]=(0,s.useState)(!1),[O,G]=(0,s.useState)(!1),M=()=>{O||(G(!0),P.order({message:j,is_private:D,ref:t,gift_ref:i}).then((e=>{G(!1),e&&!e.error&&((0,n.showDoneBox)(function(e,t){const i=new h.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),r=function(e){const t=e.getPack(),i=e.getStyles();if(t)return i.length?(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_pack_and_styles",i.length),"title",t.title,"styles_num",i.length):(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_pack"),"title",t.title);if(i.length)switch(i.length){case 1:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_1_style"),"title",i[0].title);case 2:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_2_styles"),"title1",i[0].title,"title2",i[1].title);case 3:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_3_styles"),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title);case 4:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_3_styles_and_1_more"),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title);default:{const e=i.length-3;return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_products_3_styles_and_n_more",e),"title1",i[0].title,"title2",i[1].title,"title3",i[2].title,"n",e)}}return null}(i);if(!r)return null;const s=new Set;for(const i of e.items){const{error:e,recipient_id:r}=i;if(e)continue;const n=t(r);n&&s.add(n)}const n=function(e,t){const i=Array.from(e.values());switch(i.length){case 0:return null;case 1:{const e=1===t?o.getLang("purchases_stickers_gift_result_1_recipient_single","raw"):o.getLang("purchases_stickers_gift_result_1_recipient_multiple","raw");return(0,a.langStr)((0,o.langSex)(i[0][8],e),"name",i[0][8])}case 2:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_2_recipients",t),"name1",i[0][8],"name2",i[1][8]);case 3:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_3_recipients",t),"name1",i[0][8],"name2",i[1][8],"name3",i[2][8]);case 4:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_4_recipients",t),"name1",i[0][8],"name2",i[1][8],"name3",i[2][8],"name4",i[3][8]);case 5:return(0,a.langStr)(o.getLang("purchases_stickers_gift_result_5_recipients",t),"name1",i[0][8],"name2",i[1][8],"name3",i[2][8],"name4",i[3][8],"name5",i[4][8]);default:{const e=i.length-4,r=1===t?o.getLang("purchases_stickers_gift_result_4_recipients_and_n_more_single"):o.getLang("purchases_stickers_gift_result_4_recipients_and_n_more_multiple");return(0,a.langStr)(r,"name1",i[0][8],"name2",i[1][8],"name3",i[2][8],"name4",i[3][8],"n",e)}}return null}(s,i.getCount());if(!n)return null;return(0,a.langStr)(n,"products",r)}(e,(e=>P.getRecipientById(e)))),w())}),(()=>{})))};return(0,s.useEffect)((()=>{window.WideDropdown.disable("StickerProductsGiftRecipientsDropdown",O)}),[O]),(0,r.jsxs)("article",{className:"StickerProductsGift",children:[(0,r.jsx)(c.ModalHeader,{className:"StickerProductsGift__header",title:o.getLang("purchases_stickers_gift_box_title"),onClose:w}),L?(0,r.jsx)("section",{className:"StickerProductsGift__content StickerProductsGift__content--loading",children:(0,r.jsx)(l.default,{size:24})}):(0,r.jsxs)(s.Fragment,{children:[(0,r.jsxs)("section",{className:"StickerProductsGift__content",children:[(0,r.jsx)(m.default,{order:I,forceValid:!E}),(0,r.jsx)("h1",{className:"StickerProductsGift__productsTitle",children:(0,v.decodeHTMLEntities)(T||"")}),(0,r.jsx)("p",{className:"StickerProductsGift__productsDescription",children:(0,v.decodeHTMLEntities)(A||"")}),I&&(0,r.jsxs)(s.Fragment,{children:[(0,r.jsxs)("dl",{className:"StickerProductsGift__price",children:[(0,r.jsx)("dt",{className:"StickerProductsGift__priceLabel",children:o.getLang("purchases_gift_price_label")})," ",(0,r.jsx)("dd",{className:"StickerProductsGift__priceValue",children:o.getLang("global_n_votes",I.price.current)})]}),(0,r.jsx)("div",{className:"StickerProductsGift__balance",children:(0,a.langStr)(o.getLang("gifts_you_have_X_votes"),"votes",o.getLang("global_n_votes",I.balance))})]}),(0,r.jsxs)("div",{className:"StickerProductsGift__recipients",children:[(0,r.jsx)("label",{className:"StickerProductsGift__recipientsLabel",htmlFor:"StickerProductsGiftRecipientsInput",children:o.getLang("gifts_receiver")}),(0,r.jsxs)("div",{className:"wdd StickerProductsGift__recipientsDropdown",id:"StickerProductsGiftRecipientsDropdown",children:[(0,r.jsx)("div",{className:"fl_r wdd_arr"}),(0,r.jsx)("input",{className:"wdd_text fl_l",id:"StickerProductsGiftRecipientsInput",placeholder:o.getLang("gifts_choose_recipients")})]})]}),(0,r.jsxs)("div",{className:"StickerProductsGift__message",children:[(0,r.jsx)("label",{className:"StickerProductsGift__messageLabel",htmlFor:"StickerProductsGiftMessageInput",children:o.getLang("purchases_gift_your_message")}),(0,r.jsx)(d.default,{className:"StickerProductsGift__messageInput",id:"StickerProductsGiftMessageInput",value:j,onChange:e=>x(e.currentTarget.value),onResize:()=>y(),style:{height:80},disabled:O})]}),(0,r.jsx)(u.default,{className:"StickerProductsGift__isPrivate",checked:D,disabled:O,onChange:()=>N(!D),children:o.getLang("gifts_receiver_only")})]}),(0,r.jsxs)("footer",{className:"StickerProductsGift__footer",children:[(0,r.jsx)("div",{className:"StickerProductsGift__footerNote",children:!b&&I&&(0,r.jsxs)("div",{className:"StickerProductsGift__details",children:[o.getLang("purchases_stickers_gift_details_label"),(0,r.jsx)(g.default,{className:"StickerProductsGift__detailsTooltip",text:(0,r.jsx)(k.default,{order:I,recipients:P.getRecipientsMap()}),position:"t",align:"center",appearance:"light",children:(0,r.jsx)(_.default,{className:"StickerProductsGift__detailsHintIcon"})})]})}),(0,r.jsx)("div",{className:"StickerProductsGift__footerButtons",children:(0,r.jsx)(S.default,{className:"StickerProductsGift__gift",mode:E?"primary":"secondary",size:"m",loading:b||O,disabled:!E,price:null==I?void 0:I.price,text:E?(0,a.langStr)(o.getLang("purchases_stickers_gift_send_for"),"price",o.getLang("global_n_votes",null==I?void 0:I.price.current)):o.getLang("purchases_stickers_gift_send"),onClick:()=>M()})})]})]})]})}},260795:(e,t,i)=>{i.d(t,{default:()=>_});var r=i(785893),s=i(667294),n=i(221780),a=i(29271),o=i(331533),c=i(899033),l=i(457299),d=i(659397);function u(e){const t=e.getPack(),i=e.getStyles();let r="";return i.length&&(r=i.map((e=>(0,n.langStr)(a.getLang("purchases_stickers_gift_details_recipient_style_title"),"title",e.title))).join(", ")),t?r?(0,n.langStr)(a.getLang("purchases_stickers_gift_details_recipient_pack_and_styles"),"pack_title",t.title,"style_titles",r):(0,n.langStr)(a.getLang("purchases_stickers_gift_details_recipient_pack"),"title",t.title):r?(0,n.langStr)(a.getLang("purchases_stickers_gift_details_recipient_styles"),"style_titles",r):null}const _=({order:e,recipients:t})=>{const i=function(e){if(!e)return null;let t=e.items.filter((({product:e})=>null==e?void 0:e.can_gift));const i=t.filter((e=>!e.error&&!(0,l.isSampleOrderItem)(e)));i.length&&(t=i);const r=[],s=[];for(const e of t){const{product:t}=e;t&&((0,c.isPackProduct)(t)?r.push(e):(0,c.isStyleProduct)(t)&&s.push(e))}const o=s.reduce(((e,t)=>{var i;return e+((null==(i=t.price)?void 0:i.current)||0)}),0);if(r.length){const e=r.reduce(((e,t)=>{var i;return e+((null==(i=t.price)?void 0:i.current)||0)}),0);return s.length?(0,n.langStr)(a.getLang("purchases_stickers_gift_details_summary_pack_with_styles",s.length),"pack_price_sum",a.getLang("global_n_votes",e),"styles_num",s.length,"styles_price_sum",a.getLang("global_n_votes",o)):(0,n.langStr)(a.getLang("purchases_stickers_gift_details_summary_pack"),"pack_price_sum",a.getLang("global_n_votes",e))}if(s.length)return(0,n.langStr)(a.getLang("purchases_stickers_gift_details_summary_styles",s.length),"styles_num",s.length,"styles_price_sum",a.getLang("global_n_votes",o));return null}(e),_=new Map;for(const i of e.items){const{error:e,product:r,recipient_id:s}=i;if(e)continue;const n=t.get(s);if(!n)continue;let a=_.get(n);a||(a=new c.ProductsByType,_.set(n,a)),a.add(r)}const g=Array.from(_.entries()),h=(0,s.useRef)(null);return(0,s.useEffect)((()=>{const e=h.current;e&&(e.style.maxHeight=e.getBoundingClientRect().bottom-22+"px")})),(0,r.jsxs)("div",{className:"StickerProductsGiftDetails",ref:h,children:[i&&(0,r.jsx)(o.InnerHTML,{Component:"p",className:"StickerProductsGiftDetails__summary",children:i}),g.length>0&&(0,r.jsx)("ul",{className:"StickerProductsGiftDetails__recipients",children:g.map((([e,t])=>(0,r.jsxs)("li",{className:"StickerProductsGiftDetails__recipient",children:[(0,r.jsx)(o.InnerHTML,{Component:"div",className:"StickerProductsGiftDetails__recipientName",children:e[1]}),(0,r.jsx)("div",{className:"StickerProductsGiftDetails__recipientProducts",children:(0,d.decodeHTMLEntities)(u(t)||"")})]},e[0])))})]})}},445664:(e,t,i)=>{i.d(t,{default:()=>c});var r=i(785893),s=i(682615),n=i(899033),a=i(457299);const o={s:56,m:96,l:168},c=({order:e,forceValid:t=!1})=>{var i;const c=new Map,l=new Map;if(e)for(const t of e.items){const{product:e}=t;var d;if(e)if((0,n.isPackProduct)(e))if(c.has(e))null==(d=c.get(e))||d.push(t);else c.set(e,[t]);else if((0,n.isStyleProduct)(e)){var u;if(l.has(e))null==(u=l.get(e))||u.push(t);else l.set(e,[t])}}const _=c.keys().next().value,g=(_?1:0)+l.size,h=g>1?g>2?"s":"m":"l",p=o[h],f=Array.from(l.entries());t||f.sort((([,e],[,t])=>t.filter((e=>!e.error)).length-e.filter((e=>!e.error)).length));const m=f.slice(0,3);let k=f.slice(3),S=!0;if(!t){const e=k.filter((([,e])=>e.find((e=>!e.error))));e.length?k=e:S=!1}return(0,r.jsxs)("ul",{className:"StickerProductsGiftIcons",children:[_&&(0,r.jsx)("li",{className:(0,s.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${h}`,"StickerProductsGiftIcons__icon--pack",{"StickerProductsGiftIcons__icon--invalid":!t&&!(null==(i=c.get(_))?void 0:i.find((e=>!e.error)))}),style:{backgroundImage:`url(${(0,a.getStickerPackIconUrl)(_,p,p)})`}},_.id),m.map((([e,i])=>(0,r.jsx)("li",{className:(0,s.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${h}`,"StickerProductsGiftIcons__icon--style",{"StickerProductsGiftIcons__icon--invalid":!t&&!i.find((e=>!e.error))}),style:{backgroundImage:`url(${(0,a.getStickerPackIconUrl)(e,p,p)})`}},e.id))),k.length?(0,r.jsxs)("li",{className:(0,s.classNames)("StickerProductsGiftIcons__icon",`StickerProductsGiftIcons__icon--${h}`,"StickerProductsGiftIcons__icon--more",{"StickerProductsGiftIcons__icon--invalid":!S}),children:["+",k.length]},"more"):null]})}},358740:(e,t,i)=>{i.d(t,{default:()=>_});var r=i(434788),s=i(820224),n=i(785893),a=i(667294),o=i(86894),c=i(221780),l=i(682615),d=i(29271);const u=e=>{var{className:t,price:i,text:u,placeholder:_}=e,g=(0,s._)(e,["className","price","text","placeholder"]);let h=(0,a.useMemo)((()=>{if(i){let e;i.current!==i.regular&&i.regular&&(e=(0,n.jsx)("span",{className:"StickersPriceButton__regular",children:i.current?i.regular:(0,c.langStr)(d.getLang("purchases_stickers_n_for_m"),"%n","","%m",d.getLang("global_n_votes",i.regular))},"regular"));const t=(0,n.jsx)("span",{className:"StickersPriceButton__current",children:i.current?d.getLang("global_n_votes",i.current):d.getLang("purchases_for_free_btn").toLowerCase()},"current");return u?u.split(/(\{regular_price\}|\{price\})/).map(((i,r)=>"{regular_price}"===i?e:"{price}"===i?t:i?(0,n.jsx)("span",{className:"StickersPriceButton__label",children:i},`label${r}`):void 0)):[e,t]}return[_]}),[u,_,null==i?void 0:i.regular,null==i?void 0:i.current]);return(0,n.jsx)(o.Button,(0,r._)({className:(0,l.classNames)("StickersPriceButton",t)},g,{children:h}))};u.defaultProps=(0,r._)({},o.Button.defaultProps);const _=u},138255:(e,t,i)=>{i.d(t,{useCart:()=>s});var r=i(667294);const s=e=>{const[t,i]=(0,r.useState)(e),[s,n]=(0,r.useState)(null),a=(0,r.useCallback)((()=>{const e=t.load();n(e),e.then((t=>{i(t),n((t=>t===e?null:t))}),(()=>{}))}),[t]);return(0,r.useEffect)((()=>(t.onChange=a,t.isLoaded()||a(),()=>{t.onChange=null,t.cancelLoad()})),[t]),[t,null!==s]}},581522:(e,t,i)=>{i.d(t,{activateProduct:()=>g,cacheProductsData:()=>a,getProduct:()=>_,getProductFromCache:()=>o,getProducts:()=>u,getProductsFromCache:()=>c,updateUserProductState:()=>h});var r=i(434788),s=i(363444),n=i(898718);const a=(e,t=[])=>{const i=(0,n.getCache)();if(e.stickers){const{stickers:t}=i;for(const i of e.stickers)t.has(i.id)?t.set(i.id,(0,r._)({},t.get(i.id),i)):t.set(i.id,i)}if(e.products)for(const t of e.products)i.products.set(t.id,t),i.productPromises.delete(t.id);for(const e of t)i.products.has(e)||i.products.set(e,null),i.productPromises.delete(e);e.emoji&&window.Emoji&&window.Emoji.updateTabs(e.emoji.stickers,e.emoji.keywords,!0),(0,n.updateCache)(i)},o=e=>(0,n.getCache)().products.get(e),c=e=>{const t=(0,n.getCache)().products;return e.map((e=>t.get(e)))};function l(){let{productsPromise:e}=(0,n.getCache)();return e||(e=new Promise((e=>setTimeout((()=>{const t=(0,n.getCache)().productIdsQueue,i=Array.from(t);t.clear(),(0,n.updateCache)({productIdsQueue:t,productsPromise:void 0}),s.ajax.post("stickers.php",{act:"get_products",product_ids:i},{onDone(t){a(t,i),e([])},onFail:t=>(console.error(t),a({},i),e([]),!0)})}),300))),(0,n.updateCache)({productsPromise:e})),e}const d=e=>{if(!e.length)return Promise.resolve([]);const{productPromises:t,productIdsQueue:i}=(0,n.getCache)(),r=new Set;for(const s of e)if(t.has(s)){const e=t.get(s);e&&r.add(e)}else{i.add(s);const e=l();t.set(s,e),r.add(e)}return(0,n.updateCache)({productIdsQueue:i,productPromises:t}),Promise.all(r).then((()=>c(e)))},u=(e,t=!0)=>{const i=t?e.filter((e=>void 0===o(e))):e;return i.length?d(i).then((()=>c(e))):Promise.resolve(c(e))},_=(e,t=!0)=>{if(t){const t=o(e);if(void 0!==t)return Promise.resolve(t)}return d([e]).then((()=>o(e)))},g=e=>new Promise((t=>{s.ajax.post("stickers.php",{act:"activate_product",product_id:e.id,hash:e.csrf_hash},{onDone(e){a(e),t()},onFail:e=>(console.error(e),t(),!0)})})),h=(e,t,i,r=!0)=>new Promise((n=>{s.ajax.post("stickers.php",{act:"update_user_product_state",product_ids:[e],key:t,value:i},{onDone(e){r&&a(e),n()},onFail:e=>(console.error(e),n(),!0)})}))},753884:(e,t,i)=>{i.d(t,{giftStickerProducts:()=>g,giftStickersCart:()=>_});var r=i(434788),s=i(785893),n=i(973935),a=i(869048),o=i(514986),c=i(902220),l=i(991243),d=i(898718),u=i(580284);function _(e,t){const{productsGiftLock:i}=(0,d.getCache)();if(i)return null;let c;(0,d.updateCache)({productsGiftLock:!0});const _=(0,r._)({},t);function g(){return null==c?void 0:c.bodyNode.querySelector(".StickersProductsGift")}function h(){null==c||c.hide()}function p(){null==c||c.updateBoxCoords()}return(0,l.showLoader)(),e.isGift=!0,Promise.all([e.load(!0),window.stManager.add(["stickers.css",window.jsc("web/wide_dd.js"),"wide_dd.css"])]).then((([e])=>{(0,l.hideLoader)(),c=new o.MessageBox({hideButtons:!0,bodyStyle:"padding: 0; background: none;",width:450,onShow(){!function(e){const t=g();t&&n.render((0,s.jsx)(a.AppRootProvider,{children:(0,s.jsx)(u.default,{cart:e,options:_,closeBox:h,updateBox:p})}),t)}(e),requestAnimationFrame((()=>{p()}))},onHideAttempt:()=>(function(){const e=g();e&&n.unmountComponentAtNode(e)}(),!0),onHide(){(0,d.updateCache)({productsGiftLock:!1})}}),c.content('<div class="StickersProductsGift"></div>'),c.show()}),(()=>{})),{hide:h}}function g(e,t=[],i){return _(c.Cart.create(e,t),i)}},991243:(e,t,i)=>{i.d(t,{getBoxLayerWrap:()=>d,getLangCode:()=>p,getPurchaseResult:()=>g,hideLoader:()=>_,showLoader:()=>u,updateStickersFromQueue:()=>h});var r=i(221780),s=i(29271),n=i(68003),a=i(795558),o=i(584356),c=i(899033);function l(){return document.querySelector("#box_loader")}function d(){return document.querySelector("#box_layer_wrap")}function u(){const e=l();(0,o.boxRefreshCoords)(e),(0,a.show)(e),(0,a.show)(d())}function _(){(0,a.hide)(l())}function g(e){const t=new c.ProductsByType(e.items.filter((e=>!e.error)).map((e=>e.product))),i=t.getPack(),n=t.getStyles();if(i)return n.length?(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_pack_and_styles",n.length),"pack_title",i.title,"n",n.length):(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_pack"),"title",i.title);if(n.length)switch(n.length){case 1:return(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_1_style"),"title",n[0].title);case 2:return(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_2_styles"),"title1",n[0].title,"title2",n[1].title);case 3:return(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_3_styles"),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title);case 4:return(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_3_styles_and_1_more"),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title);default:const e=n.length-3;return(0,r.langStr)(s.getLang("purchases_stickers_purchase_result_3_styles_and_n_more",e),"title1",n[0].title,"title2",n[1].title,"title3",n[2].title,"n",e)}return null}function h(e){!function(e){const t=n.colorScheme.isDarkScheme()?"data-src-dark":"data-src-light";e.querySelectorAll(`.sticker_img[${t}]`).forEach((e=>{const i=e.getAttribute(t);i&&(e.src=i)}))}(e)}const p=()=>window.vk.lang||"ru"},719876:(e,t,i)=>{i.d(t,{ViewId:()=>r,views:()=>d});var r,s=i(667294);i(849246);!function(e){e.LAYER="layer",e.LAYER_PURCHASE_DETAILS="layer_purchase_details",e.RANDOM_SELECTOR="random_selector",e.RANDOM_SELECTOR_PACKS="RANDOM_SELECTOR_packs",e.RANDOM_SELECTOR_RESULT="RANDOM_SELECTOR_result"}(r||(r={}));const n=(0,s.lazy)((()=>Promise.all([i.e(98066),i.e(56990),i.e(76429),i.e(68592),i.e(62638),i.e(87448),i.e(7103)]).then(i.bind(i,470325)).then((({Layer:e})=>({default:e}))))),a=(0,s.lazy)((()=>i.e(37211).then(i.bind(i,481558)).then((({PurchaseDetails:e})=>({default:e}))))),o=(0,s.lazy)((()=>Promise.all([i.e(76429),i.e(39457)]).then(i.bind(i,175915)).then((({Main:e})=>({default:e}))))),c=(0,s.lazy)((()=>Promise.all([i.e(68592),i.e(87448),i.e(78177)]).then(i.bind(i,577903)).then((({Packs:e})=>({default:e}))))),l=(0,s.lazy)((()=>i.e(34757).then(i.bind(i,899725)).then((({Result:e})=>({default:e}))))),d=new Map([["layer",{Component:n,width:640}],["layer_purchase_details",{Component:a}],["random_selector",{Component:o}],["RANDOM_SELECTOR_packs",{Component:c}],["RANDOM_SELECTOR_result",{Component:l}]])},849246:(e,t,i)=>{i(606448)},606448:(e,t,i)=>{var r=i(210929),s=i(933494),n=i(584356);const a=(0,r.createEffect)((({title:e,subtitle:t})=>{(0,n.showSnackbar)({text:e,subtitle:t})}));(0,r.sample)({clock:s.showSnackbar,target:a})},30173:(e,t,i)=>{i.d(t,{openView:()=>l});var r=i(11010),s=i(434788),n=i(785893),a=i(719876),o=i(537783),c=i(359639);function l(e){return d.apply(this,arguments)}function d(){return(d=(0,r._)((function*(e){const{view:t}=e,{width:i,Component:r}=a.views.get(t)||{};if(r)return(0,c.showMessageBoxModalSuspense)((({onClose:t,refreshCoordinates:i})=>(0,n.jsx)(o.InitOptionsProvider,{value:(0,s._)({payload:{}},e,{init:i,destroy:t}),children:(0,n.jsx)(r,{})})),{width:i})}))).apply(this,arguments)}},256013:(e,t,i)=>{i.d(t,{openLayerPurchaseDetails:()=>n});var r=i(719876),s=i(30173);function n(e){return(0,s.openView)({payload:e,view:r.ViewId.LAYER_PURCHASE_DETAILS})}},385036:(e,t,i)=>{i.d(t,{openStickersLayerView:()=>u});var r=i(11010),s=i(434788),n=i(210929),a=i(719876),o=i(30173),c=i(256013),l=i(390420),d=i(276782);function u(e){return _.apply(this,arguments)}function _(){return(_=(0,r._)((function*(e){return(0,o.openView)({payload:(0,s._)({},e,{onPurchaseDetailsOpen:e=>(0,c.openLayerPurchaseDetails)({details:e})}),view:a.ViewId.LAYER})}))).apply(this,arguments)}const g=l.stickers.createEffect(u);(0,n.sample)({clock:d.openProductModal,target:g})},374884:(e,t,i)=>{i.d(t,{openStickersRandomSelectorView:()=>u});var r=i(210929),s=i(30173),n=i(719876),a=i(390420),o=i(153536),c=i(438470),l=i(727211),d=i(584356);function u(e){return(0,s.openView)({view:n.ViewId.RANDOM_SELECTOR,payload:e})}const _=a.stickers.createEffect((()=>{(0,d.hideBoxLoader)(),(0,d.curBox)()||u({preventReload:!0})})),g=a.stickers.createEffect((()=>{(0,s.openView)({view:n.ViewId.RANDOM_SELECTOR_PACKS})}));(0,r.sample)({clock:c.openRandomSelectorPacksModal,target:g});const h=a.stickers.createEffect((()=>{(0,s.openView)({view:n.ViewId.RANDOM_SELECTOR_RESULT})}));(0,r.sample)({clock:l.openRandomSelectorResultModal,target:h}),(0,r.sample)({clock:o.buyFx.finally,target:_})},211314:(e,t,i)=>{i.d(t,{Stickers:()=>c});var r=i(68003),s=i(29271),n=i(404145);const a={},o=(e,t,i,r)=>{delete a[t],1===r?Emoji.favorite.addFavoriteSticker(e,t,i):-1===r&&Emoji.favorite.deleteFavoriteSticker(e,t,i)};const c={toggleFavorite:function(e,t,i){if(t&&t.stopPropagation(),!e.classList.contains("on")&&function(){const e=Emoji.stickers[Emoji.TAB_FAVORITE_STICKERS].stickers;return!(!e||e.length<Emoji.favoriteLimit)}())return function(){if(!Emoji.favoriteLimitNoticed){const e=(0,s.langStr)(getLang("purchases_stickers_favorite_limit_notice"),"%s",Emoji.favoriteLimit);setTimeout(window.showFastBox(getLang("global_error"),e).hide,3e3),ajax.post("stickers.php",{act:"favorite_limit_noticed",value:1}),Emoji.favoriteLimitNoticed=!0}}(),!1;const r=e.getAttribute("data-sticker-id"),n=e.getAttribute("data-hash");return!(!r||!n)&&(!a[r]&&(a[r]=1,e.classList.toggle("on"),void ajax.post("/stickers.php",{act:"toggle_favorite",sticker_id:r,hash:n},{onDone:o.pbind(i,r,e)})))},getStickerUrl:function(e,t){let i=String(t);if(r.colorScheme.isDarkScheme()&&(i=i.replace(/b$/,"")+"b"),window.Emoji){var s,a,o;const t=null==(s=null==(a=Emoji.stickersById)||null==(o=a[e])?void 0:o.sticker[Emoji.STICKER_FIELD_IMAGES])?void 0:s[i];if(t)return t}const c={id:e,size:i};if((0,n.isMvk)()){if(window.stickers_cache){const t=window.stickers_cache.getStickerImage(e,i);if(t)return t}return window.store.stickers&&window.rs(window.store.stickers.url_template,{id:e,size:i})}return window.getTemplate("stickers_sticker_url",c)}}},798418:(e,t,i)=>{i.d(t,{StickersAnimation:()=>n});var r=i(404145);const s=(0,i(839470).partConfigEnabled)("rlottie")&&!(0,r.isMvk)();let n=function(){let e,t,i,r,a=!1,o=!1,c={},l={},d={},u={};const _={};function g(e,t){const i=s&&!t;let r=f(e),n=1;if(r){hide(geByClass1("sticker_img",e)),addClass(e,"animation_play"),r.play();let t=attr(e,"data-loop-count");if(t=parseInt(t),isNaN(t)&&(t=3),-1!==t){var a,o;const s=i?null==r||null==(a=r.listeners)?void 0:a.loopComplete:null==r||null==(o=r._cbs)?void 0:o.loopComplete;(!s||0===(null==s?void 0:s.length))&&r.addEventListener("loopComplete",(function s(){n++;let a=!0;t>=n&&(a=!1),a&&(p(e,!1),r.removeEventListener("loopComplete",s),r[i?"pause":"stop"]())}))}}}function h(e){let t=attr(e,"data-uid");return t||(t=attr(e,"data-uid",Math.random().toString(32).substr(2))),t}function p(e,t){_[h(e)]=t}function f(e){let t=attr(e,"data-uniq-id");if(!geByClass1("svg_sticker_animation",e))return!1;let i=d[t];return i||!1}function m(e,t,a){const o=s&&!t;if(_[h(e)])return;p(e,!0);let u=f(e);if(u)return void("function"==typeof a&&a(u));let g=attr(e,"data-uniq-id");const m=attr(e,"data-uid");if(o&&hasClass(e,"animation_play"))return;let k=attr(e,"data-animation-path"),v=attr(e,"data-sticker-id"),w=!1;const y=o?l[v]:c[v];if(v&&(w=(y||k)&&S(e)),w){const s=attr(e,"data-animation-class")||"";let _=o?{elements:[e],loop:!0,autoplay:!0,name:m,group:"sticker",className:`svg_sticker_animation ${s}`}:{container:e,renderer:"svg",loop:!0,autoplay:!1,name:g,rendererSettings:{scaleMode:"noScale",progressiveLoad:!0,hideOnTransparent:!0,className:`svg_sticker_animation ${s}`}};y?_.animationData=y:_[o?"animationUrl":"path"]=k;let h=geByClass1("svg_sticker_animation",e);if(h&&re(h),u=(o?r:i).loadAnimation(_),!c[v]||o)return u instanceof Promise||(u.addEventListener("data_failed",(()=>{})),u=Promise.resolve(u)),void u.then((i=>{const r=o?"firstFrame":"data_ready";i.addEventListener(r,(()=>{const e=i.animationData;o?l[v]=e:c[v]=e,d[g]=i,"function"==typeof a&&a(i)})),o&&i.addEventListener("destroy",(()=>{n.stopAnimation(e,t)}))})).catch((()=>null))}"function"==typeof a&&(d[g]=u,a(u))}function k(e){return t(s&&!e).then((e=>{if(Array.isArray(e)){const[t,s]=e;r=t,i=s}else i=e;return i}))}return{init(e){t=e.animatorLoader},checkSettingsAndLoadInWeb:function(e){if(StickersSettings.getAutoplay()){let t=ge("fc_msg"+e),i=geByClass1("sticker_animation",t);n.loadAndPlaySticker(i)}},checkSettingsAndLoad:function(e){if(StickersSettings.getAutoplay()){let t=$(`.msg_id_${e} .sticker_animation`);n.loadAndPlaySticker(t)}},loadStickerInMvkIMAndPlay:function(e,t){let i="_msg"+e;t&&(i="msg_id_"+e);let r=geByClass1("sticker_animation",geByClass1(i));n.loadAndPlayStickerWithTimer(r,500)},loadAutoplayAnimationStickers:function(e){if(!i)return void k().then((()=>{n.loadAutoplayAnimationStickers(e)}));if(e){if(o)return;o=!0}if(a)return;a=!0;let t=geByClass("sticker_animation_autoplay");t&&each(t,(function(e,t){m(t,!1,(function(){g(t,!1)}))})),a=!1},loadAndPlaySticker:function(e,t){e&&(i?requestAnimationFrame((()=>{m(e,t,(function(){g(e,t)}))})):k(t).then((()=>{n.loadAndPlaySticker(e,t)})))},loadAndPlayStickerWithTimer:function(e,t){if(!e)return;if(u[e])return;t||(t=1e3);let i=ge(e);hasClass(i,"sticker_animation_disabled_timer")||(u[e]=setTimeout((function(){!i&&(i=ge(e),hasClass(i,"sticker_animation_disabled_timer"))||(n.loadAndPlaySticker(i),clearTimeout(u[e]),u[e]=!1)}),t))},reloadStickers:function(){d={}},touchStartSticker:function(t){t.addEventListener("contextmenu",n.preventContextMenu,!1),e=setTimeout((function(){n.loadAndPlaySticker(t)}),500)},touchEndSticker:function(){e&&clearTimeout(e)},preventContextMenu:function(e){e.preventDefault(),e.stopPropagation()},stopAnimation(e,t){const i=s&&!t,r=f(e);if(r&&r[i?"pause":"stop"](),i){const t=attr(e,"data-uniq-id");removeClass(e,"animation_play"),show(geByClass1("sticker_img",e)),p(e,!1),delete d[t]}}};function S(e){let t=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;return t<window.innerHeight&&i>=0&&isVisible(e)}}()},167198:(e,t,i)=>{i.d(t,{StickersSettings:()=>r});let r={autoplay:0,setAutoplay:function(e){this.autoplay=e},getAutoplay:function(){return!!r.autoplay&&!r.isPreventAutoplayByCalls()},isPreventAutoplayByCalls:function(){return!!window.Calls&&window.Calls.isInActiveCall}}},814323:(e,t,i)=>{i.d(t,{StickersAnimation:()=>r.StickersAnimation});var r=i(798418);r.StickersAnimation.init({animatorLoader:()=>Promise.all([Promise.all([i.e(62638),i.e(79344)]).then(i.bind(i,723508)).then((({LottieManager:e})=>e)),Promise.all([i.e(38288),i.e(55489)]).then(i.bind(i,682832)).then((e=>e.lottie))])})}},o={};function c(e){var t=o[e];if(void 0!==t)return t.exports;var i=o[e]={id:e,loaded:!1,exports:{}};return a[e].call(i.exports,i,i.exports,c),i.loaded=!0,i.exports}c.m=a,e=[],c.O=(t,i,r,s)=>{if(!i){var n=1/0;for(d=0;d<e.length;d++){for(var[i,r,s]=e[d],a=!0,o=0;o<i.length;o++)(!1&s||n>=s)&&Object.keys(c.O).every((e=>c.O[e](i[o])))?i.splice(o--,1):(a=!1,s<n&&(n=s));if(a){e.splice(d--,1);var l=r();void 0!==l&&(t=l)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[i,r,s]},c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},i=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var s=Object.create(null);c.r(s);var n={};t=t||[null,i({}),i([]),i(i)];for(var a=2&r&&e;"object"==typeof a&&!~t.indexOf(a);a=i(a))Object.getOwnPropertyNames(a).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,c.d(s,n),s},c.d=(e,t)=>{for(var i in t)c.o(t,i)&&!c.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,i)=>(c.f[i](e,t),t)),[])),c.u=e=>75980===e?"menu_settings.fe841ee6e9d1770c7df7.js":9375===e?"voice_message_player.050d74b181d5db2642f0.js":28762===e?"speech.5c7a8bafaa4c80a92840.js":57468===e?"SilentModeForms.8425705394906aebc7de.js":96248===e?"feed-skeleton.6830e5b139046f63a92d.js":51162===e?"StickersKit.4339d749c3a9af1c83c0.js":79344===e?"sticker.8572aa685d86819d0a97.js":55489===e?"lottie-light.48f1a65d83e7d0217b60.js":7103===e?"stickers-layer-view.0f9e18fceeb83717335e.js":37211===e?"stickers-layer-purchase-details-view.ecd9d8e01b1f803b4eeb.js":39457===e?"stickers-random-selector-view.15fbf277235a4f58c348.js":78177===e?"stickers-random-selector-packs-view.82e74823176d3ebdeb11.js":34757===e?"stickers-random-selector-result-view.1613cb988c705d7da5ab.js":59240===e?"performance-stats.d89fb0a11246583657a4.js":24195===e?e+".13b2fb10985a55b7af12.js":63371===e?e+".be0b8c0c48a4a1b02a8e.js":62638===e?"183ae8612f6fc4f939669ff68939db2e.051ab845cc7544fd28c7.js":38288===e?"lottie.2751896e25440664468a.js":87448===e?"df5f2238430381af4073776990037d9a.442712de4c33add780bb.js":void 0,c.miniCssF=e=>e+"."+{7103:"40a7e407b709ab3e6fbf",34757:"b5be4318cc62f878564e",37211:"765824321a7e8c9308b4",39457:"76704ef5d1a34fea5625",57468:"e8a9b5d3b4a38f45d2ec",75980:"519f671449550110bbb1",78177:"28f0e479ab7f49cdada2",79344:"39ec17015c909fafa936"}[e]+".css",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},c.l=(e,t,i,s)=>{if(r[e])r[e].push(t);else{var n,a;if(void 0!==i)for(var o=document.getElementsByTagName("script"),l=0;l<o.length;l++){var d=o[l];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")=="vk:"+i){n=d;break}}n||(a=!0,(n=document.createElement("script")).charset="utf-8",n.timeout=120,c.nc&&n.setAttribute("nonce",c.nc),n.setAttribute("data-webpack","vk:"+i),n.src=e),r[e]=[t];var u=(t,i)=>{n.onerror=n.onload=null,clearTimeout(_);var s=r[e];if(delete r[e],n.parentNode&&n.parentNode.removeChild(n),s&&s.forEach((e=>e(i))),t)return t(i)},_=setTimeout(u.bind(null,void 0,{type:"timeout",target:n}),12e4);n.onerror=u.bind(null,n.onerror),n.onload=u.bind(null,n.onload),a&&document.head.appendChild(n)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),c.p="/dist/",s=e=>new Promise(((t,i)=>{var r=c.miniCssF(e),s=c.p+r;if(((e,t)=>{for(var i=document.getElementsByTagName("link"),r=0;r<i.length;r++){var s=(a=i[r]).getAttribute("data-href")||a.getAttribute("href");if("stylesheet"===a.rel&&(s===e||s===t))return a}var n=document.getElementsByTagName("style");for(r=0;r<n.length;r++){var a;if((s=(a=n[r]).getAttribute("data-href"))===e||s===t)return a}})(r,s))return t();((e,t,i,r)=>{var s=document.createElement("link");s.rel="stylesheet",s.type="text/css",s.onerror=s.onload=n=>{if(s.onerror=s.onload=null,"load"===n.type)i();else{var a=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.href||t,c=new Error("Loading CSS chunk "+e+" failed.\n("+o+")");c.code="CSS_CHUNK_LOAD_FAILED",c.type=a,c.request=o,s.parentNode.removeChild(s),r(c)}},s.href=t,document.head.appendChild(s)})(e,s,t,i)})),n={54346:0},c.f.miniCss=(e,t)=>{n[e]?t.push(n[e]):0!==n[e]&&{7103:1,34757:1,37211:1,39457:1,57468:1,75980:1,78177:1,79344:1}[e]&&t.push(n[e]=s(e).then((()=>{n[e]=0}),(t=>{throw delete n[e],t})))},(()=>{c.b=document.baseURI||self.location.href;var e={54346:0};c.f.j=(t,i)=>{var r=c.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else if(75980!=t){var s=new Promise(((i,s)=>r=e[t]=[i,s]));i.push(r[2]=s);var n=c.p+c.u(t),a=new Error;c.l(n,(i=>{if(c.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var s=i&&("load"===i.type?"missing":i.type),n=i&&i.target&&i.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+n+")",a.name="ChunkLoadError",a.type=s,a.request=n,r[1](a)}}),"chunk-"+t,t)}else e[t]=0},c.O.j=t=>0===e[t];var t=(t,i)=>{var r,s,[n,a,o]=i,l=0;if(n.some((t=>0!==e[t]))){for(r in a)c.o(a,r)&&(c.m[r]=a[r]);if(o)var d=o(c)}for(t&&t(i);l<n.length;l++)s=n[l],c.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return c.O(d)},i=self.webpackChunkvk=self.webpackChunkvk||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var l=c.O(void 0,[75514,98066,56990,76429,24509,76400,40885,68592],(()=>c(424812)));l=c.O(l)})();