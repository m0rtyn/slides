"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[59640],{784118:(e,t,r)=>{r.d(t,{Icon20GearOutline:()=>s});var s=(0,r(825028).makeIcon)("Icon20GearOutline","gear_outline_20","0 0 20 20",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20" id="gear_outline_20"><path fill-rule="evenodd" d="m7.222 3.378.01-.033a4.147 4.147 0 0 1 .17-.476c.358-.821.944-1.285 1.854-1.36l.166-.009h1.208c1.051.033 1.735.608 2.095 1.692l.057.186.044.166c.016.064.037.132.06.203l.05.137.03.015.06-.02.116-.044.135-.059a5.36 5.36 0 0 1 .168-.074l.036-.015a4.23 4.23 0 0 1 .424-.15c.932-.27 1.685-.075 2.32.618l.108.125.714.88c.636.833.617 1.723-.004 2.683l-.109.161-.102.139c-.04.054-.082.113-.123.177l-.062.1-.029.05.004.017.08.052.11.066.133.072c1.209.614 1.707 1.42 1.515 2.541l-.032.162-.213.916c-.137.593-.245.873-.67 1.258a2.135 2.135 0 0 1-1.059.518l-.01.003a3.917 3.917 0 0 1-.438.059l-.191.012-.173.006-.052.001h-.006c-.05.002-.102.006-.156.01l-.158.02.012.123.011.083.029.154c.068.322.101.618.098.89v.012c-.015.84-.38 1.45-1.132 1.87l-.147.076-1.023.494c-.901.403-1.722.234-2.484-.467a3.934 3.934 0 0 1-.144-.14l-.133-.142-.113-.13a2.938 2.938 0 0 0-.147-.161l-.085-.083-.043-.04-.08.076-.091.093-.103.115c-.828.981-1.703 1.334-2.763.923l-.153-.063-.915-.443-.271-.138c-.415-.225-.647-.44-.874-.918a2.153 2.153 0 0 1-.209-1.01v-.016c.006-.19.03-.388.07-.603l.038-.195.001-.004c.014-.064.025-.133.035-.206l.016-.148-.003-.003-.09-.012-.128-.012-.151-.006a4.145 4.145 0 0 1-.862-.098l-.012-.003c-.837-.198-1.363-.69-1.608-1.524l-.043-.16-.254-1.102c-.204-1.026.205-1.818 1.186-2.41l.17-.098.152-.08c.06-.03.123-.065.188-.105l.134-.087.004-.017-.055-.093-.07-.108-.089-.124a5.194 5.194 0 0 1-.286-.423c-.54-.905-.534-1.72.046-2.523l.1-.132.717-.877c.687-.792 1.566-.958 2.64-.554l.18.072.158.07a2.9 2.9 0 0 0 .193.08l.118.042.032-.014.029-.077.04-.12.04-.143c.013-.056.028-.112.044-.166Zm4.24.841.013.038.05.138a1.5 1.5 0 0 0 .743.833l.03.014a1.5 1.5 0 0 0 1.136.082l.06-.02a1.47 1.47 0 0 0 .065-.023l.117-.044.062-.025.135-.059.035-.015a2.698 2.698 0 0 1 .415-.16c.268-.078.407-.06.47-.043.057.015.16.056.314.22l.077.09.682.84c.138.185.15.295.15.359 0 .084-.03.267-.225.573l-.082.122-.08.108a4.406 4.406 0 0 0-.18.26l-.014.022-.062.099-.008.013-.01.018-.03.05a1.5 1.5 0 0 0-.178 1.056l.004.017a1.5 1.5 0 0 0 .648.959l.08.052.05.032.11.066.06.034.133.072.034.018c.456.231.62.421.676.516.036.06.084.162.042.417l-.023.117-.207.892c-.066.285-.095.35-.105.369 0 0 0 .003-.01.013a.974.974 0 0 1-.101.103c-.082.074-.166.124-.354.161a2.357 2.357 0 0 1-.257.035l-.153.01-.138.004-.071.002a4.554 4.554 0 0 0-.28.02l-.158.019a1.5 1.5 0 0 0-1.318 1.628l.011.123.008.07.012.083.01.06.028.154.008.045c.05.236.068.419.066.557-.003.206-.046.301-.073.348-.028.046-.094.131-.276.235l-.105.056-.977.471c-.204.088-.317.082-.382.07-.076-.015-.228-.068-.456-.279a2.382 2.382 0 0 1-.08-.076l-.1-.107-.088-.102a4.389 4.389 0 0 0-.217-.236l-.018-.018-.084-.082a1.433 1.433 0 0 0-.036-.034l-.043-.04a1.5 1.5 0 0 0-2.047.014l-.08.075a1.43 1.43 0 0 0-.042.041l-.09.094a1.534 1.534 0 0 0-.048.05l-.103.116-.025.03c-.315.371-.532.495-.646.535-.073.025-.183.05-.415-.038l-.094-.039-.864-.418-.238-.12a1.186 1.186 0 0 1-.13-.083l-.004-.003-.003-.003a1.077 1.077 0 0 1-.083-.147.666.666 0 0 1-.063-.34c.003-.09.015-.207.043-.365l.035-.174a4.384 4.384 0 0 0 .058-.35l.016-.149a1.5 1.5 0 0 0-.434-1.224l-.004-.003a1.5 1.5 0 0 0-.86-.423l-.09-.012a1.405 1.405 0 0 0-.064-.008l-.128-.01a1.539 1.539 0 0 0-.068-.005l-.15-.007-.04-.001a2.663 2.663 0 0 1-.549-.06c-.215-.05-.305-.115-.346-.154-.04-.038-.109-.12-.17-.319l-.03-.114-.242-1.052c-.042-.224-.006-.329.023-.387.038-.076.146-.23.459-.42l.128-.074.119-.063a4.431 4.431 0 0 0 .316-.179l.134-.087a1.5 1.5 0 0 0 .65-.947l.004-.017a1.5 1.5 0 0 0-.171-1.066l-.055-.093a1.49 1.49 0 0 0-.037-.062l-.07-.108a1.496 1.496 0 0 0-.04-.057l-.088-.124a1.516 1.516 0 0 0-.024-.031c-.307-.406-.369-.647-.378-.754-.006-.067-.004-.18.148-.395l.072-.094.684-.838c.154-.173.262-.211.33-.225.09-.018.28-.027.623.1l.138.055.123.055a4.42 4.42 0 0 0 .316.13l.118.042a1.5 1.5 0 0 0 1.134-.058l.031-.015a1.5 1.5 0 0 0 .764-.823l.03-.077.023-.066.04-.12.02-.065.04-.143.01-.037.03-.119c.037-.128.076-.235.114-.323.1-.23.192-.319.243-.357.044-.033.134-.086.343-.105l.1-.006h1.14c.234.01.333.071.386.114.067.056.192.195.308.538l.043.14.034.129c.026.1.056.2.088.298ZM10 11.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0 1.5a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" clip-rule="evenodd" /></symbol>',20,20,!1,void 0)},746408:(e,t,r)=>{r.d(t,{default:()=>s});const s={counter:"BadgeCounter-module__counter--RLCgS"}},833223:(e,t,r)=>{r.d(t,{default:()=>s});const s={root:"BadgeItem-module__root--NDr99",wrapper:"BadgeItem-module__wrapper--Dk1KX"}},391342:(e,t,r)=>{r.d(t,{default:()=>s});const s={root:"BadgeItems-module__root--G6uJV"}},532013:(e,t,r)=>{r.d(t,{default:()=>s});const s={items:"BadgesOwnerBlockSkeleton-module__items--j4QSs"}},784637:(e,t,r)=>{r.d(t,{default:()=>s});const s={card:"BadgesOwnerInfoCard-module__card--RGQgs",preview:"BadgesOwnerInfoCard-module__preview--PQEuE",title:"BadgesOwnerInfoCard-module__title--fa7Jo",description:"BadgesOwnerInfoCard-module__description--XYkSi",users:"BadgesOwnerInfoCard-module__users--IahmE"}},598872:(e,t,r)=>{r.d(t,{default:()=>s});const s={items:"BadgesOwnerInfoModal-module__items--QIXCF",counter:"BadgesOwnerInfoModal-module__counter--G6cIu",body:"BadgesOwnerInfoModal-module__body--GxnQm",settings:"BadgesOwnerInfoModal-module__settings--ERtTg",previewItems:"BadgesOwnerInfoModal-module__previewItems--GUGep",previewItem:"BadgesOwnerInfoModal-module__previewItem--izjjE",preview:"BadgesOwnerInfoModal-module__preview--TOuL8",previewImage:"BadgesOwnerInfoModal-module__previewImage--WCuFZ",previewTitle:"BadgesOwnerInfoModal-module__previewTitle--qSCls",previewDescription:"BadgesOwnerInfoModal-module__previewDescription--bouGo"}},478826:(e,t,r)=>{r.d(t,{getUserFullName:()=>s});const s=e=>{const{first_name:t,last_name:r}=e;return`${t} ${r}`}},678755:(e,t,r)=>{r.d(t,{BadgeCounter:()=>d});var s=r(434788),a=r(512796),n=r(785893),o=r(86894),i=r(746408);const d=e=>{var t=(0,s._)({},(0,a._)(e));return(0,n.jsx)(o.Counter,(0,s._)({className:i.default.counter,mode:"inherit"},t))}},719293:(e,t,r)=>{r.d(t,{BadgeSenderItem:()=>h});var s=r(434788),a=r(820224),n=r(785893),o=r(448575),i=r(86894),d=r(221780),l=r(82161),c=r(354082),u=r(478826);function h(e){var{entry:t,user:{id:r,first_name:h,last_name:g,domain:p,photo_100:m,photo_200:v}}=e,_=(0,a._)(e,["entry","user"]);const E=(0,u.getUserFullName)({first_name:h,last_name:g}),I=((0,l.isRetina)()?v:m)||m||"";let f=null;return t.object_description&&(f=(0,c.parseReactWikiLinks)(t.object_description,{target:"_blank"})),f=(0,n.jsxs)(n.Fragment,{children:[f,(0,n.jsx)("br",{}),d.getLang("awards_private_text")]}),(0,n.jsx)(i.RichCell,(0,s._)({before:(0,n.jsx)(i.Avatar,{size:100,src:I,title:E}),caption:f,href:p?`/${p}`:void 0,target:"_blank",onClick:()=>{o.WebStatEvents.add({screen:"badge",type:"type_click",type_click:{type:"type_badges_screen_item",item:{type:"badges",id:r},type_badges_screen_item:{type_badges_event:{event_name:"open_sender"}}}})}},_,{children:E}))}},415796:(e,t,r)=>{r.d(t,{BadgeItem:()=>d,BadgeItemWrapper:()=>i});var s=r(785893),a=r(849776),n=r(678755),o=r(833223);const i=({children:e})=>(0,s.jsx)("div",{className:o.default.wrapper,children:e}),d=({badge:e,counter:t})=>{if(!e)return null;const r=(0,a.getBadgeImage)(e.image,128);return(0,s.jsx)(i,{children:(0,s.jsx)("div",{style:{backgroundImage:`url('${r}')`},className:o.default.root,children:(0,s.jsx)(n.BadgeCounter,{size:"s",children:t})})})}},726914:(e,t,r)=>{r.d(t,{BadgeItems:()=>d});var s=r(785893),a=r(667294),n=r(86894),o=r(415796),i=r(391342);const d=({counters:e,badges:t,onClick:r})=>{const d=(0,a.useMemo)((()=>((null==e?void 0:e.filter((e=>"total"!==e.type)))||[]).map((({value:e,badge_id:r})=>{if(!r)return null;const a=t.find((({id:e})=>r===e));return(0,s.jsx)(o.BadgeItem,{counter:e,badge:a},r)}))),[e,t]);return(0,s.jsx)(n.HorizontalScroll,{arrowSize:"m",children:(0,s.jsx)("div",{className:i.default.root,onClick:r,tabIndex:0,role:"button",children:d})})}},704919:(e,t,r)=>{r.d(t,{BadgesOwnerBlockSkeleton:()=>h});var s=r(434788),a=r(785893),n=r(667294),o=r(444972),i=r(86894),d=r(659397),l=r(415796),c=r(532013);const u=(0,d.createArray)(4),h=e=>{const t=(0,n.useMemo)((()=>u.map(((e,t)=>(0,a.jsx)(l.BadgeItemWrapper,{children:(0,a.jsx)(o.Skeleton,{width:56,height:56,circle:!0})},t)))),[56,4]);return(0,a.jsx)(i.Group,(0,s._)({header:(0,a.jsx)(i.Header,{children:(0,a.jsx)(o.Skeleton,{width:192})})},e,{children:(0,a.jsx)("div",{className:c.default.items,children:t})}))}},518285:(e,t,r)=>{r.d(t,{BadgesOwnerInfoCard:()=>c});var s=r(785893),a=r(86894),n=r(360470),o=r(29271),i=r(849776),d=r(678755),l=r(784637);const c=({badge:e,counter:t,recentSenderUsers:r,sendersCount:c,onClick:u})=>{const h=null==r?void 0:r.slice(0,3).map((({photo_200:e})=>String(e)));return(0,s.jsxs)(a.Tappable,{className:l.default.card,onClick:u,children:[(0,s.jsx)("div",{className:l.default.preview,"aria-label":e.title,style:{backgroundImage:`url('${(0,i.getBadgeImage)(e.image,128)}')`},children:(0,s.jsx)(d.BadgeCounter,{children:t})}),(0,s.jsx)(a.Title,{className:l.default.title,level:"2",weight:"1",children:e.title}),(0,s.jsx)(a.Text,{className:l.default.description,weight:"3",children:e.description}),Boolean(r.length)&&(0,s.jsx)("div",{className:l.default.users,children:(0,s.jsx)(n.UsersStack,{size:"l",photos:h,children:o.getLang("awards_senders_count",c).replace("{count}",String(c))})})]})}},55163:(e,t,r)=>{r.d(t,{BadgesOwnerInfoModal:()=>k});var s=r(434788),a=r(785893),n=r(667294),o=r(723062),i=r(599809),d=r(448575),l=r(169447),c=r(784118),u=r(86894),h=r(400856),g=r(345658),p=r(816511),m=r(685371),v=r(518285),_=r(719293),E=r(678755),I=r(254667),f=r(29271),w=r(849776),b=r(460033),S=r(598872);class k extends n.Component{componentDidMount(){d.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",owner_id:this.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_all__"+(o.Ranges.isUserId(this.props.ownerId)?"u":"c")}}}}),this.fetchOwnerInfo()}componentDidUpdate(){const{currentBadgeId:e}=this.state;e&&!this.getBadgeEntries(e)&&this.fetchOwnerEntries()}fetchOwnerInfo(){const{ownerId:e}=this.props;(0,i.api)("badges.getOwnerInfo",{owner_id:e,with_senders:1,fields:"photo_100,photo_200,domain"}).then((({owner_info:e,badges:t,users:r})=>{var s;this.setState({isOwnerInfoLoaded:!0,totalCount:(null==(s=((null==e?void 0:e.counters)||[]).find((e=>"total"===e.type)))?void 0:s.value)||0,counters:((null==e?void 0:e.counters)||[]).filter((e=>"total"!==e.type)),badges:k.convertBadges(t||[]),users:k.convertUsers(r||[])})})).catch((e=>{var t;this.props.close(),(0,I.topError)((null==e||null==(t=e.error)?void 0:t.error_msg)||f.getLang("global_unknown_error"))}))}fetchOwnerEntries(){const{ownerId:e}=this.props,{loadedBadgeEntries:t,currentBadgeId:r}=this.state;if(!r)return;const a=this.getBadgeEntries(r),n={fields:"photo_100,photo_200,domain"};(null==a?void 0:a.next_query)?Object.assign(n,{query:a.next_query}):Object.assign(n,{owner_id:e,badge_id:r,count:100}),(0,i.api)("badges.getOwnerEntries",n).then((({entries:e,badges:n,next_query:o,users:i})=>{this.setState({users:(0,s._)({},this.state.users,k.convertUsers(i||[])),badges:(0,s._)({},this.state.badges,k.convertBadges(n||[])),loadedBadgeEntries:(0,s._)({},t,{[r]:{entries:[...(null==a?void 0:a.entries)||[],...e||[]],next_query:o}})})})).catch((e=>{var t;this.props.close(),(0,I.topError)((null==e||null==(t=e.error)?void 0:t.error_msg)||f.getLang("global_unknown_error"))}))}renderHeader(){const{isOwnerInfoLoaded:e,currentBadgeId:t,isAdmin:r}=this.state,{ownerId:s}=this.props;return(0,a.jsx)(h.ModalHeader,{closeAriaLabel:f.getLang("awards_back_button"),onClose:this.props.close,before:e&&t&&(0,a.jsxs)(g.ModalHeaderButton,{"aria-label":f.getLang("awards_back_button"),onClick:()=>this.selectBadge(null),children:[(0,a.jsx)(l.Icon20ChevronLeftOutline,{}),f.getLang("awards_back_button")]}),after:r&&(0,a.jsx)(u.Link,{className:S.default.settings,href:(()=>{const e=`${location.protocol}//${window.vk.host}`;let t;return o.Ranges.isGroupId(s)?(t=new URL(`public${Math.abs(s)}`,e),t.searchParams.set("act","sections")):(t=new URL("settings",e),t.searchParams.set("act","privacy"),t.searchParams.set("hl","badges")),t.toString()})(),target:"_blank",children:(0,a.jsx)(c.Icon20GearOutline,{})}),children:e&&!t?this.renderHeaderTitle():null})}renderHeaderTitle(){const{ownerId:e}=this.props,{totalCount:t}=this.state,r=t>0?(0,a.jsx)("span",{className:S.default.counter,children:t}):null;let s="";return s=e===window.vk.id?f.getLang("awards_my_badges"):o.Ranges.isGroupId(e)?f.getLang("awards_group_block_header"):f.getLang("awards_profile_block_header"),(0,a.jsxs)(a.Fragment,{children:[s," ",r]})}renderContent(){const{counters:e,currentBadgeId:t}=this.state;return t?this.renderBadgeInfo():(0,a.jsx)("div",{className:S.default.items,children:e.map((({badge_id:e,value:t,recent_sender_ids:r,senders_count:s},n)=>(0,a.jsx)(v.BadgesOwnerInfoCard,{badge:this.getBadgeById(e||0),counter:t,recentSenderUsers:this.getUsersById(r||[]),sendersCount:s||0,onClick:()=>this.selectBadge(e||null)},n)))})}renderBadgeInfo(){var e,t;const{currentBadgeId:r,counters:s}=this.state,n=this.getBadgeEntries(r||0),o=this.getBadgeById(r||0),i=(null==(e=s.find((e=>e.badge_id===r)))?void 0:e.value)||0;return n?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:S.default.preview,children:[(0,a.jsx)("div",{className:S.default.previewImage,"aria-label":o.title,style:{backgroundImage:`url('${(0,w.getBadgeImage)(o.image,100)}')`},children:(0,a.jsx)(E.BadgeCounter,{children:i})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Title,{className:S.default.previewTitle,level:"2",weight:"2",children:o.title}),(0,a.jsx)(u.Text,{className:S.default.previewDescription,weight:"3",children:o.description})]})]}),(0,a.jsx)(u.Spacing,{size:25}),(0,a.jsx)(u.Separator,{}),(0,a.jsx)(u.Spacing,{size:25}),(0,a.jsx)(b.ReexportInfiniteScroll,{className:S.default.previewItems,hasMore:Boolean(n.next_query),loadMore:this.fetchOwnerEntries,children:null==(t=n.entries)?void 0:t.map(((e,t)=>{const r=e.sender_id;return r?(0,a.jsx)(_.BadgeSenderItem,{className:S.default.previewItem,entry:e,user:this.getUserById(r)},t):null}))})]}):(0,a.jsx)(u.Spinner,{})}getBadgeById(e){return this.state.badges[e]}getUserById(e){return this.state.users[e]}getUsersById(e){return e.map((e=>this.getUserById(e)))}getBadgeEntries(e){return this.state.loadedBadgeEntries[e]}static convertBadges(e){return e.reduce(((e,t)=>(0,s._)({},e,{[t.id]:t})),{})}static convertUsers(e){return e.reduce(((e,t)=>(0,s._)({},e,{[t.id]:t})),{})}render(){const{isOwnerInfoLoaded:e}=this.state;return(0,a.jsxs)(p.ModalBox,{children:[this.renderHeader(),(0,a.jsx)(u.CustomScrollView,{children:(0,a.jsx)(m.ModalBody,{insetLevel:2,className:S.default.body,children:e?this.renderContent():(0,a.jsx)(u.Spinner,{})})})]})}constructor(e){super(e),this.selectBadge=e=>{e&&d.WebStatEvents.add({screen:"badge",type:"type_navgo",type_navgo:{type:"type_badges_screen_item",subtype:"go",item:{type:"badges",id:e,owner_id:this.props.ownerId},type_badges_screen_item:{type_badges_event:{event_name:"open_badges_collection_badge__"+(o.Ranges.isUserId(this.props.ownerId)?"u":"c")}}}}),this.setState({currentBadgeId:e})};const{isAdmin:t=!1}=e;this.state={isOwnerInfoLoaded:!1,totalCount:0,counters:[],badges:{},users:{},currentBadgeId:null,loadedBadgeEntries:{},isAdmin:t}}}},452866:(e,t,r)=>{r.d(t,{GroupBadges:()=>v});var s=r(785893),a=r(667294),n=r(86894),o=r(869048),i=r(399639),d=r(222285),l=r(599809),c=r(377974),u=r(29271),h=r(726914),g=r(680938),p=r(323141),m=r(316688);const v=(0,g.withErrorBoundary)((e=>{var t,r,g;const{ownerId:v,isAdmin:_}=e,[E,I]=(0,a.useState)(),[f,w]=(0,a.useState)(d.LoadingStatus.pending);if((0,a.useEffect)((()=>{w(d.LoadingStatus.pending),(0,l.api)("badges.getOwnerInfo",{fields:String(["photo_100","photo_200","domain"]),owner_id:v}).then(I).then((()=>{w(d.LoadingStatus.loaded)})).catch((e=>{w(d.LoadingStatus.failed),(0,m.badgesLogger)("Failed badges.getOwnerInfo in GroupBadges",e)}))}),[v]),f!==d.LoadingStatus.loaded&&f!==d.LoadingStatus.failed)return(0,s.jsx)(p.BadgesOwnerBlockSkeleton,{separator:"hide"});if(!(null==E||null==(t=E.badges)?void 0:t.length)||f===d.LoadingStatus.failed)return null;const{badges:b,owner_info:S}=E,k=(null==(r=null==S||null==(g=S.counters)?void 0:g.find((e=>"total"===e.type)))?void 0:r.value)||0,y=()=>{(0,c.initBadgesOwnerInfo)({ownerId:v,isAdmin:_})};return(0,s.jsx)(o.AppRootProvider,{viewWidth:n.ViewWidth.DESKTOP,children:(0,s.jsx)(n.Group,{header:(0,s.jsx)(i.Header,{indicator:k,onClick:y,children:u.getLang("awards_profile_block_header")}),separator:"hide",children:(0,s.jsx)(h.BadgeItems,{badges:b,counters:null==S?void 0:S.counters,onClick:y})})})}))},680938:(e,t,r)=>{r.d(t,{withErrorBoundary:()=>l});var s=r(434788),a=r(785893),n=r(667294),o=r(86894),i=r(29271),d=r(316688);function l(e){return t=>(0,a.jsx)(c,{children:(0,a.jsx)(e,(0,s._)({},t))})}class c extends n.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e){(0,d.badgesLogger)("Rendering error has happened in component GroupBadges",e)}render(){return this.state.hasError?(0,a.jsx)(o.Group,{separator:"hide",children:(0,a.jsx)(o.Placeholder,{header:i.getLang("global_error"),action:(0,a.jsx)(o.Button,{mode:"tertiary",loading:this.state.isReloading,onClick:this.onClick,children:i.getLang("global_reload")}),children:i.getLang("awards_group_block_unknown_error")})}):this.props.children}constructor(...e){super(...e),this.state={hasError:!1,isReloading:!1},this.onClick=()=>{this.setState({isReloading:!0}),window.nav.reload({force:!0})}}}},323141:(e,t,r)=>{r.r(t),r.d(t,{BadgesOwnerBlockSkeleton:()=>d.BadgesOwnerBlockSkeleton,BadgesOwnerInfo:()=>c,GroupBadges:()=>l.GroupBadges});var s=r(785893),a=r(55163),n=r(316688),o=r(359639),i=r(222285),d=r(704919),l=r(452866);const c={init(e,t){e?(0,o.showMessageBoxModal)((({onClose:r})=>(0,s.jsx)(a.BadgesOwnerInfoModal,{ownerId:e,isAdmin:t,close:r})),{width:i.BADGES_BOX_WIDTH}):(0,n.badgesLogger)(`Wrong arguments: ownerId=${e}`)}}},222285:(e,t,r)=>{r.d(t,{BADGES_BOX_WIDTH:()=>s,BADGE_COMMENT_SELECTOR:()=>i,BadgesEventRef:()=>o,ERRORS:()=>n,LINK_TO_HELP_FOR_AUTHORS:()=>a,LoadingStatus:()=>d});const s=640,a="/@authors-badges";var n,o;!function(e){e[e.ERROR_PARAM=100]="ERROR_PARAM",e[e.NEED_CONFIRMATION=24]="NEED_CONFIRMATION",e[e.BALANCE=504]="BALANCE"}(n||(n={})),function(e){e.TAB="tab",e.SENDER_LIST="sender_list"}(o||(o={}));const i="BadgeComment";var d;!function(e){e[e.pending=0]="pending",e[e.loaded=1]="loaded",e[e.failed=2]="failed"}(d||(d={}))},849776:(e,t,r)=>{r.d(t,{buildHtmlAttributesString:()=>i,getBadgeImage:()=>n,getBadgesStackHTMLForPost:()=>o});var s=r(82161),a=r(795558);function n(e,t,r=!1){const{base_url:a,version:n}=e,o=n?`?${n}`:"";return!r&&(0,s.isRetina)()&&(t*=2),`${a}/${t}.png${o}`}function o(e,t,r){return r?(0,a.rs)(r,{object_owner_id:e,object_id:t}):""}const i=e=>Object.entries(e).reduce(((e,[t,r])=>{if(r){e+=` ${t}="${(0,s.escapeAttr)(String(r))}"`}return e}),"")},460033:(e,t,r)=>{r.d(t,{ReexportInfiniteScroll:()=>s});const s=r(625533).default},608773:(e,t,r)=>{r.d(t,{initBadgesTqInteractiveHandlers:()=>h,initGroupBadgesTq:()=>g,initStartupBadgesStackTq:()=>p,tqOpenBadgesObjectInfo:()=>u});var s=r(785893),a=r(283452),n=r(377974),o=r(973935),i=r(323141),d=r(216833),l=r(321850),c=r(68003);const u=()=>{(0,a.tq)().setInteractiveHandler("Badges/openBadgesObjectInfo",(e=>{if(!e.payload.dataAttrs)return;const{badgeId:t,objectType:r,objectOwnerId:s,objectId:a}=e.payload.dataAttrs;if(!r||!s||!a)throw new Error("No required attributes in tq Badges/openBadgesObjectInfo");(0,n.initBadgesObjectInfo)(Number(r),Number(s),Number(a),Number(t))}))},h=()=>{u(),(0,a.tq)().setInteractiveHandler("Badges/openBadgesCatalog",(e=>{if(!e.payload.dataAttrs)return;const{objectType:t,objectOwnerId:r,objectId:s,eventRef:a}=e.payload.dataAttrs;if(!t||!r||!s)throw new Error("No required attributes in tq Badges/openBadgesCatalog");(0,n.initBadgesCatalog)(Number(t),Number(r),Number(s),a)}))},g=()=>{(0,a.tq)().setStartupHandler("BadgesOwner/render_group_badges",(e=>{const{data:{owner_id:t,is_admin:r},target:a}=e.payload;a&&void 0!==t&&(0,d.isBadgesEnabled)()&&(o.render((0,s.jsx)(i.GroupBadges,{ownerId:Number(t),isAdmin:Boolean(r)}),a),(0,l.pushNavDestroy)((()=>o.unmountComponentAtNode(a))))}))},p=()=>{(0,a.tq)().setStartupHandler("BadgesStack/init",(e=>{const{target:t}=e.payload;t&&c.colorScheme.subscribe((()=>{t.querySelectorAll(".BadgesStackItem").forEach((e=>{let t=e.src;const{srcLight:r=t,srcDark:s=t}=e.dataset;t=c.colorScheme.isDarkScheme()?s:r,e.src=t}))}))}))}},377974:(e,t,r)=>{r.d(t,{initBadgesCatalog:()=>d,initBadgesObjectInfo:()=>l,initBadgesOwnerInfo:()=>c,initBadgesTqInteractiveHandlers:()=>i.initBadgesTqInteractiveHandlers,initStartupBadgesStackTq:()=>i.initStartupBadgesStackTq,loadBadgesWallOnboarding:()=>u});var s=r(316688),a=r(659397),n=r(216833),o=r(584356),i=r(608773);const d=(e,t,i,d)=>{(0,n.isBadgesEnabled)()&&((0,o.showBoxLoader)(),(window.BadgesCatalog?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.all([r.e(98066),r.e(56990),r.e(18669)]).then(r.bind(r,768327)))).then((({BadgesCatalog:e})=>{window.BadgesCatalog=e}))).then((()=>window.BadgesCatalog.init(e,t,i,d))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesCatalog",e)})).finally((()=>{(0,o.hideBoxLoader)()})))},l=(e,t,i,d,l)=>{(0,n.isBadgesEnabled)()&&((0,o.showBoxLoader)(),(window.BadgesObjectInfo?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.all([r.e(98066),r.e(68592),r.e(83803)]).then(r.bind(r,978219)))).then((({BadgesObjectInfo:e})=>{window.BadgesObjectInfo=e}))).then((()=>window.BadgesObjectInfo.init(e,t,i,d,l))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesObjectInfo",e)})).finally((()=>{(0,o.hideBoxLoader)()})))},c=e=>{if(!(0,n.isBadgesEnabled)())return;(0,o.showBoxLoader)();const{ownerId:t,isAdmin:i}=e;(window.BadgesOwnerInfo?Promise.resolve():(0,a.asyncImportLoader)((()=>Promise.resolve().then(r.bind(r,323141)))).then((({BadgesOwnerInfo:e})=>{window.BadgesOwnerInfo=e}))).then((()=>window.BadgesOwnerInfo.init(t,i))).catch((e=>{(0,s.badgesLogger)("Error loading module BadgesOwnerInfo",e)})).finally((()=>{(0,o.hideBoxLoader)()}))},u=({target:e})=>{(0,n.isBadgesEnabled)()&&(0,a.asyncImportLoader)((()=>r.e(9603).then(r.bind(r,375396)))).then((({initBadgesWallOnboarding:t})=>{t({target:e})})).catch((e=>{(0,s.badgesLogger)("Error loading module badges_wall_onboarding_init",e)}))}},316688:(e,t,r)=>{r.d(t,{badgesLogger:()=>a});var s=r(970978);const a=(e,t)=>{window.vk.dev&&console.log(t),(0,s.logError)(new Error(e),{environment:"badges"})}},216833:(e,t,r)=>{r.d(t,{isBadgesEnabled:()=>a});var s=r(839470);const a=()=>(0,s.partConfigEnabled)("web2_badges")&&(0,s.partConfigEnabled)("badges")},377976:(e,t,r)=>{r.d(t,{API:()=>p});var s,a,n=r(434788),o=r(393356),i=r(401623),d=r(283085),l=r(618430),c=r(647827),u=r(183746),h=r(722223);const g="undefined"!=typeof window&&(null==(s=window.vk)||null==(a=s.apiConfigDomains)?void 0:a.apiDomain)||"api.vk.com";class p extends i.CallbackService{setOptions(e){this.options=(0,n._)({},this.options,e)}execute(e){return this.call("execute",e)}procedure(e,t){return this.call(`execute.${e}`,t)}call(e,t){return this.callWithRequest(new i.APIRequest({method:e,params:t,api:this}))}callWithRequest(e){return this.worker.enqueue(e),e.promise}getWorker(){switch(this.options.mode){case h.APIMode.PARALLEL:return new d.ParallelWorker(this);case h.APIMode.SEQUENTIAL:return new l.SequentialWorker(this)}}constructor(e,t={}){super(),this.globalParams=new Map,this.options=(0,n._)({token:"",mode:h.APIMode.SEQUENTIAL,requestMode:h.APIRequestMode.SEQUENTIAL,requestMethod:h.APIRequestMethod.FETCH,wait:3e3,limit:3,bridge:!1,version:o.API_VERSION,baseUrl:`https://${g}`,retryLimit:3,timeout:6e4,executeCount:25,language:"ru",executeUnsupportedMethods:["photos.save","photos.saveWallPhoto","photos.saveOwnerPhoto","photos.saveMessagesPhoto","messages.setChatPhoto","photos.saveMarketPhoto","photos.saveMarketAlbumPhoto","audio.save","docs.save","photos.saveOwnerCoverPhoto","stories.save","polls.savePhoto"]},e);for(const e of c.methodGroups)this[e]=new Proxy(Object.create(null),{get:(t,r)=>(t,s)=>this.callWithRequest(new i.APIRequest({api:this,method:`${e}.${r}`,params:t,options:s}))});this.worker=this.getWorker(),this.updates=new u.Updates(this,t)}}},513222:(e,t,r)=>{r.d(t,{CaptchaType:()=>n,MINIMUM_TIME_INTERVAL_API:()=>a,POLLING_VERSION:()=>s});const s=10,a=1133;var n;!function(e){e.API="API",e.DIRECT_AUTH="DIRECT_AUTH",e.IMPLICIT_FLOW_AUTH="IMPLICIT_FLOW_AUTH",e.ACCOUNT_VERIFICATION="ACCOUNT_VERIFICATION"}(n||(n={}))},432043:(e,t,r)=>{r.d(t,{APIError:()=>n});var s=r(602033),a=r(5874);class n extends a.VKError{constructor(e){const t=Number(e.error_code);switch(super({code:t,message:`Code №${t} - ${e.error_msg}`}),this.params=e.request_params,t===s.API_ERROR_CAPTCHA&&(this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img),t){case s.API_ERROR_CAPTCHA:this.captchaSid=Number(e.captcha_sid),this.captchaImg=e.captcha_img;break;case s.API_ERROR_AUTH_VALIDATION:this.redirectUri=e.redirect_uri;break;case s.API_ERROR_NEED_CONFIRMATION:this.confirmationText=e.confirmation_text}}}},752448:(e,t,r)=>{r.d(t,{ExecuteError:()=>a});var s=r(432043);class a extends s.APIError{constructor(e){super({error_code:e.error_code,error_msg:e.error_msg,request_params:[]}),this.method=e.method}}},695007:(e,t,r)=>{r.d(t,{OAuthError:()=>a});var s=r(5874);class a extends s.VKError{constructor({error:e,error_description:t}){super({code:e,message:t})}}},869489:(e,t,r)=>{r.d(t,{UpdatesError:()=>a});var s=r(5874);class a extends s.VKError{}},5874:(e,t,r)=>{var s;r.d(t,{SharedErrorCode:()=>s,VKError:()=>a}),function(e){e.UNSUPPORTED_MODE="UNSUPPORTED_MODE",e.MISSING_CAPTCHA_HANDLER="MISSING_CAPTCHA_HANDLER",e.MISSING_TOKEN_REGENERATE_HANDLER="MISSING_TOKEN_REGENERATE_HANDLER"}(s||(s={}));class a extends Error{constructor({code:e,message:t}){super(t),this.code=e,this.name=this.constructor.name}}},526511:(e,t,r)=>{r.d(t,{CallbackService:()=>a});var s=r(5874);class a{get hasCaptchaHandler(){return void 0!==this.captchaHandler}onCaptcha(e){return this.captchaHandler=e,this}processingCaptcha(e){const{captchaHandler:t}=this;return t?new Promise(((r,s)=>{t(e,(e=>new Promise(((t,a)=>{if(e instanceof Error)return a(e),void s(e);r({key:e,validate:{resolve:t,reject:a}})}))))})):Promise.reject(new s.VKError({code:s.SharedErrorCode.MISSING_CAPTCHA_HANDLER,message:"Missing captcha handler"}))}get hasTokenRegenerateHandler(){return void 0!==this.tokenRegenerateHandler}onTokenRegenerate(e){return this.tokenRegenerateHandler=e,this}processingTokenRegenerate(){const{tokenRegenerateHandler:e}=this;return void 0===e?Promise.reject(new s.VKError({code:s.SharedErrorCode.MISSING_TOKEN_REGENERATE_HANDLER,message:"Missing token regenerate handler"})):new Promise(((t,r)=>{e((e=>new Promise(((s,a)=>{if(e instanceof Error)return a(e),void r(e);t({token:e,validate:{resolve:s,reject:a}})}))))}))}}},565579:(e,t,r)=>{r.d(t,{EventDispatcher:()=>s});class s{hasEventListener(e,t){return this.listeners.some((r=>r.type===e&&r.listener===t))}addEventListener(e,t,r={}){return this.hasEventListener(e,t)||this.listeners.push({type:e,listener:t,options:r}),this}removeEventListener(e,t){const r=this.listeners.findIndex((r=>r.type===e&&r.listener===t));return-1!==r&&this.listeners.splice(r,1),this}removeEventListeners(){return this.listeners=[],this}dispatchEvent(e){return this.listeners.filter((t=>t.type===e.type)).forEach((t=>{const{type:r,listener:s,options:{once:a}}=t;s.call(this,e),a&&this.removeEventListener(r,s)})),this}constructor(){this.listeners=[]}}},401623:(e,t,r)=>{r.d(t,{APIRequest:()=>s.APIRequest,CallbackService:()=>a.CallbackService});var s=r(17318),a=r(526511)},17318:(e,t,r)=>{r.d(t,{APIRequest:()=>l});var s=r(11010),a=r(434788),n=r(363476),o=r.n(n),i=r(372322),d=r(48989);class l{toString(){return(0,d.getExecuteMethod)(this.method,this.params)}get filteredParams(){const{options:{token:e,version:t,language:r}}=this.api;return Object.fromEntries([...Object.entries((0,a._)({},!this.isCustomMethod&&{v:t,access_token:e},{lang:r},this.params)),...this.api.globalParams.entries()].filter((([,e])=>void 0!==e)))}get isCustomMethod(){const{requestMethod:e}=this.api.options;return"function"==typeof e}make(){var e=this;return(0,s._)((function*(){const{options:{timeout:t,requestMethod:r}}=e.api;e.timeout=setTimeout((()=>{var t;return null==(t=e.options.abortController)?void 0:t.abort()}),t);try{return e.isCustomMethod?yield e.custom():yield e[r]()}finally{clearTimeout(e.timeout)}}))()}fetch(){const{abortController:e}=this.options,{options:{baseUrl:t}}=this.api;return fetch(new URL(`/method/${this.method}`,t),{method:"POST",signal:null==e?void 0:e.signal,headers:{connection:"keep-alive"},body:new URLSearchParams(this.filteredParams)}).then((e=>e.json()))}bridge(){const{abortController:e}=this.options;return new Promise(((t,r)=>{(null==e?void 0:e.signal.aborted)&&r(e.signal.reason),null==e||e.signal.addEventListener("abort",(()=>{r(e.signal.reason)})),o().send("VKWebAppCallAPIMethod",{method:this.method,params:this.filteredParams}).then(t).catch((e=>{const{error_data:r}=e;t({error:(null==r?void 0:r.error_reason)||r||e})}))}))}script(){const{abortController:e}=this.options,{options:{baseUrl:t}}=this.api;return new Promise(((r,s)=>{(null==e?void 0:e.signal.aborted)&&s(e.signal.reason);const a=(0,i.generateId)(20),n=new URLSearchParams(this.filteredParams);n.set("callback",a);const o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=new URL(`/method/${this.method}?${n}`,t).toString(),window[a]=e=>{o.remove(),delete window[a],r(e)},null==e||e.signal.addEventListener("abort",(()=>{o.remove(),delete window[a],s(e.signal.reason)})),document.head.appendChild(o)}))}custom(){const{abortController:e}=this.options,{requestMethod:t}=this.api.options;if("function"==typeof t)return new Promise(((r,s)=>{(null==e?void 0:e.signal.aborted)&&s(e.signal.reason),null==e||e.signal.addEventListener("abort",(()=>{s(e.signal.reason)})),t(this.method,this.filteredParams).then(r).catch(s)}))}constructor({api:e,method:t,params:r={},options:s={}}){var n;this.retries=0,this.api=e,this.method=t,this.params=(0,a._)({},r),this.options=(0,a._)({},s),null!=(n=this.options).abortController||(n.abortController=new AbortController),this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}},506945:(e,t,r)=>{r(667294)},964548:(e,t,r)=>{r.d(t,{API:()=>s.API,StickersQueueEventType:()=>i.StickersQueueEventType,UpdatesSource:()=>n.UpdatesSource,VKError:()=>a.VKError,VmojiQueueEventType:()=>o.VmojiQueueEventType,getRandomId:()=>d.getRandomId});var s=r(377976),a=(r(722223),r(695007),r(869489),r(752448),r(5874)),n=(r(432043),r(183746)),o=r(563772),i=r(513080),d=(r(85158),r(456079),r(187684),r(969042),r(506945),r(167718));r(153473),r(517283)},647827:(e,t,r)=>{r.d(t,{methodGroups:()=>s});const s=["account","accountVerification","actionLinks","address","adex","admins","ads","adsint","adsweb","aliexpress","antispam","appWidgets","apps","articles","asr","audio","audioSearch","auth","authorsMarketplace","autotests","badges","bestFriends","biz","blogforce","board","bot","botsConf","bugtracker","calls","captcha","cashout","catalog","channels","classifieds","combo","coupons","crowd","database","deliveryClub","docs","documentation","donut","downloadedGames","education","educationCloud","educationForeign","educationParents","educationPolls","educationReport","educationUser","email","esia","exchange","exchangeRates","execute","experts","explore","externalAudioMatching","externalUsers","fave","finance","findMe","forbiddenRegistry","fortuneSquare","fortuneWheel","friends","gamesPromo","gifts","golunch","goodsOrders","groups","healthApp","healthCommon","healthLoyalty","id","identity","instManager","interests","internal","leadForms","leads","lifeEvents","likes","lovina","loyalty","loyaltyTeen","market","marusia","masks","matching","memories","messages","microlandings","mobile","money","multiaccount","musicManager","narratives","newsfeed","nft","nospam","notes","notifications","odnoklassniki","onboarding","orders","pages","phones","photos","places","platform","platformConsole","podcasts","podcastsOffice","polls","prettyCards","promoCodes","questions","queue","reports","restore","rewardedAds","rightholders","search","secure","serverCalls","serverEffects","settings","shortVideo","signals","situationalSuggests","sms","social","specials","statEvents","stats","statsDashboard","status","stickers","storage","store","stories","streaming","studentsVerification","studio","superApp","support","survey","tags","textlives","tickets","tinkoff","translations","uma","users","utils","uxpolls","verification","video","videoPostcards","vkCharity","vkMusic","vkRun","vkStart","vkTaxi","vkUp","vkdrive","vkstore","vmoji","voicerooms","wall","weather","widgets","widgetsIOS","widgetsKit","wishlists"]},722223:(e,t,r)=>{var s,a,n;r.d(t,{APIMode:()=>s,APIRequestMethod:()=>n,APIRequestMode:()=>a}),function(e){e.PARALLEL="parallel",e.SEQUENTIAL="sequential"}(s||(s={})),function(e){e.SEQUENTIAL="sequential",e.BURST="burst"}(a||(a={})),function(e){e.FETCH="fetch",e.SCRIPT="script",e.BRIDGE="bridge"}(n||(n={}))},513080:(e,t,r)=>{var s;r.d(t,{StickersQueueEvent:()=>a,StickersQueueEventType:()=>s}),function(e){e.UGC_USER_UPDATE="ugc_user_update",e.UGC_PACK_UPDATE="ugc_pack_update",e.UGC_OWNER_UPDATE="ugc_owner_update",e.UGC_STICKER_UPDATE="ugc_sticker_update"}(s||(s={}));class a extends CustomEvent{constructor(e,t){super(e,{detail:t})}}},718557:(e,t,r)=>{r.d(t,{handlerStickersQueueEvent:()=>d});var s=r(513080),a=r(85158),n=r(456079),o=r(187684),i=r(969042);function d(e,{data:t}){const{type:r}=t;switch(r){case s.StickersQueueEventType.UGC_PACK_UPDATE:e.dispatchEvent(new a.StickersUGCPackUpdate(t));break;case s.StickersQueueEventType.UGC_USER_UPDATE:e.dispatchEvent(new n.StickersUGCUserUpdate(t));break;case s.StickersQueueEventType.UGC_OWNER_UPDATE:e.dispatchEvent(new o.StickersUGCOwnerUpdate(t));break;case s.StickersQueueEventType.UGC_STICKER_UPDATE:e.dispatchEvent(new i.StickersUGCStickerUpdate(t))}}},187684:(e,t,r)=>{r.d(t,{StickersUGCOwnerUpdate:()=>a});var s=r(513080);class a extends s.StickersQueueEvent{constructor(e){super(s.StickersQueueEventType.UGC_OWNER_UPDATE,e)}}},85158:(e,t,r)=>{r.d(t,{StickersUGCPackUpdate:()=>a});var s=r(513080);class a extends s.StickersQueueEvent{constructor(e){super(s.StickersQueueEventType.UGC_USER_UPDATE,e)}}},969042:(e,t,r)=>{r.d(t,{StickersUGCStickerUpdate:()=>a});var s=r(513080);class a extends s.StickersQueueEvent{constructor(e){super(s.StickersQueueEventType.UGC_STICKER_UPDATE,e)}}},456079:(e,t,r)=>{r.d(t,{StickersUGCUserUpdate:()=>a});var s=r(513080);class a extends s.StickersQueueEvent{constructor(e){super(s.StickersQueueEventType.UGC_USER_UPDATE,e)}}},563772:(e,t,r)=>{var s;r.d(t,{VmojiQueueEvent:()=>a,VmojiQueueEventType:()=>s}),function(e){e.AVATAR="avatar",e.STICKERS="stickers",e.CHARACTER="character",e.STICKERS_PRINT_REQUEST="stickers_print_request"}(s||(s={}));class a extends CustomEvent{constructor(e,t){super(e,{detail:t})}}},208911:(e,t,r)=>{r.d(t,{handleVmojiQueueEvent:()=>a});var s=r(563772);function a(e,{data:t}){const{type:r,query_id:a}=t;a&&e.dispatchEvent(new s.VmojiQueueEvent(a,t)),e.dispatchEvent(new s.VmojiQueueEvent(r,t))}},183746:(e,t,r)=>{r.d(t,{Updates:()=>m,UpdatesSource:()=>s});var s,a,n,o=r(11010),i=r(434788),d=r(820224),l=r(869489),c=r(565579),u=r(208911),h=r(718557),g=r(131942),p=r(513222);!function(e){e.USER="user",e.GROUP="group",e.VMOJI="vmoji",e.STICKERS="stickers"}(s||(s={})),function(e){e.CHECK="a_check",e.RELEASE="a_release"}(a||(a={})),function(e){e.NEED_RESTART="NEED_RESTART",e.POLLING_REQUEST_FAILED="POLLING_REQUEST_FAILED"}(n||(n={}));class m extends c.EventDispatcher{start(){var e=this;return(0,o._)((function*(){if(!e.started){e.started=!0;try{const{server:t,key:r,ts:n}=yield e.getLongPollServer();switch(0===e.ts&&(e.ts=n),e.url=new URL(t),e.url.searchParams.set("key",r),e.url.searchParams.set("act",a.CHECK),e.url.searchParams.set("wait","25"),e.url.searchParams.set("mode",String(e.mode)),e.url.searchParams.set("version",String(p.POLLING_VERSION)),e.source){case s.VMOJI:case s.STICKERS:e.url.searchParams.set("id",String(e.userId))}e.startFetchLoop()}catch(t){throw e.started=!1,t}}}))()}getLongPollServer(){var e=this;return(0,o._)((function*(){let t;switch(e.source){case s.GROUP:t=yield e.api.groups.getLongPollServer({group_id:e.groupId});break;case s.VMOJI:case s.STICKERS:var r;r=yield e.api[e.source].subscribeToQueue().then((e=>{var{base_url:t}=e,r=(0,d._)(e,["base_url"]);return(0,i._)({server:t},r)})),t=r;break;case s.USER:default:t=yield e.api.messages.getLongPollServer({lp_version:p.POLLING_VERSION})}const{server:a}=t;return t.server=`${a.startsWith("https")?"":"https://"}${a}`,t}))()}stop(){var e=this;return(0,o._)((function*(){e.started=!1,e.restarted=0}))()}startFetchLoop(){var e=this;return(0,o._)((function*(){try{for(;e.started;)yield e.fetchUpdates()}catch(t){if(t.code!==n.NEED_RESTART&&e.restarted!==e.retryLimit)return e.restarted+=1,yield(0,g.wait)(3e3),void e.startFetchLoop();for(;e.started;)try{yield e.stop(),yield e.start();break}catch(t){console.log(t),e.started=!0,yield(0,g.wait)(e.wait)}}}))()}fetchUpdates(){var e=this;return(0,o._)((function*(){e.url.searchParams.set("ts",String(e.ts));const t=new AbortController,r=setTimeout((()=>t.abort()),3e4);let s;try{const r=yield fetch(e.url,{method:"GET",signal:t.signal,headers:{connection:"keep-alive"}});if(!r.ok)throw new l.UpdatesError({code:n.POLLING_REQUEST_FAILED,message:"Polling request failed"});s=yield r.json()}finally{clearTimeout(r)}if(void 0!==s.failed){if(1===s.failed)return void(e.ts=s.ts);throw e.ts=0,new l.UpdatesError({code:n.NEED_RESTART,message:"The server has been failed"})}e.restarted=0,e.ts=s.ts,s.pts&&(e.pts=Number(s.pts)),s.updates=s.updates||s.events||[];for(const t of s.updates)e.handleUpdate(t)}))()}handleUpdate(e){switch(this.source){case s.VMOJI:(0,u.handleVmojiQueueEvent)(this,e);break;case s.STICKERS:(0,h.handlerStickersQueueEvent)(this,e)}}constructor(e,t={}){super(),this.mode=202,this.started=!1,this.ts=0,this.pts=0,this.restarted=0,this.api=e;const{source:r,userId:s,groupId:a,wait:n,retryLimit:o}=t;this.source=r,this.userId=s,this.groupId=a,this.wait=n||3e3,this.retryLimit=o||3}}},372322:(e,t,r)=>{function s(e){const t="abcdefghijklmnopqrstuvwxyz";let r="";for(let s=0;s<e;s++)r+=t.charAt(Math.floor(26*Math.random()));return r}r.d(t,{generateId:()=>s})},517283:(e,t,r)=>{var s;r(363476);!function(e){e.WALL="wall",e.DOCS="docs",e.STATS="stats",e.VIDEO="video",e.PAGES="pages",e.NOTES="notes",e.MANAGE="manage",e.MARKET="market",e.PHOTOS="photos",e.STATUS="status",e.GROUPS="groups",e.OFFLINE="offline",e.STORIES="stories",e.FRIENDS="friends",e.MESSAGES="messages",e.APP_WIDGET="app_widget"}(s||(s={}))},868728:(e,t,r)=>{function s(e){return`return [${e.join(",")}];`}r.d(t,{getChainReturn:()=>s})},48989:(e,t,r)=>{r.d(t,{getExecuteMethod:()=>a});var s=r(206467);function a(e,t={}){return`API.${e}(${(0,s.getExecuteParams)(t)})`}},206467:(e,t,r)=>{function s(e){return JSON.stringify(e,((t,r)=>"object"==typeof r&&r!==e?String(r):r))}r.d(t,{getExecuteParams:()=>s})},153473:(e,t,r)=>{r(11010),r(432043),r(695007),r(131942)},167718:(e,t,r)=>{function s(){return Math.floor(1e4*Math.random())*Date.now()}r.d(t,{getRandomId:()=>s})},708672:(e,t,r)=>{function s(e,t){let r=0;t.response.forEach(((s,a)=>{const n=e[a];!1===s?(n.reject(t.errors[r]),r++):n.resolve(s)}))}r.d(t,{resolveExecuteTask:()=>s})},131942:(e,t,r)=>{function s(e){return new Promise((t=>{setTimeout(t,e)}))}r.d(t,{wait:()=>s})},283085:(e,t,r)=>{r.d(t,{ParallelWorker:()=>d});var s=r(11010),a=r(401623),n=r(618430),o=r(868728),i=r(708672);class d extends n.SequentialWorker{execute(){var e=this,t=()=>super.execute;return(0,s._)((function*(){const{queue:r}=e;if(e.isAllowedMethod(r[0].method))return void t().call(e);const{executeCount:s}=e.api.options,n=[];for(let t=0;t<e.queue.length&&(e.isAllowedMethod(r[t].method)||(n.push(r.splice(t,1)[0]),t-=1,!(n.length>=s)));t+=1);if(0===n.length)return;const d=new a.APIRequest({api:e.api,method:"execute",params:{code:(0,o.getChainReturn)(n.map(String))}});t().call(e,d);try{(0,i.resolveExecuteTask)(n,yield d.promise)}catch(e){for(const t of n)t.reject(e)}}))()}isAllowedMethod(e){return e.startsWith("execute")||this.api.options.executeUnsupportedMethods.includes(e)}}},618430:(e,t,r)=>{r.d(t,{SequentialWorker:()=>c});var s=r(11010),a=r(602033),n=r(614531),o=r(432043),i=r(752448),d=r(131942),l=r(513222);class c extends n.APIWorker{execute(e){var t=this;return(0,s._)((function*(){var r;if(e||(e=t.queue.shift()),!e)return;const{method:s}=e;let a;try{a=yield e.make()}catch(r){const{options:s}=t.api;var n;return e.retries===s.limit?(null==(n=e.captchaValidate)||n.reject(r),void e.reject(r)):(e.retries+=1,yield(0,d.wait)(s.wait),void t.requeue(e))}var l;void 0===a.error?(null==(r=e.captchaValidate)||r.resolve(),s.startsWith("execute")?e.resolve({response:a.response,errors:(a.execute_errors||[]).map((e=>new i.ExecuteError(e)))}):e.resolve(null!=(l=a.response)?l:a)):t.handleError(e,new o.APIError(a.error))}))()}handleError(e,t){var r=this;return(0,s._)((function*(){var s,n;const{code:o}=t;if(o===a.API_ERROR_TOO_MANY)return r.paused?void r.requeue(e):(r.pause(),yield(0,d.wait)(l.MINIMUM_TIME_INTERVAL_API),r.requeue(e),void r.resume());if(null==(s=e.captchaValidate)||s.reject(t),null==(n=e.tokenRegenerateValidate)||n.reject(t),o===a.API_ERROR_CAPTCHA&&r.api.hasCaptchaHandler)try{const{captchaSid:s}=t,{key:a,validate:n}=yield r.api.processingCaptcha({type:l.CaptchaType.API,src:t.captchaImg,sid:s,request:e});e.captchaValidate=n,e.params.captcha_sid=s,e.params.captcha_key=a,r.requeue(e)}catch(t){e.reject(t)}else if(o===a.API_ERROR_AUTH&&r.api.hasTokenRegenerateHandler)try{const{token:t,validate:s}=yield r.api.processingTokenRegenerate();r.api.options.token=t,e.tokenRegenerateValidate=s,r.requeue(e)}catch(t){e.reject(t)}else e.reject(t)}))()}}},614531:(e,t,r)=>{r.d(t,{APIWorker:()=>a});var s=r(513222);class a{enqueue(e){this.queue.push(e),this.immediateHeat()}requeue(e){this.queue.unshift(e),this.immediateHeat()}pause(){this.paused=!0}resume(){this.paused=!1,this.immediateHeat()}heat(){if(this.paused||this.busy||!this.queue.length)return;this.busy=!0;const{requestMode:e}=this.api.options;this[e]()}sequential(){this.execute(),setTimeout((()=>{this.busy=!1,this.immediateHeat()}),this.intervalPerRequests)}burst(){const e=Math.min(this.api.options.limit,this.queue.length);for(let t=0;t<e&&0!==this.queue.length;t+=1)this.execute();const t=Math.ceil(s.MINIMUM_TIME_INTERVAL_API-e*this.intervalPerRequests);setTimeout((()=>{this.busy=!1,this.immediateHeat()}),t<=0?s.MINIMUM_TIME_INTERVAL_API:t)}immediateHeat(){setTimeout((()=>this.heat()))}constructor(e){this.busy=!1,this.paused=!1,this.queue=[],this.api=e,this.intervalPerRequests=Math.ceil(s.MINIMUM_TIME_INTERVAL_API/this.api.options.limit)}}},448575:(e,t,r)=>{r.d(t,{WebStatEvents:()=>i});var s=r(11010),a=r(599809),n=r(964548),o=r(515997);const i=new class{setAPI(e){this.api=e}setUserId(e){this.userId=e}add(e){var t=this;return(0,s._)((function*(){var r,s,a,i,d;(yield t.init(),null!=(s=e).id||(s.id=(0,n.getRandomId)()),null!=(a=e).prev_id||(a.prev_id=null==(r=t.previousEvent)?void 0:r.id),null!=(i=e).timestamp||(i.timestamp=String((0,o.nowMicroseconds)())),"undefined"!=typeof window)&&(null!=(d=e).url||(d.url=window.location.href));e.type_navgo&&t.previousNavigationEvent&&(e.type_navgo.prev_navgo_id=t.previousNavigationEvent.id,e.type_navgo.prev_navgo_timestamp=t.previousNavigationEvent.timestamp),t.previousEvent=e,e.type_navgo&&(t.previousNavigationEvent=e),t.queue.add(e),t.send()}))()}init(){var e=this;return(0,s._)((function*(){if(e.initialized)return;if(e.initialized=!0,e.api)return;const t=yield(0,a.login)("web_token").catch((()=>{}));if(!t)return void(e.initialized=!1);const{access_token:r}=t;e.api=new n.API({token:r}),e.api.onTokenRegenerate((0,s._)((function*(t){const r=yield(0,a.login)("web_token").catch((()=>{}));if(!r)return void(e.initialized=!1);const{access_token:s}=r;t(s)})))}))()}send(){this.api&&this.queue.size&&(this.api.statEvents.addWeb({events:JSON.stringify([...this.queue.values()]),user_id:this.userId}),this.queue.clear())}constructor(){var e;this.userId="undefined"!=typeof window&&(null==(e=window.vk)?void 0:e.id)||0,this.queue=new Set,this.initialized=!1}}},515997:(e,t,r)=>{r.d(t,{nowMicroseconds:()=>a});const s=performance.timeOrigin||performance.timing.navigationStart||Date.now();function a(){return Math.floor(1e3*(s+performance.now()))}},421199:(e,t,r)=>{r.d(t,{useUniqId:()=>n});var s=r(667294);let a=0;function n(){const[e]=(0,s.useState)((()=>a++));return`:r${e}:`}},512796:(e,t,r)=>{function s(e){if(null==e)throw new TypeError("Cannot destructure "+e);return e}r.d(t,{_:()=>s})}}]);try{stManager.done("dist/7201ad842699027139d77558aade7dcb.7b74f3d3aac599014502.js")}catch(e){}