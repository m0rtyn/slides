(()=>{"use strict";var e,t,n,o,i,r,s={58255:(e,t,n)=>{n.d(t,{default:()=>i});var o=n(111132);function i(e,t){e.classList?e.classList.add(t):(0,o.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}},111132:(e,t,n)=>{function o(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")}n.d(t,{default:()=>o})},374277:(e,t,n)=>{function o(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function i(e,t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=o(e.className,t):e.setAttribute("class",o(e.className&&e.className.baseVal||"",t))}n.d(t,{default:()=>i})},429697:(e,t,n)=>{n.d(t,{default:()=>f});var o=n(487462),i=n(263366),r=n(894578),s=n(58255),a=n(374277),l=n(667294),c=n(696630),u=n(559391),d=function(e,t){return e&&t&&t.split(" ").forEach((function(t){return(0,a.default)(e,t)}))},p=function(e){function t(){for(var t,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return(t=e.call.apply(e,[this].concat(o))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,n){var o=t.resolveArguments(e,n),i=o[0],r=o[1];t.removeClasses(i,"exit"),t.addClass(i,r?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,n)},t.onEntering=function(e,n){var o=t.resolveArguments(e,n),i=o[0],r=o[1]?"appear":"enter";t.addClass(i,r,"active"),t.props.onEntering&&t.props.onEntering(e,n)},t.onEntered=function(e,n){var o=t.resolveArguments(e,n),i=o[0],r=o[1]?"appear":"enter";t.removeClasses(i,r),t.addClass(i,r,"done"),t.props.onEntered&&t.props.onEntered(e,n)},t.onExit=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"appear"),t.removeClasses(n,"enter"),t.addClass(n,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var n=t.resolveArguments(e)[0];t.addClass(n,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var n=t.resolveArguments(e)[0];t.removeClasses(n,"exit"),t.addClass(n,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,n){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,n]},t.getClassNames=function(e){var n=t.props.classNames,o="string"==typeof n,i=o?""+(o&&n?n+"-":"")+e:n[e];return{baseClassName:i,activeClassName:o?i+"-active":n[e+"Active"],doneClassName:o?i+"-done":n[e+"Done"]}},t}(0,r.default)(t,e);var n=t.prototype;return n.addClass=function(e,t,n){var o=this.getClassNames(t)[n+"ClassName"],i=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===n&&i&&(o+=" "+i),"active"===n&&e&&(0,u.forceReflow)(e),o&&(this.appliedClasses[t][n]=o,function(e,t){e&&t&&t.split(" ").forEach((function(t){return(0,s.default)(e,t)}))}(e,o))},n.removeClasses=function(e,t){var n=this.appliedClasses[t],o=n.base,i=n.active,r=n.done;this.appliedClasses[t]={},o&&d(e,o),i&&d(e,i),r&&d(e,r)},n.render=function(){var e=this.props,t=(e.classNames,(0,i.default)(e,["classNames"]));return l.createElement(c.default,(0,o.default)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(l.Component);p.defaultProps={classNames:""},p.propTypes={};const f=p},696630:(e,t,n)=>{n.d(t,{default:()=>h});var o=n(263366),i=n(894578),r=n(667294),s=n(973935),a=n(806035),l=n(500220),c=n(559391),u="unmounted",d="exited",p="entering",f="entered",v="exiting",m=function(e){function t(t,n){var o;o=e.call(this,t,n)||this;var i,r=n&&!n.isMounting?t.enter:t.appear;return o.appearStatus=null,t.in?r?(i=d,o.appearStatus=p):i=f:i=t.unmountOnExit||t.mountOnEnter?u:d,o.state={status:i},o.nextCallback=null,o}(0,i.default)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===u?{status:d}:null};var n=t.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==p&&n!==f&&(t=p):n!==p&&n!==f||(t=v)}this.updateStatus(!1,t)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var e,t,n,o=this.props.timeout;return e=t=n=o,null!=o&&"number"!=typeof o&&(e=o.exit,t=o.enter,n=void 0!==o.appear?o.appear:t),{exit:e,enter:t,appear:n}},n.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t)if(this.cancelNextCallback(),t===p){if(this.props.unmountOnExit||this.props.mountOnEnter){var n=this.props.nodeRef?this.props.nodeRef.current:s.findDOMNode(this);n&&(0,c.forceReflow)(n)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===d&&this.setState({status:u})},n.performEnter=function(e){var t=this,n=this.props.enter,o=this.context?this.context.isMounting:e,i=this.props.nodeRef?[o]:[s.findDOMNode(this),o],r=i[0],l=i[1],c=this.getTimeouts(),u=o?c.appear:c.enter;!e&&!n||a.default.disabled?this.safeSetState({status:f},(function(){t.props.onEntered(r)})):(this.props.onEnter(r,l),this.safeSetState({status:p},(function(){t.props.onEntering(r,l),t.onTransitionEnd(u,(function(){t.safeSetState({status:f},(function(){t.props.onEntered(r,l)}))}))})))},n.performExit=function(){var e=this,t=this.props.exit,n=this.getTimeouts(),o=this.props.nodeRef?void 0:s.findDOMNode(this);t&&!a.default.disabled?(this.props.onExit(o),this.safeSetState({status:v},(function(){e.props.onExiting(o),e.onTransitionEnd(n.exit,(function(){e.safeSetState({status:d},(function(){e.props.onExited(o)}))}))}))):this.safeSetState({status:d},(function(){e.props.onExited(o)}))},n.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},n.setNextCallback=function(e){var t=this,n=!0;return this.nextCallback=function(o){n&&(n=!1,t.nextCallback=null,e(o))},this.nextCallback.cancel=function(){n=!1},this.nextCallback},n.onTransitionEnd=function(e,t){this.setNextCallback(t);var n=this.props.nodeRef?this.props.nodeRef.current:s.findDOMNode(this),o=null==e&&!this.props.addEndListener;if(n&&!o){if(this.props.addEndListener){var i=this.props.nodeRef?[this.nextCallback]:[n,this.nextCallback],r=i[0],a=i[1];this.props.addEndListener(r,a)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},n.render=function(){var e=this.state.status;if(e===u)return null;var t=this.props,n=t.children,i=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,o.default)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return r.createElement(l.default.Provider,{value:null},"function"==typeof n?n(e,i):r.cloneElement(r.Children.only(n),i))},t}(r.Component);function g(){}m.contextType=l.default,m.propTypes={},m.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:g,onEntering:g,onEntered:g,onExit:g,onExiting:g,onExited:g},m.UNMOUNTED=u,m.EXITED=d,m.ENTERING=p,m.ENTERED=f,m.EXITING=v;const h=m},500220:(e,t,n)=>{n.d(t,{default:()=>o});const o=n(667294).createContext(null)},806035:(e,t,n)=>{n.d(t,{default:()=>o});const o={disabled:!1}},559391:(e,t,n)=>{n.d(t,{forceReflow:()=>o});var o=function(e){return e.scrollTop}},580301:(e,t,n)=>{n.d(t,{useEventListenerOnRef:()=>i});var o=n(667294);const i=(e,t,n)=>{(0,o.useLayoutEffect)((()=>{const{current:o}=e;if(o)return o.addEventListener(t,n,{passive:!0}),()=>{o.removeEventListener(t,n)}}),[e.current])}},799695:(e,t,n)=>{n.d(t,{useOnClickOutside:()=>i});var o=n(667294);const i=(e,t)=>{(0,o.useEffect)((()=>{const n=n=>{!e.current||n.target instanceof Node&&e.current.contains(n.target)||t(n)};return document.addEventListener("mousedown",n,{passive:!0}),document.addEventListener("touchstart",n,{passive:!0}),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}}),[e,t])}},419328:(e,t,n)=>{n.d(t,{makePendingRequestState:()=>o});const o=(e={})=>{const t=Object.create(null);return{cancel:e=>{const n=t[e];null==n||n.abort(),delete t[e]},register:(n,o)=>{const i=t[n],r=(e=>{var n;return void 0!==(null==(n=t[e])?void 0:n.throttleTimerId)})(n);if(i){if(r)return!1;console.warn(`Reactions pending request for key '${n}' wasn't unregistered, but has to be overwritten.\nPending request should be cancelled through .cancel() explicitly before .register()`),i.abort()}let s;t[n]={abort:o},void 0!==(null==e?void 0:e.throttleMs)&&(s=((e,n)=>{const o=t[e];if(!o)return;o.throttleTimerId&&window.clearTimeout(o.throttleTimerId);const i=window.setTimeout((()=>{const n=t[e];n&&(n.throttleTimerId=void 0)}),n);return o.throttleTimerId=i,i})(n,e.throttleMs));return()=>{var e;(null==(e=t[n])?void 0:e.abort)===o&&delete t[n],window.clearTimeout(s)}}}}},849307:(e,t,n)=>{var o,i,r,s=n(412818);(null==(o=window.vk)||null==(i=o.pe)?void 0:i.static_manager_dynamic_imports)&&(null==(r=window.vk)?void 0:r.stDomain)&&(n.p=window.vk.stDomain+"/dist/"),window.Reactions=s.ReactionsEntryGlobal,(0,s.init)();try{window.stManager.done(window.jsc("web/reactions.js"))}catch(e){}},536943:(e,t,n)=>{n.d(t,{ReactionImage:()=>a});var o=n(785893),i=n(667294),r=n(396849),s=n(659397);const a=(0,i.forwardRef)((({animationURL:e,isPlaying:t,image:n,loadAnimationParams:a},l)=>{const c=(0,i.useRef)(null),{isAnimationReady:u}=(0,r.useReactionAnimation)({animationElem:c,animationURL:e,play:t,loadAnimationParams:a}),d=u&&t;return(0,o.jsx)("div",{className:"ReactionImage",style:{backgroundImage:!d&&n?`url(${n})`:void 0},ref:l,children:(0,o.jsx)("div",{className:(0,s.classNames)("ReactionImage__animationContainer",{"ReactionImage__animationContainer--hidden":!d}),ref:c})})}))},418559:(e,t,n)=>{n.d(t,{PreloadImages:()=>r});var o=n(249823),i=n(667294);const r=(0,i.memo)((function({imageURLs:e}){return(0,i.useEffect)((()=>{Promise.all(e.map((e=>(0,o.preloadImage)(e)))).catch((()=>{}))}),[e]),null}))},858789:(e,t,n)=>{n.d(t,{ReactedUsersStack:()=>a,stackConfigForVisibleCount:()=>l,userPhotoStub:()=>s});var o=n(785893),i=n(659397),r=n(82161);const s={kind:"stub"};function a({photos:e,size:t,totalCount:n,visibleCount:s}){const a=null!=n?n:e.length;let l=Math.min(e.length,s);a===l+1&&e.length>=l+1&&(l+=1);let c=Math.max(0,a-l),u=c>0;const d=e.slice(0,l),p=(0,r.formatCount)(c);return(0,o.jsx)("div",{className:(0,i.classNames)("ReactedUsersStack",`ReactedUsersStack--size-${t}`,{"ReactedUsersStack--others":u}),children:(0,o.jsxs)("div",{className:"ReactedUsersStack__photos",role:"presentation",children:[d.map(((e,t)=>function(e){return"profile"===e.kind}(e)?(0,o.jsx)("div",{className:"ReactedUsersStack__photo",role:"img",style:{backgroundImage:`url(${e.imageURL})`},title:e.title},t):function(e){return"stub"===e.kind}(e)?(0,o.jsx)("div",{role:"img",className:"ReactedUsersStack__photo ReactedUsersStack__photo--stub"},t):null)),u&&(0,o.jsx)("div",{className:"ReactedUsersStack__photo ReactedUsersStack__photo--others","aria-hidden":"true",dangerouslySetInnerHTML:{__html:`+${p}`}})]})})}function l(e){const t=e+1;return{maxStackItems:t,visibleCount:e,stubItemsForPhotos:e=>Math.min(e,t)}}},820161:(e,t,n)=>{n.d(t,{Reaction:()=>c});var o=n(785893),i=n(953908),r=n(659397),s=n(249917),a=n(731262),l=n(536943);const c=({animationURL:e,image:t,isOpenedDefault:n,onMouseEnter:c,onReactionClick:u,reactionId:d,reactionTitle:p})=>{const f=(0,a.useReactedUsersConfig)(d),v=()=>{null==u||u(d)};return(0,o.jsxs)("div",{className:(0,r.classNames)("Reaction",{"Reaction--openedDefault":n&&f.shouldShowReactedUsers}),onClick:e=>{v(),e.stopPropagation()},onKeyDown:e=>{[i.KEY.RETURN,i.KEY.SPACE].includes(e.keyCode)&&(v(),e.stopPropagation())},onMouseEnter:c,tabIndex:0,role:"button","aria-label":p||void 0,children:[(0,o.jsx)("div",{className:"Reaction__hoverArea"}),(0,o.jsx)("div",{className:"Reaction__title",children:(0,o.jsx)(s.ReactionTitle,{reactedUsersConfigResult:f,reactionId:d,title:p})}),(0,o.jsx)("div",{className:"Reaction__image",children:(0,o.jsx)(l.ReactionImage,{isPlaying:!0,image:t,animationURL:e})})]})}},249917:(e,t,n)=>{n.d(t,{ReactionTitle:()=>a});var o=n(785893),i=n(667294),r=n(659397),s=n(763832);const a=({reactedUsersConfigResult:e,reactionId:t,title:n})=>{const a=(0,i.useRef)(null),{reactedUsersConfig:l,shouldShowReactedUsers:c}=e;return(0,o.jsxs)("div",{className:(0,r.classNames)("ReactionTitle",{"ReactionTitle--withUsers":c}),ref:a,children:[(0,o.jsx)("div",{className:"ReactionTitle__name",children:n}),(0,o.jsx)("div",{className:(0,r.classNames)({"ReactionTitle__reactedUsers--visible":c}),children:(0,o.jsx)(s.ReactionsMenuReactedUsersPreview,{parentClickContainerRef:a,reactedUsersConfig:l,reactionId:t})})]})}},674953:(e,t,n)=>{n.d(t,{ReactionsMenu:()=>u});var o=n(785893),i=n(667294),r=n(659397),s=n(953908),a=n(820161),l=n(921881),c=n(805827);const u=(0,i.forwardRef)((function({close:e,currentReactionId:t,onReactionChoose:n,position:u=l.PopperVerticalPosition.TOP,reactionsOptions:d,onMouseEnter:p,onMouseLeave:f},v){const m=(0,c.useReactionMenuConfig)(),g=u===l.PopperVerticalPosition.TOP?null==m?void 0:m.openedDefaultReactionId:void 0,[h,b]=(0,i.useState)(g),R=(0,i.useCallback)((t=>{t.keyCode===s.KEY.ESC&&(null==e||e())}),[]),E=(0,i.useCallback)((()=>{b(void 0)}),[]);return(0,o.jsx)("div",{className:(0,r.classNames)("ReactionsMenu ReactionsMenu--extraHoverArea",{"ReactionsMenu--extraHoverAreaToTop":u===l.PopperVerticalPosition.TOP,"ReactionsMenu--extraHoverAreaToBottom":u===l.PopperVerticalPosition.BOTTOM}),onKeyDown:R,onMouseEnter:p,onMouseLeave:f,ref:v,children:(0,o.jsx)("div",{className:"ReactionsMenu__inner",children:d.items.map((e=>(0,o.jsx)(a.Reaction,{animationURL:e.animationURL,image:e.imageMenuURL,isOpenedDefault:e.id===h,isSelected:e.id===t,onMouseEnter:E,onReactionClick:n,reactionId:e.id,reactionTitle:e.title},e.id)))})})}))},40165:(e,t,n)=>{n.d(t,{ReactionsMenuContextProvider:()=>c,useReactionsMenuContext:()=>l});var o=n(434788),i=n(785893),r=n(667294),s=n(921414);const a=(0,r.createContext)({currentReactionId:void 0,likeObjectId:void 0,reactedUsers:s.REMOTE_RESOURCE_STATE_CONTEXT_STUB,reactedUsersCounts:void 0,titleVariant:void 0,triggerClose:()=>{}}),l=()=>(0,r.useContext)(a),c=({value:e,children:t})=>{const n=(0,s.useRemoteResource)();return(0,i.jsx)(a.Provider,{value:(0,o._)({},e,{reactedUsers:n}),children:t})}},763832:(e,t,n)=>{n.d(t,{ReactionsMenuReactedUsersPreview:()=>d});var o=n(785893),i=n(667294),r=n(198508),s=n(858789),a=n(40165),l=n(580301),c=n(731262);const u="s";function d({parentClickContainerRef:e,reactionId:t,reactedUsersConfig:n}){const{likeObjectId:d,triggerClose:p}=(0,a.useReactionsMenuContext)(),f=(0,i.useCallback)((function(e){if(e.stopPropagation(),!d)throw new Error("ReactionTitle: unable to open reacted modal, missing object id");(null==n?void 0:n.hasSomeReactions)&&(p(),(0,r.showReactedModal)(t,d))}),[]);return(0,l.useEventListenerOnRef)(e,"click",f),(0,o.jsx)("div",{className:"ReactionsMenuReactedUsersPreview",children:n&&n.userPhotos?(0,o.jsx)(s.ReactedUsersStack,{visibleCount:c.visibleCount,totalCount:n.totalPhotosCount,photos:n.userPhotos,size:u}):null})}},976873:(e,t,n)=>{n.d(t,{ReactionsMenuStateContainer:()=>r});var o=n(785893),i=n(40165);const r=({children:e,contextValue:t})=>(0,o.jsx)(i.ReactionsMenuContextProvider,{value:t,children:e})},705967:(e,t,n)=>{n.d(t,{getUsersForReactionId:()=>i,isTitleVariantWithUsers:()=>r});var o=n(282795);function i(e,t){var n;const o=null==(n=e.byReactionId)?void 0:n[t];if(void 0!==o)return o}function r(e){return e===o.TitleVariantWithLikedUsers}},731262:(e,t,n)=>{n.d(t,{useReactedUsersConfig:()=>d,visibleCount:()=>u});var o=n(40165),i=n(858789),r=n(880549),s=n(282795),a=n(705967),l=n(822715);const{stubItemsForPhotos:c,visibleCount:u}=(0,i.stackConfigForVisibleCount)(3);function d(e){const{currentReactionId:t,reactedUsers:{valueMaybeStale:n}}=(0,o.useReactionsMenuContext)(),u=function(e){const{titleVariant:t=s.TITLE_VARIANT_DEFAULT,reactedUsers:{valueMaybeStale:n},reactedUsersCounts:i}=(0,o.useReactionsMenuContext)();if(!(0,a.isTitleVariantWithUsers)(t))return;return function(e,t,n){const o=t?(0,a.getUsersForReactionId)(t,e):void 0;if(o)return{kind:"reacted_users",reactedUsersForReaction:o};const i=n?(0,l.counterForReactionId)(n,e):void 0;if(i&&i>0)return{kind:"count_only_stub",counter:i};return}(e,n,i)}(e);let d,f;if(u&&"reacted_users"===u.kind&&u.reactedUsersForReaction.users){let{reactedUsersForReaction:{users:o=[],totalCount:i}}=u;const s=(0,r.withCurrentUser)(o,i,e,t,null==n?void 0:n.currentUser);i=s.totalCount,o=s.users,f=null!=i?i:o.length,d=o.map(p)}else if(u&&function(e){return"count_only_stub"===e.kind}(u)){let o=u.counter;const s=(0,r.withCurrentUser)([],o,e,t,null==n?void 0:n.currentUser);o=s.totalCount;const a=s.users;o&&(f=o,d=[...a.map(p),...Array.from({length:c(o)},(()=>i.userPhotoStub))])}else{const o=(0,r.withCurrentUserAddedOnly)(e,t,null==n?void 0:n.currentUser);f=o.totalCount,d=o.users.map(p)}var v;f=null!=(v=null!=f?f:null==d?void 0:d.length)?v:0;const m=Boolean(f&&f>0);return m?{shouldShowReactedUsers:!0,reactedUsersConfig:{hasSomeReactions:m,totalPhotosCount:f,userPhotos:d}}:{shouldShowReactedUsers:!1,reactedUsersConfig:void 0}}function p(e){return{kind:"profile",imageURL:e.ownerImageURL,title:e.ownerName}}},880549:(e,t,n)=>{n.d(t,{useReactedUsersPreview:()=>f,withCurrentUser:()=>g,withCurrentUserAddedOnly:()=>h});var o=n(11010),i=n(434788),r=n(822715),s=n(647434),a=n(512637),l=n(705967),c=n(40165),u=n(851793),d=n(667294),p=n(991059);function f({attemptRefetch:e}){const{likeObjectId:t,titleVariant:n,reactedUsers:i}=(0,c.useReactionsMenuContext)(),{counts:r}=(0,u.useReactionsGlobalStateForObject)(t,{payloadIsSuitable:v}),[p,f]=(0,d.useState)(!1);(0,d.useEffect)((()=>{r&&f(!0)}),[r]),(0,d.useEffect)((()=>{if(!t||!(0,l.isTitleVariantWithUsers)(n))return;function r(){return(r=(0,o._)((function*(){if(!t)return;p&&f(!1),i.setLoading(!0);const e=(0,s.requestGetReacted)(t);try{const t=function(e){const{reactedMenuStats:t}=e;if(!t)return;let n;const{byReactionId:o}=t;if(o){n={};for(const[e,t]of Object.entries(o)){var i,r,s;n[e]={totalCount:null!=(r=t.totalCount)?r:void 0,users:null!=(s=null==(i=t.users)?void 0:i.map((e=>m(e))))?s:void 0}}}const a=t.currentUser?m(t.currentUser):t.currentUser;return{byReactionId:n,currentUser:a}}(yield e.promise);if(!t){const e=new Error("useReactedUsersTooltip: failed to transform response");return(0,a.isDebugEnabled)()&&console.error(e),void i.setFailed(e)}i.setLoaded(t)}catch(e){i.setFailed(e)}}))).apply(this,arguments)}e&&("initial"===i.resource.kind||"loading"!==i.resource.kind&&p)&&function(){r.apply(this,arguments)}()}),[n,t,p,e])}function v(e){return"counts_only"===e.kind||!0===e.isQueueUpdate}function m(e){return(0,i._)({},e,{ownerName:e.ownerName?(0,p.stringWithHTMLEntitiesDecode)(e.ownerName):void 0})}function g(e,t,n,o,i){const s=null!=t?t:0,a=window.vk.id;if((0,r.isReactionIdSet)(o)&&o===n&&i){const t=function(e,t,n,o,i){if(!i)return;const{ownerImageURL:r,ownerName:s}=i;if(!r)return;if(n.find((t=>t.ownerId===e)))return;return{currentUser:{ownerId:e,ownerImageURL:r,ownerName:s},totalCount:o+1}}(a,0,e,s,i);if(null==t?void 0:t.currentUser){const n={ownerId:t.currentUser.ownerId,ownerImageURL:t.currentUser.ownerImageURL,ownerName:t.currentUser.ownerName};return{totalCount:t.totalCount,users:[n].concat(e||[])}}}else if((0,r.isReactionIdUnset)(o)||o!==n){const t=function(e,t,n,o){const i=n&&n.filter((t=>t.ownerId!==e)),r=i&&n&&i.length<n.length;if(r)return{totalCount:r?o-1:o,users:i}}(a,0,e,s);if(t)return{totalCount:t.totalCount,users:t.users}}return{totalCount:s,users:e}}function h(e,t,n){return g([],0,e,t,n)}},396849:(e,t,n)=>{n.d(t,{useReactionAnimation:()=>l});var o=n(11010),i=n(434788),r=n(667294),s=n(666734),a=n(143790);const l=({animationElem:e,animationURL:t,play:n=!0,loadAnimationParams:l})=>{const c=(0,r.useRef)(null),[u,d]=(0,r.useState)((()=>t&&(0,s.animationItemHasData)(t)));return(0,r.useEffect)((()=>{if(!t)return void(c.current=null);if(!e.current)return void console.error(new Error("Missing animation container"));let n=()=>{};return(0,o._)((function*(){e.current&&(c.current=yield(0,s.getAnimationAsync)(t,e.current,{loadAnimationParams:(0,i._)({autoplay:!0},l)}),n=()=>{d(!0)},(0,a.onAnimationReady)(c.current,n))}))(),()=>{var e,t;!c.current||!c.current._cbs||(null==(e=c.current)||e.removeEventListener("DOMLoaded",n),null==(t=c.current)||t.destroy());d(!1),c.current=null}}),[t,e]),(0,r.useEffect)((()=>{var e,t;u&&(n?null==(e=c.current)||e.play():null==(t=c.current)||t.stop())}),[n,u]),{isAnimationReady:u}}},445031:(e,t,n)=>{n.d(t,{useReactionMenuSet:()=>r});var o=n(667294),i=n(908088);const r=e=>(0,o.useMemo)((()=>(0,i.getReactionSet)(e)),[e])},851793:(e,t,n)=>{n.d(t,{useReactionsGlobalStateForObject:()=>l,useReactionsGlobalUpdateEventsForObject:()=>c});var o=n(667294),i=n(822715),r=n(505426),s=n(693982),a=n(249823);function l(e,{payloadIsSuitable:t}={}){const[n,r]=(0,o.useState)(void 0),s=(0,a.usePreviousRef)(n);return c(e,(0,o.useCallback)((function(e){var n;t&&!t(e)||e.counts&&!(0,i.areCountersEqual)(e.counts,null!=(n=s.current)?n:void 0)&&r(e.counts)}),[e])),{counts:n}}function c(e,t){!function({onAnyPostCountsAnyUpdate:e}){(0,o.useEffect)((()=>(0,r.registerNonGlobalNonUniqueListener)(r.WallDataEvents.post_reactions_counts_update,e)),[e])}({onAnyPostCountsAnyUpdate:(0,o.useCallback)((function(n){(0,s.likePostObjectId)(n.postFullId)===e&&t(n)}),[e])})}},921414:(e,t,n)=>{n.d(t,{REMOTE_RESOURCE_STATE_CONTEXT_STUB:()=>r,useRemoteResource:()=>l});var o=n(667294);const i={kind:"initial"},r={valueMaybeStale:void 0,value:void 0,reset:()=>{},setFailed:()=>{},setLoaded:()=>{},setLoading:()=>{},resource:i};function s(e){if("value"in e&&void 0!==e.value)return e.value}function a(e){const t=s(e);return void 0!==t?t:"staleValue"in e&&void 0!==e.staleValue?e.staleValue:void 0}function l(){const[e,t]=(0,o.useState)(i);return{valueMaybeStale:a(e),value:s(e),resource:e,setFailed:(0,o.useCallback)(((e,n=!1)=>{t((t=>({kind:"failed",error:e,staleValue:n?a(t):void 0})))}),[]),setLoaded:(0,o.useCallback)((e=>{t({kind:"loaded",value:e})}),[]),setLoading:(0,o.useCallback)(((e=!1)=>{t((t=>({kind:"loading",staleValue:e?a(t):void 0})))}),[]),reset:(0,o.useCallback)((()=>{t((()=>i))}),[])}}},753566:(e,t,n)=>{n.d(t,{ReactionsMenuButton:()=>g});var o=n(785893),i=n(667294),r=n(512637),s=n(805827),a=n(123799),l=n(418559),c=n(655154),u=n(674953),d=n(445031),p=n(407089),f=n(577698),v=n(976873),m=n(377974);const g=({objectId:e,onReactionChoose:t,reactionButtonContainerElem:n,reactionIdInitial:g,reactionSetId:h,reactionsCounts:b,styleVariant:R,triggerMouseenterOnInitial:E,titleVariant:C})=>{const{isAllowedReenter:y,tooltipVisibility:_,triggerClose:w}=(0,a.useTooltipVisibility)(),[T,S]=(0,i.useState)(g);(0,i.useEffect)((()=>{const t=[(0,c.addReactionChooseListener)(e,(()=>{w()})),(0,c.addDataUpdateListener)(e,(e=>{S(e.currentReactionId)}))];return()=>{t.forEach((e=>{e()}))}}),[]);const k=(0,d.useReactionMenuSet)(h),P=(0,s.useReactionMenuConfig)();var x;const I=(0,i.useMemo)((()=>null!=(x=null==k?void 0:k.items.map((e=>e.imageMenuURL)))?x:[]),[null==k?void 0:k.id]);(0,i.useEffect)((()=>{var e;k&&void 0!==T&&!(null==(e=k.items)?void 0:e.find((e=>e.id===T)))&&console.warn(`Current reaction ID ${T} is not found in set '${h}'`)}),[k]);if(!k)return console.warn(`ReactionsMenuButton init error, unavailable reaction set: ${h}`),null;const U={close:w,currentReactionId:T,onReactionChoose:e=>{(w(),e!==T)&&t(e)},reactionsOptions:k},O={currentReactionId:T,likeObjectId:e,reactedUsersCounts:b,titleVariant:C,triggerClose:w};return(0,o.jsxs)(v.ReactionsMenuStateContainer,{contextValue:O,children:[(0,o.jsx)(p.ReactionsMenuTooltip,{delayShow:null==P?void 0:P.menuShowDelay,getAttachElem:e=>{if(!e)return;const t=(0,f.getClosestLikeBtnContainerElem)(e);return t||(0,r.isDebugEnabled)()&&console.warn("ReactionsMenuButton missing attach target:",e),t},isAllowedReenter:y,popup:u.ReactionsMenu,popupProps:U,reactionButtonContainer:n,styleVariant:R,triggerMouseenterOnInitial:E,visibility:_,onOpenStateChange:(e,t)=>{e&&t&&(0,m.loadBadgesWallOnboarding)({target:t})}}),(0,o.jsx)(l.PreloadImages,{imageURLs:I})]})}},407089:(e,t,n)=>{n.d(t,{ReactionsMenuTooltip:()=>m});var o=n(434788),i=n(785893),r=n(667294),s=n(59985),a=n(880549),l=n(249823),c=n(310707),u=n(544311),d=n(123799),p=n(746257);const f=["--post-padding-lr"],v=()=>{const e=document.createElement("div");return e.setAttribute("aria-hidden","true"),e},m=({getAttachElem:e,initialIsOpen:t=!1,isAllowedReenter:n,reactionButtonContainer:m,popup:g,popupProps:h,delayHide:b=s.HIDE_TOOLTIP_TIMEOUT,delayShow:R=s.SHOW_TOOLTIP_TIMEOUT,onOpenStateChange:E,onPopperVisibilityChange:C,styleVariant:y,triggerMouseenterOnInitial:_=!0,visibility:w=d.TooltipVisibility.uncontrolled})=>{const T=void 0!==e,[S,k]=(0,r.useState)(t),P=w!==d.TooltipVisibility.uncontrolled,x=(0,l.usePrevious)(w),I=(0,r.useRef)(null),U=(0,r.useRef)(null),O=(0,r.useRef)(null);(0,a.useReactedUsersPreview)({attemptRefetch:S});const{style:M}=(0,p.useCSSVarsPropagation)({elementWithPropsRef:U,properties:f}),A=(0,r.useMemo)((()=>{var t;if(e)return e(null!=(t=O.current)?t:void 0)}),[e,O.current]),L=(0,r.useCallback)(((e,t)=>{!t&&P||k(e)}),[P]);(0,r.useEffect)((()=>{null==E||E(S,O.current)}),[S]),(0,r.useEffect)((()=>{S&&n&&(n.current=d.IS_ALLOWED_REENTER_DEFAULT)}),[S]);const j=(0,u.useTooltipTrigger)({afterHide:L,afterShow:L,cancelCloseOnContentHover:n,delayHide:b,delayShow:R,ignoreMouseTriggers:P,popperPopupRef:I,reactionButtonContainer:m,triggerMouseenterOnInitial:_});return(0,r.useEffect)((()=>{if(P){const e=w===d.TooltipVisibility.opened;return e||j.cancelDelayedOpening(),void k(e)}S&&x===d.TooltipVisibility.opened&&k(!1)}),[w,P]),(0,i.jsx)(c.TransitionPopper,{attachTarget:A,isOpen:S,content:g,contentProps:(0,o._)({},h,j.contentProps),mode:"side",onPopperVisibilityChange:C,position:"t",popperContentStyle:M,popperPopupRef:I,ref:T?O:U,renderNodeFactory:v,styleVariant:y,children:(0,i.jsx)("div",{className:"ReactionsMenuButtonPopperReference"})})}},310707:(e,t,n)=>{n.d(t,{TransitionPopper:()=>f});var o=n(434788),i=n(820224),r=n(785893),s=n(667294),a=n(682615),l=n(429697),c=n(515190),u=n(921881),d=n(814833);const p={appear:150,enter:150,exit:150},f=(0,s.forwardRef)((function(e,t){var{attachTarget:n,isOpen:f=!1,content:v,contentProps:m,onPopperVisibilityChange:g,popperContentStyle:h,popperPopupRef:b,styleVariant:R}=e,E=(0,i._)(e,["attachTarget","isOpen","content","contentProps","onPopperVisibilityChange","popperContentStyle","popperPopupRef","styleVariant"]);const{isVisible:C,onEnter:y,onHidden:_}=(e=>{const[t,n]=(0,s.useState)(!!e);return{isVisible:!!e||t,onEnter:(0,s.useCallback)((()=>{n(!0)}),[]),onHidden:(0,s.useCallback)((()=>{n(!1)}),[])}})(f),w=(0,s.useRef)(null),T=(0,d.useCombinedRefs)(t,w);var S;const k=(0,u.usePopperTopAutoPosition)(null!=(S=w.current)?S:void 0,146,C),P=(()=>{const e=(0,s.useRef)(!0);return(0,s.useEffect)((()=>{e.current=!1}),[]),e.current})();(0,s.useEffect)((()=>{P||null==g||g(C)}),[C]);const x=(0,a.classNames)("ReactionsMenuPopper _ReactionsMenuPopperRoot",{"ReactionsMenuPopper--alignType-post":"post"===R,"ReactionsMenuPopper--popperBottom":k===u.PopperVerticalPosition.BOTTOM,"ReactionsMenuPopper--popperTop":k===u.PopperVerticalPosition.TOP}),I=(0,r.jsx)(v,(0,o._)({},m,{position:k})),U=(0,r.jsx)(l.default,{appear:!0,in:f,classNames:"ReactionsMenuPopperTransition",onEnter:y,onExited:_,timeout:p,children:(0,r.jsx)("div",{className:x,ref:b,style:h,children:I})});return(0,r.jsx)(c.Popper,(0,o._)({},E,{align:"left",attachTarget:n,content:U,open:C,position:k,ref:T}))}))},746257:(e,t,n)=>{n.d(t,{useCSSVarsPropagation:()=>i});var o=n(667294);const i=({elementWithPropsRef:e,properties:t})=>(0,o.useMemo)((()=>{const n=e.current;if(!n)return{style:{}};const o=window.getComputedStyle(n),i={};return t.forEach((e=>{const t=o.getPropertyValue(e);t&&(i[e]=t)})),{style:i}}),[e.current,t])},921881:(e,t,n)=>{n.d(t,{PopperVerticalPosition:()=>o,usePopperTopAutoPosition:()=>s});var o,i=n(667294),r=n(759876);!function(e){e.BOTTOM="b",e.TOP="t"}(o||(o={}));const s=(e,t,n)=>(0,i.useMemo)((()=>((e,t)=>{if(!e)return"t";const n=(0,r.default)(e),o=window.pageYOffset||document.documentElement.scrollTop;return n.top-o<t?"b":"t"})(e,t)),[e,t,n])},805827:(e,t,n)=>{n.d(t,{useReactionMenuConfig:()=>r});var o=n(667294),i=n(908088);const r=()=>(0,o.useMemo)((()=>(0,i.getReactionConfig)()),[])},544311:(e,t,n)=>{n.d(t,{useTooltipTrigger:()=>r});var o=n(799695),i=n(667294);const r=({afterHide:e,afterShow:t,cancelCloseOnContentHover:n,delayHide:r=0,delayShow:s=0,ignoreMouseTriggers:a=!1,reactionButtonContainer:l,popperPopupRef:c,triggerMouseenterOnInitial:u})=>{const d=(0,i.useRef)(null),p=(0,i.useRef)(void 0),f=(0,i.useRef)(void 0),v=(0,i.useCallback)((()=>{var e;window.clearTimeout(null!=(e=p.current)?e:void 0)}),[]),m=(0,i.useCallback)((()=>{v(),null==t||t(!1)}),[t]),g=(0,i.useCallback)((()=>{v(),null==t||t(!0)}),[t]);(0,o.useOnClickOutside)(c,m),(0,i.useEffect)((()=>()=>{window.clearTimeout(p.current),window.clearTimeout(f.current)}),[]);const h=(0,i.useCallback)((t=>window.setTimeout((()=>{null==e||e(!1)}),null!=t?t:0)),[e]),b=()=>{var e,t;(window.clearTimeout(null!=(e=f.current)?e:void 0),a)||(p.current=(t=s,window.setTimeout((()=>{g()}),null!=t?t:0)))},R=e=>{var t,n;if(window.clearTimeout(null!=(n=p.current)?n:void 0),a)return;e.relatedTarget instanceof HTMLElement&&(null==d||null==(t=d.current)?void 0:t.contains(e.relatedTarget))||(f.current=h(r))};(0,i.useEffect)((()=>{u&&b()}),[]),(0,i.useEffect)((()=>(null==l||l.addEventListener("mouseenter",b,{passive:!0}),null==l||l.addEventListener("mouseleave",R,{passive:!0}),()=>{null==l||l.removeEventListener("mouseenter",b),null==l||l.removeEventListener("mouseleave",R)})),[l]);return{cancelDelayedOpening:v,contentProps:{ref:d,onMouseEnter:(0,i.useCallback)((()=>{var e;window.clearTimeout(null!=(e=f.current)?e:void 0),(null==n?void 0:n.current)&&g()}),[a,g]),onMouseLeave:(0,i.useCallback)((e=>{a||l&&e.target instanceof HTMLElement&&l.contains(e.target)||(f.current=h(r))}),[h,r,a,l])}}}},123799:(e,t,n)=>{n.d(t,{IS_ALLOWED_REENTER_DEFAULT:()=>r,TooltipVisibility:()=>o,useTooltipVisibility:()=>s});var o,i=n(667294);!function(e){e.closed="closed",e.opened="opened",e.uncontrolled="uncontrolled"}(o||(o={}));const r=!0,s=()=>{const[e,t]=(0,i.useState)("uncontrolled"),n=(0,i.useRef)(r),o=(0,i.useCallback)((o=>{"closed"!==e&&(void 0!==o&&(n.current=o),t("closed"),window.setTimeout((()=>{t("uncontrolled")})))}),[]);return{isAllowedReenter:n,tooltipVisibility:e,setTooltipVisibility:t,triggerClose:o}}},189841:(e,t,n)=>{n.d(t,{reactionsButtonMount:()=>m});var o=n(785893),i=n(973935),r=n(198508),s=n(512637),a=n(32375),l=n(282795),c=n(753566),u=n(655154),d=n(225960),p=n(577698),f=n(321850);const v=d.ButtonStyleVariant.Post,m=(e,t={})=>{if("__isMounted"in e)return;const n=(0,p.getMenuMount)(e),d=(0,a.reactionsElemPayload)(e);if(!n||!(null==d?void 0:d.objectRaw))return void((0,s.isDebugEnabled)()&&console.error("Init reactions button failed",n,d));const{counts:m,csrfHash:g,objectRaw:h,reactionSetId:b,styleVariant:R=v,userReactionId:E}=d;var C;const y=null!=(C=d.titleVariant)?C:l.TITLE_VARIANT_DEFAULT;null===g&&console.warn("Missing reactions csrf hash"),(0,s.isDebugEnabled)()&&console.log("Init reactions button",h,b);i.render((0,o.jsx)(c.ReactionsMenuButton,{objectId:h,onReactionChoose:t=>{const n=(0,a.reactionsElemPayload)(e);null!==g&&n&&((0,u.emitReactionChoose)(h),(0,r.reactionButtonSetReaction)(t,n.userReactionId,h,g,e))},reactionButtonContainerElem:e,reactionIdInitial:E,reactionSetId:b,reactionsCounts:m,styleVariant:R,titleVariant:y,triggerMouseenterOnInitial:!!t.isMouseenterEvent}),n),(0,f.pushNavDestroy)((function(){n&&(i.unmountComponentAtNode(n),delete e.__isMounted)})),e.__isMounted=!0}},198508:(e,t,n)=>{n.d(t,{reactionButtonSetReaction:()=>h,showReactedModal:()=>b});var o=n(434788),i=n(95432),r=n(192441),s=n(682951),a=n(898298),l=n(999237),c=n(72569),u=n(647434),d=n(512637),p=n(32375),f=n(249823),v=n(767176),m=n(944615);const g=(e,{counts:t,isFromWkLayer:n,isPrimaryLikeButtonClick:o,isUserAction:i=!1,objectRaw:r,previewVisibility:s,reactionId:a,suggestSubscribe:c})=>{(0,l.triggerReactionsUpdate)(r,t,{id:a},{isFromWkLayer:n,isPrimaryLikeButtonClick:o,isUserAction:i,previewVisibility:s,suggestSubscribe:c})},h=(e,t,n,i,s,l)=>{if((0,d.isDebugEnabled)()&&console.log(`Change reaction for object ${n}: ${e}`),!(0,f.isValidEnvironment)())return;const h=(0,p.reactionsElemPayload)(s),b=null==h?void 0:h.counts,R=((e,t,n)=>{const i=(0,o._)({},e);return void 0!==t&&(i[t]=(i[t]||0)+1),void 0!==n&&(i[n]=Math.max(0,(i[n]||0)-1)),i})((null==h?void 0:h.counts)||(0,r.reactionCountsBrandWrap)({}),e,t),E=null==l?void 0:l.isPrimaryLikeButtonClick,C=(0,c.isWkLayerWallPostOpen)(),y=(0,a.previewVisibilityIntentForVariant)(null==h?void 0:h.previewVariant),_=(0,m.getTrackCodeFromPost)(s);g(0,{counts:R,isFromWkLayer:C,isPrimaryLikeButtonClick:E,isUserAction:!0,objectRaw:n,previewVisibility:y,reactionId:e}),(0,u.requestPostReactionSet)(e,n,i,{trackCode:_}).promise.then((t=>{const o=(0,u.validateLikesChangeResponse)(t),i=null==o?void 0:o.userReaction;o&&void 0!==i&&g(0,{counts:o.counts,isFromWkLayer:C,isPrimaryLikeButtonClick:!1,isUserAction:!1,objectRaw:n,previewVisibility:y,reactionId:i.id,suggestSubscribe:o.suggestSubscribe});let r=n.replace("wall","post"),s=document.getElementById(r);if(s){let t=s.getAttribute("data-ad");if(t){let n=void 0===e?"unlike":"like";v.AdsEvents.register(n,t)}}}),(e=>{(null==e?void 0:e.isAborted)||g(0,{counts:b,isFromWkLayer:C,isPrimaryLikeButtonClick:!1,isUserAction:!1,objectRaw:n,previewVisibility:y,reactionId:t})}))};function b(e,t){!function(e){(0,i.showWiki)({w:e},!1,void 0,{queue:1})}(`${s.WK_SECTION_PREFIX_REACTIONS}_${e}/${t}`)}},647434:(e,t,n)=>{n.d(t,{requestGetReacted:()=>o.requestGetReacted,requestPostReactionSet:()=>i.requestPostReactionSet,validateLikesChangeResponse:()=>i.validateLikesChangeResponse});var o=n(585386),i=n(913923)},585386:(e,t,n)=>{n.d(t,{requestGetReacted:()=>s});var o=n(434788),i=n(822715),r=n(363444);const s=e=>{const t={act:"reactions_get_reacted",object:e};return{promise:new Promise(((e,n)=>{r.ajax.post("/like.php",t,{onDone:t=>{const r=function(e){let t;if(!(0,i.isUnknownObject)(e))return t;const{reactedMenuStats:n}=e;n&&(t||(t={}),t=(0,o._)({},t,{reactedMenuStats:n}));return t}(t);if(!r){const e=new Error("requestGetReacted: Invalid response");return console.error(e,t),void n(e)}e(r)},onFail:e=>(n({err:e}),!1)})}))}}},991059:(e,t,n)=>{n.d(t,{stringWithHTMLEntitiesDecode:()=>r});var o=n(640971),i=n(659397);const r=e=>(0,i.decodeHTMLEntities)((0,o.unwrap)(e));o.unwrap},913923:(e,t,n)=>{n.d(t,{requestPostReactionSet:()=>d,validateLikesChangeResponse:()=>p});var o=n(419328),i=n(822715),r=n(363444),s=n(383320),a=n(584356),l=n(682951),c=n(878021);const u=(0,o.makePendingRequestState)(),d=(e,t,n,o)=>{var i,l;(null==(l=null==o?void 0:o.abortPendingRequests)||l)&&u.cancel(t);const d={act:"a_set_reaction",object:t,reaction_id:e,hash:n,wall:2,from:null==(i=window.Likes)?void 0:i._getReference(t),track_code:null==o?void 0:o.trackCode},p=new s.AjaxCancellationToken,f=new Promise(((e,t)=>{const n=r.ajax.post("like.php",d,{cancellationToken:p,onDone:n=>{if(null==n?void 0:n.unauth_action_box)return c.UnauthActionBox.show(n.unauth_action_box),void t();(null==n?void 0:n.done_box)&&(0,a.showDoneBox)("",{},n.done_box),e(n)},onFail:e=>{const o=(e=>{return"object"==typeof(t=e)&&null!==t&&"readyState"in t&&0===e.readyState;var t})(n);return t({err:e,isAborted:o}),!!o}})})),v=()=>{p.cancel()},m=u.register(t,v);return f.catch((()=>{})).finally((()=>{m&&m()})),{abort:v,promise:f}},p=e=>{if(void 0===(null==e?void 0:e.reactions_my))return void console.warn("Invalid reaction change response format",e);var t;const n=null!=(t=null==e?void 0:e[l.REACTIONS_COUNTS_RESPONSE_FIELD])?t:void 0,o=e.reactions_my,r=e.suggest_subscribe;let s;return null===o?s={id:void 0}:(0,i.isValidReactionId)(o)&&(s={id:o}),{counts:n,userReaction:s,suggestSubscribe:r}}},412818:(e,t,n)=>{n.d(t,{ReactionsEntryGlobal:()=>d,init:()=>u});var o=n(953908),i=n(189841),r=n(557530),s=n(259036),a=n(835821),l=n(908088),c=n(530517);const u=()=>{(0,c.postRenderReactionsInit)(),(0,a.initResponseHandlers)()},d={onReactionKeyDown:(e,t)=>{(0,r.isEventFromMenu)(t)||[o.KEY.RETURN,o.KEY.SPACE].includes(t.keyCode)&&(t.stopPropagation(),(0,r.toggleReactionOnClick)(e))},onReactionMouseEnter:(e,t)=>{t.target===e&&(0,s.reactionsButtonInit)(e,{isMouseenterEvent:!0})},onReactionClick:(e,t)=>{(0,o.checkEvent)(t)||(0,r.isEventFromMenu)(t)||((0,r.toggleReactionOnClick)(e),(0,s.reactionsButtonInit)(e))},reactionsButtonMount:i.reactionsButtonMount,storageAddSets:l.storageAddSets,storageSetConfig:l.storageSetConfig}},557530:(e,t,n)=>{n.d(t,{isEventFromMenu:()=>l,toggleReactionOnClick:()=>c});var o=n(59985),i=n(198508),r=n(655154),s=n(32375),a=n(377974);const l=e=>e.target instanceof HTMLElement&&(null==e.target.closest?void 0:e.target.closest("._ReactionsMenuPopperRoot")),c=e=>{const t=(0,s.reactionsElemPayload)(e);if(!(null==t?void 0:t.objectRaw))return void console.warn("Missing reactions object raw",e);const{csrfHash:n,objectRaw:l,userReactionId:c}=t;if((0,r.emitReactionChoose)(l),null===n)return void console.warn("Missing reactions csrf hash",e);const u=void 0===c?o.REACTION_ID_DEFAULT:void 0;(0,i.reactionButtonSetReaction)(u,c,l,n,e,{isPrimaryLikeButtonClick:!0}),(0,a.loadBadgesWallOnboarding)({target:e})}},259036:(e,t,n)=>{n.d(t,{reactionsButtonInit:()=>o});const o=(...e)=>{const t=window.Reactions;t?t.reactionsButtonMount(...e):window.stManager.add([window.jsc("web/reactions.js"),"reactions.css"]).then((()=>{window.Reactions?o(...e):console.error("Reactions module is unavailable")}))}},835821:(e,t,n)=>{n.d(t,{initResponseHandlers:()=>l});var o=n(541140),i=n(908088);const r=e=>{const t=null==e?void 0:e.reaction_sets;t&&(0,i.storageAddSets)(t)},s=e=>{e&&(0,i.storageSetConfig)(e)};let a=!1;const l=()=>{a||((0,o.replaceExtraHandler)("reactionsConfig",s),(0,o.replaceExtraHandler)("reactions",r),a=!0)}},999237:(e,t,n)=>{n.d(t,{triggerReactionsUpdate:()=>a});var o=n(693982),i=n(682951),r=n(505426),s=n(109454);const a=(e,t,n,a)=>{const l=(0,o.parseLikeObjectId)(e);l&&l.objectType===i.SUPPORTED_OBJECT_TYPES.wall&&l.objectId?(0,r.emitEvent)(r.WallDataEvents.post_reactions_counts_update,function(e,t,n,o){const i={counts:e,isFromWkLayer:null==t?void 0:t.isFromWkLayer,isPrimaryLikeButtonClick:null==t?void 0:t.isPrimaryLikeButtonClick,isQueueUpdate:null==t?void 0:t.isQueueUpdate,isUserAction:t.isUserAction,postFullId:n.objectId,previewVisibility:t.previewVisibility,reactionIdState:o?{reactionId:o.id}:void 0,suggestSubscribe:t.suggestSubscribe};return o?(0,s.reactionsCountsUpdatePayload)(i,o):(0,s.reactionsCountsOnlyUpdatePayload)(i)}(t,a,l,n)):l&&l.objectType===i.SUPPORTED_OBJECT_TYPES.wall_reply&&l.objectId?(0,r.emitEvent)(r.WallDataEvents.reply_reactions_counts_update,{counts:t,replyFullId:l.objectId,reactionIdState:n?{reactionId:n.id}:void 0}):console.warn("Unsupported reactions object update",e)}},767176:(e,t,n)=>{n.d(t,{AdsEvents:()=>p});var o=n(599809),i=n(936134),r=n(795558),s=n(796943),a=n(866310),l=n(95432),c=n(9480);let u=[];const d=(0,i.debounce)((()=>{if(0===u.length)return;const e=u.splice(0,u.length);(0,o.api)("adsint.registerAdEvents",{events:JSON.stringify(e)}).catch((t=>{for(;e.length;)u.unshift(e.pop())}))}),1e3);const p={register:(e,t)=>{(e=>["like","unlike","share","music_pause","music_play","music_track_to_profile","music_playlist_to_profile","music_track_share","music_playlist_share","music_track_share_to_story","music_playlist_share_to_story"].includes(e))(e)&&(e=>!!e)(t)&&(u.push({event_type:e,ad_data:t}),d())},handleShareEvent:(e,t,n)=>{const o=e&&e.dataset&&e.dataset.ad;if(!o||!t)return null;let i="share";0===t.indexOf("audio")&&(window.Wall&&Wall.triggerAdStat(e,"audio_click"),0===t.indexOf("audio_playlist")?i=2==n?"music_playlist_share_to_story":"music_playlist_share":0===t.indexOf("audio")&&(i=2==n?"music_track_share_to_story":"music_track_share")),p.register(i,o)}};(0,s.onDomReady)((()=>{const e="adsEvents",t=(0,l.getAudioPlayer)();if(!t||t.subscribers&&t.subscribers.filter((t=>t.context===e)).length>0)return;const n={[a.AudioPlayerEventType.PLAY]:"music_play",[a.AudioPlayerEventType.PAUSE]:"music_pause",[a.AudioPlayerEventType.MUSIC_AUDIOS_ADD]:"music_track_to_profile",[a.AudioPlayerEventType.MUSIC_PLAYLISTS_ADD]:"music_playlist_to_profile"},o=e=>{if(n[e]){const o=c.AudioUtils.audioTupleToAudioObject(t.getCurrentAudio()),i=o?document.querySelector("._audio_row_"+o.fullId+"."+c.AudioUtils.AUDIO_CURRENT_CLS):null,s=(0,r.domClosest)("post",i);let a=s&&s.dataset&&s.dataset.ad;a||(a=(e=>{if(!e)return null;const t=0===e.indexOf("feed:")?e.replace("feed:","post"):null,n=t&&document.getElementById(t);return n&&n.dataset&&n.dataset.ad})(t._getPlayingContext())),a&&(window.Wall&&Wall.triggerAdStat(s,"audio_click"),p.register(n[e],a))}};t.on(e,a.AudioPlayerEventType.PLAY,(()=>o(a.AudioPlayerEventType.PLAY))),t.on(e,a.AudioPlayerEventType.PAUSE,(()=>o(a.AudioPlayerEventType.PAUSE))),t.on(e,a.AudioPlayerEventType.MUSIC_AUDIOS_ADD,(()=>o(a.AudioPlayerEventType.MUSIC_AUDIOS_ADD))),t.on(e,a.AudioPlayerEventType.MUSIC_PLAYLISTS_ADD,(()=>o(a.AudioPlayerEventType.MUSIC_PLAYLISTS_ADD)))}))}},a={};function l(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return s[e].call(n.exports,n,n.exports,l),n.loaded=!0,n.exports}l.m=s,e=[],l.O=(t,n,o,i)=>{if(!n){var r=1/0;for(u=0;u<e.length;u++){for(var[n,o,i]=e[u],s=!0,a=0;a<n.length;a++)(!1&i||r>=i)&&Object.keys(l.O).every((e=>l.O[e](n[a])))?n.splice(a--,1):(s=!1,i<r&&(r=i));if(s){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,o,i]},l.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return l.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,l.t=function(e,o){if(1&o&&(e=this(e)),8&o)return e;if("object"==typeof e&&e){if(4&o&&e.__esModule)return e;if(16&o&&"function"==typeof e.then)return e}var i=Object.create(null);l.r(i);var r={};t=t||[null,n({}),n([]),n(n)];for(var s=2&o&&e;"object"==typeof s&&!~t.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((t=>r[t]=()=>e[t]));return r.default=()=>e,l.d(i,r),i},l.d=(e,t)=>{for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.f={},l.e=e=>Promise.all(Object.keys(l.f).reduce(((t,n)=>(l.f[n](e,t),t)),[])),l.u=e=>75980===e?"menu_settings.fe841ee6e9d1770c7df7.js":9375===e?"voice_message_player.050d74b181d5db2642f0.js":28762===e?"speech.5c7a8bafaa4c80a92840.js":57468===e?"SilentModeForms.8425705394906aebc7de.js":96248===e?"feed-skeleton.6830e5b139046f63a92d.js":18669===e?"BadgesCatalog.669ff6f267763ebfc857.js":83803===e?"BadgesObjectInfo.a2be12c7e579c85087a4.js":9603===e?"badges_wall_onboarding_init.056bb80a58645e39f25c.js":55489===e?"lottie-light.48f1a65d83e7d0217b60.js":59240===e?"performance-stats.d89fb0a11246583657a4.js":48164===e?"badges_wall_onboarding.e29d7d08a17563b3ca03.js":38288===e?"lottie.2751896e25440664468a.js":void 0,l.miniCssF=e=>e+"."+{18669:"d4e06fe9c242d1c751ef",48164:"ec78c85c8296af470758",57468:"e8a9b5d3b4a38f45d2ec",75980:"519f671449550110bbb1",83803:"1cff23236b255685c4df"}[e]+".css",l.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),l.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o={},l.l=(e,t,n,i)=>{if(o[e])o[e].push(t);else{var r,s;if(void 0!==n)for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++){var u=a[c];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")=="vk:"+n){r=u;break}}r||(s=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,l.nc&&r.setAttribute("nonce",l.nc),r.setAttribute("data-webpack","vk:"+n),r.src=e),o[e]=[t];var d=(t,n)=>{r.onerror=r.onload=null,clearTimeout(p);var i=o[e];if(delete o[e],r.parentNode&&r.parentNode.removeChild(r),i&&i.forEach((e=>e(n))),t)return t(n)},p=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),s&&document.head.appendChild(r)}},l.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),l.p="/dist/",i=e=>new Promise(((t,n)=>{var o=l.miniCssF(e),i=l.p+o;if(((e,t)=>{for(var n=document.getElementsByTagName("link"),o=0;o<n.length;o++){var i=(s=n[o]).getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(i===e||i===t))return s}var r=document.getElementsByTagName("style");for(o=0;o<r.length;o++){var s;if((i=(s=r[o]).getAttribute("data-href"))===e||i===t)return s}})(o,i))return t();((e,t,n,o)=>{var i=document.createElement("link");i.rel="stylesheet",i.type="text/css",i.onerror=i.onload=r=>{if(i.onerror=i.onload=null,"load"===r.type)n();else{var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.href||t,l=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");l.code="CSS_CHUNK_LOAD_FAILED",l.type=s,l.request=a,i.parentNode.removeChild(i),o(l)}},i.href=t,document.head.appendChild(i)})(e,i,t,n)})),r={70724:0},l.f.miniCss=(e,t)=>{r[e]?t.push(r[e]):0!==r[e]&&{18669:1,48164:1,57468:1,75980:1,83803:1}[e]&&t.push(r[e]=i(e).then((()=>{r[e]=0}),(t=>{throw delete r[e],t})))},(()=>{var e={70724:0};l.f.j=(t,n)=>{var o=l.o(e,t)?e[t]:void 0;if(0!==o)if(o)n.push(o[2]);else if(75980!=t){var i=new Promise(((n,i)=>o=e[t]=[n,i]));n.push(o[2]=i);var r=l.p+l.u(t),s=new Error;l.l(r,(n=>{if(l.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",s.name="ChunkLoadError",s.type=i,s.request=r,o[1](s)}}),"chunk-"+t,t)}else e[t]=0},l.O.j=t=>0===e[t];var t=(t,n)=>{var o,i,[r,s,a]=n,c=0;if(r.some((t=>0!==e[t]))){for(o in s)l.o(s,o)&&(l.m[o]=s[o]);if(a)var u=a(l)}for(t&&t(n);c<r.length;c++)i=r[c],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(u)},n=self.webpackChunkvk=self.webpackChunkvk||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var c=l.O(void 0,[75514,98066,56990,76429,24509,76400,40885,68592,72809,59640,90613],(()=>l(849307)));c=l.O(c)})();