"use strict";(self.webpackChunkvk=self.webpackChunkvk||[]).push([[82198],{696023:(e,t,n)=>{n.d(t,{BrowserEnvProvider:()=>oe,ChannelsProvider:()=>G,ConvosProvider:()=>L,ConvosSearchIndexProvider:()=>he,DispatchProvider:()=>I,FeatureFlagsProvider:()=>W,HelpHintsProvider:()=>S,InsertIntoCacheProvider:()=>le,OnlinesProvider:()=>k,OrganisersProvider:()=>V,OwnerProvider:()=>Y,PeersProvider:()=>T,TypingsProvider:()=>x,VideoMessageShapesProvider:()=>te,ViewerProvider:()=>Q,matchAddEventListener:()=>N,useActualEffectCleanup:()=>h,useBrowserEnv:()=>ne,useCallbackWithCustomCompare:()=>_,useCombinedRefs:()=>de,useConvos:()=>D,useConvosSearchIndex:()=>me,useDebounced:()=>f,useDidUpdate:()=>p,useDispatch:()=>b,useFeatureFlags:()=>H,useHelpHints:()=>w,useInsertIntoCache:()=>ue,useNow:()=>R,useOnChange:()=>m,useOnline:()=>v,useOrganisers:()=>B,useOwner:()=>z,usePeers:()=>F,usePixelDensity:()=>E,usePrevious:()=>u,useRead:()=>se,useTypings:()=>A,useVideoMessageShapes:()=>Z,useViewer:()=>J,useViewport:()=>ie});var r=n(434788),o=n(667294),i=n(997650),a=n(96190),s=n(821551),d=n(83062),c=n(89131),l=n(991792);function u(e){const t=(0,o.useRef)();return(0,o.useEffect)((()=>{t.current=e}),[e]),t.current}function p(e,t){const n=(0,o.useRef)(!1);(0,o.useEffect)((()=>{if(n.current)return e()}),t),(0,o.useEffect)((()=>{n.current=!0}),[])}function h(e,t){const n=(0,o.useRef)(t);n.current=t,(0,o.useEffect)((()=>()=>{t.some(((e,t)=>e!==n.current[t]))&&e()}),[...t,e]);const r=(0,o.useRef)(e);r.current=e,(0,o.useEffect)((()=>()=>{r.current()}),[])}function m(e,t){const[n,r]=(0,o.useState)([]);t.some(((e,t)=>n[t]!==e))&&(r(t),e())}function f(e,t){const[n,i]=(0,o.useState)({debounced:e,debouncedUpdatesCount:0});return(0,o.useLayoutEffect)((()=>{if(0===t)return void i((t=>(0,r._)({},t,{debounced:e})));const n=setTimeout((()=>{i((({debouncedUpdatesCount:t})=>({debounced:e,debouncedUpdatesCount:t+1})))}),t);return()=>{clearTimeout(n)}}),[e,t]),n}function _(e,t,n){const r=(0,o.useRef)(void 0);return void 0!==r.current&&n(r.current,t)||(r.current=t),(0,o.useCallback)(e,r.current)}function v(e){const t=(0,o.useContext)(g);return!!a.isUserPeerId(e)&&t.has(e)}const g=o.createContext(new Set),k=g.Provider;function b(){const e=(0,o.useContext)(y);if(!e)throw new Error("DispatchProvider не добавлен в дерево Реакта!");return e}const y=o.createContext(null),I=y.Provider;function w(){const e=(0,o.useContext)(C);if(void 0===e)throw new Error("HelpHintsProvider не добавлен в дерево Реакта!");return e}const C=o.createContext(new Set),S=C.Provider;function A(e,t="full",n=3){const r=(0,o.useContext)(P),i=F(),{lang:s}=ne(),d=r.get(e);if(!d)return;const c=[],u=new Set;for(const e of l.TypingVariants){const t=d[e];t&&(c.push(e),t.peerIds.forEach((e=>u.add(e))))}const p=c.length>1?"text":c[0]||"text";if(0===n)return{text:s.use(`me_typing_${p}`),type:p};const h=[];for(const e of u){const t=i.get(e);if(t&&(h.push(t),h.length===n))break}let m;const f=u.size-h.length;switch(!0){case 0===h.length&&f>0:m=s.use("me_typing_people",{num:f});break;case f>0:m=h.map((e=>a.shortName(e))).join(", "),m=s.use("me_typing_names_lots",{num:f,values:{names:m}});break;case h.length>1:{const e=h.length>n-1?h.slice(0,n-1).map((e=>a.shortName(e))).join(", "):h[0]?a.shortName(h[0]):"",t=h[h.length-1],r=t?a.shortName(t):"";m=s.use("me_typing_names_couple",{values:{before:e,after:r}});break}case 1===h.length:m=h[0]?a.shortName(h[0]):"";break;default:m=""}return{text:"compact"===t?m:s.use(`me_typing_${p}_named`,{num:h.length,values:{names:m}}),type:p}}const P=o.createContext(new Map),x=P.Provider,M=()=>window.devicePixelRatio>=1.25;function E(){const[e,t]=(0,o.useState)(M);return(0,o.useEffect)((()=>N(window.matchMedia("(resolution: 1.25dppx)"),(()=>{t(M)}))),[]),e}function N(e,t){try{return e.addEventListener("change",t),()=>{e.removeEventListener("change",t)}}catch(n){return e.addListener(t),()=>{e.removeListener(t)}}}function R(e=6e4){const[t,n]=(0,o.useState)(Date.now);return(0,o.useLayoutEffect)((()=>{const t=setInterval((()=>{n(Date.now())}),e);return()=>clearInterval(t)}),[e]),t}function F(){return(0,o.useContext)(U)}const U=o.createContext(new Map),T=U.Provider;function D(){return(0,o.useContext)(q)}const q=o.createContext(new Map),L=q.Provider;function B(){return(0,o.useContext)(j)}const j=o.createContext(d.empty()),V=j.Provider;const O=o.createContext(new Map),G=O.Provider;function H(){const e=(0,o.useContext)(K);if(!e)throw new Error("FeatureFlagsProvider не добавлен в дерево Реакта!");return e}const K=o.createContext(null),W=K.Provider;function z(){const e=(0,o.useContext)($);if(!e)throw new Error("OwnerProvider не добавлен в дерево Реакта!");return e}const $=o.createContext(null),Y=$.Provider;function J(){const e=(0,o.useContext)(X);if(!e)throw new Error("ViewerProvider не добавлен в дерево Реакта!");return e}const X=o.createContext(null),Q=X.Provider;function Z(){return(0,o.useContext)(ee)}const ee=o.createContext(new Map),te=ee.Provider;function ne(){const e=(0,o.useContext)(re);if(!e)throw new Error("BrowserEnvProvider не добавлен в дерево Реакта!");return e}const re=o.createContext(null),oe=re.Provider;function ie({debounced:e=!1}){const[t,n]=(0,o.useState)(ae),r=(0,o.useRef)((0,c.debounce)(n,300,!1));return(0,o.useLayoutEffect)((()=>{const t=r.current,o=()=>{e?t(ae()):n(ae())};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),e&&t.cancel()}}),[e]),t}function ae(){return"undefined"==typeof window?[0,0]:[document.documentElement.clientWidth,document.documentElement.clientHeight]}function se({isUnread:e,isOut:t,onRead:n,onSeen:r}){const{idle:a}=ne(),[s,d]=(0,o.useState)((()=>a.isIdle())),c=!e&&void 0===r,{ref:l,inView:u}=(0,i.useInView)({threshold:.01,skip:c});return(0,o.useEffect)((()=>a.subscribe((()=>{d(a.isIdle())}))),[a]),(0,o.useEffect)((()=>{if(!u||s||c)return;const t=setTimeout((()=>{null==r||r(),e&&n()}),500);return()=>clearTimeout(t)}),[u,s,c,n,r,t,e]),l}function de(...e){const t=(0,o.useRef)(null);return o.useEffect((()=>{e.forEach((e=>{e&&("function"==typeof e?e(t.current):e.current=t.current)}))}),[e]),t}const ce=o.createContext(null),le=ce.Provider;function ue(){const e=(0,o.useContext)(ce);if(!e)throw new Error("InsertIntoCacheProvider не добавлен в дерево Реакта!");return e}const pe=o.createContext(s.create()),he=pe.Provider;function me(){return(0,o.useContext)(pe)}},966933:(e,t,n)=>{n.d(t,{LayoutDataProvider:()=>p,UIConfigProvider:()=>d,useDeviceData:()=>l,useLayoutData:()=>c});var r=n(667294),o=n(86894),i=n(696023),a=n(89131),s=n(582362);const d=({scheme:e="VKCOM",theme:t="system",children:n,locale:d,onThemeUpdated:c})=>{const[l,u]=(0,r.useState)("system"!==t?t:"light"),h=(0,r.useRef)(null),m=(0,r.useCallback)((e=>{u(e.matches?"dark":"light")}),[]);(0,r.useEffect)((()=>{const e=window.matchMedia("(prefers-color-scheme: dark)");switch(t){case"light":case"dark":u(t),null==h.current||h.current();break;case"system":h.current=(0,i.matchAddEventListener)(e,m),u(e.matches?"dark":"light");break;default:(0,a.exhaustivenessCheck)(t)}}),[m,t]),(0,r.useEffect)((()=>()=>null==h.current?void 0:h.current()),[]),(0,r.useLayoutEffect)((()=>{null==c||c(l)}),[c,l]),(0,r.useEffect)((()=>{const e=s.BounceDisabler.supported()?new s.BounceDisabler:void 0;return null==e||e.enable(),()=>{null==e||e.disable()}}),[]);const f="VKCOM"===e?"light"===l?"vkcom_light":"vkcom_dark":"light"===l?o.Scheme.BRIGHT_LIGHT:o.Scheme.SPACE_GRAY,[_]=(0,i.useViewport)({debounced:!0}),v=_<640?"one-column":"two-column";return r.createElement(o.ConfigProvider,{locale:d,platform:o.Platform.IOS,scheme:f},r.createElement(o.ConfigProvider,{locale:d,platform:o.Platform.VKCOM,scheme:"inherit"},r.createElement(o.AdaptivityProvider,null,r.createElement(p,{value:(0,r.useMemo)((()=>({mode:v})),[v])},n))))};function c(){const e=(0,r.useContext)(u);if(!e)throw new Error("LayoutDataContext не добавлен в дерево Реакта!");return e}function l(){return{isTouchOnly:!(0,o.useAdaptivity)().deviceHasHover}}const u=r.createContext(null),p=u.Provider},582362:(e,t,n)=>{n.d(t,{BounceDisabler:()=>o});var r=n(89131);class o{onTouchMove(e){const t=i(e);if(!e.target||!t||function(e){const t=window.innerWidth/window.document.documentElement.clientWidth;if(1===e.length)return!1;return 1!==t}(t)||function(e,t,n){const r=10,{screenY:o,screenX:i}=n[0],a=o<=t+r&&o>=t-r;return e!==i&&a}(this.startX,this.startY,t))return;let n=e.target;for(;n!==document.body;){if(a(n))return;const r=s(n);if(r){return void(r(this.startY,t[0].screenY)&&e.preventDefault())}const o=n.parentElement;if(!o)break;n=o}e.preventDefault()}onTouchStart(e){const t=i(e);t&&(this.startX=t[0].screenX,this.startY=t[0].screenY)}enable(){window.addEventListener("touchstart",this.onTouchStart,{passive:!1}),window.addEventListener("touchmove",this.onTouchMove,{passive:!1})}disable(){window.removeEventListener("touchstart",this.onTouchStart,!1),window.removeEventListener("touchmove",this.onTouchMove,!1)}static supported(){try{const e=document.createElement("div");document.documentElement.appendChild(e),e.style.WebkitOverflowScrolling="touch";const t="getComputedStyle"in window&&"touch"===window.getComputedStyle(e).getPropertyValue("-webkit-overflow-scrolling");return document.documentElement.removeChild(e),t}catch(e){return console.error(e),!1}}constructor(){this.startX=0,this.startY=0}}function i(e){return(0,r.toNonEmpty)(Array.from(e.touches))}function a(e){return"INPUT"===e.nodeName&&"range"===e.getAttribute("type")}function s(e){const t=window.getComputedStyle(e),n=t.getPropertyValue("-webkit-overflow-scrolling"),r=t.getPropertyValue("overflow-y"),o=parseInt(t.getPropertyValue("height"),10),i="touch"===n&&("auto"===r||"scroll"===r),a=e.scrollHeight>e.offsetHeight;return!(!i||!a)&&((t,n)=>{const r=t>=n,i=t<=n&&0===e.scrollTop,a=r&&e.scrollHeight-e.scrollTop===o;return i||a})}},859352:(e,t,n)=>{function r(e){return e}n.d(t,{resolveId:()=>r})},452788:(e,t,n)=>{n.d(t,{empty:()=>i,getLockId:()=>d,isLoaded:()=>c,push:()=>l,refresh:()=>u,snakeCaseId:()=>s,sorter:()=>h,updateCounters:()=>p});var r=n(434788),o=n(839963);function i(){const e={channelIds:new Set,hasMore:!0,unreadCount:0,totalCount:0,boundary:{channelId:o.resolveId(0),majorSortId:1/0,minorSortId:1/0}};return{all:(0,r._)({kind:"all"},e),unread:(0,r._)({kind:"unread"},e),archive:(0,r._)({kind:"archive",isHidden:!1},e)}}const a={all:"all",unread:"unread",archive:"archived"};function s(e){return a[e]}function d(e){return`filter_${e}`}function c(e){return e.boundary.minorSortId!==1/0&&e.boundary.majorSortId!==1/0}function l(e,t,n,r){for(const r of n)m(e,t,r),u(e,r);e[t].hasMore=r,e[t].hasMore||(e[t].boundary={majorSortId:0,minorSortId:0,channelId:o.resolveId(0)})}function u(e,t){e.all.channelIds.delete(t.id),e.unread.channelIds.delete(t.id),e.archive.channelIds.delete(t.id),t.isMember&&(t.isArchived?f(e.archive,t)&&e.archive.channelIds.add(t.id):(f(e.all,t)&&e.all.channelIds.add(t.id),o.isUnread(t)&&f(e.unread,t)&&e.unread.channelIds.add(t.id)))}function p(e,{unread:t,archiveTotal:n}){void 0!==t&&(e.all.unreadCount=t,e.unread.unreadCount=t),void 0!==n&&(e.archive.totalCount=n)}function h(e,t){if(e.majorSortId!==t.majorSortId)return t.majorSortId-e.majorSortId;const n=o.lastPost({channel:e,withPending:!0}),r=o.lastPost({channel:t,withPending:!0});var i,a;return"Pending"===(null==n?void 0:n.kind)||"Pending"===(null==r?void 0:r.kind)?(null!=(i=null==r?void 0:r.sentAt)?i:0)-(null!=(a=null==n?void 0:n.sentAt)?a:0):t.minorSortId!==e.minorSortId?t.minorSortId-e.minorSortId:e.id-t.id}function m(e,t,n){o.isHidden(n)||(n.majorSortId<e[t].boundary.majorSortId?e[t].boundary={channelId:n.id,majorSortId:n.majorSortId,minorSortId:n.minorSortId}:n.majorSortId===e[t].boundary.majorSortId&&n.minorSortId<e[t].boundary.minorSortId?(e[t].boundary.channelId=n.id,e[t].boundary.minorSortId=n.minorSortId):n.majorSortId===e[t].boundary.majorSortId&&n.minorSortId===e[t].boundary.minorSortId&&(e[t].boundary.channelId=n.id),"all"===t&&m(e,"unread",n))}function f(e,t){return!o.isHidden(t)&&(!(t.majorSortId<e.boundary.majorSortId)&&(t.majorSortId>e.boundary.majorSortId||!(t.minorSortId<e.boundary.minorSortId)&&(t.minorSortId>e.boundary.minorSortId||!(t.id>e.boundary.channelId))))}},498928:(e,t,n)=>{n.d(t,{empty:()=>s,getLockId:()=>u,isLoaded:()=>l,isVisible:()=>p,push:()=>h,refresh:()=>m,snakeCaseId:()=>c,sorter:()=>_,toggleBusinessNotifyVisibility:()=>v,updateCounters:()=>f});var r=n(434788),o=n(185327),i=n(168465),a=n(89131);function s(){const e={peerIds:new Set,hasMore:!0,unreadCount:0,unreadUnmutedCount:0,totalCount:0,boundary:{majorSortId:1/0,minorSortId:1/0}};return{all:(0,r._)({kind:"all"},e),unread:(0,r._)({kind:"unread",headerNotMutedUnread:0},e),chats:(0,r._)({kind:"chats"},e),archive:(0,r._)({kind:"archive",hasMentions:!1},e),messageRequest:(0,r._)({kind:"messageRequest"},e),businessNotify:(0,r._)({kind:"businessNotify",isHidden:!1},e)}}const d={all:"all",unread:"unread",chats:"chats",messageRequest:"message_request",businessNotify:"business_notify",archive:"archive"};function c(e){return d[e]}function l(e){return e.boundary.majorSortId!==1/0&&e.boundary.minorSortId!==1/0}function u(e){return`filter_${e}`}function p(e){switch(e.kind){case"all":case"unread":case"chats":case"archive":return!0;case"messageRequest":return e.peerIds.size>0||e.hasMore;case"businessNotify":return!e.isHidden&&(e.totalCount>0||e.unreadCount>0);default:(0,a.exhaustivenessCheck)(e)}}function h(e,t,n,r){for(const r of n)g(e,t,r),m(e,r);e[t].hasMore=r,e[t].hasMore||(e[t].boundary={majorSortId:0,minorSortId:0})}function m(e,t){switch(t.kind){case"ChatConvo":case"GroupConvo":case"UserConvo":case"ContactConvo":case"MessageRequestUserConvo":case"MessageRequestChatConvo":case"BusinessNotify":return e.all.peerIds.delete(t.peerId),e.unread.peerIds.delete(t.peerId),e.archive.peerIds.delete(t.peerId),e.messageRequest.peerIds.delete(t.peerId),e.businessNotify.peerIds.delete(t.peerId),o.isBusinessNotify(t)?void(k(e.businessNotify,t)&&e.businessNotify.peerIds.add(t.peerId)):o.isMR(t)?void(o.isPendingMR(t)&&k(e.messageRequest,t)&&e.messageRequest.peerIds.add(t.peerId)):t.isArchived?void(k(e.archive,t)&&e.archive.peerIds.add(t.peerId)):(k(e.all,t)&&e.all.peerIds.add(t.peerId),o.isUnread(t)&&k(e.unread,t)&&e.unread.peerIds.add(t.peerId),void("ChatConvo"===t.kind&&k(e.chats,t)&&e.chats.peerIds.add(t.peerId)));default:return(0,a.exhaustivenessCheck)(t)}}function f(e,{unread:t,unreadUnmuted:n,headerNotMutedUnread:r,archive:o,archiveTotal:i,archiveMentions:a,messageRequests:s,businessNotify:d,businessNotifyTotal:c}){void 0!==t&&(e.all.unreadCount=t,e.unread.unreadCount=t),void 0!==n&&(e.all.unreadUnmutedCount=n,e.unread.unreadUnmutedCount=n),void 0!==r&&(e.unread.headerNotMutedUnread=r),void 0!==o&&(e.archive.unreadCount=o),void 0!==a&&(e.archive.hasMentions=!!a),void 0!==i&&(e.archive.totalCount=i),void 0!==s&&(e.messageRequest.totalCount=s),void 0!==d&&(e.businessNotify.unreadCount=d),void 0!==c&&(e.businessNotify.totalCount=c)}function _(e,t){var n,r;if(e.majorSortId!==t.majorSortId)return t.majorSortId-e.majorSortId;const o=null==(n=i.lastNode({history:e.history,withDeleted:!1,withPending:!0}))?void 0:n.item,a=null==(r=i.lastNode({history:t.history,withDeleted:!1,withPending:!0}))?void 0:r.item;var s,d;return"Queued"===(null==o?void 0:o.kind)||"Queued"===(null==a?void 0:a.kind)?(null!=(s=null==a?void 0:a.sentAt)?s:0)-(null!=(d=null==o?void 0:o.sentAt)?d:0):t.minorSortId-e.minorSortId}function v(e,t){e.businessNotify.isHidden=!t}function g(e,t,n){o.isHidden(n)||(n.majorSortId<e[t].boundary.majorSortId?e[t].boundary={majorSortId:n.majorSortId,minorSortId:n.minorSortId}:n.majorSortId===e[t].boundary.majorSortId&&n.minorSortId<e[t].boundary.minorSortId&&(e[t].boundary.minorSortId=n.minorSortId),"all"===t&&(g(e,"unread",n),g(e,"chats",n)))}function k(e,t){return!o.isHidden(t)&&(t.majorSortId>e.boundary.majorSortId||t.majorSortId===e.boundary.majorSortId&&t.minorSortId>=e.boundary.minorSortId)}},651285:(e,t,n)=>{function r(e){return!Number.isNaN(e)&&e||(e=0),e}n.d(t,{resolveId:()=>r})},83062:(e,t,n)=>{n.d(t,{canHavePinnedConvos:()=>u,empty:()=>c,filterToTab:()=>p,isEqual:()=>l,refresh:()=>s,refreshChannels:()=>d,tabToChannelFilter:()=>m,tabToFilter:()=>h});var r=n(89131),o=n(498928),i=n(452788),a=n(999504);function s(e,t){a.refresh(e.folders,t),o.refresh(e.filters,t)}function d(e,t){i.refresh(e.channelFilters,t)}function c(){return{filters:o.empty(),folders:a.empty(),channelFilters:i.empty()}}function l(e,t){if(e.kind!==t.kind)return!1;switch(e.kind){case"filters":return e.filter===t.filter;case"folders":return e.id===t.id;default:(0,r.exhaustivenessCheck)(e)}}function u(e){return"filters"===e.kind}function p(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return}}function h(e){switch(e){case"archive":case"unread":case"businessNotify":case"messageRequest":return e;default:return"all"}}function m(e){switch(e){case"archive":case"unread":return e;default:return"all"}}},434425:(e,t,n)=>{function r(e){return!Number.isNaN(e)&&e||(e=0),e}n.d(t,{resolveId:()=>r})},71568:(e,t,n)=>{function r(e){return Number.isNaN(e)&&(e=0),e}n.d(t,{resolveStickerId:()=>r})},651041:(e,t,n)=>{n.d(t,{dictionaryLatinConvert:()=>d,toLocalCase:()=>l,toTranslit:()=>c});var r=n(434788);const o={u1072:"a",u1073:"b",u1074:"v",u1075:"g",u1076:"d",u1077:"e",u1105:"yo",u1078:"zh",u1079:"z",u1080:"i",u1081:"y",u1082:"k",u1083:"l",u1084:"m",u1085:"n",u1086:"o",u1087:"p",u1088:"r",u1089:"s",u1090:"t",u1091:"u",u1092:"f",u1093:"kh",u1094:"ts",u1095:"ch",u1096:"sh",u1097:"shch",u1098:"'",u1099:"y",u1100:"'",u1101:"e",u1102:"yu",u1103:"ya"},i=(0,r._)({},o,{u1093:"h",u1097:"sh",u1098:"",u1100:"",u1105:"e"}),a={u102:"а",u44:"б",u100:"в",u117:"г",u108:"д",u116:"е",u92:"ё",u59:"ж",u112:"з",u98:"и",u113:"й",u114:"к",u107:"л",u118:"м",u121:"н",u106:"о",u103:"п",u104:"р",u99:"с",u110:"т",u101:"у",u97:"ф",u91:"х",u119:"ц",u120:"ч",u105:"ш",u111:"щ",u93:"ъ",u109:"ь",u115:"ы",u39:"э",u46:"ю",u122:"я",u60:"б",u126:"ё",u58:"ж",u123:"х",u125:"ъ",u34:"э",u62:"ю",u64:'"',u35:"№",u36:";",u37:"%",u94:":",u38:"?",u63:",",u47:"."},s={yo:"ё",YO:"Ё",zh:"ж",ZH:"Ж",kh:"х",KH:"Х",ts:"ц",TS:"Ц",ch:"ч",CH:"Ч",sch:"щ",SCH:"Щ",shch:"щ",SHCH:"Щ",sh:"ш",SH:"Ш",eh:"э",EH:"Э",yu:"ю",YU:"Ю",ya:"я",YA:"Я","'":"ь",a:"а",A:"А",b:"б",B:"Б",v:"В",g:"г",G:"Г",d:"д",D:"Д",e:"е",E:"Е",z:"з",Z:"З",i:"и",I:"И",j:"й",J:"Й",k:"к",K:"К",l:"л",L:"Л",m:"м",M:"М",n:"н",N:"Н",o:"о",O:"О",p:"п",P:"Р",r:"р",R:"Р",s:"с",S:"С",t:"т",T:"Т",u:"у",U:"У",f:"ф",F:"Ф",h:"х",H:"Х",c:"ц",C:"Ц",y:"ы",Y:"Ы"};function d({value:e}){return function({dictionary:e,value:t}){return Object.entries(e).reduce(((e,[t,n])=>e.replace(new RegExp(t,"g"),n)),t)}({value:e,dictionary:s})}function c(e,t){e=e.toLowerCase().trim();const n=[o,i];return t&&n.push(a),n.reduce(((t,n)=>{const r=u(e,n);return r===e||t.includes(r)||t.push(r),t}),[])}function l(e){return u(e=e.toLowerCase().trim(),a)}function u(e,t){let n="";for(let r of e){const e=t["u"+r.codePointAt(0)];n+=void 0!==e?e:r}return n}},821551:(e,t,n)=>{n.d(t,{add:()=>s,create:()=>a,peerWords:()=>u,search:()=>d});var r=n(651041),o=n(89131),i=n(709420);function a(){return{items:new Set,branches:{}}}function s(e,t,n){if(Array.isArray(t))t.forEach((t=>s(e,t,n)));else{const{id:r,strings:o}=n(t);(0,i.getWordsVariants)(o).forEach((t=>{let n=e;n.items.add(r),Array.from(t.trim().toLowerCase()).forEach((e=>{let t=n.branches[e];t||(t=n.branches[e]=a()),t.items.add(r),n=t}))}))}return e}function d(e,t){const n=c(e,p(t)),o=c(e,p(r.toLocalCase(t))),i=c(e,r.toTranslit(t));return new Set([...n,...o,...i])}function c(e,t){let n=null;for(const r of t){const t=l(e,r);if(n)for(const e of n)t.has(e)||n.delete(e);else n=new Set([...t])}return n||new Set}function l(e,t){let n=e;const r=t.trim().toLowerCase();for(const e of r){let t=n.branches[e];if(!t)return new Set;n=t}return n.items}function u(e){let t=[];switch(e.kind){case"Chat":t.push(...p(e.title));break;case"Group":e.screenName&&t.push(e.screenName),t.push(...p(e.name));break;case"User":e.screenName&&t.push(e.screenName),t.push(...p(e.firstName)),t.push(...p(e.lastName));break;case"Contact":t.push(...p(e.name));break;default:(0,o.exhaustivenessCheck)(e)}return t}function p(e){return e.trim().toLowerCase().split(/\s+/g)}},709420:(e,t,n)=>{n.d(t,{getWordsVariants:()=>o});var r=n(651041);function o(e){let t=[];for(let n of e){const e=n.replace(/ё/g,"е").replace(/Ё/g,"Е");e!==n&&t.push(e),r.toTranslit(n,!0).forEach((e=>{e!==n&&t.push(e)})),t.push(n)}return t}},694788:(e,t,n)=>{n.d(t,{UNKNOWN_SHAPE_ID:()=>p,apiAttachWallOwnerId:()=>j,fromApiAttach:()=>h,fromApiAudio:()=>A,fromApiConvoAttach:()=>m,fromApiDoc:()=>g,fromApiPhoto:()=>k,fromApiPoll:()=>q,fromApiPollBackgroundGradient:()=>L,fromApiVideo:()=>b,fromApiVoice:()=>P,fromApiWallAttach:()=>f,fromApiWallReplyAttach:()=>_});var r=n(434788),o=n(820224),i=n(197934),a=n(96190),s=n(777634),d=n(504698),c=n(89131),l=n(986727);const u=200,p=-1;function h(e,t){if(0===e.length)return{};const n={},o=e=>{n.unknown=[...n.unknown||[],{data:e,kind:"Unknown"}]};for(const x of e)switch(x.type){case"photo":{if(!x.photo){o(x);break}const e=k(x.photo,t);if(!e){o(x);break}n.photos=[...n.photos||[],e];break}case"audio":{if(!x.audio){o(x);break}const e=A(x.audio);n.audios=[...n.audios||[],e];break}case"video":if(!x.video){o(x);break}const e=b(x.video,t);if(!e){o(x);break}n.videos=[...n.videos||[],e];break;case"doc":{if(!x.doc){o(x);break}const e=g(x.doc);if(!e){o(x);break}n.docs=[...n.docs||[],e];break}case"link":{if(!x.link){o(x);break}const e=v(x.link);if(!e){o(x);break}const t=e=>e.image&&(0,r._)({},e,{image:e.image,kind:"InviteLink"});if(i.isChatInviteLink(e.url)&&e.image){n.inviteLink=t(e);break}n.link=e;break}case"market":if(!x.market){o(x);break}n.market={kind:"Market",id:(w=x.market).id,ownerId:w.owner_id,isService:!!w.is_price_list_service,title:w.title,price:w.price.text,priceOld:w.price.old_amount_text,photo:w.thumb_photo};break;case"market_album":if(!x.market_market_album){o(x);break}n.marketAlbum={kind:"MarketAlbum"};break;case"gift":if(!x.gift){o(x);break}const N=S(x.gift);if(!N){o(x);break}n.gift=N;break;case"ugc_sticker":{if(!x.ugc_sticker){o(x);break}const e=(0,l.fromApiUgcSticker)(x.ugc_sticker);if(!e){o(x);break}n.ugcSticker=e;break}case"sticker":{if(!x.sticker){o(x);break}const e=(0,l.fromApiSticker)(x.sticker);if(!e){o(x);break}n.sticker=e;break}case"wall":{if(!x.wall||!x.wall.from_id||!x.wall.id){o(x);break}x.wall.geo&&(x.wall.attachments=[...x.wall.attachments||[],{type:"geo",geo:x.wall.geo}]);const e=j(x.wall);if(!e){o(x);break}n.wall={kind:"Wall",authorId:a.resolveId(x.wall.from_id),ownerId:a.resolveId(e),id:x.wall.id,date:1e3*(x.wall.date||0),chunks:d.fromServerText(x.wall.text||""),attaches:f(x.wall)};break}case"wall_reply":{if(!(x.wall_reply&&x.wall_reply.from_id&&x.wall_reply.id&&x.wall_reply.post_id)){o(x);break}const e=j(x.wall_reply);if(!e){o(x);break}n.wallReply={kind:"WallReply",id:x.wall_reply.id,postId:x.wall_reply.post_id,authorId:a.resolveId(x.wall_reply.from_id),ownerId:a.resolveId(e),parentsStack:x.wall_reply.parents_stack,date:1e3*(x.wall_reply.date||0),chunks:d.fromServerText(x.wall_reply.text||""),attaches:_(x.wall_reply.attachments||[])};break}case"article":if(!x.article){o(x);break}n.article=I(x.article);break;case"poll":if(!x.poll){o(x);break}n.poll=q(x.poll);break;case"graffiti":if(!x.graffiti){o(x);break}n.graffiti={kind:"Graffiti",imageUrl:x.graffiti.url,width:x.graffiti.width,height:x.graffiti.height};break;case"audio_message":if(!x.audio_message){o(x);break}n.voice=P(x.audio_message);break;case"audio_playlist":if(!x.audio_playlist){o(x);break}n.audioPlaylist={kind:"AudioPlaylist",id:(m=x.audio_playlist).id,ownerId:m.owner_id,type:M[m.type],title:m.title,accessKey:m.access_key,image:C(m.photo,"photo")};break;case"podcast":if(!x.podcast){o(x);break}n.podcast=E(x.podcast);break;case"money_transfer":if(!x.money_transfer){o(x);break}n.moneyTransfer=(p=x.money_transfer,h=void 0,{kind:"MoneyTransfer",text:(null==(h=p.amount)?void 0:h.text)||""});break;case"money_request":if(!x.money_request){o(x);break}n.moneyRequest={kind:"MoneyRequest",id:(u=x.money_request).id,toId:u.to_id,fromId:u.from_id,text:u.amount.text,initUrl:u.init_url,isUserOwner:!!u.user_is_owner,isProcessed:!!u.processed};break;case"story":if(!x.story){o(x);break}n.story=y(x.story);break;case"geo":if(!x.geo||!x.geo.coordinates){o(x);break}n.geo={kind:"Geo",coordinates:x.geo.coordinates,place:x.geo.place};break;case"call":{if(!x.call){o(x);break}const e=U(x.call);if(!e){o(x);break}n.finishedCall=e;break}case"group_call_in_progress":if(!x.group_call_in_progress){o(x);break}n.activeCall=(s=x.group_call_in_progress,c=void 0,{kind:"ActiveCall",initiatorId:s.initiator_id,joinLink:s.join_link,participants:{list:null==(c=s.participants.list)?void 0:c.map(a.resolveId),count:s.participants.count||0,coverList:F(s)}});break;case"mini_app":if(!x.mini_app){o(x);break}const R=T(x.mini_app);if(!R){o(x);break}n.miniApps=[...n.miniApps||[],R];break;case"donut_link":if(!x.donut_link){o(x);break}const L=D(x.donut_link);if(!L){o(x);break}n.donutLink=L;break;case"video_message":if(!x.video_message){o(x);break}n.videoMessage=V(x.video_message);break;case"widget":if(!x.widget){o(x);break}n.widget=G(x.widget);break;case"narrative":case"artist":case"event":case"curator":case"group":case"link_curator":case"video_playlist":case"app_action":case"vkpay":o(x);break;default:x.type;o(x);break}var s,c,u,p,h,m,w;return n}function m(e){const t={};for(const n of e)switch(n.attachment.type){case"photo":{if(!n.attachment.photo)break;const e=k(n.attachment.photo,n.attachment.photo.access_key);if(!e)break;const r={attach:e,cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.photos=(t.photos||[]).concat(r);break}case"audio":{if(!n.attachment.audio)break;const e={attach:A(n.attachment.audio),cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.audios=(t.audios||[]).concat(e);break}case"video":{if(!n.attachment.video)break;const e=b(n.attachment.video,n.attachment.video.access_key);if(!e)break;const r={attach:e,cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.videos=(t.videos||[]).concat(r);break}case"doc":{if(!n.attachment.doc)break;const e=g(n.attachment.doc);if(!e)break;const r={attach:e,cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.docs=(t.docs||[]).concat(r);break}case"link":{if(!n.attachment.link)break;const e=v(n.attachment.link);if(!e)break;const r={attach:e,cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.links=(t.links||[]).concat(r);break}case"mini_app":{if(!n.attachment.mini_app)break;const e=T(n.attachment.mini_app);if(!e)break;const r={attach:e,cmid:s.resolveCmid(n.message_id),messageId:s.resolveId(n.message_id),peerId:a.resolveId(n.from_id),date:n.date};t.links=(t.links||[]).concat(r);break}case"audio_message":case"app_action":case"graffiti":case"market":case"share":case"wall":break;default:n.attachment.type}return t}function f(e){const{geo:t,attachments:n,copy_history:o,access_key:i}=e,s=[];t&&(null==n||n.push({type:"geo",geo:t}));for(const e of n||[])switch(e.type){case"photo":case"audio":case"video":case"doc":case"link":case"mini_app":case"sticker":case"market":case"article":case"poll":case"audio_playlist":case"podcast":case"market_album":case"donut_link":case"graffiti":s.push({type:e.type,[e.type]:e[e.type]});break;case"geo":{var d,c,l;if(!e.geo)break;const t=null==(d=e.geo.coordinates)?void 0:d.split(" ").map((e=>parseFloat(e)));s.push({type:"geo",geo:(0,r._)({},e.geo,{place:{title:null==(c=e.geo.place)?void 0:c.title,address:null==(l=e.geo.place)?void 0:l.address},coordinates:t&&t[0]&&t[1]?{latitude:t[0],longitude:t[1]}:void 0})});break}case"textlive":case"textpost":case"textpost_publish":case"posted_photo":case"note":case"app":case"page":case"album":case"event":case"situational_theme":case"group":case"artist":case"curator":case"photos_list":case"pretty_cards":case"narrative":case"video_playlist":break;default:e.type}const u=h(s,i);if(null==o?void 0:o[0]){const e=j(o[0]);u.wallHistory={kind:"WallHistory",id:o[0].id||0,authorId:a.resolveId(o[0].from_id),ownerId:a.resolveId(e),date:1e3*(o[0].date||0),text:o[0].text||""}}return u}function _(e){const t=[];for(const n of e)switch(n.type){case"photo":case"audio":case"video":case"doc":case"link":case"sticker":case"market":case"graffiti":case"market_album":case"geo":t.push({type:n.type,[n.type]:n[n.type]});break;case"note":case"page":case"audio_playlist":case"album":case"app":case"article":case"curator":case"donut_link":case"event":case"group":case"mini_app":case"narrative":case"photos_list":case"poll":case"posted_photo":case"pretty_cards":case"video_playlist":case"situational_theme":case"textlive":case"textpost":case"textpost_publish":case"podcast":case"artist":break;default:n.type}return h(t)}function v(e){var t,n,r,o;if(!e.title)return;let i=e.url;const a=/^https:\/\/m\.vk\.com(.+)/;if(a.test(e.url)){const t=e.url.match(a);i=t&&t[1]?t[1]:i}let s;var d,c,l,u;((null==(t=e.seller_product)?void 0:t.owner_name)||(null==(n=e.rating)?void 0:n.stars)||(null==(r=e.rating)?void 0:r.reviews_count)||(null==(o=e.seller_product)?void 0:o.favicon_link))&&(s={ownerName:null==(d=e.seller_product)?void 0:d.owner_name,rating:null==(c=e.rating)?void 0:c.stars,reviews:null==(l=e.rating)?void 0:l.reviews_count,favicon:null==(u=e.seller_product)?void 0:u.favicon_link});return{kind:"Link",url:i,meta:s,title:e.title,subtitle:e.caption||i,image:e.photo?N(e.photo.sizes||[]):void 0}}function g(e){var t,n,o;if(!e.url)return;const i=!!(null==(t=e.preview)||null==(n=t.photo)||null==(o=n.sizes)?void 0:o.length)&&N(e.preview.photo.sizes.map((e=>(0,r._)({},e,{url:e.src}))));return(0,r._)({kind:"Doc",id:e.id,ownerId:e.owner_id,title:e.title,size:e.size,ext:e.ext,date:e.date,url:e.url,isUnsafe:Boolean(e.is_unsafe)},i&&{image:i})}function k(e,t){var n;if(e.sizes)return{kind:"Photo",accessKey:e.access_key,albumId:e.album_id,id:e.id,ownerId:e.owner_id,hasTags:e.has_tags,sizes:N(e.sizes),originalImage:null==(n=e.orig_photo)?void 0:n.url,messageAccessKey:t,uploadDate:1e3*e.date}}function b(e,t){if(!e.id||!e.owner_id)return;const n=R(e.image||[{url:"",height:0,width:0}]);return n?{kind:"Video",accessKey:e.access_key,id:e.id,ownerId:e.owner_id,duration:e.duration,width:e.width,height:e.height,image:n,title:e.title,views:e.views||0,restriction:e.restriction,files:"files"in e?e.files:void 0,messageAccessKey:t,player:e.player,platform:e.platform}:void 0}function y(e){const t=!!e.is_expired,n=!!e.is_restricted,r=!t&&0!==e.can_see;return{kind:"Story",id:e.id,ownerId:e.owner_id,date:void 0!==e.date?1e3*e.date:void 0,restricted:n,expired:t,available:r,photo:e.photo&&k(e.photo),video:e.video&&b(e.video)}}function I(e){let t,n;switch(e.state){case"available":case"banned":case"deleted":case"paid":case"protected":t=e.state;break;case void 0:t="unknown";break;default:e.state;t="unknown"}return e.photo?n=N(e.photo.sizes||[]):e.owner_photo&&(n=N([{type:"o",width:0,height:0,url:e.owner_photo}])),{kind:"Article",state:t,url:e.url||"",title:e.title||"",author:e.owner_name||"",meta:e.subtitle||"",image:n}}const w={thumb:[48,96,256,512],photo:[34,68,135,270,300,600,1200],unknown:[]};function C(e,t){if(!e)return;const[n,...r]=w[t].reduce(((n,r)=>{const o=e[`${t}_${r}`];return o?(n.push({url:o,width:r,height:r}),n):n}),[]);return n?[n,...r]:void 0}function S(e){const t=C(e,"thumb");if(t)return{kind:"Gift",id:e.id,isStickerStyle:!!e.is_stickers_style,image:t}}function A(e){var t;return{kind:"Audio",id:e.id,ownerId:e.owner_id,artist:e.artist,title:e.title,subtitle:e.subtitle,url:e.url,duration:e.duration,albumId:e.album_id,trackCode:e.track_code,contentRestricted:e.content_restricted,albumPartNumber:e.album_part_number,thumb:null==(t=e.album)?void 0:t.thumb,accessKey:e.access_key}}function P(e){return{kind:"Voice",duration:e.duration,id:e.id,linkMp3:e.link_mp3,linkOgg:e.link_ogg,ownerId:e.owner_id,waveform:e.waveform,isTranscriptPossible:e.duration/60/60<1,transcription:x(e)}}function x(e){switch(e.transcript_state){case"done":var t;return{state:"done",text:null==(t=e.transcript)?void 0:t.trim(),updatedAt:e.transcript_update_time?1e3*e.transcript_update_time:void 0};case"error":case"in_progress":return{state:e.transcript_state};case void 0:return;default:e.transcript_state;return}}const M={0:"playlist",1:"album",2:"playlist",3:"playlist",4:"playlist",5:"playlist"};function E(e){var t,n;const r=null==(t=e.podcast_info)||null==(n=t.cover)?void 0:n.sizes,o=r&&N(r).values(),i=o&&(0,c.toNonEmpty)([...o])||void 0;return{kind:"Podcast",id:e.id,ownerId:e.owner_id,title:e.title,image:i}}function N(e){return e.sort(((e,t)=>e.width-t.width)).reduce(((e,t)=>{var{type:n,src:i,url:a}=t,s=(0,o._)(t,["type","src","url"]);return void 0===a||"s"!==n&&"m"!==n&&"x"!==n&&"o"!==n&&"p"!==n&&"q"!==n&&"r"!==n&&"y"!==n&&"z"!==n&&"w"!==n||(s.width&&s.height?e.set(n,(0,r._)({url:a},s)):e.set(n,(0,r._)({},s,{url:a,width:u,height:u}))),e}),new Map)}function R(e){const t=e.sort(((e,t)=>e.width-t.width)).map((e=>({width:e.width,height:e.height,url:e.url}))),[n,...r]=t;if(n)return[n,...r]}function F(e){var t;const n=null==(t=e.participants)?void 0:t.list;if(!n)return[];return n.reduce(((e,t)=>{const n=a.resolveAnyId(t);return(a.isUserPeerId(n)||a.isGroupPeerId(n))&&e.push(n),e}),[]).slice(0,3)}function U(e){var t,n,r;const o=function(e){switch(e.state){case"reached":return"reached";case"canceled_by_initiator":return"canceledByInitiator";case"canceled_by_receiver":return"canceledByReceiver";default:return}}(e);if(o)return{kind:"FinishedCall",initiatorId:e.initiator_id,duration:e.duration,state:o,participants:{list:null==(t=e.participants)||null==(n=t.list)?void 0:n.map(a.resolveId),count:(null==(r=e.participants)?void 0:r.count)||0,coverList:F(e)}}}function T(e){if(!e.app||!e.app.share_url||!e.app.webview_url)return;const t=(0,c.toNonEmpty)(e.images.map((({url:e,height:t,width:n})=>({width:n,height:t,url:e}))));if(!t)return;t.sort(((e,t)=>e.width-t.width));const n=e.app.share_url.replace(/https:\/\/[a-z0-9_\-.]+\//,""),r=new URL(e.app.share_url).hash.slice(1);return{kind:"MiniApp",title:e.title,appLink:n,images:t,id:i.resolveMiniAppId(e.app.id),url:e.app.webview_url,shareUrl:e.app.share_url,hash:r}}function D(e){var t,n;const r=a.resolveId(e.owner_id);if(a.isGroupPeerId(r)&&(null==(t=e.action)?void 0:t.url)&&(null==(n=e.button.action)?void 0:n.url)&&e.button.title)return{kind:"DonutLink",ownerId:r,button:{action:{target:"internal",type:"open_url",url:e.button.action.url},title:e.button.title},donorsCount:e.donors.count,text:e.text,action:{target:"internal",type:"open_url",url:e.action.url}}}function q(e){var t,n;return{kind:"Poll",id:e.id,ownerId:a.resolveId(e.owner_id),authorId:void 0!==e.author_id?a.resolveId(e.author_id):a.resolveId(e.owner_id),title:e.question,anonymous:!!e.anonymous,endDate:1e3*e.end_date,answers:e.answers.map((t=>{var n;return{id:t.id,text:t.text,votes:t.votes,rate:t.rate,selected:!!(null==(n=e.answer_ids)?void 0:n.includes(t.id))}})),voted:!!(null==(t=e.answer_ids)?void 0:t.length),canVote:e.can_vote,canChangeVote:!e.disable_unvote,canEdit:e.can_edit,multiple:e.multiple,votes:e.votes,friends:(null==(n=e.friends)?void 0:n.map((e=>a.resolveId(e.id))))||[],backgroundGradient:L(e.background),backgroundPhoto:B(e.photo)}}function L(e){if(!e||"gradient"!==e.type)return;const{points:t,angle:n}=e;return void 0!==t&&void 0!==n?{id:e.id||0,points:t.map((e=>"#"+e.color)),angle:n}:void 0}function B(e){if(!e||!e.color||!e.images)return;const t=(0,c.toNonEmpty)(e.images.map((e=>({url:e.url,width:e.width,height:e.height}))));return t?{kind:"PollBackgroundPhoto",image:t,color:"#"+e.color}:void 0}function j({owner_id:e,source_id:t,to_id:n}){var r;return null!=(r=null!=e?e:t)?r:n}function V(e){if(!e.id||!e.owner_id)return;const t=R(e.image||[{url:"",height:0,width:0}]);return t?{kind:"VideoMessage",id:e.id,ownerId:e.owner_id,duration:e.duration,shapeId:e.shape_id||p,image:t,files:e.files,transcription:O(e)}:void 0}function O(e){switch(e.transcript_state){case"done":var t;return{state:"done",text:null==(t=e.transcript)?void 0:t.trim(),updatedAt:e.transcript_update_time?1e3*e.transcript_update_time:void 0};case"error":case"in_progress":case"uninitialized":return{state:e.transcript_state};case void 0:return;default:(0,c.exhaustivenessCheck)(e.transcript_state)}}function G(e){if(e.item.widget_id)return{kind:"Widget",id:e.item.widget_id,data:e}}},233300:(e,t,n)=>{n.d(t,{convertButtons:()=>p,fromApiKeyboard:()=>c,fromApiMessageEvent:()=>m,fromEngineKeyboard:()=>l});var r=n(434788),o=n(659397),i=n(197934),a=n(859352),s=n(96190),d=n(95154);function c(e,t){const n=u(e.buttons,e.inline),r=s.resolveId(e.author_id||t);return e.inline?{kind:"InlineKeyboard",authorId:r,buttons:n}:{kind:"InputKeyboard",authorId:r,buttons:n,oneTime:e.one_time}}function l(e,t){if(e.inline)return e.buttons?{kind:"InlineKeyboard",buttons:u(e.buttons,e.inline),authorId:s.resolveId(e.author_id||t)}:void 0;var n;if(!(null==(n=e.buttons)?void 0:n.length))return{kind:"InputKeyboardDeleteEvent"};return{kind:"InputKeyboardUpsertEvent",keyboard:{kind:"InputKeyboard",buttons:u(e.buttons,e.inline),authorId:s.resolveId(e.author_id||t),oneTime:e.one_time}}}function u(e,t){return e.map((e=>p(e,t)))}function p(e,t){return e.map((e=>function(e,t){const n="positive"===(r=e.color)?"commerce":"negative"===r?"destructive":"primary"===r?r:"secondary";var r;switch(e.action.type){case"text":case"callback":return{type:e.action.type,label:(0,o.unescape)(e.action.label||""),payload:e.action.payload||"",color:n};case"open_link":return{type:e.action.type,link:e.action.link,label:(0,o.unescape)(e.action.label||""),payload:e.action.payload||"",color:n};case"location":return{type:e.action.type,payload:e.action.payload||"",color:n};case"vkpay":return{type:e.action.type,payload:e.action.payload||"",appId:(0,i.resolveMiniAppId)(d.VK_PAY_APP_ID),hash:e.action.hash||""};case"open_app":return{type:e.action.type,payload:e.action.payload||"",label:(0,o.unescape)(e.action.label||""),hash:e.action.hash||"",appId:(0,i.resolveMiniAppId)(e.action.app_id),ownerId:s.resolveId(e.action.owner_id),color:n};case"open_photo":return;default:return void e.action}}(e))).filter(h)}function h(e){return void 0!==e}const m=(e,t,n)=>{const{event_id:o,action:d,owner_id:c}=n,l=a.resolveId(o),u=s.resolveId(c);if(d)switch(d.type){case"show_snackbar":return(0,r._)({},d,{id:l,ownerId:u,title:s.name(e),photo:t.photo50,peerId:e.id});case"open_link":case"open_modal_view":return(0,r._)({},d,{id:l,ownerId:u,title:s.name(e),peerId:e.id});case"open_app":return{id:l,type:d.type,ownerId:u,appId:(0,i.resolveMiniAppId)(d.app_id),hash:d.hash,peerId:e.id};default:}return{id:l,type:"null",ownerId:u,peerId:e.id}}},634263:(e,t,n)=>{n.d(t,{fromApiTemplate:()=>s});var r=n(434788),o=n(820224),i=n(233300),a=n(694788);function s(e,t){var n;return{kind:"carousel",elements:(null==(n=e.elements)?void 0:n.map((e=>function(e,t){var{buttons:n,photo:s,action:d}=e,c=(0,o._)(e,["buttons","photo","action"]);const l=s?(0,a.fromApiPhoto)(s,t):null,u=(0,r._)({buttons:n?(0,i.convertButtons)(n,!0):[]},l&&{photo:l},c),p=(0,r._)({},u,{kind:"simple"});if(!d)return p;switch(d.type){case"open_photo":return s&&l?(0,r._)({},u,{kind:"photo",photo:l}):p;case"open_link":return(0,r._)({},u,{kind:"link",link:d.link});default:return p}}(e,t))))||[]}}},739361:(e,t,n)=>{n.d(t,{fromApiChannel:()=>a});var r=n(839963),o=n(86144),i=n(54965);const a=(e,t)=>{var n,a,s,d;const{channel:c,last_message:l}=e,u=l&&(0,i.fromApiPost)(l).post,p={confirmed:[],pending:[]};u&&(p.confirmed=u.cmid>1?[{kind:"GapNode",fromCmid:o.resolveCmid(1),toCmid:o.resolveCmid(u.cmid-1)},{kind:"Node",item:u}]:[{kind:"Node",item:u}]);const h=!c.user_data.notification_settings.is_enabled||(c.user_data.notification_settings.disable_duration||0)>0,m=o.resolveCmid((null==(n=c.user_data)||null==(a=n.read_state)?void 0:a.read_up_to_cmid)||0);return{kind:"Channel",id:r.resolveId(c.channel_id),unreadCount:(null==(s=c.user_data.read_state)?void 0:s.unread_count)||0,isArchived:!!(null==(d=c.user_data)?void 0:d.is_archived),isMuted:h,notificationsDisabledUntil:c.user_data.notification_settings.disable_duration||0,inReadCmid:m,majorSortId:c.sort_id.major_id,minorSortId:c.sort_id.minor_id,membersCount:t.members_count||0,isMember:Boolean(t.is_member),adminLevel:t.admin_level||0,photos:{photo50:t.photo_50,photo100:t.photo_100},name:t.name||"",activity:t.activity||"",isVerified:!!t.verified,screenName:t.screen_name,history:p,canSendDonut:!!t.can_post_donut,pending:{}}}},508047:(e,t,n)=>{n.d(t,{fromApiConvoBanner:()=>o});var r=n(504698);function o(e){var t,n;return{icon:null!=(t=e.icon)?t:"",name:e.name,title:null!=(n=e.title)?n:"",chunks:r.fromServerText(e.text),canHide:e.can_hide||!0,buttons:(e.buttons||[]).map((e=>{var t,n;return{callbackData:null!=(t=null==e?void 0:e.callback_data)?t:"",mode:e.layout,appearance:i(e.style),link:null!=(n=null==e?void 0:e.link)?n:"",text:e.text,hideOnAction:!!e.hide_on_action,type:e.type}}))}}function i(e){return"destructive"===e?"negative":"regular"===e?"accent":e}},954811:(e,t,n)=>{n.d(t,{fromApiConvo:()=>p,fromLongpollPushSettings:()=>h});var r=n(434788),o=n(96190),i=n(185327),a=n(999504),s=n(777634),d=n(481186),c=n(233300),l=n(508047);const u={18:"peer_deleted",900:"peer_blacklisted_by_me",901:"peer_blacklisted",902:"peer_blacklisted",915:"disabled_by_community",916:"disabled_by_peer",917:"kicked",918:"no_access",922:"no_access",925:"no_access",932:"no_access",945:"chat_unsupported",946:"chat_unsupported",203:"disabled_by_peer"};function p(e,t){var n,u,p;const h=t&&(0,d.fromApiMessage)(t).message,v={confirmed:[],pending:[]};h?v.confirmed=h.cmid>1?[{kind:"GapNode",fromCmid:s.resolveCmid(1),toCmid:s.resolveCmid(h.cmid-1)},{kind:"Node",item:h}]:[{kind:"Node",item:h}]:void 0!==e.last_conversation_message_id&&e.last_conversation_message_id>0&&(v.confirmed=[{kind:"GapNode",fromCmid:1,toCmid:e.last_conversation_message_id}]);const g=e.current_keyboard&&(0,c.fromApiKeyboard)(e.current_keyboard);if("InlineKeyboard"===(null==g?void 0:g.kind))throw new Error("Не может прийти инлайн клавиатура для сообщения");const k={majorSortId:(null==(n=e.sort_id)?void 0:n.major_id)||0,minorSortId:(null==(u=e.sort_id)?void 0:u.minor_id)||0,unreadCount:e.unread_count||0,isMarkedUnread:!!e.is_marked_unread,isArchived:!!e.is_archived,inReadBy:s.resolveCmid(e.in_read_cmid),outReadBy:s.resolveCmid(e.out_read_cmid),folderIds:new Set((null==(p=e.folder_ids)?void 0:p.map(a.resolveId))||[]),isNew:!!e.is_new,canWrite:f(e),currentKeyboard:g,push:m(e.push_settings),history:v,unreadExpireables:new Set((e.expire_cmids||[]).map(s.resolveCmid)),unreadReactions:new Set((e.unread_reactions||[]).map(s.resolveCmid)),convoBanner:e.conversation_bar&&(0,l.fromApiConvoBanner)(e.conversation_bar)},b=o.resolveId(e.peer.id);switch(e.peer.type){case"user":if(!o.isUserPeerId(b))return null;if(void 0!==e.message_request_data){const{status:t}=e.message_request_data;return"pending"===t?{convo:(0,r._)({},k,{kind:"MessageRequestUserConvo",peerId:b,MRStatus:t})}:null}return{convo:(0,r._)({},k,{kind:"UserConvo",peerId:b})};case"chat":{var y,I,w,C,S,A;if(!o.isChatPeerId(b))return null;if(!e.chat_settings)throw new Error("TODO chat convo has to has chat settings");const t=e.chat_settings.owner_id&&0!==e.chat_settings.owner_id?o.resolveId(e.chat_settings.owner_id):void 0,n=t&&(o.isUserPeerId(t)||o.isGroupPeerId(t))?t:void 0,a=(0,r._)({},k,{peerId:b,ownerId:n,unreadMentions:new Set((e.mention_cmids||[]).map(s.resolveCmid)),membersCount:e.chat_settings.members_count||0,state:e.chat_settings.state,isCasper:!!e.chat_settings.is_disappearing,isCommunityChat:!!t&&o.isGroupPeerId(t),isDonut:!!e.chat_settings.is_donut,isGroupChannel:!!e.chat_settings.is_group_channel,activeCall:_(e.call_in_progress),pinnedMessage:e.chat_settings.pinned_message?(0,d.fromApiPinnedMessage)(e.chat_settings.pinned_message):void 0,acl:(x=e.chat_settings.acl,{canChangeInfo:x.can_change_info,canChangeInviteLink:x.can_change_invite_link,canChangePin:x.can_change_pin,canInvite:x.can_invite,canPromoteUsers:x.can_promote_users,canSeeInviteLink:x.can_see_invite_link,canModerate:x.can_moderate,canCopyChat:x.can_copy_chat,canCall:x.can_call,canUseMassMentions:x.can_use_mass_mentions,canChangeServiceType:Boolean(x.can_change_service_type),canChangeStyle:Boolean(x.can_change_style),canSendReactions:!0}),permissions:e.chat_settings.permissions?(P=e.chat_settings.permissions,(0,r._)({},i.DEFAULT_CHAT_PERMISSIONS,P)):void 0,description:e.chat_settings.description,isService:Boolean(e.chat_settings.is_service),adminIds:new Set([...[t]||0,...e.chat_settings.admin_ids||[]].map(o.resolveId)),memberIds:new Set([]),invitedIds:new Set([]),shouldShortPollReactions:Boolean(e.chat_settings.short_poll_reactions)}),c={kind:"Chat",id:b,title:(null==(y=e.chat_settings)?void 0:y.title)||"",photo50:null==(I=e.chat_settings.photo)?void 0:I.photo_50,photo100:null==(w=e.chat_settings.photo)?void 0:w.photo_100,photo200:null==(C=e.chat_settings.photo)?void 0:C.photo_200,hasDefaultPhoto:(null==(S=e.chat_settings.photo)?void 0:S.is_default_photo)||(null==(A=e.chat_settings.photo)?void 0:A.is_default_call_photo),canCall:e.chat_settings.acl.can_call};if(void 0!==e.message_request_data){const{status:t,inviter_id:n}=e.message_request_data;return"pending"===t&&void 0!==n?{convo:(0,r._)({},a,{kind:"MessageRequestChatConvo",inviterPeerId:o.resolveId(n),MRStatus:t}),peer:c}:null}return"business_notify"===e.special_service_type?{convo:(0,r._)({},a,{kind:"BusinessNotify"}),peer:c}:{convo:(0,r._)({},a,{kind:"ChatConvo"}),peer:c}}case"group":return o.isGroupPeerId(b)?{convo:(0,r._)({},k,{peerId:b,kind:"GroupConvo"})}:null;case"email":return null;case"contact":return o.isContactPeerId(b)?{convo:(0,r._)({},k,{peerId:b,kind:"ContactConvo"})}:null;default:e.peer.type;return null}var P,x}function h(e){const t=Number(e[1].disabled_until);switch(t){case 0:return{mode:"everything",disabledUntil:0};case-1:return{mode:"every-mention",disabledUntil:1/0};default:return{mode:"every-mention",disabledUntil:1e3*t}}}function m(e){let t={mode:"everything",disabledUntil:0};return e?(e.disabled_forever?t={mode:"every-mention",disabledUntil:1/0}:e.disabled_until&&(t={mode:"every-mention",disabledUntil:1e3*e.disabled_until}),"everything"!==t.mode&&(e.disabled_mass_mentions&&(t=(0,r._)({},t,{mode:"direct-mention"})),e.disabled_mentions&&(t=(0,r._)({},t,{mode:"nothing"}))),t):t}function f(e){var t;const n=e.can_write;return"chat"===e.peer.type&&"rejected"===(null==(t=e.message_request_data)?void 0:t.status)?{allowed:!1,reason:"mr_rejected"}:(null==n?void 0:n.allowed)?{allowed:!0}:{allowed:!1,reason:(null==n?void 0:n.reason)&&u[n.reason]||"unknown"}}function _(e){if(!e)return;return{participants:{list:(e.participants.list||[]).reduce(((e,t)=>{const n=o.resolveAnyId(t);return(o.isUserPeerId(n)||o.isGroupPeerId(n))&&e.push(n),e}),[]),count:e.participants.count||0},joinLink:e.join_link,canFinishCall:Boolean(e.can_finish_call),hasLink:Boolean(e.has_link)}}},171949:(e,t,n)=>{n.d(t,{fromApiFolder:()=>o});var r=n(999504);function o(e){return{id:r.resolveId(e.id),name:e.name,unreadCount:0,unreadUnmutedCount:0,all:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0},unread:{peerIds:new Set,boundaryMinorId:1/0,hasMore:!0}}}},481186:(e,t,n)=>{n.d(t,{fromApiMessage:()=>m,fromApiPinnedMessage:()=>b,fromEngineMessage:()=>f});var r=n(659397),o=n(877740),i=n(694788),a=n(777634),s=n(96190),d=n(504698),c=n(651285),l=n(89131),u=n(233300),p=n(634263),h=n(858289);function m(e){if(e.action)return{message:{kind:"Service",id:a.resolveId(e.id),action:g({apiAction:e.action,apiAttaches:e.attachments}),peerId:s.resolveId(e.peer_id),cmid:a.resolveCmid(e.conversation_message_id),authorId:s.resolveId(e.from_id),sentAt:1e3*e.date,isOut:1===e.out,isSilent:e.is_silent,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0},mentions:{hasDirect:!1,hasMass:!1}};const t=s.resolveId(e.peer_id);if(e.is_expired)return{message:{kind:"Expired",id:a.resolveId(e.id),cmid:a.resolveCmid(e.conversation_message_id),peerId:s.resolveId(e.peer_id),authorId:s.resolveId(e.from_id),isOut:1===e.out,isSilent:e.is_silent,sentAt:1e3*e.date},mentions:{hasDirect:!1,hasMass:!1}};const n=e.keyboard&&(0,u.fromApiKeyboard)(e.keyboard);if("InputKeyboard"===(null==n?void 0:n.kind))throw new Error("Кажется из апи пришла не инлайн клавиатура для сообщения");const r=a.resolveCmid(e.conversation_message_id);return{message:{kind:"Normal",id:a.resolveId(e.id),randomId:a.resolveRandomId(e.random_id),cmid:r,peerId:t,authorId:s.resolveId(e.from_id),chunks:d.fromServerText(e.text),isOut:1===e.out,isSilent:e.is_silent,isImportant:!!e.important,isPlayed:!!e.was_played,sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,i.fromApiAttach)(k(e),`mail${e.id}`),keyboard:n,forwardedMessages:v(e.fwd_messages,t,r),replyMessage:e.reply_message?_(e.reply_message,t,r):void 0,expireTTL:e.expire_ttl?1e3*e.expire_ttl:void 0,deleteTTL:void 0!==e.ttl?1e3*e.ttl:void 0,pinnedAt:e.pinned_at&&1e3*e.pinned_at,template:e.template?(0,p.fromApiTemplate)(e.template,`mail${e.id}`):void 0,reactions:e.reactions?(0,h.fromApiMessageReactions)(e.reactions):new Map,reactionId:e.reaction_id?c.resolveId(e.reaction_id):void 0},mentions:{hasDirect:!1,hasMass:!1}}}function f(e,t,n){let c,p,h,m,f,_,v,k,b,y;switch(e[0]){case 4:[,c,p,,h,m,f,_,v,k,y]=e;break;case 10004:[,y,p,,h,m,f,_,v,k,c]=e;break;case 5:case 18:[,c,p,h,m,f,_,v,k,y,b]=e;break;case 10005:case 10018:[,y,p,h,m,f,_,v,k,c,b]=e;break;default:(0,l.exhaustivenessCheck)(e)}const I=s.resolveId(h),{isOut:w,isImportant:C,noPush:S,isPlayed:A}=a.convertFlags(p),P=w||s.isFavorites(I,t),x="1"===_.is_silent;let M;if(M=void 0!==_.from?s.resolveId(Number(_.from)):P?t:I,_.source_act)return{message:{kind:"Service",id:a.resolveId(c),cmid:a.resolveCmid(y),peerId:I,authorId:M,action:g({apiAction:{conversation_message_id:_.source_chat_local_id?Number(_.source_chat_local_id):void 0,message:_.source_message,type:_.source_act,member_id:_.source_mid?Number(_.source_mid):void 0,text:_.source_text,old_text:_.source_old_text,style:_.source_style}}),deleteTTL:void 0!==_.ttl?1e3*Number(_.ttl):void 0,sentAt:1e3*m,isOut:P,isSilent:x},mentions:{hasDirect:!1,hasMass:!1},noPush:S};if("1"===_.is_expired)return{message:{kind:"Expired",id:a.resolveId(c),cmid:a.resolveCmid(y),isOut:P,isSilent:x,peerId:I,authorId:M,sentAt:1e3*m},mentions:{hasDirect:!1,hasMass:!1},noPush:!0};const E={hasDirect:!1,hasMass:!1};for(const e of _.marked_users||[])if(e[0]===o.IEngine.MarkedType.Mention)switch(e[1]){case"all":E.hasMass=E.hasMass||M!==t;break;case"online":E.hasMass=E.hasMass||e[2].includes(t);break;default:E.hasDirect=e[1].includes(t)}let N,R={};if("sticker"!==v.attach1_type&&"audiomsg"!==v.attach1_kind||!v.attachments)void 0!==v.attach1_type&&(R={unknown:[{data:v,kind:"Unknown"}]});else{const e=JSON.parse(v.attachments);Array.isArray(e)&&(R=(0,i.fromApiAttach)(e,`mail${c}`))}if(void 0!==v.reply){const e=JSON.parse(v.reply),t=n(a.resolveCmid(e.conversation_message_id));t&&(N=a.toForeign({message:t,rootPeerId:I,rootCmid:a.resolveCmid(y)}))}const F=_.keyboard?(0,u.fromEngineKeyboard)(_.keyboard,M):void 0;let U,T;return"InlineKeyboard"===(null==F?void 0:F.kind)?U=F:T=F,{message:{kind:"Normal",id:a.resolveId(c),cmid:a.resolveCmid(y),randomId:a.resolveRandomId(k),peerId:I,authorId:M,chunks:d.fromServerText((0,r.unescape)(f)),isOut:P,isSilent:x,isImportant:C,isPlayed:A,sentAt:1e3*m,updatedAt:b?1e3*b:void 0,pinnedAt:_.pinned_at?1e3*Number(_.pinned_at):void 0,expireTTL:_.expire_ttl?1e3*Number(_.expire_ttl):void 0,deleteTTL:void 0!==_.ttl?1e3*Number(_.ttl):void 0,attaches:R,replyMessage:N,keyboard:U,reactions:new Map},mentions:E,noPush:S,keyboardEvent:T}}function _(e,t,n){let r,o;return e.peer_id&&(r=s.resolveId(e.peer_id)),e.id&&(o=a.resolveId(e.id)),e.is_expired?{kind:"ForeignExpired",id:o,peerId:r,rootPeerId:t,rootCmid:n,cmid:a.resolveCmid(e.conversation_message_id),authorId:s.resolveId(e.from_id),sentAt:1e3*e.date}:{kind:"Foreign",id:o,peerId:r,rootPeerId:t,rootCmid:n,cmid:a.resolveCmid(e.conversation_message_id),authorId:s.resolveId(e.from_id),chunks:d.fromServerText(e.text),sentAt:1e3*e.date,updatedAt:e.update_time&&1e3*e.update_time,attaches:(0,i.fromApiAttach)(k(e),e.id?`mail${e.id}`:void 0),forwardedMessages:v(e.fwd_messages,t,n),replyMessage:e.reply_message?_(e.reply_message,t,n):void 0}}function v(e,t,n){if(!e||0===e.length)return;let r;for(const o of e){const e=_(o,t,n);if("ForeignExpired"!==e.kind)r?r.push(e):r=[e];else if(l.isDev)throw new Error("Исчезающих сообщений не может быть в пересланных.")}return r}function g({apiAction:e,apiAttaches:t}){const n={type:"unknown"};switch(e.type){case"chat_create":return e.text?{type:e.type,title:e.text}:n;case"chat_title_update":return e.text&&e.old_text?{type:e.type,title:e.text,oldTitle:e.old_text}:n;case"chat_photo_remove":case"chat_screenshot":case"chat_group_call_started":case"chat_invite_user_by_link":case"chat_invite_user_by_call_join_link":case"chat_kick_don":return{type:e.type};case"chat_pin_message":case"chat_unpin_message":return{type:e.type,cmid:a.resolveCmid(e.conversation_message_id),chunks:e.message?d.fromServerText(e.message):[]};case"chat_photo_update":const r=null==t?void 0:t.find((e=>"photo"===e.type)),o=null==r?void 0:r.photo;if(!o)return n;const c=(0,i.fromApiPhoto)(o);return c?{type:e.type,photo:c}:n;case"chat_invite_user":case"chat_kick_user":case"accepted_message_request":{if(!e.member_id)return n;const t=s.resolveId(e.member_id);return s.isUserPeerId(t)||s.isGroupPeerId(t)?{type:e.type,peerId:t}:n}case"chat_invite_user_by_message_request":case"chat_invite_user_by_call":case"chat_kick_user_call_block":{if(!e.member_id)return n;const t=s.resolveId(e.member_id);return s.isUserPeerId(t)?{type:e.type,peerId:t}:n}case"conversation_style_update":case"conversation_style_update_action":let l;switch(e.style){case"disco":case"twilight":case"sunset":case"lagoon":case"marine":case"retrowave":case"candy":case"crimson":case"emerald":case"halloween_orange":case"halloween_violet":case"unicorn":case"midnight":case"easter_egg":case"frost":case"new_year":case"valentine":case"warm_valentine":case"womens_day":case"mable":case void 0:l=e.style;break;default:l="unknown"}return{type:e.type,style:l};case"custom":return e.message?{type:e.type,chunks:d.fromServerText(e.message)}:n;default:e.type;return n}}function k({attachments:e=[],geo:t}){return t?[...e,{type:"geo",geo:t}]:e}function b(e){const t=s.resolveId(e.peer_id),n=a.resolveCmid(e.conversation_message_id),r=s.resolveId(e.from_id);let o;return e.id&&(o=a.resolveId(e.id)),{kind:"Pinned",id:o,cmid:n,peerId:t,authorId:r,chunks:d.fromServerText(e.text),sentAt:1e3*e.date,forwardedMessages:e.fwd_messages?v(e.fwd_messages,t,n):void 0,replyMessage:e.reply_message?_(e.reply_message,t,n):void 0,attaches:(0,i.fromApiAttach)(e.attachments||[])}}},858289:(e,t,n)=>{n.d(t,{fromApiMessageReactions:()=>i});var r=n(651285),o=n(96190);function i(e){return e.sort(((e,t)=>t.count-e.count)).reduce(((e,t)=>(e.set(r.resolveId(t.reaction_id),{reactionId:r.resolveId(t.reaction_id),count:t.count,peerIds:new Set(t.user_ids.map(o.resolveId))}),e)),new Map)}},882670:(e,t,n)=>{n.d(t,{convertPlatform:()=>l,fromApiAnonym:()=>c,fromApiContact:()=>d,fromApiGroup:()=>s,fromApiUser:()=>a});var r=n(96190);const o=[6482950,6481715,6146827],i={1:"mobile",2:"mobile",3:"mobile",4:"mobile",5:"mobile",6:"other",7:"other"};function a(e){var t,n,i,a,s,d;const c={0:"unfamiliar",1:"outgoingRequest",2:"incomingRequest",3:"friends"};let l="other";(null==(t=e.online_info)?void 0:t.is_mobile)&&(l="mobile"),o.includes((null==(n=e.online_info)?void 0:n.app_id)||0)&&(l="vkme");const u=r.resolveRealId("User",e.id),p=Boolean(e.blacklisted),[,h]=e.photo_id?e.photo_id.split("_"):[],m=h?parseInt(h):null;return{user:{kind:"User",id:u,firstName:e.first_name,firstNameGen:e.first_name_gen||e.first_name,firstNameAcc:e.first_name_acc||e.first_name,lastName:e.last_name,lastNameGen:e.last_name_gen||e.last_name,lastNameAcc:e.last_name_acc||e.last_name,screenName:e.screen_name,sex:void 0!==e.sex?{0:"unknown",1:"female",2:"male"}[e.sex]:"unknown",photoId:m&&!isNaN(m)?m:void 0,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,lastSeen:{isVisible:!!(null==(i=e.online_info)?void 0:i.visible),at:(null==(a=e.online_info)?void 0:a.last_seen)&&1e3*e.online_info.last_seen,platform:l},isVerified:Boolean(e.verified),isBlacklisted:p,isBlacklistedByMe:Boolean(e.blacklisted_by_me),isDeactivated:Boolean(e.deactivated),deactivationReason:e.deactivated,canCall:Boolean(e.can_call),canChangeFriendship:1===e.can_send_friend_request,canInviteToChats:!!e.can_invite_to_chats,canMessage:1===e.can_write_private_message,hasDefaultPhoto:1!==e.has_photo,followersCount:e.followers_count||0,friendship:void 0!==e.friend_status?c[e.friend_status]:c[0],mutualFriends:p?{hint:[],count:0}:void 0,contactName:e.contact_name,occupation:e.occupation,bdate:e.bdate,city:e.city,phone:e.mobile_phone},isOnline:!!(null==(s=e.online_info)?void 0:s.visible)&&!!(null==(d=e.online_info)?void 0:d.is_online)}}function s(e){var t;const n=r.resolveRealId("Group",e.id);if(!e.type)throw new Error(`fromApiGroup содержит некорректный тип ${e.type}`);const o={0:"notMember",1:"member",2:"unsure",3:"declined",4:"outgoingRequest",5:"incomingRequest"}[e.member_status||0];return{kind:"Group",id:n,type:e.type,name:e.name,screenName:e.screen_name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,activity:e.activity,memberCount:e.members_count||0,membership:o,isDeactivated:Boolean(e.deactivated),isVerified:1===e.verified,isClosed:Boolean(e.is_closed),canMessage:1===e.can_message,canChangeMembership:0!==(null==(t=e.ban_info)?void 0:t.end_date)&&(0===e.is_closed||"member"===o||"incomingRequest"===o),mutualFriends:2===e.is_closed&&"member"!==o?{hint:[],count:0}:void 0,isBlacklistedByMe:1===e.is_messages_blocked,site:e.site}}function d(e){const t=r.resolveRealId("Contact",e.id),n=r.resolveId(e.user_id);return{kind:"Contact",id:t,name:e.name,userId:n,phone:e.phone,canWrite:e.can_write,photo50:e.photo_50,lastSeen:e.last_seen_status}}function c(e){const t=r.resolveAnyId(e.id);if(r.isAnonymPeerId(t))return{id:t,kind:"Anonym",name:e.name,photo50:e.photo_50,photo100:e.photo_100,photo200:e.photo_200,photo400:e.photo_400}}function l(e,t){let n=i[e]||"other";return o.includes(t)&&(n="vkme"),n}},54965:(e,t,n)=>{n.d(t,{fromApiPost:()=>p});var r=n(434788),o=n(86144),i=n(504698),a=n(96190),s=n(839963),d=n(434425),c=n(694788),l=n(249690);const u={id:"reactions",items:[{id:0,title:"Нравится",asset:{animation_url:"https://vk.com/reaction/3-reactions-0?c_uniq_tag=83b2081a8e4adfc36ee536f5f1b4ad470174c89678369a4b9dc5547614a3955e",images:[{url:"https://vk.com/reaction/1-reactions-0-48?c_uniq_tag=e6bee176471af6e4f7ca0f57ac099847d57b8101bf07944e47b42b097a6d8455",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-0-72?c_uniq_tag=d6f55fe94c0add8f817b447cbd804768752eb996c06ef222b39eb3fd35834780",width:72,height:72}],title:{color:{foreground:{light:"FF3347",dark:"FF5C5C"},background:{light:"FFEDED",dark:"3E2526"}}},title_color:{light:"FF3347",dark:"FF5C5C"}}},{id:1,title:"Смешно",asset:{animation_url:"https://vk.com/reaction/3-reactions-1?c_uniq_tag=a47193579880c0f53dd597a15d3bd57d4827820687c73d6128df2720647b42b9",images:[{url:"https://vk.com/reaction/1-reactions-1-48?c_uniq_tag=8f5eb3a1d6a6ec81aceff211782af3c9e9a5d1c837f0bfade6965a6844786f8b",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-1-72?c_uniq_tag=c852fcad6e67059878dcf1905e3e416fd89fbc61222ead100935a6fcc1dab4c9",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:2,title:"Ого!",asset:{animation_url:"https://vk.com/reaction/3-reactions-2?c_uniq_tag=b946fcbe262642bc920331746b6eccd9f175bb17d8ef37e54d232fa35ca2c750",images:[{url:"https://vk.com/reaction/1-reactions-2-48?c_uniq_tag=2a6544dce8827d216db7ea91eafc726cd3a823f5d465ba00216901a6de2801ad",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-2-72?c_uniq_tag=5a0663f3d38dd6fbcf3e4973610d50641420631c9df30b6cf80eee0dd5c5efee",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:3,title:"Восторг",asset:{animation_url:"https://vk.com/reaction/3-reactions-3?c_uniq_tag=c6ed3add99e841dccda5479c8e21779954e61e0fba15f94a2ae16706df492123",images:[{url:"https://vk.com/reaction/1-reactions-3-48?c_uniq_tag=eda1a2c18d733b356babdeed5f52cdcc64dd59f1f69776a133fc34a5627eecee",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-3-72?c_uniq_tag=be09c5080773a9ba78984406588c7371e48073e80b842eb7c9a817f7b435379b",width:72,height:72}],title:{color:{foreground:{light:"FF8000",dark:"FFC233"},background:{light:"FFF2D6",dark:"352E23"}}},title_color:{light:"FF8000",dark:"FFC233"}}},{id:5,title:"Печаль",asset:{animation_url:"https://vk.com/reaction/3-reactions-5?c_uniq_tag=c61122c8c334154cb10ccf0e0687057bf1f0f40c2817198b2e1150df534c22c4",images:[{url:"https://vk.com/reaction/1-reactions-5-48?c_uniq_tag=31bcb230babad96120a62589c52af22811aaba54d4ed73a36cfd499d9d94102f",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-5-72?c_uniq_tag=a840d0eb581c133d97638ff5bf34f4b33f3fb8557b932cfe3516925b88e2f151",width:72,height:72}],title:{color:{foreground:{light:"4986CC",dark:"71AAEB"},background:{light:"EDF3FA",dark:"27303C"}}},title_color:{light:"4986CC",dark:"71AAEB"}}},{id:4,title:"&$#%!",asset:{animation_url:"https://vk.com/reaction/3-reactions-4?c_uniq_tag=063e6b2dd888bb5a9716cf6153f03bf9c0c9707713b857eed8fe1e4e09aea2b3",images:[{url:"https://vk.com/reaction/1-reactions-4-48?c_uniq_tag=c80e3224c299a73384c057ff065c9458dcd533d57a1458875eb98883c3a96783",width:48,height:48},{url:"https://vk.com/reaction/1-reactions-4-72?c_uniq_tag=a0eddba1ec31f96adbb9afa2c6c14bec055b95f8d9f113bdf759fb5a9c9054f0",width:72,height:72}],title:{color:{foreground:{light:"EF5203",dark:"FA5300"},background:{light:"FDEBE8",dark:"3C2421"}}},title_color:{light:"EF5203",dark:"FA5300"}}}]};function p(e){var t,n,p,m,f,_,v,g,k,b,y,I,w,C,S;const A=(0,r._)({},null==e||null==(t=e.attachments)||null==(n=t[0])?void 0:n.wall,{attachments:h(e)}),P=null==A||null==(p=A.copy_history)?void 0:p[0];let x={};if(P){const e=(0,c.apiAttachWallOwnerId)(P),t="reply"===P.post_type;x=(0,r._)({},x,t?{wallReply:{kind:"WallReply",id:P.id||0,postId:P.reply_post_id||0,authorId:a.resolveId(P.from_id),ownerId:a.resolveId(e),parentsStack:P.parents_stack,date:1e3*(P.date||0),chunks:i.fromServerText(P.text||""),attaches:(0,c.fromApiWallAttach)(P)}}:{wall:{kind:"Wall",id:P.id||0,authorId:a.resolveId(P.from_id),ownerId:a.resolveId(e),date:1e3*(P.date||0),chunks:i.fromServerText(P.text||""),attaches:(0,c.fromApiWallAttach)(P)}}),A.copy_history=void 0}(null==A?void 0:A.attachments)&&(x=(0,r._)({},x,(0,c.fromApiWallAttach)(A)));let M=[],E=[];return u.items.forEach((e=>{const t=(0,l.fromApiReaction)(e);t&&(M.push(t),E.push(t.id))})),{post:{kind:"Normal",cmid:o.resolveCmid(e.cmid),chunks:(null==A?void 0:A.text)?i.fromServerText(A.text):[],views:(null==A||null==(m=A.views)?void 0:m.count)||0,sentAt:1e3*e.time,updatedAt:e.update_time&&1e3*e.update_time,channelId:s.resolveId(e.author_id),likes:{count:(null==A||null==(f=A.likes)?void 0:f.count)||0,reactionId:Boolean(null==A||null==(_=A.likes)?void 0:_.user_likes)?d.resolveId(null==A||null==(v=A.reactions)?void 0:v.user_reaction):void 0,availableReactionIds:E,peerIds:new Set},reposts:{count:(null==A||null==(g=A.reposts)?void 0:g.count)||0,isReposted:Boolean(null==A||null==(k=A.reposts)?void 0:k.user_reposted)},comments:{count:(null==A||null==(b=A.comments)?void 0:b.count)||0,oneLevelCount:0,canView:Boolean(null==A||null==(y=A.comments)?void 0:y.can_view),canPost:Boolean(null==A||null==(I=A.comments)?void 0:I.can_post),history:[],order:"interesting"},attaches:x,rights:{canDelete:1===A.can_delete},donutPlaceholder:(null==(w=A.donut)?void 0:w.placeholder)?{text:null==(C=A.donut.placeholder)?void 0:C.text,button:null==(S=A.donut.placeholder)?void 0:S.button}:void 0},reactions:M}}function h(e){var t,n;const r=null==e||null==(t=e.attachments)||null==(n=t[0])?void 0:n.wall,o=null==r?void 0:r.geo,i=(null==r?void 0:r.attachments)||[];return o?[...i,{type:"geo",geo:o}]:i}},249690:(e,t,n)=>{n.d(t,{fromApiReaction:()=>o});var r=n(434425);function o(e){var t,n,o,i,a,s;if(!e.asset.animation_url||!(null==(t=e.asset.title_color)?void 0:t.dark)||!(null==(n=e.asset.title_color)?void 0:n.light))return;const d=null==(o=e.asset.images.find((e=>48===e.height)))?void 0:o.url,c=null==(i=e.asset.images.find((e=>72===e.height)))?void 0:i.url;return d&&c?{id:r.resolveId(e.id),animation:e.asset.animation_url,title:e.title,image48:d,image72:c,color:{light:null==(a=e.asset.title_color)?void 0:a.light,dark:null==(s=e.asset.title_color)?void 0:s.dark}}:void 0}},986727:(e,t,n)=>{n.d(t,{fromApiSticker:()=>o,fromApiStickersKeywords:()=>i,fromApiUgcSticker:()=>a,fromContextSticker:()=>s});var r=n(71568);function o(e){return{id:r.resolveStickerId(e.sticker_id),kind:"Sticker",item:e}}function i(e){return e.dictionary.reduce(((e,t)=>{const n=(t.stickers||[]).map((e=>o(e).id));for(const r of t.words)e[r]=n;return e}),{})}const a=e=>({kind:"UgcSticker",id:e.id,item:e}),s=e=>e.isUGC?{id:e.id,kind:"UgcSticker",item:e.rawData}:{id:e.id,kind:"Sticker",item:e.rawData}},877740:(e,t,n)=>{var r;n.d(t,{IEngine:()=>r}),function(e){let t,n,r;!function(e){e[e.Mention=1]="Mention",e[e.ExpiringMessage=2]="ExpiringMessage"}(t=e.MarkedType||(e.MarkedType={})),function(e){e[e.CopyFlagChanged=0]="CopyFlagChanged",e[e.TitleChanged=1]="TitleChanged",e[e.AvatarChanged=2]="AvatarChanged",e[e.AdminGrated=3]="AdminGrated",e[e.FlagsChanged=4]="FlagsChanged",e[e.Pinned=5]="Pinned",e[e.UserJoined=6]="UserJoined",e[e.UserLeft=7]="UserLeft",e[e.UserKicked=8]="UserKicked",e[e.AdminKicked=9]="AdminKicked",e[e.BannerChanged=10]="BannerChanged",e[e.KeyboardChanged=11]="KeyboardChanged",e[e.MessageRequestChanged=12]="MessageRequestChanged",e[e.ContactConverted=13]="ContactConverted",e[e.BusinessNotifyDataChanged=14]="BusinessNotifyDataChanged",e[e.MessageRequestCanceled=15]="MessageRequestCanceled",e[e.MessageRequestRejected=16]="MessageRequestRejected",e[e.MessageRequestAccepted=17]="MessageRequestAccepted",e[e.ContactJoined=18]="ContactJoined",e[e.CallInProgressChanged=19]="CallInProgressChanged",e[e.DonSubscribed=20]="DonSubscribed",e[e.DonUnsubscribed=21]="DonUnsubscribed",e[e.IsNewChange=22]="IsNewChange",e[e.StyleChanged=23]="StyleChanged",e[e.DescriptionChanged=24]="DescriptionChanged",e[e.ShortPollReactionsChanged=25]="ShortPollReactionsChanged"}(n=e.ChatUpdateType||(e.ChatUpdateType={})),function(e){e[e.Deleted=0]="Deleted",e[e.Accepted=1]="Accepted",e[e.Rejected=2]="Rejected",e[e.New=3]="New"}(r=e.MRStatus||(e.MRStatus={})),e.isIncompleteUpdate=function(e){switch(e[0]){case 10004:{const t=12;return e.length<t}case 10005:{const t=11;return e.length<t}case 10018:{const t=11;return e.length<t}case 4:{const t=12;return e.length<t}case 5:{const t=11;return e.length<t}case 18:{const t=11;return e.length<t}default:return!1}}}(r||(r={}))},991792:(e,t,n)=>{n.d(t,{TypingVariants:()=>h,addConvosToFolder:()=>I,getConvosByIds:()=>w,getOwnerGroupId:()=>b,insertChannels:()=>k,insertContactItems:()=>_,insertContacts:()=>v,insertConvos:()=>m,insertFolders:()=>g,insertPeers:()=>f,removeConvosFromFolder:()=>y});var r=n(185327),o=n(96190),i=n(821551),a=n(839963),s=n(999504),d=n(954811),c=n(882670),l=n(171949),u=n(739361),p=n(54965);const h=["text","voice","photo","video","file","videomessage"];function m(e,t,{dangerouslyMerge:n}={}){const o=[];for(const i of t){var a;const t="conversation"in i?(0,d.fromApiConvo)(i.conversation,i.last_message):(0,d.fromApiConvo)(i);if(!t)continue;const{convo:s,peer:c}=t,l=e.convos.get(s.peerId);if(l&&!n){o.push(l);continue}const u=r.merge(s,l);e.convos.set(s.peerId,u),c&&e.peers.set(c.id,c),o.push(s),"ChatConvo"===u.kind&&e.hiddenPinnedMessages.get(u.peerId)!==(null==(a=u.pinnedMessage)?void 0:a.cmid)&&e.hiddenPinnedMessages.delete(u.peerId)}const s=o.filter((e=>!r.isMR(e)&&!r.isBusinessNotify(e)));return i.add(e.convosSearchIndex,s,(t=>{const n=e.peers.get(t.peerId);return{id:t.peerId,strings:n?i.peerWords(n):[]}})),o}function f(e,{apiUsers:t,apiGroups:n,apiContacts:r},{dangerouslyOverwrite:i}={}){const a=[];for(const n of t){const{user:t,isOnline:r}=(0,c.fromApiUser)(n),s=e.peers.get(t.id);e.onlines.delete(t.id),r&&e.onlines.add(t.id),"User"===(null==s?void 0:s.kind)&&o.updateLastSeen(s,t.lastSeen),"User"!==(null==s?void 0:s.kind)||i?(e.peers.set(t.id,t),a.push(t)):a.push(s)}const s=[];for(const t of n){const n=(0,c.fromApiGroup)(t),r=e.peers.get(n.id);!r||"Group"!==r.kind||i?(e.peers.set(n.id,n),s.push(n)):s.push(r)}const d=[];for(const t of r){const n=(0,c.fromApiContact)(t),r=e.peers.get(n.id);!r||"Contact"!==r.kind||i?(e.peers.set(n.id,n),d.push(n)):d.push(r)}return{insertedUsers:a,insertedGroups:s,insertedContacts:d}}function _(e,t,n){const r=[];return f(e,{apiUsers:n,apiGroups:[],apiContacts:[]},{dangerouslyOverwrite:!0}),t.forEach((t=>{const n=o.resolveId(t);if(o.isUserPeerId(n)){const t=e.peers.get(n);if("User"!==(null==t?void 0:t.kind))return;e.contacts.items.set(n,t),r.push(n)}})),r}function v(e,t){const n=[];t.sort(((e,t)=>e.name.localeCompare(t.name)));for(const r of t){const t=(0,c.fromApiContact)(r),o=t.userId?t.userId:t.id;e.contacts.contacts.set(o,t),n.push(t)}return n}function g(e,t){const n=[];for(const r of t){const t=(0,l.fromApiFolder)(r);e.organisers.folders.find((e=>e.id===t.id))?n.push(t):(e.organisers.folders.push(t),n.push(t))}return n}function k(e,{apiChannels:t,apiGroups:n,dangerouslyMerge:r}){const o=[];for(const i of t){const t=n.find((e=>-e.id===i.channel.channel_id));if(!t)throw new Error("С бэка не приходит нужная группа для канала");const s=(0,u.fromApiChannel)(i,t);(i.last_message&&(0,p.fromApiPost)(i.last_message).reactions||[]).forEach((t=>{e.reactions.set(t.id,t)}));const d=e.channels.get(s.id);if(d&&!r){o.push(d);continue}const c=d?a.merge(d,s):s;e.channels.set(c.id,c),o.push(c)}return o}function b(e){return o.isGroupPeerId(e)?o.toRealId(e):0}function y(e,t,n){const o=e.organisers.folders.find((e=>e.id===t));if(!o)return;var i;let a=null!=(i=o.unreadCount)?i:0;var d;let c=null!=(d=o.unreadUnmutedCount)?d:0;for(const o of n)r.isInFolder(o,t)&&(r.removeFolder(o,t),s.refresh(e.organisers.folders,o),o.unreadCount&&(r.isMuted(o)?a--:c--));s.setUnreadCounters(e.organisers.folders,t,a,c)}function I(e,t,n){const o=[],i=e.organisers.folders.find((e=>e.id===t));if(!i)return;var a;let d=null!=(a=i.unreadCount)?a:0;var c;let l=null!=(c=i.unreadUnmutedCount)?c:0;for(const e of n)r.isInFolder(e,t)||(r.addFolder(e,t),o.push(e),e.unreadCount&&(r.isMuted(e)?d++:l++));s.push(e.organisers.folders,t,"all",o,i.all.hasMore),s.push(e.organisers.folders,t,"unread",o.filter((e=>r.isUnread(e))),i.unread.hasMore),s.setUnreadCounters(e.organisers.folders,t,d,l)}function w(e,t){return t.reduce(((t,n)=>{const r=e.convos.get(o.resolveId(n));return r&&t.push(r),t}),[])}},997650:(e,t,n)=>{n.d(t,{observe:()=>c,useInView:()=>l});var r=n(667294);const o=new Map,i=new WeakMap;let a,s=0;function d(e){return Object.keys(e).sort().filter((t=>void 0!==e[t])).map((t=>{return`${t}_${"root"===t?(n=e.root,n?(i.has(n)||(s+=1,i.set(n,s.toString())),i.get(n)):"0"):e[t]}`;var n})).toString()}function c(e,t,n={},r=a){if(void 0===window.IntersectionObserver&&void 0!==r){const o=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"==typeof n.threshold?n.threshold:0,time:0,boundingClientRect:o,intersectionRect:o,rootBounds:o}),()=>{}}const{id:i,observer:s,elements:c}=function(e){let t=d(e),n=o.get(t);if(!n){const r=new Map;let i;const a=new IntersectionObserver((t=>{t.forEach((t=>{var n;const o=t.isIntersecting&&i.some((e=>t.intersectionRatio>=e));e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=o),null==(n=r.get(t.target))||n.forEach((e=>{e(o,t)}))}))}),e);i=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:a,elements:r},o.set(t,n)}return n}(n);let l=c.get(e)||[];return c.has(e)||c.set(e,l),l.push(t),s.observe(e),function(){l.splice(l.indexOf(t),1),0===l.length&&(c.delete(e),s.unobserve(e)),0===c.size&&(s.disconnect(),o.delete(i))}}r.Component;function l({threshold:e,delay:t,trackVisibility:n,rootMargin:o,root:i,triggerOnce:a,skip:s,initialInView:d,fallbackInView:l,onChange:u}={}){var p;const[h,m]=r.useState(null),f=r.useRef(),[_,v]=r.useState({inView:!!d,entry:void 0});f.current=u,r.useEffect((()=>{if(s||!h)return;let r;return r=c(h,((e,t)=>{v({inView:e,entry:t}),f.current&&f.current(e,t),t.isIntersecting&&a&&r&&(r(),r=void 0)}),{root:i,rootMargin:o,threshold:e,trackVisibility:n,delay:t},l),()=>{r&&r()}}),[Array.isArray(e)?e.toString():e,h,i,o,a,s,n,l,t]);const g=null==(p=_.entry)?void 0:p.target,k=r.useRef();h||!g||a||s||k.current===g||(k.current=g,v({inView:!!d,entry:void 0}));const b=[m,_.inView,_.entry];return b.ref=b[0],b.inView=b[1],b.entry=b[2],b}}}]);try{stManager.done("dist/8d0a62ab5c45600d60af72c18bc20c9c.76c844f4115d8cb6b4eb.js")}catch(e){}